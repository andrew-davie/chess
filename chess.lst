------- FILE ./chess.asm LEVEL 1 PASS 2
      1  10000 ????						; Chess
      2  10000 ????						; Atari 2600 Chess display system
      3  10000 ????						; Copyright (c) 2019-2020 Andrew Davie
      4  10000 ????						; andrew@taswegian.com
      5  10000 ????
      6  10000 ????
      7  10000 ????		00 40	    TIA_BASE_ADDRESS =	$40
      8  10000 ????
      9  10000 ????				       processor	6502
------- FILE vcs.h LEVEL 2 PASS 2
      0  10000 ????				       include	"vcs.h"
      1  10000 ????						; VCS.H
      2  10000 ????						; Version 1.05, 13/November/2003
      3  10000 ????
      4  10000 ????		00 69	    VERSION_VCS =	105
      5  10000 ????
      6  10000 ????						; This file defines hardware registers and memory mapping for the
      7  10000 ????						; Atari 2600. It is distributed as a companion machine-specific support package
      8  10000 ????						; for the DASM compiler. Updates to this file, DASM, and associated tools are
      9  10000 ????						; available at at http://www.atari2600.org/dasm
     10  10000 ????						;
     11  10000 ????						; Many thanks to the original author(s) of this file, and to everyone who has
     12  10000 ????						; contributed to understanding the Atari 2600.  If you take issue with the
     13  10000 ????						; contents, or naming of registers, please write to me (atari2600@taswegian.com)
     14  10000 ????						; with your views.  Please contribute, if you think you can improve this
     15  10000 ????						; file!
     16  10000 ????						;
     17  10000 ????						; Latest Revisions...
     18  10000 ????						; 1.05  13/NOV/2003	  - Correction to 1.04 - now functions as requested by MR.
     19  10000 ????						;			  - Added VERSION_VCS equate (which will reflect 100x version #)
     20  10000 ????						;			    This will allow conditional code to verify VCS.H being
     21  10000 ????						;			    used for code assembly.
     22  10000 ????						; 1.04  12/NOV/2003	 Added TIA_BASE_WRITE_ADDRESS and TIA_BASE_READ_ADDRESS for
     23  10000 ????						;			 convenient disassembly/reassembly compatibility for hardware
     24  10000 ????						;			 mirrored reading/writing differences.	This is more a
     25  10000 ????						;			 readability issue, and binary compatibility with disassembled
     26  10000 ????						;			 and reassembled sources.  Per Manuel Rotschkar's suggestion.
     27  10000 ????						; 1.03  12/MAY/2003	 Added SEG segment at end of file to fix old-code compatibility
     28  10000 ????						;			 which was broken by the use of segments in this file, as
     29  10000 ????						;			 reported by Manuel Polik on [stella] 11/MAY/2003
     30  10000 ????						; 1.02  22/MAR/2003	 Added TIMINT($285)
     31  10000 ????						; 1.01				Constant offset added to allow use for 3F-style bankswitching
     32  10000 ????						;						 - define TIA_BASE_ADDRESS as $40 for Tigervision carts, otherwise
     33  10000 ????						;						   it is safe to leave it undefined, and the base address will
     34  10000 ????						;						   be set to 0.  Thanks to Eckhard Stolberg for the suggestion.
     35  10000 ????						;			    Note, may use -DLABEL=EXPRESSION to define TIA_BASE_ADDRESS
     36  10000 ????						;			  - register definitions are now generated through assignment
     37  10000 ????						;			    in uninitialised segments.	This allows a changeable base
     38  10000 ????						;			    address architecture.
     39  10000 ????						; 1.0	22/MAR/2003		Initial release
     40  10000 ????
     41  10000 ????
     42  10000 ????						;-------------------------------------------------------------------------------
     43  10000 ????
     44  10000 ????						; TIA_BASE_ADDRESS
     45  10000 ????						; The TIA_BASE_ADDRESS defines the base address of access to TIA registers.
     46  10000 ????						; Normally 0, the base address should (externally, before including this file)
     47  10000 ????						; be set to $40 when creating 3F-bankswitched (and other?) cartridges.
     48  10000 ????						; The reason is that this bankswitching scheme treats any access to locations
     49  10000 ????						; < $40 as a bankswitch.
     50  10000 ????
     51  10000 ????			   -	       IFNCONST	TIA_BASE_ADDRESS
     52  10000 ????			   -TIA_BASE_ADDRESS =	0
     53  10000 ????				       ENDIF
     54  10000 ????
     55  10000 ????						; Note: The address may be defined on the command-line using the -D switch, eg:
     56  10000 ????						; dasm.exe code.asm -DTIA_BASE_ADDRESS=$40 -f3 -v5 -ocode.bin
     57  10000 ????						; *OR* by declaring the label before including this file, eg:
     58  10000 ????						; TIA_BASE_ADDRESS = $40
     59  10000 ????						;   include "vcs.h"
     60  10000 ????
     61  10000 ????						; Alternate read/write address capability - allows for some disassembly compatibility
     62  10000 ????						; usage ; to allow reassembly to binary perfect copies).  This is essentially catering
     63  10000 ????						; for the mirrored ROM hardware registers.
     64  10000 ????
     65  10000 ????						; Usage: As per above, define the TIA_BASE_READ_ADDRESS and/or TIA_BASE_WRITE_ADDRESS
     66  10000 ????						; using the -D command-line switch, as required.  If the addresses are not defined,
     67  10000 ????						; they defaut to the TIA_BASE_ADDRESS.
     68  10000 ????
     69  10000 ????			   -	       IFNCONST	TIA_BASE_READ_ADDRESS
     70  10000 ????			   -TIA_BASE_READ_ADDRESS =	TIA_BASE_ADDRESS
     71  10000 ????				       ENDIF
     72  10000 ????
     73  10000 ????			   -	       IFNCONST	TIA_BASE_WRITE_ADDRESS
     74  10000 ????			   -TIA_BASE_WRITE_ADDRESS =	TIA_BASE_ADDRESS
     75  10000 ????				       ENDIF
     76  10000 ????
     77  10000 ????						;-------------------------------------------------------------------------------
     78  10000 ????
     79 U006d ????				      SEG.U	TIA_REGISTERS_WRITE
     80 U0040					      ORG	TIA_BASE_WRITE_ADDRESS
     81 U0040
     82 U0040							; DO NOT CHANGE THE RELATIVE ORDERING OF REGISTERS!
     83 U0040
     84 U0040		       00	   VSYNC      ds	1	; $00	 0000 00x0   Vertical Sync Set-Clear
     85 U0041		       00	   VBLANK     ds	1	; $01	 xx00 00x0   Vertical Blank Set-Clear
     86 U0042		       00	   WSYNC      ds	1	; $02	 ---- ----   Wait for Horizontal Blank
     87 U0043		       00	   RSYNC      ds	1	; $03	 ---- ----   Reset Horizontal Sync Counter
     88 U0044		       00	   NUSIZ0     ds	1	; $04	 00xx 0xxx   Number-Size player/missle 0
     89 U0045		       00	   NUSIZ1     ds	1	; $05	 00xx 0xxx   Number-Size player/missle 1
     90 U0046		       00	   COLUP0     ds	1	; $06	 xxxx xxx0   Color-Luminance Player 0
     91 U0047		       00	   COLUP1     ds	1	; $07	 xxxx xxx0   Color-Luminance Player 1
     92 U0048		       00	   COLUPF     ds	1	; $08	 xxxx xxx0   Color-Luminance Playfield
     93 U0049		       00	   COLUBK     ds	1	; $09	 xxxx xxx0   Color-Luminance Background
     94 U004a		       00	   CTRLPF     ds	1	; $0A	 00xx 0xxx   Control Playfield, Ball, Collisions
     95 U004b		       00	   REFP0      ds	1	; $0B	 0000 x000   Reflection Player 0
     96 U004c		       00	   REFP1      ds	1	; $0C	 0000 x000   Reflection Player 1
     97 U004d		       00	   PF0	      ds	1	; $0D	 xxxx 0000   Playfield Register Byte 0
     98 U004e		       00	   PF1	      ds	1	; $0E	 xxxx xxxx   Playfield Register Byte 1
     99 U004f		       00	   PF2	      ds	1	; $0F	 xxxx xxxx   Playfield Register Byte 2
    100 U0050		       00	   RESP0      ds	1	; $10	 ---- ----   Reset Player 0
    101 U0051		       00	   RESP1      ds	1	; $11	 ---- ----   Reset Player 1
    102 U0052		       00	   RESM0      ds	1	; $12	 ---- ----   Reset Missle 0
    103 U0053		       00	   RESM1      ds	1	; $13	 ---- ----   Reset Missle 1
    104 U0054		       00	   RESBL      ds	1	; $14	 ---- ----   Reset Ball
    105 U0055		       00	   AUDC0      ds	1	; $15	 0000 xxxx   Audio Control 0
    106 U0056		       00	   AUDC1      ds	1	; $16	 0000 xxxx   Audio Control 1
    107 U0057		       00	   AUDF0      ds	1	; $17	 000x xxxx   Audio Frequency 0
    108 U0058		       00	   AUDF1      ds	1	; $18	 000x xxxx   Audio Frequency 1
    109 U0059		       00	   AUDV0      ds	1	; $19	 0000 xxxx   Audio Volume 0
    110 U005a		       00	   AUDV1      ds	1	; $1A	 0000 xxxx   Audio Volume 1
    111 U005b		       00	   GRP0       ds	1	; $1B	 xxxx xxxx   Graphics Register Player 0
    112 U005c		       00	   GRP1       ds	1	; $1C	 xxxx xxxx   Graphics Register Player 1
    113 U005d		       00	   ENAM0      ds	1	; $1D	 0000 00x0   Graphics Enable Missle 0
    114 U005e		       00	   ENAM1      ds	1	; $1E	 0000 00x0   Graphics Enable Missle 1
    115 U005f		       00	   ENABL      ds	1	; $1F	 0000 00x0   Graphics Enable Ball
    116 U0060		       00	   HMP0       ds	1	; $20	 xxxx 0000   Horizontal Motion Player 0
    117 U0061		       00	   HMP1       ds	1	; $21	 xxxx 0000   Horizontal Motion Player 1
    118 U0062		       00	   HMM0       ds	1	; $22	 xxxx 0000   Horizontal Motion Missle 0
    119 U0063		       00	   HMM1       ds	1	; $23	 xxxx 0000   Horizontal Motion Missle 1
    120 U0064		       00	   HMBL       ds	1	; $24	 xxxx 0000   Horizontal Motion Ball
    121 U0065		       00	   VDELP0     ds	1	; $25	 0000 000x   Vertical Delay Player 0
    122 U0066		       00	   VDELP1     ds	1	; $26	 0000 000x   Vertical Delay Player 1
    123 U0067		       00	   VDELBL     ds	1	; $27	 0000 000x   Vertical Delay Ball
    124 U0068		       00	   RESMP0     ds	1	; $28	 0000 00x0   Reset Missle 0 to Player 0
    125 U0069		       00	   RESMP1     ds	1	; $29	 0000 00x0   Reset Missle 1 to Player 1
    126 U006a		       00	   HMOVE      ds	1	; $2A	 ---- ----   Apply Horizontal Motion
    127 U006b		       00	   HMCLR      ds	1	; $2B	 ---- ----   Clear Horizontal Move Registers
    128 U006c		       00	   CXCLR      ds	1	; $2C	 ---- ----   Clear Collision Latches
    129 U006d
    130 U006d							;-------------------------------------------------------------------------------
    131 U006d
    132 U004e ????				      SEG.U	TIA_REGISTERS_READ
    133 U0040					      ORG	TIA_BASE_READ_ADDRESS
    134 U0040
    135 U0040							;											bit 7	 bit 6
    136 U0040		       00	   CXM0P      ds	1	; $00	     xx00 0000	     Read Collision  M0-P1   M0-P0
    137 U0041		       00	   CXM1P      ds	1	; $01	     xx00 0000			     M1-P0   M1-P1
    138 U0042		       00	   CXP0FB     ds	1	; $02	     xx00 0000			     P0-PF   P0-BL
    139 U0043		       00	   CXP1FB     ds	1	; $03	     xx00 0000			     P1-PF   P1-BL
    140 U0044		       00	   CXM0FB     ds	1	; $04	     xx00 0000			     M0-PF   M0-BL
    141 U0045		       00	   CXM1FB     ds	1	; $05	     xx00 0000			     M1-PF   M1-BL
    142 U0046		       00	   CXBLPF     ds	1	; $06	     x000 0000			     BL-PF   -----
    143 U0047		       00	   CXPPMM     ds	1	; $07	     xx00 0000			     P0-P1   M0-M1
    144 U0048		       00	   INPT0      ds	1	; $08	     x000 0000	     Read Pot Port 0
    145 U0049		       00	   INPT1      ds	1	; $09	     x000 0000	     Read Pot Port 1
    146 U004a		       00	   INPT2      ds	1	; $0A	     x000 0000	     Read Pot Port 2
    147 U004b		       00	   INPT3      ds	1	; $0B	     x000 0000	     Read Pot Port 3
    148 U004c		       00	   INPT4      ds	1	; $0C		x000 0000	 Read Input (Trigger) 0
    149 U004d		       00	   INPT5      ds	1	; $0D		x000 0000	 Read Input (Trigger) 1
    150 U004e
    151 U004e							;-------------------------------------------------------------------------------
    152 U004e
    153 U0298 ????				      SEG.U	RIOT
    154 U0280					      ORG	$280
    155 U0280
    156 U0280							; RIOT MEMORY MAP
    157 U0280
    158 U0280		       00	   SWCHA      ds	1	; $280      Port A data register for joysticks:
    159 U0281							;			Bits 4-7 for player 1.  Bits 0-3 for player 2.
    160 U0281
    161 U0281		       00	   SWACNT     ds	1	; $281      Port A data direction register (DDR)
    162 U0282		       00	   SWCHB      ds	1	; $282		Port B data (console switches)
    163 U0283		       00	   SWBCNT     ds	1	; $283      Port B DDR
    164 U0284		       00	   INTIM      ds	1	; $284		Timer output
    165 U0285
    166 U0285		       00	   TIMINT     ds	1	; $285
    167 U0286
    168 U0286							; Unused/undefined registers ($285-$294)
    169 U0286
    170 U0286		       00		      ds	1	; $286
    171 U0287		       00		      ds	1	; $287
    172 U0288		       00		      ds	1	; $288
    173 U0289		       00		      ds	1	; $289
    174 U028a		       00		      ds	1	; $28A
    175 U028b		       00		      ds	1	; $28B
    176 U028c		       00		      ds	1	; $28C
    177 U028d		       00		      ds	1	; $28D
    178 U028e		       00		      ds	1	; $28E
    179 U028f		       00		      ds	1	; $28F
    180 U0290		       00		      ds	1	; $290
    181 U0291		       00		      ds	1	; $291
    182 U0292		       00		      ds	1	; $292
    183 U0293		       00		      ds	1	; $293
    184 U0294
    185 U0294		       00	   TIM1T      ds	1	; $294		set 1 clock interval
    186 U0295		       00	   TIM8T      ds	1	; $295      set 8 clock interval
    187 U0296		       00	   TIM64T     ds	1	; $296      set 64 clock interval
    188 U0297		       00	   T1024T     ds	1	; $297      set 1024 clock interval
    189 U0298
    190 U0298							;-------------------------------------------------------------------------------
    191 U0298							; The following required for back-compatibility with code which does not use
    192 U0298							; segments.
    193 U0298
    194  0000 ????				      SEG
    195  0000 ????
    196  0000 ????						; EOF
------- FILE ./chess.asm
------- FILE macro.h LEVEL 2 PASS 2
      0  0000 ????				      include	"macro.h"
      1  0000 ????
      2  0000 ????						; MACRO.H
      3  0000 ????						; Version 1.06, 3/SEPTEMBER/2004
      4  0000 ????
      5  0000 ????	       00 6a	   VERSION_MACRO =	106
      6  0000 ????
      7  0000 ????						;
      8  0000 ????						; THIS FILE IS EXPLICITLY SUPPORTED AS A DASM-PREFERRED COMPANION FILE
      9  0000 ????						; PLEASE DO *NOT* REDISTRIBUTE MODIFIED VERSIONS OF THIS FILE!
     10  0000 ????						;
     11  0000 ????						; This file defines DASM macros useful for development for the Atari 2600.
     12  0000 ????						; It is distributed as a companion machine-specific support package
     13  0000 ????						; for the DASM compiler. Updates to this file, DASM, and associated tools are
     14  0000 ????						; available at at http://www.atari2600.org/dasm
     15  0000 ????						;
     16  0000 ????						; Many thanks to the people who have contributed.  If you take issue with the
     17  0000 ????						; contents, or would like to add something, please write to me
     18  0000 ????						; (atari2600@taswegian.com) with your contribution.
     19  0000 ????						;
     20  0000 ????						; Latest Revisions...
     21  0000 ????						;
     22  0000 ????						; 1.06  03/SEP/2004	 - nice revision of VERTICAL_BLANK (Edwin Blink)
     23  0000 ????						; 1.05  14/NOV/2003	 - Added VERSION_MACRO equate (which will reflect 100x version #)
     24  0000 ????						;			   This will allow conditional code to verify MACRO.H being
     25  0000 ????						;			   used for code assembly.
     26  0000 ????						; 1.04  13/NOV/2003	 - SET_POINTER macro added (16-bit address load)
     27  0000 ????						;
     28  0000 ????						; 1.03  23/JUN/2003	 - CLEAN_START macro added - clears TIA, RAM, registers
     29  0000 ????						;
     30  0000 ????						; 1.02  14/JUN/2003	 - VERTICAL_SYNC macro added
     31  0000 ????						;			   (standardised macro for vertical synch code)
     32  0000 ????						; 1.01  22/MAR/2003	 - SLEEP macro added.
     33  0000 ????						;			 - NO_ILLEGAL_OPCODES switch implemented
     34  0000 ????						; 1.0	22/MAR/2003		Initial release
     35  0000 ????
     36  0000 ????						; Note: These macros use illegal opcodes.  To disable illegal opcode usage,
     37  0000 ????						;   define the symbol NO_ILLEGAL_OPCODES (-DNO_ILLEGAL_OPCODES=1 on command-line).
     38  0000 ????						;   If you do not allow illegal opcode usage, you must include this file
     39  0000 ????						;   *after* including VCS.H (as the non-illegal opcodes access hardware
     40  0000 ????						;   registers and require them to be defined first).
     41  0000 ????
     42  0000 ????						; Available macros...
     43  0000 ????						;   SLEEP n		 - sleep for n cycles
     44  0000 ????						;   VERTICAL_SYNC	 - correct 3 scanline vertical synch code
     45  0000 ????						;   CLEAN_START	 - set machine to known state on startup
     46  0000 ????						;   SET_POINTER	 - load a 16-bit absolute to a 16-bit variable
     47  0000 ????
     48  0000 ????						;-------------------------------------------------------------------------------
     49  0000 ????						; SLEEP duration
     50  0000 ????						; Original author: Thomas Jentzsch
     51  0000 ????						; Inserts code which takes the specified number of cycles to execute.	This is
     52  0000 ????						; useful for code where precise timing is required.
     53  0000 ????						; ILLEGAL-OPCODE VERSION DOES NOT AFFECT FLAGS OR REGISTERS.
     54  0000 ????						; LEGAL OPCODE VERSION MAY AFFECT FLAGS
     55  0000 ????						; Uses illegal opcode (DASM 2.20.01 onwards).
     56  0000 ????
     57  0000 ????				      MAC	sleep
     58  0000 ????			   .CYCLES    SET	{1}
     59  0000 ????
     60  0000 ????				      IF	.CYCLES < 2
     61  0000 ????				      ECHO	"MACRO ERROR: 'SLEEP': Duration must be > 1"
     62  0000 ????				      ERR
     63  0000 ????				      ENDIF
     64  0000 ????
     65  0000 ????				      IF	.CYCLES & 1
     66  0000 ????				      IFNCONST	NO_ILLEGAL_OPCODES
     67  0000 ????				      nop	0
     68  0000 ????				      ELSE
     69  0000 ????				      bit	VSYNC
     70  0000 ????				      ENDIF
     71  0000 ????			   .CYCLES    SET	.CYCLES - 3
     72  0000 ????				      ENDIF
     73  0000 ????
     74  0000 ????				      REPEAT	.CYCLES / 2
     75  0000 ????				      nop
     76  0000 ????				      REPEND
     77  0000 ????				      ENDM		;usage: SLEEP n (n>1)
     78  0000 ????
     79  0000 ????						;-------------------------------------------------------------------------------
     80  0000 ????						; VERTICAL_SYNC
     81  0000 ????						; revised version by Edwin Blink -- saves bytes!
     82  0000 ????						; Inserts the code required for a proper 3 scanline vertical sync sequence
     83  0000 ????						; Note: Alters the accumulator
     84  0000 ????
     85  0000 ????						; OUT: A = 0
     86  0000 ????
     87  0000 ????				      MAC	vertical_sync
     88  0000 ????				      lda	#%1110	; each '1' bits generate a VSYNC ON line (bits 1..3)
     89  0000 ????			   .VSLP1     sta	WSYNC	; 1st '0' bit resets Vsync, 2nd '0' bit exit loop
     90  0000 ????				      sta	VSYNC
     91  0000 ????				      lsr
     92  0000 ????				      bne	.VSLP1	; branch until VYSNC has been reset
     93  0000 ????				      ENDM
     94  0000 ????
     95  0000 ????						;-------------------------------------------------------------------------------
     96  0000 ????						; CLEAN_START
     97  0000 ????						; Original author: Andrew Davie
     98  0000 ????						; Standardised start-up code, clears stack, all TIA registers and RAM to 0
     99  0000 ????						; Sets stack pointer to $FF, and all registers to 0
    100  0000 ????						; Sets decimal mode off, sets interrupt flag (kind of un-necessary)
    101  0000 ????						; Use as very first section of code on boot (ie: at reset)
    102  0000 ????						; Code written to minimise total ROM usage - uses weird 6502 knowledge :)
    103  0000 ????
    104  0000 ????				      MAC	clean_start
    105  0000 ????				      sei
    106  0000 ????				      cld
    107  0000 ????
    108  0000 ????				      ldx	#0
    109  0000 ????				      txa
    110  0000 ????				      tay
    111  0000 ????			   .CLEAR_STACK dex
    112  0000 ????				      txs
    113  0000 ????				      pha
    114  0000 ????				      bne	.CLEAR_STACK	; SP=$FF, X = A = Y = 0
    115  0000 ????
    116  0000 ????				      ENDM
    117  0000 ????
    118  0000 ????						;-------------------------------------------------------
    119  0000 ????						; SET_POINTER
    120  0000 ????						; Original author: Manuel Rotschkar
    121  0000 ????						;
    122  0000 ????						; Sets a 2 byte RAM pointer to an absolute address.
    123  0000 ????						;
    124  0000 ????						; Usage: SET_POINTER pointer, address
    125  0000 ????						; Example: SET_POINTER SpritePTR, SpriteData
    126  0000 ????						;
    127  0000 ????						; Note: Alters the accumulator, NZ flags
    128  0000 ????						; IN 1: 2 byte RAM location reserved for pointer
    129  0000 ????						; IN 2: absolute address
    130  0000 ????
    131  0000 ????				      MAC	set_pointer
    132  0000 ????			   .POINTER   SET	{1}
    133  0000 ????			   .ADDRESS   SET	{2}
    134  0000 ????
    135  0000 ????				      LDA	#<.ADDRESS	; Get Lowbyte of Address
    136  0000 ????				      STA	.POINTER	; Store in pointer
    137  0000 ????				      LDA	#>.ADDRESS	; Get Hibyte of Address
    138  0000 ????				      STA	.POINTER+1	; Store in pointer+1
    139  0000 ????
    140  0000 ????				      ENDM
    141  0000 ????
    142  0000 ????						;-------------------------------------------------------
    143  0000 ????						; BOUNDARY byte#
    144  0000 ????						; Original author: Denis Debro (borrowed from Bob Smith / Thomas)
    145  0000 ????						;
    146  0000 ????						; Push data to a certain position inside a page and keep count of how
    147  0000 ????						; many free bytes the programmer will have.
    148  0000 ????						;
    149  0000 ????						; eg: BOUNDARY 5    ; position at byte #5 in page
    150  0000 ????
    151  0000 ????			   __DASM__TOTAL_FREE_MEMORY SET	0
    152  0000 ????			   .FREE_BYTES SET	0
    153  0000 ????				      MAC	boundary
    154  0000 ????				      REPEAT	256
    155  0000 ????				      IF	<. % {1} = 0
    156  0000 ????				      MEXIT
    157  0000 ????				      ELSE
    158  0000 ????			   .FREE_BYTES SET	.FREE_BYTES + 1
    159  0000 ????				      .byte	$00
    160  0000 ????				      ENDIF
    161  0000 ????				      REPEND
    162  0000 ????			   __DASM__TOTAL_FREE_MEMORY SET	__DASM__TOTAL_FREE_MEMORY + .FREE_BYTES
    163  0000 ????				      ENDM
    164  0000 ????
    165  0000 ????
    166  0000 ????						; EOF
------- FILE ./chess.asm
------- FILE piece_defines.h LEVEL 2 PASS 2
      0  0000 ????				      include	"piece_defines.h"
      1  0000 ????						; Copyright (C)2020 Andrew Davie
      2  0000 ????
      3  0000 ????	       00 80	   BLACK      =	128
      4  0000 ????	       00 00	   WHITE      =	0
      5  0000 ????
      6  0000 ????	       00 80	   FLAG_COLOUR =	128	; mask
      7  0000 ????	       00 40	   FLAG_MOVED =	64	; mark ALL pieces when moved. Used for castling
      8  0000 ????						; but maybe useful for evaluation of development
      9  0000 ????	       00 20	   FLAG_ENPASSANT =	32
     10  0000 ????	       00 10	   FLAG_CASTLE =	16
     11  0000 ????
     12  0000 ????						;---------------------------------------------------------------------------------------------------
     13  0000 ????						; DEFINE THE PIECES
     14  0000 ????						; ID lives in bits 0-2
     15  0000 ????
     16  0000 ????	       00 00	   BLANK      =	0
     17  0000 ????	       00 00	   ███  =	BLANK
     18  0000 ????
     19  0000 ????	       00 01	   WPAWN      =	1
     20  0000 ????	       00 01	   WP	      =	WPAWN
     21  0000 ????	       00 02	   BPAWN      =	2
     22  0000 ????	       00 02	   BP	      =	BPAWN
     23  0000 ????	       00 03	   KNIGHT     =	3
     24  0000 ????	       00 03	   N	      =	KNIGHT
     25  0000 ????	       00 04	   BISHOP     =	4
     26  0000 ????	       00 04	   B	      =	BISHOP
     27  0000 ????	       00 05	   ROOK       =	5
     28  0000 ????	       00 05	   R	      =	ROOK
     29  0000 ????	       00 06	   QUEEN      =	6
     30  0000 ????	       00 06	   Q	      =	QUEEN
     31  0000 ????	       00 07	   KING       =	7
     32  0000 ????	       00 07	   K	      =	KING
     33  0000 ????	       00 08	   MARKER     =	8
     34  0000 ????
     35  0000 ????	       00 0f	   PIECE_MASK =	15	; trim off the flags leaving just piece ID
     36  0000 ????
     37  0000 ????						;---------------------------------------------------------------------------------------------------
     38  0000 ????
     39  0000 ????						; Movements
     40  0000 ????
     41  0000 ????	       00 0a	   _UP	      =	10	; up
     42  0000 ????	       ff ff ff ff _LEFT      =	-1	; left
     43  0000 ????	       ff ff ff f6 _DOWN      =	-10	; down
     44  0000 ????	       00 01	   _RIGHT     =	1	; right
     45  0000 ????
     46  0000 ????						; EOF
------- FILE ./chess.asm
     13  0000 ????
     14  0000 ????			   ORIGIN     SET	0
     15  0000 ????			   ORIGIN_RAM SET	0
     16  0000 ????
------- FILE segtime.asm LEVEL 2 PASS 2
      0  0000 ????				      include	"segtime.asm"
      1  0000 ????						;    Sokoboo - a Sokoban implementation
      2  0000 ????						;    using a generic tile-based display engine for the Atari 2600
      3  0000 ????						;    Sokoban (倉庫番)™ is © Falcon Co., Ltd.
      4  0000 ????						;
      5  0000 ????						;    Code related to this Sokoban™ implementation was developed by Andrew Davie.
      6  0000 ????						;
      7  0000 ????						;    Code related to the generic tile-based display engine was developed by
      8  0000 ????						;    Andrew Davie and Thomas Jentzsch during 2003-2011 and is
      9  0000 ????						;    Copyright(C)2003-2019 Thomas Jentzsch and Andrew Davie - contacts details:
     10  0000 ????						;    Andrew Davie (andrew@taswegian.com), Thomas Jentzsch (tjentzsch@yahoo.de).
     11  0000 ????						;
     12  0000 ????						;    Code related to music and sound effects uses the TIATracker music player
     13  0000 ????						;    Copyright 2016 Andre "Kylearan" Wichmann - see source code in the "sound"
     14  0000 ????						;    directory for Apache licensing details.
     15  0000 ????						;
     16  0000 ????						;    Some level data incorporated in this program were created by Lee J Haywood.
     17  0000 ????						;    See the copyright notices in the License directory for a list of level
     18  0000 ????						;    contributors.
     19  0000 ????						;
     20  0000 ????						;    Except where otherwise indicated, this software is released under the
     21  0000 ????						;    following licensing arrangement...
     22  0000 ????						;
     23  0000 ????						;    This program is free software: you can redistribute it and/or modify
     24  0000 ????						;    it under the terms of the GNU General Public License as published by
     25  0000 ????						;    the Free Software Foundation, either version 3 of the License, or
     26  0000 ????						;    (at your option) any later version.
     27  0000 ????						;    see https://www.gnu.org/licenses/gpl-3.0.en.html
     28  0000 ????
     29  0000 ????						;    This program is distributed in the hope that it will be useful,
     30  0000 ????						;    but WITHOUT ANY WARRANTY; without even the implied warranty of
     31  0000 ????						;    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
     32  0000 ????						;    GNU General Public License for more details.
     33  0000 ????
     34  0000 ????						; segtime optimization (averages):
     35  0000 ????						;   lost time = segtime/2 * 64
     36  0000 ????						;   num-segments = (vblank + overscan time) (NTSC 276=62+51=113) / 2 / segtime
     37  0000 ????						;   overhead: num-segments * 8 (assuming minimal INTIM check only)
     38  0000 ????						;
     39  0000 ????						; segtime = 2:
     40  0000 ????						;   lost time = 64
     41  0000 ????						;   num-segments = 28
     42  0000 ????						;   overhead = 224!
     43  0000 ????						; segtime = 3:
     44  0000 ????						;   lost time = 96
     45  0000 ????						;   num-segments = 18
     46  0000 ????						;   overhead = 144!
     47  0000 ????						; segtime = 4: 	     <--!!!
     48  0000 ????						;   lost time = 128!
     49  0000 ????						;   num-segments = 28
     50  0000 ????						;   overhead = 112
     51  0000 ????						; segtime = 5:
     52  0000 ????						;   lost time = 160!
     53  0000 ????						;   num-segments = 11
     54  0000 ????						;   overhead = 88
     55  0000 ????						; segtime = 6:
     56  0000 ????						;   lost time = 192!
     57  0000 ????						;   num-segments = 9
     58  0000 ????						;   overhead = 72
     59  0000 ????						; segtime = 7:
     60  0000 ????						;   lost time = 224!
     61  0000 ????						;   num-segments = 8
     62  0000 ????						;   overhead = 64
     63  0000 ????						; segtime = 10:
     64  0000 ????						;   lost time = 320!
     65  0000 ????						;   num-segments = 5
     66  0000 ????						;   overhead = 40
     67  0000 ????						; segtime = 20:
     68  0000 ????						;   lost time = 640!
     69  0000 ????						;   num-segments = 2
     70  0000 ????						;   overhead = 16
     71  0000 ????						; segtime = 40:
     72  0000 ????						;   lost time = 1280!
     73  0000 ????						;   num-segments = 1
     74  0000 ????						;   overhead = 8
     75  0000 ????
     76  0000 ????						; optimal INTIM segtime is 4 + 1 = 5,
     77  0000 ????						; below wasted time increases rapidly, above only moderately
     78  0000 ????						; if the overhead becomes larger, optimal segtimes will increase too
     79  0000 ????						; also the lost time will become smaller, if smaller segments can be used instead,
     80  0000 ????						;  so larger segtimes are not that bad then
     81  0000 ????
     82  0000 ????
     83  0000 ????				      MAC	segtime
     84  0000 ????			   {1}	      SET	{2}
     85  0000 ????			   TEST_{1}   =	0
     86  0000 ????				      ENDM
     87  0000 ????
     88  0000 ????				      MAC	segtime_c
     89  0000 ????			   {1}	      SET	({2}+32)/64 + 2
     90  0000 ????			   TEST_{1}   =	0
     91  0000 ????				      ENDM
     92  0000 ????
     93  0000 ????						; Pathways
     94  0000 ????						; StealPart3, not enough time for SCD_SLOW --> 79✅
     95  0000 ????						; if QuickDraw does immediate exit, 58✅
     96  0000 ????
     97  0000 ????						;---------------------------------------------------------------------------------------------------
     98  0000 ????
      0  0000 ????				      SEGTIME_C	MINIMUM_SEGTIME, 95	;✅ processing slice minimum requirement
      1  0000 ????			   MINIMUM_SEGTIME SET	(95+32)/64 + 2
      2  0000 ????	       00 00	   TEST_MINIMUM_SEGTIME =	0
      0  0000 ????				      SEGTIME_C	SEGTIME_MINIMUM_TIMESLICE, 54	;✅ abort time maximum requirement for timeslice
      1  0000 ????			   SEGTIME_MINIMUM_TIMESLICE SET	(54+32)/64 + 2
      2  0000 ????	       00 00	   TEST_SEGTIME_MINIMUM_TIMESLICE =	0
    101  0000 ????
    102  0000 ????						; Note: we add 1 to the minimum because there's a bit of overhead at the start of the timeslice code which vectors
    103  0000 ????						; to the appropriate timeslice.  That timeslice then checks the segtime again -- and in the case of the minimum we
    104  0000 ????						; will already have used 55 cycles of the available timeslice to get to the segtime check. Given that there are only
    105  0000 ????						; 9 spare cycles in the 'unit' left, it's probably more efficient to abort earlier and save those 55 cycles for other
    106  0000 ????						; uses ...
    107  0000 ????
    108  0000 ????
    109  0000 ????						; The following timings have been physicaly timed via code/debugger... the comment shows the worst observed time.
    110  0000 ????						; Generally the allocated segtime should be a bit bigger than the worst observed, to cater for the minor code
    111  0000 ????						; outside the creature itself which might otherwise cause screen time over-run.
    112  0000 ????
    113  0000 ????						; The following are NOT object-related and timing is a bit of manual guesswork/calculation
    114  0000 ????						; Comment may indicate at what value a glitch was DEFINITELY seen. These timings may not be optimal.
    115  0000 ????
      0  0000 ????				      SEGTIME	SEGTIME_MAN,22	;18 ;12	  ;NFI
      1  0000 ????			   SEGTIME_MAN SET	22
      2  0000 ????	       00 00	   TEST_SEGTIME_MAN =	0
------- FILE ./chess.asm
     18  0000 ????
     19  0000 ????						;FIXED_BANK		 = 3 * 2048	      ;-->  8K ROM tested OK
     20  0000 ????						;FIXED_BANK		  = 7 * 2048	      ;-->  16K ROM tested OK
     21  0000 ????						;FIXED_BANK		 = 15 * 2048	       ; ->> 32K
     22  0000 ????	       f8 00	   FIXED_BANK =	31 * 2048	; ->> 64K
     23  0000 ????						;FIXED_BANK		 = 239 * 2048	      ;--> 480K ROM tested OK (KK/CC2 compatibility)
     24  0000 ????						;FIXED_BANK		 = 127 * 2048	      ;--> 256K ROM tested OK
     25  0000 ????						;FIXED_BANK		 = 255 * 2048	      ;--> 512K ROM tested OK (CC2 can't handle this)
     26  0000 ????
     27  0000 ????	       00 01	   YES	      =	1
     28  0000 ????	       00 00	   NO	      =	0
     29  0000 ????
     30  0000 ????						; assemble diagnostics. Remove for release.
     31  0000 ????	       00 01	   ASSERTS    =	1
     32  0000 ????	       00 00	   TEST_POSITION =	0	; 0=normal, 1 = setup test position
     33  0000 ????	       00 00	   PVSP       =	0	; player versus player =1
     34  0000 ????
     35  0000 ????	       00 00	   WHITE_PLAYER =	0	; human
     36  0000 ????	       00 00	   BLACK_PLAYER =	0	; human
     37  0000 ????
     38  0000 ????
     39  0000 ????						;===================================
     40  0000 ????	       00 00	   FINAL_VERSION =	NO	; this OVERRIDES any selections below and sets everything correct for a final release
     41  0000 ????						;===================================
     42  0000 ????
     43  0000 ????						;-------------------------------------------------------------------------------
     44  0000 ????						; The following are optional YES/NO depending on phase of the moon
     45  0000 ????			   L276       SET	YES	; use 276 line display for NTSC
     46  0000 ????						;-------------------------------------------------------------------------------
     47  0000 ????						; DO NOT MODIFY THE BELOW SETTINGS -- USE THE ONES ABOVE!
     48  0000 ????						; Here we make sure everyting is OK based on the single switch -- less chance for accidents
     49  0000 ????			  -	      IF	FINAL_VERSION = YES
     50  0000 ????			  -L276       SET	YES	; use 276 line display for NTSC
     51  0000 ????				      ENDIF
     52  0000 ????
     53  0000 ????						;-------------------------------------------------------------------------------
     54  0000 ????
     55  0000 ????	       00 01	   COMPILE_ILLEGALOPCODES =	1
     56  0000 ????
     57  0000 ????	       00 07	   DIRECTION_BITS =	%111	; for ManLastDirection
     58  0000 ????
     59  0000 ????						;------------------------------------------------------------------------------
     60  0000 ????
     61  0000 ????	       00 01	   PLUSCART   =	YES
     62  0000 ????
     63  0000 ????						;------------------------------------------------------------------------------
     64  0000 ????
     65  0000 ????
     66  0000 ????	       00 08	   CHESSBOARD_ROWS =	8	; number of ROWS of chessboard
     67  0000 ????	       00 18	   LINES_PER_CHAR =	24	; MULTIPLE OF 3 SO RGB INTERFACES CHARS OK
     68  0000 ????	       00 48	   PIECE_SHAPE_SIZE =	72	; 3 PF bytes x 24 scanlines
     69  0000 ????
     70  0000 ????	       00 3f	   SET_BANK   =	$3F	; write address to switch ROM banks
     71  0000 ????	       00 3e	   SET_BANK_RAM =	$3E	; write address to switch RAM banks
     72  0000 ????
     73  0000 ????
     74  0000 ????	       10 00	   RAM_3E     =	$1000
     75  0000 ????	       04 00	   RAM_SIZE   =	$400
     76  0000 ????	       04 00	   RAM_WRITE  =	$400	; add this to RAM address when doing writes
     77  0000 ????
     78  0000 ????
     79  0000 ????
     80  0000 ????
     81  0000 ????						; Platform constants:
     82  0000 ????	       00 02	   PAL	      =	%10
     83  0000 ????	       00 02	   PAL_50     =	PAL|0
     84  0000 ????	       00 03	   PAL_60     =	PAL|1
     85  0000 ????
     86  0000 ????
     87  0000 ????				      IF	L276
     88  0000 ????	       00 30	   VBLANK_TIM_NTSC =	48	; NTSC 276 (Desert Falcon does 280, so this should be pretty safe)
     89  0000 ????			  -	      ELSE
     90  0000 ????			  -VBLANK_TIM_NTSC =	50	; NTSC 262
     91  0000 ????				      ENDIF
     92  0000 ????	       00 55	   VBLANK_TIM_PAL =	85	;85			    ; PAL 312 (we could increase this too, if we want to, but I suppose the used vertical screen size would become very small then)
     93  0000 ????
     94  0000 ????				      IF	L276
     95  0000 ????	       00 23	   OVERSCAN_TIM_NTSC =	35	;24 ;51			; NTSC 276 (Desert Falcon does 280, so this should be pretty safe)
     96  0000 ????			  -	      ELSE
     97  0000 ????			  -OVERSCAN_TIM_NTSC =	8	;51			    ; NTSC 262
     98  0000 ????				      ENDIF
     99  0000 ????	       00 29	   OVERSCAN_TIM_PAL =	41	; PAL 312 (we could increase this too, if we want to, but I suppose the used vertical screen size would become very small then)
    100  0000 ????
    101  0000 ????				      IF	L276
    102  0000 ????	       01 14	   SCANLINES_NTSC =	276	; NTSC 276 (Desert Falcon does 280, so this should be pretty safe)
    103  0000 ????			  -	      ELSE
    104  0000 ????			  -SCANLINES_NTSC =	262	; NTSC 262
    105  0000 ????				      ENDIF
    106  0000 ????	       01 38	   SCANLINES_PAL =	312
    107  0000 ????
    108  0000 ????
    109  0000 ????	       00 26	   TIME_PART_2 =	38
    110  0000 ????	       00 37	   TIME_PART_1 =	55
    111  0000 ????
    112  0000 ????
    113  0000 ????						;------------------------------------------------------------------------------
    114  0000 ????						; MACRO definitions
    115  0000 ????
    116  0000 ????
    117  0000 ????	       08 00	   ROM_BANK_SIZE =	$800
    118  0000 ????
    119  0000 ????				      MAC	newbank
    120  0000 ????				      SEG	{1}
    121  0000 ????				      ORG	ORIGIN
    122  0000 ????				      RORG	$F000
    123  0000 ????			   BANK_START SET	*
    124  0000 ????			   {1}	      SET	ORIGIN / 2048
    125  0000 ????			   ORIGIN     SET	ORIGIN + 2048
    126  0000 ????			   _CURRENT_BANK SET	{1}
    127  0000 ????				      ENDM		; bank name
    128  0000 ????
    129  0000 ????				      MAC	define_1k_segment
    130  0000 ????				      ALIGN	$400
    131  0000 ????			   SEGMENT_{1} SET	*
    132  0000 ????			   BANK_{1}   SET	_CURRENT_BANK
    133  0000 ????				      ENDM		; {seg name}
    134  0000 ????
    135  0000 ????				      MAC	check_bank_size
    136  0000 ????			   .TEMP      =	* - BANK_START
    137  0000 ????				      ECHO	{1}, "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
    138  0000 ????				      if	( .TEMP ) > ROM_BANK_SIZE
    139  0000 ????				      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
    140  0000 ????				      ERR
    141  0000 ????				      endif
    142  0000 ????				      ENDM		; name
    143  0000 ????
    144  0000 ????
    145  0000 ????				      MAC	check_half_bank_size
    146  0000 ????						; This macro is for checking the first 1K of ROM bank data that is to be copied to RAM.
    147  0000 ????						; Note that these ROM banks can contain 2K, so this macro will generally go 'halfway'
    148  0000 ????			   .TEMP      =	* - BANK_START
    149  0000 ????				      ECHO	{1}, "(1K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE/2 - .TEMP
    150  0000 ????				      if	( .TEMP ) > ROM_BANK_SIZE/2
    151  0000 ????				      ECHO	"HALF-BANK OVERFLOW @ ", * - ORIGIN
    152  0000 ????				      ERR
    153  0000 ????				      endif
    154  0000 ????				      ENDM		; name
    155  0000 ????
    156  0000 ????
    157  0000 ????						;---------------------------------------------------------------------------------------------------
    158  0000 ????
    159  0000 ????						; Macro inserts a page break if the object would overlap a page
    160  0000 ????
    161  0000 ????				      MAC	optional_pagebreak
    162  0000 ????				      LIST	OFF
    163  0000 ????				      IF	(>( * + {2} -1 )) > ( >* )
    164  0000 ????			   EARLY_LOCATION SET	*
    165  0000 ????				      ALIGN	256
    166  0000 ????				      ECHO	"PAGE BREAK INSERTED FOR", {1}
    167  0000 ????				      ECHO	"REQUESTED SIZE =", {2}
    168  0000 ????				      ECHO	"WASTED SPACE =", *-EARLY_LOCATION
    169  0000 ????				      ECHO	"PAGEBREAK LOCATION =", *
    170  0000 ????				      ENDIF
    171  0000 ????				      LIST	ON
    172  0000 ????				      ENDM		; { string, size }
    173  0000 ????
    174  0000 ????
    175  0000 ????				      MAC	check_page_crossing
    176  0000 ????				      LIST	OFF
    177  0000 ????				      if	( >BLOCK_END != >BLOCK_START )
    178  0000 ????				      ECHO	"PAGE CROSSING @ ", BLOCK_START
    179  0000 ????				      endif
    180  0000 ????				      LIST	ON
    181  0000 ????				      ENDM
    182  0000 ????
    183  0000 ????				      MAC	checkpage
    184  0000 ????				      LIST	OFF
    185  0000 ????				      IF	>. != >{1}
    186  0000 ????				      ECHO	""
    187  0000 ????				      ECHO	"ERROR: different pages! (", {1}, ",", ., ")"
    188  0000 ????				      ECHO	""
    189  0000 ????				      ERR
    190  0000 ????				      ENDIF
    191  0000 ????				      LIST	ON
    192  0000 ????				      ENDM
    193  0000 ????
    194  0000 ????				      MAC	checkpagex
    195  0000 ????				      LIST	OFF
    196  0000 ????				      IF	>. != >{1}
    197  0000 ????				      ECHO	""
    198  0000 ????				      ECHO	"ERROR: different pages! (", {1}, ",", ., ") @ {0}"
    199  0000 ????				      ECHO	{2}
    200  0000 ????				      ECHO	""
    201  0000 ????				      ERR
    202  0000 ????				      ENDIF
    203  0000 ????				      LIST	ON
    204  0000 ????				      ENDM
    205  0000 ????
    206  0000 ????						;---------------------------------------------------------------------------------------------------
    207  0000 ????
    208  0000 ????						; Defines a variable of the given size, making sure it doesn't cross a page
    209  0000 ????				      MAC	variable
    210  0000 ????				      OPTIONAL_PAGEBREAK	"Variable", {2}
    211  0000 ????			   {1}	      ds	{2}
    212  0000 ????				      ENDM		; {name, size}
    213  0000 ????
    214  0000 ????
    215  0000 ????						;---------------------------------------------------------------------------------------------------
    216  0000 ????
    217  0000 ????				      MAC	def
    218  0000 ????			   BANK_{1}   SET	_CURRENT_BANK	; bank in which this subroutine resides
    219  0000 ????			   {1}			; entry point
    220  0000 ????			   TEMPORARY_VAR SET	Overlay
    221  0000 ????			   TEMPORARY_OFFSET SET	0
    222  0000 ????				      SUBROUTINE
    223  0000 ????				      ENDM		; name of subroutine
    224  0000 ????
    225  0000 ????
    226  0000 ????						;---------------------------------------------------------------------------------------------------
    227  0000 ????
    228  0000 ????				      MAC	allocate
    229  0000 ????				      OPTIONAL_PAGEBREAK	"Table", {2}
    230  0000 ????				      DEF	{1}
    231  0000 ????				      ENDM
    232  0000 ????
    233  0000 ????
    234  0000 ????						;---------------------------------------------------------------------------------------------------
    235  0000 ????
    236  0000 ????			   TEMPORARY_OFFSET SET	0
    237  0000 ????
    238  0000 ????				      MAC	varbase
    239  0000 ????			   TEMPORARY_OFFSET SET	{1}
    240  0000 ????				      ENDM		; {offset}
    241  0000 ????
    242  0000 ????	       00 00	   VAR_LEVEL0 =	0
    243  0000 ????	       00 10	   VAR_LEVEL1 =	16
    244  0000 ????	       00 20	   VAR_LEVEL2 =	32
    245  0000 ????
    246  0000 ????
    247  0000 ????						; Define a temporary variable for use in a subroutine
    248  0000 ????						; Will allocate appropriate bytes, and also check for overflow of the available overlay buffer
    249  0000 ????
    250  0000 ????				      MAC	var
    251  0000 ????			   {1}	      SET	TEMPORARY_VAR
    252  0000 ????			   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + {2}
    253  0000 ????
    254  0000 ????			   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
    255  0000 ????				      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
    256  0000 ????			   MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
    257  0000 ????				      ENDIF
    258  0000 ????				      IF	OVERLAY_DELTA > OVERLAY_SIZE
    259  0000 ????				      ECHO	"Temporary Variable", {1}, "overflow!"
    260  0000 ????				      ERR
    261  0000 ????				      ENDIF
    262  0000 ????				      LIST	ON
    263  0000 ????				      ENDM		; { name, size }
    264  0000 ????
    265  0000 ????
    266  0000 ????
    267  0000 ????
    268  0000 ????						;---------------------------------------------------------------------------------------------------
    269  0000 ????
    270  0000 ????				      MAC	tag
    271  0000 ????						; {0}
    272  0000 ????				      ENDM		; {ident/tag}
    273  0000 ????
    274  0000 ????
    275  0000 ????						;---------------------------------------------------------------------------------------------------
    276  0000 ????
    277  0000 ????				      MAC	newrambank
    278  0000 ????						; {1}	     bank name
    279  0000 ????						; {2}	     RAM bank number
    280  0000 ????
    281  0000 ????				      SEG.U	{1}
    282  0000 ????				      ORG	ORIGIN_RAM
    283  0000 ????				      RORG	RAM_3E
    284  0000 ????			   BANK_START SET	*
    285  0000 ????			   RAMBANK_{1} SET	ORIGIN_RAM / RAM_SIZE
    286  0000 ????			   _CURRENT_RAMBANK SET	RAMBANK_{1}
    287  0000 ????			   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
    288  0000 ????				      ENDM		; bank name
    289  0000 ????
    290  0000 ????						; TODO - fix - this is faulty....
    291  0000 ????				      MAC	validate_ram_size
    292  0000 ????			   .RAM_BANK_SIZE SET	* - RAM_3E
    293  0000 ????				      IF	.RAM_BANK_SIZE > RAM_SIZE
    294  0000 ????				      ECHO	"RAM BANK OVERFLOW @ ", (* - RAM_3E)
    295  0000 ????				      ERR
    296  0000 ????				      ENDIF
    297  0000 ????				      ENDM
    298  0000 ????
    299  0000 ????						;---------------------------------------------------------------------------------------------------
    300  0000 ????
    301  0000 ????				      MAC	resync
    302  0000 ????						; resync screen, X and Y == 0 afterwards
    303  0000 ????				      lda	#%10	; make sure VBLANK is ON
    304  0000 ????				      sta	VBLANK
    305  0000 ????
    306  0000 ????				      ldx	#8	; 5 or more RESYNC_FRAMES
    307  0000 ????			   .loopResync
    308  0000 ????				      VERTICAL_SYNC
    309  0000 ????
    310  0000 ????				      ldy	#SCANLINES_NTSC/2 - 2
    311  0000 ????				      lda	Platform
    312  0000 ????				      eor	#PAL_50	; PAL-50?
    313  0000 ????				      bne	.ntsc
    314  0000 ????				      ldy	#SCANLINES_PAL/2 - 2
    315  0000 ????			   .ntsc
    316  0000 ????			   .loopWait
    317  0000 ????				      sta	WSYNC
    318  0000 ????				      sta	WSYNC
    319  0000 ????				      dey
    320  0000 ????				      bne	.loopWait
    321  0000 ????				      dex
    322  0000 ????				      bne	.loopResync
    323  0000 ????				      ENDM
    324  0000 ????
    325  0000 ????				      MAC	set_platform
    326  0000 ????						; 00 = NTSC
    327  0000 ????						; 01 = NTSC
    328  0000 ????						; 10 = PAL-50
    329  0000 ????						; 11 = PAL-60
    330  0000 ????				      lda	SWCHB
    331  0000 ????				      rol
    332  0000 ????				      rol
    333  0000 ????				      rol
    334  0000 ????				      and	#%11
    335  0000 ????				      eor	#PAL
    336  0000 ????				      sta	Platform	; P1 difficulty --> TV system (0=NTSC, 1=PAL)
    337  0000 ????				      ENDM
    338  0000 ????
    339  0000 ????
    340  0000 ????						;---------------------------------------------------------------------------------------------------
    341  0000 ????
    342  0000 ????				      MAC	jsram_safe
    343  0000 ????						; Saves bank of routine to variable for later restore.
    344  0000 ????						; Switches to the bank and does a JSR to the routine.
    345  0000 ????
    346  0000 ????				      lda	#BANK_{1}
    347  0000 ????				      sta	savedBank
    348  0000 ????				      sta	SET_BANK
    349  0000 ????				      jsr	{1}
    350  0000 ????				      ENDM		; {routine}
    351  0000 ????
    352  0000 ????
    353  0000 ????				      MAC	jsram
    354  0000 ????
    355  0000 ????				      lda	#BANK_{1}
    356  0000 ????				      sta	SET_BANK
    357  0000 ????				      jsr	{1}
    358  0000 ????				      ENDM		; {routine}
    359  0000 ????
    360  0000 ????
    361  0000 ????				      MAC	timecheck
    362  0000 ????				      lda	INTIM
    363  0000 ????				      cmp	#SPEEDOF_{1}
    364  0000 ????				      bcc	{2}
    365  0000 ????				      ENDM		; {ident}, {branch if out of time}
    366  0000 ????
    367  0000 ????
    368  0000 ????				      MAC	timing
    369  0000 ????			   SPEEDOF_{1} =	({2}/64) + 1
    370  0000 ????				      ENDM		; {label}, {cycles}
    371  0000 ????
    372  0000 ????
    373  0000 ????						;---------------------------------------------------------------------------------------------------
    374  0000 ????
    375  0000 ????				      MAC	x12b64table
    376  0000 ????						; Use this table to
    377  0000 ????						;   a) Determine if a square is valid (-1 = NO)
    378  0000 ????						;   b) Move pieces without addition.  e.g., "lda ValidSquareTable+10,x" will let you know
    379  0000 ????						;	if a white pawn on square "x" can move "up" the board.
    380  0000 ????
    381  0000 ????				      .byte	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1
    382  0000 ????				      .byte	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1
    383  0000 ????				      .byte	-1, -1, 0, 1, 2, 3, 4, 5, 6, 7
    384  0000 ????				      .byte	-1, -1, 8, 9, 10, 11, 12, 13, 14, 15
    385  0000 ????				      .byte	-1, -1, 16, 17, 18, 19, 20, 21, 22, 23
    386  0000 ????				      .byte	-1, -1, 24, 25, 26, 27, 28, 29, 30, 31
    387  0000 ????				      .byte	-1, -1, 32, 33, 34, 35, 36, 37, 38, 39
    388  0000 ????				      .byte	-1, -1, 40, 41, 42, 43, 44, 45, 46, 47
    389  0000 ????				      .byte	-1, -1, 48, 49, 50, 51, 52, 53, 54, 55
    390  0000 ????				      .byte	-1, -1, 56, 57, 58, 59, 60, 61, 62, 63
    391  0000 ????				      ENDM		; {name}
    392  0000 ????
    393  0000 ????						;---------------------------------------------------------------------------------------------------
    394  0000 ????
------- FILE zeropage.asm LEVEL 2 PASS 2
      0  0000 ????				      include	"zeropage.asm"
      1  0000 ????						; Chess
      2  0000 ????						; Atari 2600 Chess display system
      3  0000 ????						; Copyright (c) 2019-2020 Andrew Davie
      4  0000 ????						; andrew@taswegian.com
      5  0000 ????
      6 U00fd ????				      SEG.U	variables
      7 U0080					      ORG	$80
      8 U0080
      9 U0080		       00	   drawPieceNumber ds	1	; partial - square being drawn
     10 U0081
     11 U0081		       00	   rnd	      ds	1	; random
     12 U0082		       00	   drawDelay  ds	1
     13 U0083		       00	   lastSquare ds	1
     14 U0084		       00	   drawCount  ds	1
     15 U0085		       00	   fromX12    ds	1
     16 U0086		       00	   toX12      ds	1
     17 U0087		       00	   highlight_row ds	1
     18 U0088		       00	   highlight_col ds	1
     19 U0089		       00	   mdelay     ds	1
     20 U008a		       00	   ccur       ds	1
     21 U008b		       00	   savedBank  ds	1	; switched-in bank for FIXED returns
     22 U008c		       00	   aiPhase    ds	1	; human/computer state machine
     23 U008d		       00	   aiFlashDelay ds	1
     24 U008e		       00	   aiFromSquare ds	1
     25 U008f		       00	   aiToSquare ds	1
     26 U0090		       00	   aiFromSquareX12 ds	1
     27 U0091		       00	   aiToSquareX12 ds	1
     28 U0092		       00	   aiMoveIndex ds	1
     29 U0093
     30 U0093		       00	   aiFlashPhase ds	1
     31 U0094
     32 U0094		       00 00	   Evaluation ds	2	; tracks value of the board position
     33 U0096
     34 U0096		       00	   currentPiece ds	1
     35 U0097		       00	   currentSquare ds	1
     36 U0098		       00	   returnBank ds	1
     37 U0099		       00	   enPassantPawn ds	1	; TODO - this belongs in PLY bank
     38 U009a		       00	   followPiece ds	1
     39 U009b		       00	   currentPly ds	1
     40 U009c		       00	   piecelistIndex ds	1
     41 U009d		       00	   sideToMove ds	1	; d7 == side, 0=white, 128 = black
     42 U009e		       00	   fromSquare ds	1
     43 U009f		       00	   fromPiece  ds	1
     44 U00a0		       00	   toSquare   ds	1
     45 U00a1		       00	   lastPiece  ds	1
     46 U00a2		       00	   previousPiece ds	1
     47 U00a3
     48 U00a3		       00	   Platform   ds	1	; TV system (%0x=NTSC, %10=PAL-50, %11=PAL-60)
     49 U00a4		       00	   aiPiece    ds	1
------- FILE ./chess.asm
------- FILE overlays.asm LEVEL 2 PASS 2
      0 U00a5					      include	"overlays.asm"
      1 U00a5							; Chess
      2 U00a5							; Atari 2600 Chess display system
      3 U00a5							; Copyright (c) 2019-2020 Andrew Davie
      4 U00a5							; andrew@taswegian.com
      5 U00a5
      6 U00a5							;---------------------------------------------------------------------------------------------------
      7 U00a5							; OVERLAYS!
      8 U00a5							; These variables are overlays, and should be managed with care
      9 U00a5							; They co-exist (each "OVERLAY" starts at the zero-page variable "Overlay"
     10 U00a5							; and thus, overlays cannot be used at the same time (that is, you cannot
     11 U00a5							; use a variable in overlay #1 while at the same time using a variable in
     12 U00a5							; overlay #2
     13 U00a5
     14 U00a5							; for clarity, prefix ALL overlay variables with double-underscore (__)
     15 U00a5
     16 U00a5							; TOTAL SPACE USED BY ANY OVERLAY GROUP SHOULD BE <= SIZE OF 'Overlay'
     17 U00a5							; ensure this by using the VALIDATE_OVERLAY macro
     18 U00a5							;---------------------------------------------------------------------------------------------------
     19 U00a5
     20 U00a5					      MAC	overlay
     21 U00a5				   OVERLAY_NAME SET	{1}
     22 U00a5					      SEG.U	OVERLAY_{1}
     23 U00a5					      org	Overlay
     24 U00a5					      ENDM		; {name}
     25 U00a5
     26 U00a5							;---------------------------------------------------------------------------------------------------
     27 U00a5
     28 U00a5					      MAC	validate_overlay
     29 U00a5					      LIST	OFF
     30 U00a5				   OVERLAY_DELTA SET	* - Overlay
     31 U00a5					      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
     32 U00a5				   MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
     33 U00a5					      ENDIF
     34 U00a5					      IF	OVERLAY_DELTA > OVERLAY_SIZE
     35 U00a5					      ECHO	"Overlay", OVERLAY_NAME, "is too big!"
     36 U00a5					      ECHO	"REQUIRED SIZE =", OVERLAY_DELTA
     37 U00a5					      ERR
     38 U00a5					      ENDIF
     39 U00a5					      LIST	ON
     40 U00a5					      ECHO	OVERLAY_NAME, "-", OVERLAY_SIZE - ( * - Overlay ), "bytes available"
     41 U00a5					      ENDM
     42 U00a5
     43 U00a5							;---------------------------------------------------------------------------------------------------
     44 U00a5
     45 U00a5				   OVERLAY_SIZE SET	$4C	; maximum size
     46 U00a5				   MAXIMUM_REQUIRED_OVERLAY_SIZE SET	0
     47 U00a5
     48 U00a5
     49 U00a5							; This overlay variable is used for the overlay variables.  That's OK.
     50 U00a5							; However, it is positioned at the END of the variables so, if on the off chance we're overlapping
     51 U00a5							; stack space and variable, it is LIKELY that that won't be a problem, as the temp variables
     52 U00a5							; (especially the latter ones) are only used in rare occasions.
     53 U00a5
     54 U00a5							; FOR SAFETY, DO NOT USE THIS AREA DIRECTLY (ie: NEVER reference 'Overlay' in the code)
     55 U00a5							; ADD AN OVERLAY FOR EACH ROUTINE'S USE, SO CLASHES CAN BE EASILY CHECKED
     56 U00a5
      0 U00a5					      DEF	Overlay
      1 U00a5				   BANK_Overlay SET	_CURRENT_BANK
      2 U00a5				   Overlay
      3 U00a5				   TEMPORARY_VAR SET	Overlay
      4 U00a5				   TEMPORARY_OFFSET SET	0
      5 U00a5					      SUBROUTINE
     58 U00a5		       00 00 00 00*	      ds	OVERLAY_SIZE	;--> overlay (share) variables
     59 U00f1				   END_OF_OVERLAY
     60 U00f1
     61 U00f1							;---------------------------------------------------------------------------------------------------
     62 U00f1							; And now... the overlays....
     63 U00f1
 ---- OVERLAYS ( $4c bytes ) ----
     64 U00f1					      ECHO	"---- OVERLAYS (", OVERLAY_SIZE, "bytes ) ----"
     65 U00f1
     66 U00f1							;---------------------------------------------------------------------------------------------------
     67 U00f1
     68 U00f1							; Some overlays are used across multiple routines/calls, and they will need to be defined
     69 U00f1							; "globally" in this file.
     70 U00f1
      0 U00f1					      VAR	__pieceShapeBuffer, PIECE_SHAPE_SIZE
      1 U00f1				   __pieceShapeBuffer SET	TEMPORARY_VAR
      2 U00f1				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + PIECE_SHAPE_SIZE
      3 U00f1
      4 U00f1				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5 U00f1					      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6 U00f1				   MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7 U00f1					      ENDIF
      8 U00f1				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9 U00f1				  -	      ECHO	"Temporary Variable", __pieceShapeBuffer, "overflow!"
     10 U00f1				  -	      ERR
     11 U00f1					      ENDIF
     12 U00f1					      LIST	ON
      0 U00f1					      VAR	__ptr, 2
      1 U00f1				   __ptr      SET	TEMPORARY_VAR
      2 U00f1				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 2
      3 U00f1
      4 U00f1				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5 U00f1					      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6 U00f1				   MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7 U00f1					      ENDIF
      8 U00f1				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9 U00f1				  -	      ECHO	"Temporary Variable", __ptr, "overflow!"
     10 U00f1				  -	      ERR
     11 U00f1					      ENDIF
     12 U00f1					      LIST	ON
      0 U00f1					      VAR	__ptr2, 2
      1 U00f1				   __ptr2     SET	TEMPORARY_VAR
      2 U00f1				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 2
      3 U00f1
      4 U00f1				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5 U00f1					      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6 U00f1				   MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7 U00f1					      ENDIF
      8 U00f1				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9 U00f1				  -	      ECHO	"Temporary Variable", __ptr2, "overflow!"
     10 U00f1				  -	      ERR
     11 U00f1					      ENDIF
     12 U00f1					      LIST	ON
     74 U00f1
     75 U00f1							;---------------------------------------------------------------------------------------------------
     76 U00f1
     77 U00f1
     78 U00f1					      ORG	END_OF_OVERLAY
 ---- END OF OVERLAYS ----
     79 U00f1					      ECHO	"---- END OF OVERLAYS ----"
 MAXIMUM OVERLAY SIZE NEEDED =  $4c
     80 U00f1					      ECHO	"MAXIMUM OVERLAY SIZE NEEDED = ", MAXIMUM_REQUIRED_OVERLAY_SIZE
     81 U00f1
     82 U00f1							;EOF
------- FILE ./chess.asm
------- FILE stack.asm LEVEL 2 PASS 2
      0 U00f1					      include	"stack.asm"
      1 U00f1							; Chess
      2 U00f1							; Atari 2600 Chess display system
      3 U00f1							; Copyright (c) 2019-2020 Andrew Davie
      4 U00f1							; andrew@taswegian.com
      5 U00f1
      6 U00f1
      7 U00f1		       00 0c	   RESERVED_FOR_STACK =	12	; bytes guaranteed not overwritten by variable use
      8 U00f1
      9 U00f1		       00 00 00 00*	      ds	RESERVED_FOR_STACK
     10 U00fd
     11 U00fd							; WARNING/NOTE - the alphabeta search violates the above size constraints
     12 U00fd							; HOWEVER, the "OVERLAY" segment is beneath this, and will be stomped, depending on # plys
     13 U00fd							;  but since overlay is not generally stressed during alphabeta, we're good.
------- FILE ./chess.asm
    398 U00fd
 FREE BYTES IN ZERO PAGE =  $2
    399 U00fd					      ECHO	"FREE BYTES IN ZERO PAGE = ", $FF - *
    400 U00fd				  -	      IF	* > $FF
    401 U00fd				  -	      ERR	"Zero Page overflow!"
    402 U00fd					      ENDIF
    403 U00fd
    404 U00fd							;------------------------------------------------------------------------------
    405 U00fd							;##############################################################################
    406 U00fd							;------------------------------------------------------------------------------
    407 U00fd
    408 U00fd							; NOW THE VERY INTERESTING '3E' RAM BANKS
    409 U00fd							; EACH BANK HAS A READ-ADDRESS AND A WRITE-ADDRESS, WITH 1k TOTAL ACCESSIBLE
    410 U00fd							; IN A 2K MEMORY SPACE
    411 U00fd
      0 U00fd					      NEWRAMBANK	CHESS_BOARD_ROW
      1 U00fd
      2 U00fd
      3 U00fd
      4 U0000 ????				      SEG.U	CHESS_BOARD_ROW
      5 U0000					      ORG	ORIGIN_RAM
      6 U0000					      RORG	RAM_3E
      7 U0000				   BANK_START SET	*
      8 U0000				   RAMBANK_CHESS_BOARD_ROW SET	ORIGIN_RAM / RAM_SIZE
      9 U0000				   _CURRENT_RAMBANK SET	RAMBANK_CHESS_BOARD_ROW
     10 U0000				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
    413 U0000					      REPEAT	(CHESSBOARD_ROWS) - 1
      0 U0000					      NEWRAMBANK	.DUMMY
      1 U0000
      2 U0000
      3 U0000
      4 U1c00 ????				      SEG.U	.DUMMY
      5 U0400					      ORG	ORIGIN_RAM
      6 U0400					      RORG	RAM_3E
      7 U0400				   BANK_START SET	*
      8 U0400				   RAMBANK_.DUMMY SET	ORIGIN_RAM / RAM_SIZE
      9 U0400				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY
     10 U0400				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
      0 U0400					      VALIDATE_RAM_SIZE
      1 U0400				   .RAM_BANK_SIZE SET	* - RAM_3E
      2 U0400				  -	      IF	.RAM_BANK_SIZE > RAM_SIZE
      3 U0400				  -	      ECHO	"RAM BANK OVERFLOW @ ", (* - RAM_3E)
      4 U0400				  -	      ERR
      5 U0400					      ENDIF
    413 U0400					      REPEND
      0 U0400					      NEWRAMBANK	.DUMMY
      1 U0400
      2 U0400
      3 U0400
      4 U0400					      SEG.U	.DUMMY
      5 U0800					      ORG	ORIGIN_RAM
      6 U0800					      RORG	RAM_3E
      7 U0800				   BANK_START SET	*
      8 U0800				   RAMBANK_.DUMMY SET	ORIGIN_RAM / RAM_SIZE
      9 U0800				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY
     10 U0800				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
      0 U0800					      VALIDATE_RAM_SIZE
      1 U0800				   .RAM_BANK_SIZE SET	* - RAM_3E
      2 U0800				  -	      IF	.RAM_BANK_SIZE > RAM_SIZE
      3 U0800				  -	      ECHO	"RAM BANK OVERFLOW @ ", (* - RAM_3E)
      4 U0800				  -	      ERR
      5 U0800					      ENDIF
    413 U0800					      REPEND
      0 U0800					      NEWRAMBANK	.DUMMY
      1 U0800
      2 U0800
      3 U0800
      4 U0800					      SEG.U	.DUMMY
      5 U0c00					      ORG	ORIGIN_RAM
      6 U0c00					      RORG	RAM_3E
      7 U0c00				   BANK_START SET	*
      8 U0c00				   RAMBANK_.DUMMY SET	ORIGIN_RAM / RAM_SIZE
      9 U0c00				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY
     10 U0c00				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
      0 U0c00					      VALIDATE_RAM_SIZE
      1 U0c00				   .RAM_BANK_SIZE SET	* - RAM_3E
      2 U0c00				  -	      IF	.RAM_BANK_SIZE > RAM_SIZE
      3 U0c00				  -	      ECHO	"RAM BANK OVERFLOW @ ", (* - RAM_3E)
      4 U0c00				  -	      ERR
      5 U0c00					      ENDIF
    413 U0c00					      REPEND
      0 U0c00					      NEWRAMBANK	.DUMMY
      1 U0c00
      2 U0c00
      3 U0c00
      4 U0c00					      SEG.U	.DUMMY
      5 U1000					      ORG	ORIGIN_RAM
      6 U1000					      RORG	RAM_3E
      7 U1000				   BANK_START SET	*
      8 U1000				   RAMBANK_.DUMMY SET	ORIGIN_RAM / RAM_SIZE
      9 U1000				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY
     10 U1000				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
      0 U1000					      VALIDATE_RAM_SIZE
      1 U1000				   .RAM_BANK_SIZE SET	* - RAM_3E
      2 U1000				  -	      IF	.RAM_BANK_SIZE > RAM_SIZE
      3 U1000				  -	      ECHO	"RAM BANK OVERFLOW @ ", (* - RAM_3E)
      4 U1000				  -	      ERR
      5 U1000					      ENDIF
    413 U1000					      REPEND
      0 U1000					      NEWRAMBANK	.DUMMY
      1 U1000
      2 U1000
      3 U1000
      4 U1000					      SEG.U	.DUMMY
      5 U1400					      ORG	ORIGIN_RAM
      6 U1400					      RORG	RAM_3E
      7 U1400				   BANK_START SET	*
      8 U1400				   RAMBANK_.DUMMY SET	ORIGIN_RAM / RAM_SIZE
      9 U1400				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY
     10 U1400				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
      0 U1400					      VALIDATE_RAM_SIZE
      1 U1400				   .RAM_BANK_SIZE SET	* - RAM_3E
      2 U1400				  -	      IF	.RAM_BANK_SIZE > RAM_SIZE
      3 U1400				  -	      ECHO	"RAM BANK OVERFLOW @ ", (* - RAM_3E)
      4 U1400				  -	      ERR
      5 U1400					      ENDIF
    413 U1400					      REPEND
      0 U1400					      NEWRAMBANK	.DUMMY
      1 U1400
      2 U1400
      3 U1400
      4 U1400					      SEG.U	.DUMMY
      5 U1800					      ORG	ORIGIN_RAM
      6 U1800					      RORG	RAM_3E
      7 U1800				   BANK_START SET	*
      8 U1800				   RAMBANK_.DUMMY SET	ORIGIN_RAM / RAM_SIZE
      9 U1800				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY
     10 U1800				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
      0 U1800					      VALIDATE_RAM_SIZE
      1 U1800				   .RAM_BANK_SIZE SET	* - RAM_3E
      2 U1800				  -	      IF	.RAM_BANK_SIZE > RAM_SIZE
      3 U1800				  -	      ECHO	"RAM BANK OVERFLOW @ ", (* - RAM_3E)
      4 U1800				  -	      ERR
      5 U1800					      ENDIF
    413 U1800					      REPEND
      0 U1800					      NEWRAMBANK	.DUMMY
      1 U1800
      2 U1800
      3 U1800
      4 U1800					      SEG.U	.DUMMY
      5 U1c00					      ORG	ORIGIN_RAM
      6 U1c00					      RORG	RAM_3E
      7 U1c00				   BANK_START SET	*
      8 U1c00				   RAMBANK_.DUMMY SET	ORIGIN_RAM / RAM_SIZE
      9 U1c00				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY
     10 U1c00				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
      0 U1c00					      VALIDATE_RAM_SIZE
      1 U1c00				   .RAM_BANK_SIZE SET	* - RAM_3E
      2 U1c00				  -	      IF	.RAM_BANK_SIZE > RAM_SIZE
      3 U1c00				  -	      ECHO	"RAM BANK OVERFLOW @ ", (* - RAM_3E)
      4 U1c00				  -	      ERR
      5 U1c00					      ENDIF
    416 U1c00					      REPEND
    417 U1c00
    418 U1c00							; NOTE: THIS BANK JUST *LOOKS* EMPTY.
    419 U1c00							; It actually contains everything copied from the ROM copy of the ROW RAM banks.
    420 U1c00							; The variable definitions are also in that ROM bank (even though they're RAM :)
    421 U1c00
    422 U1c00							; A neat feature of having multiple copies of the same code in different RAM banks
    423 U1c00							; is that we can use that code to switch between banks, and the system will happily
    424 U1c00							; execute the next instruction from the newly switched-in bank without a problem.
    425 U1c00
    426 U1c00							; Now we have the actual graphics data for each of the rows.  This consists of an
    427 U1c00							; actual bitmap (in exact PF-style format, 6 bytes per line) into which the
    428 U1c00							; character shapes are masked/copied. The depth of the character shapes may be
    429 U1c00							; changed by changing the #LINES_PER_CHAR value.  Note that this depth should be
    430 U1c00							; a multiple of 3, so that the RGB scanlines match at character joins.
    431 U1c00
    432 U1c00							; We have one bank for each chessboard row.  These banks are duplicates of the above,
    433 U1c00							; accessed via the above labels but with the appropriate bank switched in.
    434 U1c00
    435 U1c00							;------------------------------------------------------------------------------
    436 U1c00
    437 U1c00
    438 U1c00							;---------------------------------------------------------------------------------------------------
    439 U1c00
    440 U1c00
    441 U1c00		       00 fe	   RND_EOR_VAL =	$FE	;B4
    442 U1c00
    443 U1c00					      MAC	next_random
    444 U1c00					      lda	rnd
    445 U1c00					      lsr
    446 U1c00					      bcc	.skipEOR
    447 U1c00					      eor	#RND_EOR_VAL
    448 U1c00				   .skipEOR   sta	rnd
    449 U1c00					      ENDM
    450 U1c00
    451 U1c00							;--------------------------------------------------------------------------------
    452 U1c00
    453 U1c00					      MAC	phase
    454 U1c00					      lda	#{1}
    455 U1c00					      sta	aiPhase
    456 U1c00					      ENDM		;#
    457 U1c00
    458 U1c00							;--------------------------------------------------------------------------------
    459 U1c00
    460 U1c00							;ORIGIN      SET 0
    461 U1c00
------- FILE Handler_MACROS.asm LEVEL 2 PASS 2
      0 U1c00					      include	"Handler_MACROS.asm"
      1 U1c00							; Copyright (C)2020 Andrew Davie
      2 U1c00							; Common macros for piece move handlers
      3 U1c00
      4 U1c00							;---------------------------------------------------------------------------------------------------
      5 U1c00							; Looks at a square offset {1} to see if piece can move to it
      6 U1c00							; Adds the square to the movelist if it can
      7 U1c00							; Keeps moving in the same direction until it's blocked/off=board
      8 U1c00
      9 U1c00					      MAC	move_towards
     10 U1c00					      SUBROUTINE
     11 U1c00
     12 U1c00							; = 76 for single square (empty/take)
     13 U1c00
     14 U1c00					      ldx	currentSquare	; 3
     15 U1c00					      bne	.project	; 3   unconditional
     16 U1c00
     17 U1c00				   .empty     jsr	AddMove	; 57
     18 U1c00				   .project   ldy	ValidSquare+{1},x	; 4
     19 U1c00					      bmi	.invalid	; 2/3 off board!
     20 U1c00					      lda	Board,y	; 4   piece @ destination
     21 U1c00					      beq	.empty	; 2/3
     22 U1c00					      eor	currentPiece	; 3
     23 U1c00					      bpl	.invalid	; 2/3 same colour
     24 U1c00					      jsr	AddMove	; 57  and exit
     25 U1c00
     26 U1c00				   .invalid
     27 U1c00					      ENDM
     28 U1c00
     29 U1c00
     30 U1c00							;---------------------------------------------------------------------------------------------------
     31 U1c00
     32 U1c00					      MAC	move_to
     33 U1c00					      SUBROUTINE
     34 U1c00					      ldy	ValidSquare+{1},x
     35 U1c00					      bmi	.invalid	; off board!
     36 U1c00					      lda	Board,y	; piece @ destination
     37 U1c00					      beq	.squareEmpty
     38 U1c00					      eor	currentPiece
     39 U1c00					      bpl	.invalid	; same colour
     40 U1c00				   .squareEmpty jsr	AddMove
     41 U1c00				   .invalid
     42 U1c00					      ENDM
     43 U1c00
     44 U1c00
     45 U1c00							;---------------------------------------------------------------------------------------------------
     46 U1c00
     47 U1c00					      MAC	move_to_x
     48 U1c00					      ldx	currentSquare
     49 U1c00					      MOVE_TO	{1}
     50 U1c00					      ENDM
     51 U1c00
     52 U1c00
     53 U1c00							;---------------------------------------------------------------------------------------------------
     54 U1c00							; EOF
------- FILE ./chess.asm
    463 U1c00
------- FILE BANK_GENERIC.asm LEVEL 2 PASS 2
      0 U1c00					      include	"BANK_GENERIC.asm"
      1 U1c00
      0 U1c00					      NEWBANK	GENERIC_BANK_1
      1  0140 ????				      SEG	GENERIC_BANK_1
      2  0000					      ORG	ORIGIN
      3  0000					      RORG	$F000
      4  0000				   BANK_START SET	*
      5  0000				   GENERIC_BANK_1 SET	ORIGIN / 2048
      6  0000				   ORIGIN     SET	ORIGIN + 2048
      7  0000				   _CURRENT_BANK SET	GENERIC_BANK_1
      3  0000
      0  0000					      DEFINE_1K_SEGMENT	DECODE_LEVEL_SHADOW
      1  0000					      ALIGN	$400
      2  0000				   SEGMENT_DECODE_LEVEL_SHADOW SET	*
      3  0000				   BANK_DECODE_LEVEL_SHADOW SET	_CURRENT_BANK
      5  0000
      6  0000				  -	      if	0
      7  0000				  -	      IF	PLUSCART = YES
      8  0000				  -	      .byte	"ChessAPI.php", #0 //TODO: change!
      9  0000				  -	      .byte	"pluscart.firmaplus.de", #0
     10  0000				  -	      ENDIF
     11  0000					      endif
     12  0000
     13  0000		       85 3e a9 00 STELLA_AUTODETECT .byte.b	$85,$3e,$a9,$00	; 3E
     14  0004
      0  0004					      CHECK_HALF_BANK_SIZE	"GENERIC_BANK_1 (DECODE_LEVEL)"
      1  0004
      2  0004
      3  0004		       00 04	   .TEMP      =	* - BANK_START
 GENERIC_BANK_1 (DECODE_LEVEL) (1K) SIZE =  $4 , FREE= $3fc
      4  0004					      ECHO	"GENERIC_BANK_1 (DECODE_LEVEL)", "(1K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE/2 - .TEMP
      5  0004				  -	      if	( .TEMP ) > ROM_BANK_SIZE/2
      6  0004				  -	      ECHO	"HALF-BANK OVERFLOW @ ", * - ORIGIN
      7  0004				  -	      ERR
      8  0004					      endif
     16  0004
     17  0004							;---------------------------------------------------------------------------------------------------
     18  0004							; ... the above is a (potentially) RAM-copied section -- the following is ROM-only.  Note that
     19  0004							; we do not configure a 1K boundary, as we con't really care when the above 'RAM'
     20  0004							; bank finishes.  Just continue on from where it left off...
     21  0004							;---------------------------------------------------------------------------------------------------
     22  0004
      0  0004					      DEF	Cart_Init
      1  0004				   BANK_Cart_Init SET	_CURRENT_BANK
      2  0004				   Cart_Init
      3  0004				   TEMPORARY_VAR SET	Overlay
      4  0004				   TEMPORARY_OFFSET SET	0
      5  0004					      SUBROUTINE
     24  0004					      SUBROUTINE
     25  0004
     26  0004		       a9 00		      lda	#0
     27  0006		       8d 83 02 	      sta	SWBCNT	; console I/O always set to INPUT
     28  0009		       8d 81 02 	      sta	SWACNT	; set controller I/O to INPUT
     29  000c		       85 6b		      sta	HMCLR
     30  000e
     31  000e							; cleanup remains of title screen
     32  000e		       85 5b		      sta	GRP0
     33  0010		       85 5c		      sta	GRP1
     34  0012
     35  0012		       a9 10		      lda	#%00010000	; double width missile, double width player
     36  0014		       85 44		      sta	NUSIZ0
     37  0016		       85 45		      sta	NUSIZ1
     38  0018
     39  0018		       a9 04		      lda	#%100	; players/missiles BEHIND BG
     40  001a		       85 4a		      sta	CTRLPF
     41  001c
     42  001c		       60		      rts
     43  001d
     44  001d
     45  001d							;---------------------------------------------------------------------------------------------------
     46  001d
      0  001d					      DEF	Resync
      1  001d				   BANK_Resync SET	_CURRENT_BANK
      2  001d				   Resync
      3  001d				   TEMPORARY_VAR SET	Overlay
      4  001d				   TEMPORARY_OFFSET SET	0
      5  001d					      SUBROUTINE
     48  001d					      SUBROUTINE
     49  001d
      0  001d					      RESYNC
      1  001d
      2  001d		       a9 02		      lda	#%10
      3  001f		       85 41		      sta	VBLANK
      4  0021
      5  0021		       a2 08		      ldx	#8
      6  0023				   .loopResync
      0  0023					      VERTICAL_SYNC
      1  0023		       a9 0e		      lda	#%1110
      2  0025		       85 42	   .VSLP1     sta	WSYNC
      3  0027		       85 40		      sta	VSYNC
      4  0029		       4a		      lsr
      5  002a		       d0 f9		      bne	.VSLP1
      8  002c
      9  002c		       a0 88		      ldy	#SCANLINES_NTSC/2 - 2
     10  002e		       a5 a3		      lda	Platform
     11  0030		       49 02		      eor	#PAL_50
     12  0032		       d0 02		      bne	.ntsc
     13  0034		       a0 9a		      ldy	#SCANLINES_PAL/2 - 2
     14  0036				   .ntsc
     15  0036				   .loopWait
     16  0036		       85 42		      sta	WSYNC
     17  0038		       85 42		      sta	WSYNC
     18  003a		       88		      dey
     19  003b		       d0 f9		      bne	.loopWait
     20  003d		       ca		      dex
     21  003e		       d0 e3		      bne	.loopResync
     51  0040		       60		      rts
     52  0041
     53  0041
     54  0041							;---------------------------------------------------------------------------------------------------
     55  0041
      0  0041					      DEF	aiStartClearBoard
      1  0041				   BANK_aiStartClearBoard SET	_CURRENT_BANK
      2  0041				   aiStartClearBoard
      3  0041				   TEMPORARY_VAR SET	Overlay
      4  0041				   TEMPORARY_OFFSET SET	0
      5  0041					      SUBROUTINE
     57  0041					      SUBROUTINE
     58  0041
     59  0041		       a2 08		      ldx	#8
     60  0043		       86 84		      stx	drawCount	; = bank
     61  0045
     62  0045		       a9 ff		      lda	#-1
     63  0047		       85 87		      sta	highlight_row
     64  0049
      0  0049					      PHASE	AI_ClearEachRow
      1  0049		       a9 0e		      lda	#AI_ClearEachRow
      2  004b		       85 8c		      sta	aiPhase
     66  004d		       60		      rts
     67  004e
     68  004e							;---------------------------------------------------------------------------------------------------
     69  004e
      0  004e					      DEF	aiClearEachRow
      1  004e				   BANK_aiClearEachRow SET	_CURRENT_BANK
      2  004e				   aiClearEachRow
      3  004e				   TEMPORARY_VAR SET	Overlay
      4  004e				   TEMPORARY_OFFSET SET	0
      5  004e					      SUBROUTINE
     71  004e					      SUBROUTINE
     72  004e
     73  004e		       c6 84		      dec	drawCount
     74  0050		       30 05		      bmi	.bitmapCleared
     75  0052		       a4 84		      ldy	drawCount
     76  0054		       4c ad f8 	      jmp	CallClear
     77  0057
     78  0057				   .bitmapCleared
     79  0057
     80  0057		       a9 3f		      lda	#63
     81  0059		       85 80		      sta	drawPieceNumber
     82  005b
      0  005b					      PHASE	AI_DrawEntireBoard
      1  005b		       a9 0f		      lda	#AI_DrawEntireBoard
      2  005d		       85 8c		      sta	aiPhase
     84  005f		       60		      rts
     85  0060
     86  0060
     87  0060							;---------------------------------------------------------------------------------------------------
     88  0060
      0  0060					      DEF	aiPrepForPhysicalMove
      1  0060				   BANK_aiPrepForPhysicalMove SET	_CURRENT_BANK
      2  0060				   aiPrepForPhysicalMove
      3  0060				   TEMPORARY_VAR SET	Overlay
      4  0060				   TEMPORARY_OFFSET SET	0
      5  0060					      SUBROUTINE
     90  0060					      SUBROUTINE
      0  0060					      TAG	MOVE_SELECTED (AI)
      1  0060
     92  0060
     93  0060
     94  0060							; Both computer and human have now seleted a move, and converge here
     95  0060
     96  0060
     97  0060							; fromPiece	 piece doing the move
     98  0060							; fromSquare	 starting square BASE64
     99  0060							; toSquare	 ending square BASE64
    100  0060							; fromX12	 starting square X12
    101  0060							; toX12	 ending square X12
    102  0060
    103  0060							;    -previousPiece
    104  0060							;    +fromPiece
    105  0060
    106  0060
    107  0060
    108  0060		       a9 00		      lda	#BLANK
    109  0062		       85 a2		      sta	previousPiece
    110  0064
    111  0064
    112  0064							;TODO: evaluation mods
    113  0064
    114  0064
    115  0064				  -	      if	0
    116  0064				  -	      get	piece
    117  0064				  -	      eor	#128
    118  0064				  -	      cmp	#128	; negate colour --> C
    119  0064				  -
    120  0064				  -	      and	#PIECE_MASK
    121  0064				  -	      beq	.nopiece
    122  0064				  -
    123  0064				  -			;TOD: we're taking a piece - at this point we could adjust the
    124  0064				  -			; we've negated the colour so the captured piece will be negatively-added, so to speak
    125  0064				  -
    126  0064				  -	      tay
    127  0064				  -
    128  0064				  -	      ldx	#BANK_AddPieceMaterialValue
    129  0064				  -	      sta	SET_BANK
    130  0064				  -	      jsr	AddPieceMaterialValue
    131  0064					      endif
    132  0064
    133  0064
    134  0064
    135  0064
    136  0064							;lda toSquare
    137  0064							;cmp fromSquare
    138  0064							;beq .idleErase
    139  0064
    140  0064		       a9 06		      lda	#6	; on/off count
    141  0066		       85 84		      sta	drawCount	; flashing for piece about to move
    142  0068		       a9 00		      lda	#0
    143  006a		       85 82		      sta	drawDelay
    144  006c
      0  006c					      PHASE	AI_WriteStartPieceBlank
      1  006c		       a9 15		      lda	#AI_WriteStartPieceBlank
      2  006e		       85 8c		      sta	aiPhase
    146  0070		       60	   .idleErase rts
    147  0071
    148  0071
    149  0071							;---------------------------------------------------------------------------------------------------
    150  0071
      0  0071					      DEF	aiWriteStartPieceBlank
      1  0071				   BANK_aiWriteStartPieceBlank SET	_CURRENT_BANK
      2  0071				   aiWriteStartPieceBlank
      3  0071				   TEMPORARY_VAR SET	Overlay
      4  0071				   TEMPORARY_OFFSET SET	0
      5  0071					      SUBROUTINE
    152  0071					      SUBROUTINE
    153  0071
    154  0071							; Flash the piece in-place preparatory to moving it.
    155  0071							; drawDelay = flash speed
    156  0071							; drawCount = # of flashes
    157  0071
    158  0071		       a5 82		      lda	drawDelay
    159  0073		       f0 03		      beq	deCount
    160  0075		       c6 82		      dec	drawDelay
    161  0077		       60		      rts
    162  0078
    163  0078				   deCount
    164  0078
    165  0078		       a5 84		      lda	drawCount
    166  007a		       f0 0e		      beq	flashDone
    167  007c		       c6 84		      dec	drawCount
    168  007e
    169  007e		       a9 04		      lda	#4
    170  0080		       85 82		      sta	drawDelay	; "getting ready to move" flash
    171  0082
    172  0082		       a5 9e		      lda	fromSquare
    173  0084		       85 80		      sta	drawPieceNumber
    174  0086		       20 ea fd 	      jsr	SAFE_CopySinglePiece	; EOR-draw = flash
    175  0089		       60		      rts
    176  008a
      0  008a				   flashDone  PHASE	AI_MarchToTargetA
      1  008a		       a9 16		      lda	#AI_MarchToTargetA
      2  008c		       85 8c		      sta	aiPhase
    178  008e		       60		      rts
    179  008f
    180  008f
    181  008f							;---------------------------------------------------------------------------------------------------
    182  008f
      0  008f					      DEF	aiDrawPart2
      1  008f				   BANK_aiDrawPart2 SET	_CURRENT_BANK
      2  008f				   aiDrawPart2
      3  008f				   TEMPORARY_VAR SET	Overlay
      4  008f				   TEMPORARY_OFFSET SET	0
      5  008f					      SUBROUTINE
    184  008f					      SUBROUTINE
    185  008f
    186  008f		       20 ea fd 	      jsr	SAFE_CopySinglePiece
    187  0092		       c6 80		      dec	drawPieceNumber
    188  0094		       30 05		      bmi	.comp
    189  0096
      0  0096					      PHASE	AI_DrawEntireBoard
      1  0096		       a9 0f		      lda	#AI_DrawEntireBoard
      2  0098		       85 8c		      sta	aiPhase
    191  009a		       60		      rts
    192  009b
      0  009b				   .comp      PHASE	AI_FlipBuffers
      1  009b		       a9 11		      lda	#AI_FlipBuffers
      2  009d		       85 8c		      sta	aiPhase
    194  009f		       60		      rts
    195  00a0
    196  00a0
    197  00a0							;---------------------------------------------------------------------------------------------------
    198  00a0
      0  00a0					      DEF	aiMarchB
      1  00a0				   BANK_aiMarchB SET	_CURRENT_BANK
      2  00a0				   aiMarchB
      3  00a0				   TEMPORARY_VAR SET	Overlay
      4  00a0				   TEMPORARY_OFFSET SET	0
      5  00a0					      SUBROUTINE
    200  00a0					      SUBROUTINE
    201  00a0
    202  00a0							; Draw the piece in the new square
    203  00a0
    204  00a0		       a5 9e		      lda	fromSquare
    205  00a2		       85 80		      sta	drawPieceNumber
    206  00a4		       20 ea fd 	      jsr	SAFE_CopySinglePiece	; draw the moving piece into the new square
    207  00a7
    208  00a7		       a9 06		      lda	#6	; snail trail delay
    209  00a9		       85 82		      sta	drawDelay
    210  00ab
      0  00ab					      PHASE	AI_MarchToTargetB
      1  00ab		       a9 18		      lda	#AI_MarchToTargetB
      2  00ad		       85 8c		      sta	aiPhase
    212  00af		       60		      rts
    213  00b0
    214  00b0
    215  00b0							;---------------------------------------------------------------------------------------------------
    216  00b0
      0  00b0					      DEF	aiFinalFlash
      1  00b0				   BANK_aiFinalFlash SET	_CURRENT_BANK
      2  00b0				   aiFinalFlash
      3  00b0				   TEMPORARY_VAR SET	Overlay
      4  00b0				   TEMPORARY_OFFSET SET	0
      5  00b0					      SUBROUTINE
    218  00b0					      SUBROUTINE
    219  00b0
    220  00b0		       a5 82		      lda	drawDelay
    221  00b2		       f0 03		      beq	.deCount
    222  00b4		       c6 82		      dec	drawDelay
    223  00b6		       60		      rts
    224  00b7
    225  00b7		       a5 84	   .deCount   lda	drawCount
    226  00b9		       f0 0e		      beq	flashDone2
    227  00bb		       c6 84		      dec	drawCount
    228  00bd
    229  00bd		       a9 0a		      lda	#10
    230  00bf		       85 82		      sta	drawDelay	; "getting ready to move" flash
    231  00c1
    232  00c1		       a5 9e		      lda	fromSquare
    233  00c3		       85 80		      sta	drawPieceNumber
    234  00c5		       20 ea fd 	      jsr	SAFE_CopySinglePiece
    235  00c8		       60		      rts
    236  00c9
      0  00c9				   flashDone2 PHASE	AI_SpecialMoveFixup
      1  00c9		       a9 1b		      lda	#AI_SpecialMoveFixup
      2  00cb		       85 8c		      sta	aiPhase
    238  00cd		       60		      rts
    239  00ce
    240  00ce
    241  00ce							;---------------------------------------------------------------------------------------------------
    242  00ce
      0  00ce					      DEF	CastleFixup
      1  00ce				   BANK_CastleFixup SET	_CURRENT_BANK
      2  00ce				   CastleFixup
      3  00ce				   TEMPORARY_VAR SET	Overlay
      4  00ce				   TEMPORARY_OFFSET SET	0
      5  00ce					      SUBROUTINE
    244  00ce					      SUBROUTINE
    245  00ce
    246  00ce							; fixup any castling issues
    247  00ce							; at this point the king has finished his two-square march
    248  00ce							; based on the finish square, we determine which rook we're interacting with
    249  00ce							; and generate a 'move' for the rook to position on the other side of the king
    250  00ce
    251  00ce
    252  00ce		       a5 9f		      lda	fromPiece
    253  00d0		       29 10		      and	#FLAG_CASTLE
    254  00d2		       f0 33		      beq	.noCast	; NOT involved in castle!
    255  00d4
    256  00d4		       a2 04		      ldx	#4
    257  00d6		       a5 a0		      lda	toSquare
    258  00d8		       ca	   .findCast  dex
    259  00d9		       30 2c		      bmi	.noCast
    260  00db		       dd 08 f1 	      cmp	KSquare,x
    261  00de		       d0 f8		      bne	.findCast
    262  00e0
    263  00e0
    264  00e0		       bd 10 f1 	      lda	RSquareEnd,x
    265  00e3		       85 86		      sta	toX12
    266  00e5		       bd 14 f1 	      lda	RSquareStart64,x
    267  00e8		       85 9e		      sta	fromSquare
    268  00ea		       bd 18 f1 	      lda	RSquareEnd64,x
    269  00ed		       85 a0		      sta	toSquare
    270  00ef
    271  00ef		       bc 0c f1 	      ldy	RSquareStart,x
    272  00f2		       84 85		      sty	fromX12
    273  00f4
    274  00f4		       a5 9f		      lda	fromPiece
    275  00f6		       29 80		      and	#128	; colour bit
    276  00f8		       09 05		      ora	#ROOK	; preserve colour
    277  00fa		       85 9f		      sta	fromPiece
    278  00fc
      0  00fc					      PHASE	AI_PrepForPhysicalMove
      1  00fc		       a9 14		      lda	#AI_PrepForPhysicalMove
      2  00fe		       85 8c		      sta	aiPhase
    280  0100
    281  0100							; in this siutation (castle, rook moving) we do not change sides yet!
    282  0100							; SO we DO change sides so the later change is a no-change...
    283  0100
    284  0100		       a5 9d		      lda	sideToMove
    285  0102		       49 80		      eor	#128
    286  0104		       85 9d		      sta	sideToMove
    287  0106
    288  0106		       60		      rts
    289  0107
    290  0107				   .noCast
    291  0107
    292  0107
    293  0107		       60		      rts
    294  0108
    295  0108
    296  0108		       02 06 3a 3e KSquare    .byte.b	2,6,58,62
    297  010c		       16 1d 5c 63 RSquareStart .byte.b	22,29,92,99
    298  0110		       19 1b 5f 61 RSquareEnd .byte.b	25,27,95,97
    299  0114		       00 07 38 3f RSquareStart64 .byte.b	0,7,56,63
    300  0118		       03 05 3b 3d RSquareEnd64 .byte.b	3,5,59,61
    301  011c
    302  011c
    303  011c							;---------------------------------------------------------------------------------------------------
    304  011c
      0  011c					      DEF	SetupBanks
      1  011c				   BANK_SetupBanks SET	_CURRENT_BANK
      2  011c				   SetupBanks
      3  011c				   TEMPORARY_VAR SET	Overlay
      4  011c				   TEMPORARY_OFFSET SET	0
      5  011c					      SUBROUTINE
    306  011c					      SUBROUTINE
    307  011c
      0  011c					      VAR	__plyBank, 1
      1  011c				   __plyBank  SET	TEMPORARY_VAR
      2  011c				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  011c
      4  011c				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  011c				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  011c				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  011c					      ENDIF
      8  011c				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  011c				  -	      ECHO	"Temporary Variable", __plyBank, "overflow!"
     10  011c				  -	      ERR
     11  011c					      ENDIF
     12  011c					      LIST	ON
    309  011c
    310  011c							; SAFE
    311  011c
    312  011c		       a0 07		      ldy	#7
    313  011e		       a2 01	   .copyRowBanks ldx	#BANK_ROM_SHADOW_OF_CHESS_BITMAP
    314  0120		       20 ab fd 	      jsr	SAFE_CopyShadowROMtoRAM
    315  0123		       88		      dey
    316  0124		       10 f8		      bpl	.copyRowBanks
    317  0126
    318  0126							; copy the BOARD/MOVES bank
    319  0126
    320  0126		       a0 08		      ldy	#RAMBANK_MOVES_RAM
    321  0128		       a2 0d		      ldx	#MOVES
    322  012a		       20 ab fd 	      jsr	SAFE_CopyShadowROMtoRAM	; this auto-initialises Board too
    323  012d
    324  012d							; copy the PLY banks
    325  012d
    326  012d		       a9 06		      lda	#MAX_PLY
    327  012f		       85 a5		      sta	__plyBank
    328  0131		       a0 09		      ldy	#RAMBANK_PLY
    329  0133		       84 9b		      sty	currentPly
    330  0135		       a2 0e	   .copyPlyBanks ldx	#BANK_PLY
    331  0137		       20 ab fd 	      jsr	SAFE_CopyShadowROMtoRAM
    332  013a		       c8		      iny
    333  013b		       c6 a5		      dec	__plyBank
    334  013d		       d0 f6		      bne	.copyPlyBanks
    335  013f
    336  013f		       60		      rts
    337  0140
    338  0140
    339  0140							;---------------------------------------------------------------------------------------------------
    340  0140
      0  0140					      CHECK_BANK_SIZE	"GENERIC_BANK_1 -- full 2K"
      1  0140		       01 40	   .TEMP      =	* - BANK_START
 GENERIC_BANK_1 -- full 2K (2K) SIZE =  $140 , FREE= $6c0
      2  0140					      ECHO	"GENERIC_BANK_1 -- full 2K", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  0140				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  0140				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  0140				  -	      ERR
      6  0140					      endif
------- FILE ./chess.asm
------- FILE BANK_ROM_SHADOW_SCREEN.asm LEVEL 2 PASS 2
      0  0140					      include	"BANK_ROM_SHADOW_SCREEN.asm"
      1  0140
      0  0140					      NEWBANK	BANK_ROM_SHADOW_OF_CHESS_BITMAP
      1  0b2e ????				      SEG	BANK_ROM_SHADOW_OF_CHESS_BITMAP
      2  0800					      ORG	ORIGIN
      3  0800					      RORG	$F000
      4  0800				   BANK_START SET	*
      5  0800				   BANK_ROM_SHADOW_OF_CHESS_BITMAP SET	ORIGIN / 2048
      6  0800				   ORIGIN     SET	ORIGIN + 2048
      7  0800				   _CURRENT_BANK SET	BANK_ROM_SHADOW_OF_CHESS_BITMAP
      3  0800
      4  0800							; Template bank for a SINGLE ROW of the chessboard display.
      5  0800							; There are 8x of these.
      6  0800							; The bank contains the definition of the bitmap, and also the code to draw the bitmap
      7  0800							; The bank is copied from ROM into RAM at startup.
      8  0800							; The draw switches between consecutive row banks, with the last returning
      9  0800							; we effectively have 1K
     10  0800							;---------------------------------------------------------------------------------------------------
     11  0800
     12  0800		       00 a4	   COLOUR_LINE_1 =	$a4
     13  0800		       00 48	   COLOUR_LINE_2 =	$48
     14  0800		       00 2a	   COLOUR_LINE_3 =	$2A
     15  0800		       00 00	   BACKGCOL   =	$00
     16  0800
     17  0800							;COLOUR_LINE_1 = $94 ; square col
     18  0800							;COLOUR_LINE_2 = $C6
     19  0800							;COLOUR_LINE_3 = $48
     20  0800							;BACKGCOL	= 0 ;$F0
     21  0800
     22  0800
     23  0800							; good 94/46/28/0
     24  0800							; good 94/44/26/0
     25  0800
     26  0800
     27  0800		       00 90	   ROW_BITMAP_SIZE =	6 * 24	; PF0/PF1/PF2/(PF0)/(PF1)/(PF2) x 8 ICC pixels
     28  0800
     29  0800
      0  0800					      ALLOCATE	ChessBitmap, ROW_BITMAP_SIZE
      0  0800					      OPTIONAL_PAGEBREAK	"Table", ROW_BITMAP_SIZE
     10  0800					      LIST	ON
      0  0800					      DEF	ChessBitmap
      1  0800				   BANK_ChessBitmap SET	_CURRENT_BANK
      2  0800				   ChessBitmap
      3  0800				   TEMPORARY_VAR SET	Overlay
      4  0800				   TEMPORARY_OFFSET SET	0
      5  0800					      SUBROUTINE
     31  0800		       00 00 00 00*ChessBitmap0 ds	24
     32  0818		       00 00 00 00*ChessBitmap1 ds	24
     33  0830		       00 00 00 00*ChessBitmap2 ds	24
     34  0848		       00 00 00 00*ChessBitmap3 ds	24
     35  0860		       00 00 00 00*ChessBitmap4 ds	24
     36  0878		       00 00 00 00*ChessBitmap5 ds	24
     37  0890
      0  0890					      ALLOCATE	BlankSprite, 8
      0  0890					      OPTIONAL_PAGEBREAK	"Table", 8
     10  0890					      LIST	ON
      0  0890					      DEF	BlankSprite
      1  0890				   BANK_BlankSprite SET	_CURRENT_BANK
      2  0890				   BlankSprite
      3  0890				   TEMPORARY_VAR SET	Overlay
      4  0890				   TEMPORARY_OFFSET SET	0
      5  0890					      SUBROUTINE
     39  0890		       00 00 00 00*	      ds	8, 0
     40  0898
      0  0898					      ALLOCATE	SpriteBuffer, 24
      0  0898					      OPTIONAL_PAGEBREAK	"Table", 24
     10  0898					      LIST	ON
      0  0898					      DEF	SpriteBuffer
      1  0898				   BANK_SpriteBuffer SET	_CURRENT_BANK
      2  0898				   SpriteBuffer
      3  0898				   TEMPORARY_VAR SET	Overlay
      4  0898				   TEMPORARY_OFFSET SET	0
      5  0898					      SUBROUTINE
     42  0898				   SpriteBuffer2
     43  0898					      REPEAT	24
     44  0898		       f8		      .byte.b	%11111000
     43  0898					      REPEND
     44  0899		       f8		      .byte.b	%11111000
     43  0899					      REPEND
     44  089a		       f8		      .byte.b	%11111000
     43  089a					      REPEND
     44  089b		       f8		      .byte.b	%11111000
     43  089b					      REPEND
     44  089c		       f8		      .byte.b	%11111000
     43  089c					      REPEND
     44  089d		       f8		      .byte.b	%11111000
     43  089d					      REPEND
     44  089e		       f8		      .byte.b	%11111000
     43  089e					      REPEND
     44  089f		       f8		      .byte.b	%11111000
     43  089f					      REPEND
     44  08a0		       f8		      .byte.b	%11111000
     43  08a0					      REPEND
     44  08a1		       f8		      .byte.b	%11111000
     43  08a1					      REPEND
     44  08a2		       f8		      .byte.b	%11111000
     43  08a2					      REPEND
     44  08a3		       f8		      .byte.b	%11111000
     43  08a3					      REPEND
     44  08a4		       f8		      .byte.b	%11111000
     43  08a4					      REPEND
     44  08a5		       f8		      .byte.b	%11111000
     43  08a5					      REPEND
     44  08a6		       f8		      .byte.b	%11111000
     43  08a6					      REPEND
     44  08a7		       f8		      .byte.b	%11111000
     43  08a7					      REPEND
     44  08a8		       f8		      .byte.b	%11111000
     43  08a8					      REPEND
     44  08a9		       f8		      .byte.b	%11111000
     43  08a9					      REPEND
     44  08aa		       f8		      .byte.b	%11111000
     43  08aa					      REPEND
     44  08ab		       f8		      .byte.b	%11111000
     43  08ab					      REPEND
     44  08ac		       f8		      .byte.b	%11111000
     43  08ac					      REPEND
     44  08ad		       f8		      .byte.b	%11111000
     43  08ad					      REPEND
     44  08ae		       f8		      .byte.b	%11111000
     43  08ae					      REPEND
     44  08af		       f8		      .byte.b	%11111000
     45  08b0					      REPEND
     46  08b0
      0  08b0					      ALLOCATE	BackupBitmap, ROW_BITMAP_SIZE
      0  08b0					      OPTIONAL_PAGEBREAK	"Table", ROW_BITMAP_SIZE
 PAGE BREAK INSERTED FOR Table
 REQUESTED SIZE = $90
 WASTED SPACE = $50
 PAGEBREAK LOCATION = $f100
     10  0900					      LIST	ON
      0  0900					      DEF	BackupBitmap
      1  0900				   BANK_BackupBitmap SET	_CURRENT_BANK
      2  0900				   BackupBitmap
      3  0900				   TEMPORARY_VAR SET	Overlay
      4  0900				   TEMPORARY_OFFSET SET	0
      5  0900					      SUBROUTINE
     48  0900		       00 00 00 00*	      ds	ROW_BITMAP_SIZE, 0
     49  0990
     50  0990							;---------------------------------------------------------------------------------------------------
     51  0990
      0  0990					      DEF	ClearRowBitmap
      1  0990				   BANK_ClearRowBitmap SET	_CURRENT_BANK
      2  0990				   ClearRowBitmap
      3  0990				   TEMPORARY_VAR SET	Overlay
      4  0990				   TEMPORARY_OFFSET SET	0
      5  0990					      SUBROUTINE
     53  0990					      SUBROUTINE
     54  0990
     55  0990		       a9 00		      lda	#0
     56  0992		       a0 90		      ldy	#ROW_BITMAP_SIZE
     57  0994		       99 ff f3    .clearRow  sta	ChessBitmap+RAM_WRITE-1,y
     58  0997		       88		      dey
     59  0998		       d0 fa		      bne	.clearRow
     60  099a		       60		      rts
     61  099b
     62  099b
     63  099b							;---------------------------------------------------------------------------------------------------
     64  099b
      0  099b					      DEF	CopyPieceToRowBitmap
      1  099b				   BANK_CopyPieceToRowBitmap SET	_CURRENT_BANK
      2  099b				   CopyPieceToRowBitmap
      3  099b				   TEMPORARY_VAR SET	Overlay
      4  099b				   TEMPORARY_OFFSET SET	0
      5  099b					      SUBROUTINE
     66  099b					      SUBROUTINE
     67  099b
     68  099b		       a0 11		      ldy	#17
     69  099d		       b0 30		      bcs	.rightSide
     70  099f
     71  099f		       b9 a5 00    .copyPiece lda	__pieceShapeBuffer,y
     72  09a2		       f0 06		      beq	.blank1
     73  09a4		       59 00 f0 	      eor	ChessBitmap,y
     74  09a7		       99 00 f4 	      sta	ChessBitmap+RAM_WRITE,y
     75  09aa
     76  09aa		       b9 b7 00    .blank1    lda	__pieceShapeBuffer+18,y
     77  09ad		       f0 06		      beq	.blank2
     78  09af		       59 12 f0 	      eor	ChessBitmap+18,y
     79  09b2		       99 12 f4 	      sta	ChessBitmap+RAM_WRITE+18,y
     80  09b5
     81  09b5		       b9 c9 00    .blank2    lda	__pieceShapeBuffer+36,y
     82  09b8		       f0 06		      beq	.blank3
     83  09ba		       59 24 f0 	      eor	ChessBitmap+36,y
     84  09bd		       99 24 f4 	      sta	ChessBitmap+RAM_WRITE+36,y
     85  09c0
     86  09c0		       b9 db 00    .blank3    lda	__pieceShapeBuffer+54,y
     87  09c3		       f0 06		      beq	.blank4
     88  09c5		       59 36 f0 	      eor	ChessBitmap+54,y
     89  09c8		       99 36 f4 	      sta	ChessBitmap+RAM_WRITE+54,y
     90  09cb
     91  09cb		       88	   .blank4    dey
     92  09cc		       10 d1		      bpl	.copyPiece
     93  09ce		       60		      rts
     94  09cf
     95  09cf				   .rightSide
     96  09cf
     97  09cf					      SUBROUTINE
     98  09cf
     99  09cf		       b9 a5 00    .copyPieceR lda	__pieceShapeBuffer,y
    100  09d2		       f0 06		      beq	.blank1
    101  09d4		       59 48 f0 	      eor	ChessBitmap+72,y
    102  09d7		       99 48 f4 	      sta	ChessBitmap+RAM_WRITE+72,y
    103  09da
    104  09da		       b9 b7 00    .blank1    lda	__pieceShapeBuffer+18,y
    105  09dd		       f0 06		      beq	.blank2
    106  09df		       59 5a f0 	      eor	ChessBitmap+72+18,y
    107  09e2		       99 5a f4 	      sta	ChessBitmap+RAM_WRITE+72+18,y
    108  09e5
    109  09e5		       b9 c9 00    .blank2    lda	__pieceShapeBuffer+36,y
    110  09e8		       f0 06		      beq	.blank3
    111  09ea		       59 6c f0 	      eor	ChessBitmap+72+36,y
    112  09ed		       99 6c f4 	      sta	ChessBitmap+RAM_WRITE+72+36,y
    113  09f0
    114  09f0		       b9 db 00    .blank3    lda	__pieceShapeBuffer+54,y
    115  09f3		       f0 06		      beq	.blank4
    116  09f5		       59 7e f0 	      eor	ChessBitmap+72+54,y
    117  09f8		       99 7e f4 	      sta	ChessBitmap+RAM_WRITE+72+54,y
    118  09fb
    119  09fb		       88	   .blank4    dey
    120  09fc		       10 d1		      bpl	.copyPieceR
    121  09fe		       60		      rts
    122  09ff
    123  09ff
    124  09ff							;---------------------------------------------------------------------------------------------------
    125  09ff
    126  0a00		       00		      ALIGN	256
    127  0a00
    128  0a00							; x = row # (and bank#)
    129  0a00
    130  0a00				   .endline
    131  0a00
    132  0a00							;@59
    133  0a00
    134  0a00							; The following 'inx' is replaced in the LAST row bank with a 'RTS', thus ending the draw loop
    135  0a00							; Note that the other 7 row banks are unmodified (keeping the 'inx')
    136  0a00				   SELFMOD_RTS_ON_LAST_ROW
    137  0a00
    138  0a00		       e8		      inx		; 2
    139  0a01		       86 3e		      stx	SET_BANK_RAM	; 3 @64     BANK switch to next row
    140  0a03
      0  0a03					      DEF	DrawRow
      1  0a03				   BANK_DrawRow SET	_CURRENT_BANK
      2  0a03				   DrawRow
      3  0a03				   TEMPORARY_VAR SET	Overlay
      4  0a03				   TEMPORARY_OFFSET SET	0
      5  0a03					      SUBROUTINE
    142  0a03
    143  0a03							;@64
    144  0a03		       a0 07		      ldy	#7	; 2
    145  0a05		       10 3b		      bpl	.dl2	; 3   (must be 69 here)
    146  0a07
    147  0a07							;@58...
    148  0a07
    149  0a07				   .l3
    150  0a07
    151  0a07		       b9 a8 f0    SMSPRITE16_0 lda	SpriteBuffer+16,y	; 4
    152  0a0a		       85 5b		      sta	GRP0	; 3
    153  0a0c		       b9 a8 f0    SMSPRITE16_1 lda	SpriteBuffer2+16,y	; 4
    154  0a0f		       85 5c		      sta	GRP1	; 3
    155  0a11
    156  0a11							;@-4
    157  0a11
    158  0a11		       a9 a4		      lda	#COLOUR_LINE_1	;#$94			  ; 2
    159  0a13		       85 48		      sta	COLUPF	; 3 @1
    160  0a15
    161  0a15		       b9 10 f0 	      lda	ChessBitmap0+16,y	; 4
    162  0a18		       85 4d		      sta	PF0	; 3
    163  0a1a		       b9 28 f0 	      lda	ChessBitmap1+16,y	; 4
    164  0a1d		       85 4e		      sta	PF1	; 3
    165  0a1f		       b9 40 f0 	      lda	ChessBitmap2+16,y	; 4
    166  0a22		       85 4f		      sta	PF2	; 3 @22
    167  0a24
      0  0a24					      SLEEP	6	; 6 @28
      1  0a24				   .CYCLES    SET	6
      2  0a24
      3  0a24				  -	      IF	.CYCLES < 2
      4  0a24				  -	      ECHO	"MACRO ERROR: 'SLEEP': Duration must be > 1"
      5  0a24				  -	      ERR
      6  0a24					      ENDIF
      7  0a24
      8  0a24				  -	      IF	.CYCLES & 1
      9  0a24				  -	      IFNCONST	NO_ILLEGAL_OPCODES
     10  0a24				  -	      nop	0
     11  0a24				  -	      ELSE
     12  0a24				  -	      bit	VSYNC
     13  0a24				  -	      ENDIF
     14  0a24				  -.CYCLES    SET	.CYCLES - 3
     15  0a24					      ENDIF
     16  0a24
     17  0a24					      REPEAT	.CYCLES / 2
     18  0a24		       ea		      nop
     17  0a24					      REPEND
     18  0a25		       ea		      nop
     17  0a25					      REPEND
     18  0a26		       ea		      nop
     19  0a27					      REPEND
    169  0a27
    170  0a27		       b9 58 f0 	      lda	ChessBitmap3+16,y	; 4
    171  0a2a		       85 4d		      sta	PF0	; 3
    172  0a2c		       b9 70 f0 	      lda	ChessBitmap4+16,y	; 4
    173  0a2f		       85 4e		      sta	PF1	; 3
    174  0a31		       b9 88 f0 	      lda	ChessBitmap5+16,y	; 4
    175  0a34		       8d 4f 00 	      sta.w	PF2	; 4 @50
    176  0a37
      0  0a37					      SLEEP	4	; 4
      1  0a37				   .CYCLES    SET	4
      2  0a37
      3  0a37				  -	      IF	.CYCLES < 2
      4  0a37				  -	      ECHO	"MACRO ERROR: 'SLEEP': Duration must be > 1"
      5  0a37				  -	      ERR
      6  0a37					      ENDIF
      7  0a37
      8  0a37				  -	      IF	.CYCLES & 1
      9  0a37				  -	      IFNCONST	NO_ILLEGAL_OPCODES
     10  0a37				  -	      nop	0
     11  0a37				  -	      ELSE
     12  0a37				  -	      bit	VSYNC
     13  0a37				  -	      ENDIF
     14  0a37				  -.CYCLES    SET	.CYCLES - 3
     15  0a37					      ENDIF
     16  0a37
     17  0a37					      REPEAT	.CYCLES / 2
     18  0a37		       ea		      nop
     17  0a37					      REPEND
     18  0a38		       ea		      nop
     19  0a39					      REPEND
    178  0a39
    179  0a39		       88		      dey		; 2
    180  0a3a		       30 c4		      bmi	.endline	; 2 (3)
    181  0a3c
    182  0a3c							;@57
    183  0a3c				   .drawLine
    184  0a3c
      0  0a3c					      SLEEP	11
      1  0a3c				   .CYCLES    SET	11
      2  0a3c
      3  0a3c				  -	      IF	.CYCLES < 2
      4  0a3c				  -	      ECHO	"MACRO ERROR: 'SLEEP': Duration must be > 1"
      5  0a3c				  -	      ERR
      6  0a3c					      ENDIF
      7  0a3c
      8  0a3c					      IF	.CYCLES & 1
      9  0a3c					      IFNCONST	NO_ILLEGAL_OPCODES
     10  0a3c		       04 00		      nop	0
     11  0a3e				  -	      ELSE
     12  0a3e				  -	      bit	VSYNC
     13  0a3e					      ENDIF
     14  0a3e				   .CYCLES    SET	.CYCLES - 3
     15  0a3e					      ENDIF
     16  0a3e
     17  0a3e					      REPEAT	.CYCLES / 2
     18  0a3e		       ea		      nop
     17  0a3e					      REPEND
     18  0a3f		       ea		      nop
     17  0a3f					      REPEND
     18  0a40		       ea		      nop
     17  0a40					      REPEND
     18  0a41		       ea		      nop
     19  0a42					      REPEND
    186  0a42
    187  0a42				   .dl2
    188  0a42		       b9 98 f0    SMSPRITE0_0 lda	SpriteBuffer,y	; 4
    189  0a45		       85 5b		      sta	GRP0	; 3
    190  0a47		       b9 98 f0    SMSPRITE0_1 lda	SpriteBuffer2,y	; 4
    191  0a4a		       85 5c		      sta	GRP1	; 3
    192  0a4c
    193  0a4c							;@7
    194  0a4c
    195  0a4c		       a9 48		      lda	#COLOUR_LINE_2	;#$4A			  ; 2
    196  0a4e		       85 48		      sta	COLUPF	; 3 @12
    197  0a50
    198  0a50		       b9 00 f0 	      lda	ChessBitmap0,y	; 4
    199  0a53		       85 4d		      sta	PF0	; 3
    200  0a55		       b9 18 f0 	      lda	ChessBitmap1,y	; 4
    201  0a58		       85 4e		      sta	PF1	; 3
    202  0a5a		       b9 30 f0 	      lda	ChessBitmap2,y	; 4
    203  0a5d		       85 4f		      sta	PF2	; 3 @33
    204  0a5f
      0  0a5f					      SLEEP	3	; 3 @36
      1  0a5f				   .CYCLES    SET	3
      2  0a5f
      3  0a5f				  -	      IF	.CYCLES < 2
      4  0a5f				  -	      ECHO	"MACRO ERROR: 'SLEEP': Duration must be > 1"
      5  0a5f				  -	      ERR
      6  0a5f					      ENDIF
      7  0a5f
      8  0a5f					      IF	.CYCLES & 1
      9  0a5f					      IFNCONST	NO_ILLEGAL_OPCODES
     10  0a5f		       04 00		      nop	0
     11  0a61				  -	      ELSE
     12  0a61				  -	      bit	VSYNC
     13  0a61					      ENDIF
     14  0a61				   .CYCLES    SET	.CYCLES - 3
     15  0a61					      ENDIF
     16  0a61
     17  0a61				  -	      REPEAT	.CYCLES / 2
     18  0a61				  -	      nop
     19  0a61					      REPEND
    206  0a61
    207  0a61		       b9 48 f0 	      lda	ChessBitmap3,y	; 4
    208  0a64		       85 4d		      sta	PF0	; 3
    209  0a66		       b9 60 f0 	      lda	ChessBitmap4,y	; 4
    210  0a69		       85 4e		      sta	PF1	; 3
    211  0a6b		       b9 78 f0 	      lda	ChessBitmap5,y	; 4
    212  0a6e		       85 4f		      sta	PF2	; 3 @57
    213  0a70
      0  0a70					      SLEEP	5
      1  0a70				   .CYCLES    SET	5
      2  0a70
      3  0a70				  -	      IF	.CYCLES < 2
      4  0a70				  -	      ECHO	"MACRO ERROR: 'SLEEP': Duration must be > 1"
      5  0a70				  -	      ERR
      6  0a70					      ENDIF
      7  0a70
      8  0a70					      IF	.CYCLES & 1
      9  0a70					      IFNCONST	NO_ILLEGAL_OPCODES
     10  0a70		       04 00		      nop	0
     11  0a72				  -	      ELSE
     12  0a72				  -	      bit	VSYNC
     13  0a72					      ENDIF
     14  0a72				   .CYCLES    SET	.CYCLES - 3
     15  0a72					      ENDIF
     16  0a72
     17  0a72					      REPEAT	.CYCLES / 2
     18  0a72		       ea		      nop
     19  0a73					      REPEND
    215  0a73
    216  0a73		       b9 a0 f0    SMSPRITE8_0 lda	SpriteBuffer+8,y	; 4
    217  0a76		       85 5b		      sta	GRP0	; 3
    218  0a78		       b9 a0 f0    SMSPRITE8_1 lda	SpriteBuffer2+8,y	; 4
    219  0a7b		       85 5c		      sta	GRP1	; 3
    220  0a7d
    221  0a7d							;@0
    222  0a7d		       a9 2a		      lda	#COLOUR_LINE_3	;#$28			  ; 2
    223  0a7f		       85 48		      sta	COLUPF	; 3 @5
    224  0a81
    225  0a81		       b9 08 f0 	      lda	ChessBitmap0+8,y	; 4
    226  0a84		       85 4d		      sta	PF0	; 3
    227  0a86		       b9 20 f0 	      lda	ChessBitmap1+8,y	; 4
    228  0a89		       85 4e		      sta	PF1	; 3
    229  0a8b		       b9 38 f0 	      lda	ChessBitmap2+8,y	; 4
    230  0a8e		       85 4f		      sta	PF2	; 3 @26
    231  0a90
      0  0a90					      SLEEP	8	; 6 @34
      1  0a90				   .CYCLES    SET	8
      2  0a90
      3  0a90				  -	      IF	.CYCLES < 2
      4  0a90				  -	      ECHO	"MACRO ERROR: 'SLEEP': Duration must be > 1"
      5  0a90				  -	      ERR
      6  0a90					      ENDIF
      7  0a90
      8  0a90				  -	      IF	.CYCLES & 1
      9  0a90				  -	      IFNCONST	NO_ILLEGAL_OPCODES
     10  0a90				  -	      nop	0
     11  0a90				  -	      ELSE
     12  0a90				  -	      bit	VSYNC
     13  0a90				  -	      ENDIF
     14  0a90				  -.CYCLES    SET	.CYCLES - 3
     15  0a90					      ENDIF
     16  0a90
     17  0a90					      REPEAT	.CYCLES / 2
     18  0a90		       ea		      nop
     17  0a90					      REPEND
     18  0a91		       ea		      nop
     17  0a91					      REPEND
     18  0a92		       ea		      nop
     17  0a92					      REPEND
     18  0a93		       ea		      nop
     19  0a94					      REPEND
    233  0a94
    234  0a94		       b9 50 f0 	      lda	ChessBitmap3+8,y	; 4
    235  0a97		       85 4d		      sta	PF0	; 3
    236  0a99		       b9 68 f0 	      lda	ChessBitmap4+8,y	; 4
    237  0a9c		       85 4e		      sta	PF1	; 3
    238  0a9e		       b9 80 f0 	      lda	ChessBitmap5+8,y	; 4
    239  0aa1		       85 4f		      sta	PF2	; 3 @55
    240  0aa3
    241  0aa3		       4c 07 f2 	      jmp	.l3	; 3 @58
    242  0aa6
    243  0aa6
    244  0aa6							;---------------------------------------------------------------------------------------------------
    245  0aa6
      0  0aa6					      DEF	WriteBlank
      1  0aa6				   BANK_WriteBlank SET	_CURRENT_BANK
      2  0aa6				   WriteBlank
      3  0aa6				   TEMPORARY_VAR SET	Overlay
      4  0aa6				   TEMPORARY_OFFSET SET	0
      5  0aa6					      SUBROUTINE
    247  0aa6					      SUBROUTINE
    248  0aa6
    249  0aa6		       a9 90		      lda	#<BlankSprite
    250  0aa8		       8d 43 f6 	      sta	SMSPRITE0_0+1+RAM_WRITE
    251  0aab		       8d 74 f6 	      sta	SMSPRITE8_0+1+RAM_WRITE
    252  0aae		       8d 08 f6 	      sta	SMSPRITE16_0+1+RAM_WRITE
    253  0ab1		       8d 48 f6 	      sta	SMSPRITE0_1+1+RAM_WRITE
    254  0ab4		       8d 79 f6 	      sta	SMSPRITE8_1+1+RAM_WRITE
    255  0ab7		       8d 0d f6 	      sta	SMSPRITE16_1+1+RAM_WRITE
    256  0aba
    257  0aba		       a9 f0		      lda	#>BlankSprite
    258  0abc		       8d 44 f6 	      sta	SMSPRITE0_0+2+RAM_WRITE
    259  0abf		       8d 75 f6 	      sta	SMSPRITE8_0+2+RAM_WRITE
    260  0ac2		       8d 09 f6 	      sta	SMSPRITE16_0+2+RAM_WRITE
    261  0ac5		       8d 49 f6 	      sta	SMSPRITE0_1+2+RAM_WRITE
    262  0ac8		       8d 7a f6 	      sta	SMSPRITE8_1+2+RAM_WRITE
    263  0acb		       8d 0e f6 	      sta	SMSPRITE16_1+2+RAM_WRITE
    264  0ace
    265  0ace		       60		      rts
    266  0acf
    267  0acf
    268  0acf							;---------------------------------------------------------------------------------------------------
    269  0acf
      0  0acf					      DEF	WriteCursor
      1  0acf				   BANK_WriteCursor SET	_CURRENT_BANK
      2  0acf				   WriteCursor
      3  0acf				   TEMPORARY_VAR SET	Overlay
      4  0acf				   TEMPORARY_OFFSET SET	0
      5  0acf					      SUBROUTINE
    271  0acf					      SUBROUTINE
    272  0acf
    273  0acf		       a6 87		      ldx	highlight_row
    274  0ad1		       30 18		      bmi	.exit
    275  0ad3
    276  0ad3		       86 3e		      stx	SET_BANK_RAM
    277  0ad5		       a9 98		      lda	#<SpriteBuffer
    278  0ad7		       8d 43 f6 	      sta	SMSPRITE0_0+1+RAM_WRITE
    279  0ada		       8d 74 f6 	      sta	SMSPRITE8_0+1+RAM_WRITE
    280  0add		       8d 08 f6 	      sta	SMSPRITE16_0+1+RAM_WRITE
    281  0ae0		       a9 f0		      lda	#>SpriteBuffer
    282  0ae2		       8d 44 f6 	      sta	SMSPRITE0_0+2+RAM_WRITE
    283  0ae5		       8d 75 f6 	      sta	SMSPRITE8_0+2+RAM_WRITE
    284  0ae8		       8d 09 f6 	      sta	SMSPRITE16_0+2+RAM_WRITE
    285  0aeb
    286  0aeb		       60	   .exit      rts
    287  0aec
    288  0aec
    289  0aec							;---------------------------------------------------------------------------------------------------
    290  0aec
      0  0aec					      DEF	SaveBitmap
      1  0aec				   BANK_SaveBitmap SET	_CURRENT_BANK
      2  0aec				   SaveBitmap
      3  0aec				   TEMPORARY_VAR SET	Overlay
      4  0aec				   TEMPORARY_OFFSET SET	0
      5  0aec					      SUBROUTINE
    292  0aec					      SUBROUTINE
    293  0aec
    294  0aec		       a0 47		      ldy	#71
    295  0aee		       b9 00 f0    .fromTo    lda	ChessBitmap,y
    296  0af1		       99 00 f5 	      sta	BackupBitmap+RAM_WRITE,y
    297  0af4		       b9 48 f0 	      lda	ChessBitmap+72,y
    298  0af7		       99 48 f5 	      sta	BackupBitmap+72+RAM_WRITE,y
    299  0afa		       88		      dey
    300  0afb		       10 f1		      bpl	.fromTo
    301  0afd		       60		      rts
    302  0afe
    303  0afe
    304  0afe							;---------------------------------------------------------------------------------------------------
    305  0afe
      0  0afe					      DEF	RestoreBitmap
      1  0afe				   BANK_RestoreBitmap SET	_CURRENT_BANK
      2  0afe				   RestoreBitmap
      3  0afe				   TEMPORARY_VAR SET	Overlay
      4  0afe				   TEMPORARY_OFFSET SET	0
      5  0afe					      SUBROUTINE
    307  0afe					      SUBROUTINE
    308  0afe
    309  0afe		       a0 47		      ldy	#71
    310  0b00		       b9 00 f1    .fromTo    lda	BackupBitmap,y
    311  0b03		       99 00 f4 	      sta	ChessBitmap+RAM_WRITE,y
    312  0b06		       b9 48 f1 	      lda	BackupBitmap+72,y
    313  0b09		       99 48 f4 	      sta	ChessBitmap+72+RAM_WRITE,y
    314  0b0c		       88		      dey
    315  0b0d		       10 f1		      bpl	.fromTo
    316  0b0f		       60		      rts
    317  0b10
    318  0b10
    319  0b10							;---------------------------------------------------------------------------------------------------
    320  0b10
      0  0b10					      DEF	CopyTextToRowBitmap
      1  0b10				   BANK_CopyTextToRowBitmap SET	_CURRENT_BANK
      2  0b10				   CopyTextToRowBitmap
      3  0b10				   TEMPORARY_VAR SET	Overlay
      4  0b10				   TEMPORARY_OFFSET SET	0
      5  0b10					      SUBROUTINE
    322  0b10					      SUBROUTINE
    323  0b10
    324  0b10							; An OR-draw, used for placing matricies/text onscreen
    325  0b10							; Similar to the EOR - first copy data into __pieceShapeBuffer, then call this function
    326  0b10							; The draw can be bracketed by "SaveBitmap" and "RestoreBitmap" to leave screen
    327  0b10							; in original state once text disappears
    328  0b10
    329  0b10		       a0 47		      ldy	#71
    330  0b12		       b0 0d		      bcs	.rightSide
    331  0b14
    332  0b14		       b9 a5 00    .copy      lda	__pieceShapeBuffer,y
    333  0b17		       19 00 f0 	      ora	ChessBitmap,y
    334  0b1a		       99 00 f4 	      sta	ChessBitmap+RAM_WRITE,y
    335  0b1d		       88		      dey
    336  0b1e		       10 f4		      bpl	.copy
    337  0b20
    338  0b20		       60		      rts
    339  0b21
    340  0b21				   .rightSide
    341  0b21
    342  0b21					      SUBROUTINE
    343  0b21
    344  0b21		       b9 a5 00    .copy      lda	__pieceShapeBuffer,y
    345  0b24		       19 48 f0 	      ora	ChessBitmap+72,y
    346  0b27		       99 48 f4 	      sta	ChessBitmap+RAM_WRITE+72,y
    347  0b2a		       88		      dey
    348  0b2b		       10 f4		      bpl	.copy
    349  0b2d
    350  0b2d		       60		      rts
    351  0b2e
    352  0b2e
    353  0b2e							;---------------------------------------------------------------------------------------------------
    354  0b2e
      0  0b2e					      CHECK_HALF_BANK_SIZE	"ROM_SHADOW_SCREEN"
      1  0b2e
      2  0b2e
      3  0b2e		       03 2e	   .TEMP      =	* - BANK_START
 ROM_SHADOW_SCREEN (1K) SIZE =  $32e , FREE= $d2
      4  0b2e					      ECHO	"ROM_SHADOW_SCREEN", "(1K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE/2 - .TEMP
      5  0b2e				  -	      if	( .TEMP ) > ROM_BANK_SIZE/2
      6  0b2e				  -	      ECHO	"HALF-BANK OVERFLOW @ ", * - ORIGIN
      7  0b2e				  -	      ERR
      8  0b2e					      endif
    356  0b2e							;VALIDATE_RAM_SIZE
------- FILE ./chess.asm
------- FILE BANK_CHESS_INCLUDES.asm LEVEL 2 PASS 2
      0  0b2e					      include	"BANK_CHESS_INCLUDES.asm"
      1  0b2e							; Chess
      2  0b2e							; Atari 2600 Chess display system
      3  0b2e							; Copyright (c) 2019-2020 Andrew Davie
      4  0b2e							; andrew@taswegian.com
      5  0b2e
      6  0b2e
      7  0b2e							; Each piece is defined as 3 PF bytes (horizontal) x 24 scanlines (vertical)
      8  0b2e							; The pieces are converted by ConvertChessPieces.py (in tools), which takes
      9  0b2e							; a single gif of the format..
     10  0b2e							; a row of white pieces on black squares
     11  0b2e							; a row of white pieces on white squares
     12  0b2e							; a row of black pieces on black squares
     13  0b2e							; a row of black pieces on white squares
     14  0b2e
     15  0b2e							; each row has the pieces ordered thus:
     16  0b2e							; a blank, then pawn, knight, bishop, rook, queen, king
     17  0b2e							; each piece is 5 pixels wide x 8 pixels deep
     18  0b2e							; each pixel is from an 8-colour palette.
     19  0b2e							; Given a pixel colour 0-7 (represented in binary 000 - 111) then if the bits
     20  0b2e							; for the colour are abc (i.e., colour #3 = binary 011 = bits 0bc)
     21  0b2e							; then bit "a" becomes the first interleaved chronocolour pixel (line 1)
     22  0b2e							; bit "b" becomes the second ICC pixel line (2)
     23  0b2e							; bit "c" becomes the third ICC pixel line (3)
     24  0b2e							; Thus, a 5 pxel x 8 pixel shape becomes 24 lines deep
     25  0b2e							; The tool produces 4 variants of the piece; shifted into the 4 squares
     26  0b2e							; in the PF - thus, at pixel 0, pixel 5, pixel 10, pixel 15.
     27  0b2e							; These 4 shifted positions are stored consecutively in the shape definition
     28  0b2e
     29  0b2e							; Example...
     30  0b2e							;DEF WHITE_BISHOP_on_BLACK_SQUARE_0
     31  0b2e							;.byte $00,$40,$40,$40,$00,$00,$e0,$e0,$e0,$d0,$d0,$d0,$b0,$b0,$b0,$f0,$f0,$f0,$e0,$60,$e0,$f0,$f0,$f0 ;PF0
     32  0b2e							;.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$00,$80,$80,$00,$80,$80,$00,$80,$00,$00,$00,$00,$80,$00 ;PF1
     33  0b2e							;.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00 ;PF2
     34  0b2e
     35  0b2e							; The above defines the three 24-byte vertical strips for the 3 PF bytes that
     36  0b2e							; the piece (could) overlay. In this case, on square 0 (leftmost), it doesn't
     37  0b2e							; actually have any data in PF1 or PF2.
     38  0b2e
     39  0b2e
     40  0b2e
------- FILE piece_graphics.asm LEVEL 3 PASS 2
      0  0b2e					      include	"piece_graphics.asm"
      1  0b2e							; Import the graphics definitions generated by ConvertChessPieces.py
      0  0b2e					      NEWBANK	PIECES_0
      1  17d8 ????				      SEG	PIECES_0
      2  1000					      ORG	ORIGIN
      3  1000					      RORG	$F000
      4  1000				   BANK_START SET	*
      5  1000				   PIECES_0   SET	ORIGIN / 2048
      6  1000				   ORIGIN     SET	ORIGIN + 2048
      7  1000				   _CURRENT_BANK SET	PIECES_0
      3  1000
------- FILE gfx/WHITE_BLANK_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  1000					      include	"gfx/WHITE_BLANK_on_WHITE_SQUARE_0.asm"
      0  1000					      OPTIONAL_PAGEBREAK	"WHITE_BLANK_on_WHITE_SQUARE_0", 72
     10  1000					      LIST	ON
      0  1000					      DEF	WHITE_BLANK_on_WHITE_SQUARE_0
      1  1000				   BANK_WHITE_BLANK_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  1000				   WHITE_BLANK_on_WHITE_SQUARE_0
      3  1000				   TEMPORARY_VAR SET	Overlay
      4  1000				   TEMPORARY_OFFSET SET	0
      5  1000					      SUBROUTINE
      3  1000		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$f0,$f0,$f0,$f0,$f0,$f0,$f0,$f0	;PF0
      4  1018		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$80,$80,$80,$80,$80,$80	;PF1
      5  1030		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BLANK_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  1048					      include	"gfx/WHITE_BLANK_on_WHITE_SQUARE_1.asm"
      0  1048					      OPTIONAL_PAGEBREAK	"WHITE_BLANK_on_WHITE_SQUARE_1", 72
     10  1048					      LIST	ON
      0  1048					      DEF	WHITE_BLANK_on_WHITE_SQUARE_1
      1  1048				   BANK_WHITE_BLANK_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  1048				   WHITE_BLANK_on_WHITE_SQUARE_1
      3  1048				   TEMPORARY_VAR SET	Overlay
      4  1048				   TEMPORARY_OFFSET SET	0
      5  1048					      SUBROUTINE
      3  1048		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1060		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$7c,$7c,$7c,$7c,$7c,$7c,$7c,$7c	;PF1
      5  1078		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BLANK_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  1090					      include	"gfx/WHITE_BLANK_on_WHITE_SQUARE_2.asm"
      0  1090					      OPTIONAL_PAGEBREAK	"WHITE_BLANK_on_WHITE_SQUARE_2", 72
     10  1090					      LIST	ON
      0  1090					      DEF	WHITE_BLANK_on_WHITE_SQUARE_2
      1  1090				   BANK_WHITE_BLANK_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  1090				   WHITE_BLANK_on_WHITE_SQUARE_2
      3  1090				   TEMPORARY_VAR SET	Overlay
      4  1090				   TEMPORARY_OFFSET SET	0
      5  1090					      SUBROUTINE
      3  1090		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  10a8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$03,$03,$03,$03,$03,$03,$03,$03	;PF1
      5  10c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$07,$07,$07,$07,$07,$07,$07,$07	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BLANK_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  10d8					      include	"gfx/WHITE_BLANK_on_WHITE_SQUARE_3.asm"
      0  10d8					      OPTIONAL_PAGEBREAK	"WHITE_BLANK_on_WHITE_SQUARE_3", 72
 PAGE BREAK INSERTED FOR WHITE_BLANK_on_WHITE_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f100
     10  1100					      LIST	ON
      0  1100					      DEF	WHITE_BLANK_on_WHITE_SQUARE_3
      1  1100				   BANK_WHITE_BLANK_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  1100				   WHITE_BLANK_on_WHITE_SQUARE_3
      3  1100				   TEMPORARY_VAR SET	Overlay
      4  1100				   TEMPORARY_OFFSET SET	0
      5  1100					      SUBROUTINE
      3  1100		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1118		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1130		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$f8,$f8,$f8,$f8,$f8,$f8,$f8,$f8	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PAWN_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  1148					      include	"gfx/WHITE_PAWN_on_WHITE_SQUARE_0.asm"
      0  1148					      OPTIONAL_PAGEBREAK	"WHITE_PAWN_on_WHITE_SQUARE_0", 72
     10  1148					      LIST	ON
      0  1148					      DEF	WHITE_PAWN_on_WHITE_SQUARE_0
      1  1148				   BANK_WHITE_PAWN_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  1148				   WHITE_PAWN_on_WHITE_SQUARE_0
      3  1148				   TEMPORARY_VAR SET	Overlay
      4  1148				   TEMPORARY_OFFSET SET	0
      5  1148					      SUBROUTINE
      3  1148		       e0 e0 40 40*	      .byte.b	$e0,$e0,$40,$40,$a0,$40,$40,$00,$00,$e0,$40,$40,$e0,$40,$40,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1160		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1178		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PAWN_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  1190					      include	"gfx/WHITE_PAWN_on_WHITE_SQUARE_1.asm"
      0  1190					      OPTIONAL_PAGEBREAK	"WHITE_PAWN_on_WHITE_SQUARE_1", 72
     10  1190					      LIST	ON
      0  1190					      DEF	WHITE_PAWN_on_WHITE_SQUARE_1
      1  1190				   BANK_WHITE_PAWN_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  1190				   WHITE_PAWN_on_WHITE_SQUARE_1
      3  1190				   TEMPORARY_VAR SET	Overlay
      4  1190				   TEMPORARY_OFFSET SET	0
      5  1190					      SUBROUTINE
      3  1190		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  11a8		       38 38 10 10*	      .byte.b	$38,$38,$10,$10,$28,$10,$10,$00,$00,$38,$10,$10,$38,$10,$10,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  11c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PAWN_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  11d8					      include	"gfx/WHITE_PAWN_on_WHITE_SQUARE_2.asm"
      0  11d8					      OPTIONAL_PAGEBREAK	"WHITE_PAWN_on_WHITE_SQUARE_2", 72
 PAGE BREAK INSERTED FOR WHITE_PAWN_on_WHITE_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f200
     10  1200					      LIST	ON
      0  1200					      DEF	WHITE_PAWN_on_WHITE_SQUARE_2
      1  1200				   BANK_WHITE_PAWN_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  1200				   WHITE_PAWN_on_WHITE_SQUARE_2
      3  1200				   TEMPORARY_VAR SET	Overlay
      4  1200				   TEMPORARY_OFFSET SET	0
      5  1200					      SUBROUTINE
      3  1200		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1218		       01 01 00 00*	      .byte.b	$01,$01,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1230		       03 03 01 01*	      .byte.b	$03,$03,$01,$01,$02,$01,$01,$00,$00,$03,$01,$01,$03,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PAWN_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  1248					      include	"gfx/WHITE_PAWN_on_WHITE_SQUARE_3.asm"
      0  1248					      OPTIONAL_PAGEBREAK	"WHITE_PAWN_on_WHITE_SQUARE_3", 72
     10  1248					      LIST	ON
      0  1248					      DEF	WHITE_PAWN_on_WHITE_SQUARE_3
      1  1248				   BANK_WHITE_PAWN_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  1248				   WHITE_PAWN_on_WHITE_SQUARE_3
      3  1248				   TEMPORARY_VAR SET	Overlay
      4  1248				   TEMPORARY_OFFSET SET	0
      5  1248					      SUBROUTINE
      3  1248		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1260		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1278		       70 70 20 20*	      .byte.b	$70,$70,$20,$20,$50,$20,$20,$00,$00,$70,$20,$20,$70,$20,$20,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KNIGHT_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  1290					      include	"gfx/WHITE_KNIGHT_on_WHITE_SQUARE_0.asm"
      0  1290					      OPTIONAL_PAGEBREAK	"WHITE_KNIGHT_on_WHITE_SQUARE_0", 72
     10  1290					      LIST	ON
      0  1290					      DEF	WHITE_KNIGHT_on_WHITE_SQUARE_0
      1  1290				   BANK_WHITE_KNIGHT_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  1290				   WHITE_KNIGHT_on_WHITE_SQUARE_0
      3  1290				   TEMPORARY_VAR SET	Overlay
      4  1290				   TEMPORARY_OFFSET SET	0
      5  1290					      SUBROUTINE
      3  1290		       f0 f0 e0 f0*	      .byte.b	$f0,$f0,$e0,$f0,$f0,$a0,$40,$00,$f0,$70,$e0,$c0,$f0,$b0,$40,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  12a8		       80 00 80 80*	      .byte.b	$80,$00,$80,$80,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  12c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KNIGHT_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  12d8					      include	"gfx/WHITE_KNIGHT_on_WHITE_SQUARE_1.asm"
      0  12d8					      OPTIONAL_PAGEBREAK	"WHITE_KNIGHT_on_WHITE_SQUARE_1", 72
 PAGE BREAK INSERTED FOR WHITE_KNIGHT_on_WHITE_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f300
     10  1300					      LIST	ON
      0  1300					      DEF	WHITE_KNIGHT_on_WHITE_SQUARE_1
      1  1300				   BANK_WHITE_KNIGHT_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  1300				   WHITE_KNIGHT_on_WHITE_SQUARE_1
      3  1300				   TEMPORARY_VAR SET	Overlay
      4  1300				   TEMPORARY_OFFSET SET	0
      5  1300					      SUBROUTINE
      3  1300		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1318		       7c 78 3c 7c*	      .byte.b	$7c,$78,$3c,$7c,$7c,$2c,$14,$00,$7c,$70,$38,$18,$78,$68,$14,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1330		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KNIGHT_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  1348					      include	"gfx/WHITE_KNIGHT_on_WHITE_SQUARE_2.asm"
      0  1348					      OPTIONAL_PAGEBREAK	"WHITE_KNIGHT_on_WHITE_SQUARE_2", 72
     10  1348					      LIST	ON
      0  1348					      DEF	WHITE_KNIGHT_on_WHITE_SQUARE_2
      1  1348				   BANK_WHITE_KNIGHT_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  1348				   WHITE_KNIGHT_on_WHITE_SQUARE_2
      3  1348				   TEMPORARY_VAR SET	Overlay
      4  1348				   TEMPORARY_OFFSET SET	0
      5  1348					      SUBROUTINE
      3  1348		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1360		       03 03 01 03*	      .byte.b	$03,$03,$01,$03,$03,$01,$00,$00,$03,$03,$01,$00,$03,$03,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1378		       07 03 07 07*	      .byte.b	$07,$03,$07,$07,$07,$06,$05,$00,$07,$01,$03,$03,$03,$02,$05,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KNIGHT_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  1390					      include	"gfx/WHITE_KNIGHT_on_WHITE_SQUARE_3.asm"
      0  1390					      OPTIONAL_PAGEBREAK	"WHITE_KNIGHT_on_WHITE_SQUARE_3", 72
     10  1390					      LIST	ON
      0  1390					      DEF	WHITE_KNIGHT_on_WHITE_SQUARE_3
      1  1390				   BANK_WHITE_KNIGHT_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  1390				   WHITE_KNIGHT_on_WHITE_SQUARE_3
      3  1390				   TEMPORARY_VAR SET	Overlay
      4  1390				   TEMPORARY_OFFSET SET	0
      5  1390					      SUBROUTINE
      3  1390		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  13a8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  13c0		       f8 78 f0 f8*	      .byte.b	$f8,$78,$f0,$f8,$f8,$d0,$a0,$00,$f8,$38,$70,$60,$78,$58,$a0,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BISHOP_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  13d8					      include	"gfx/WHITE_BISHOP_on_WHITE_SQUARE_0.asm"
      0  13d8					      OPTIONAL_PAGEBREAK	"WHITE_BISHOP_on_WHITE_SQUARE_0", 72
 PAGE BREAK INSERTED FOR WHITE_BISHOP_on_WHITE_SQUARE_0
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f400
     10  1400					      LIST	ON
      0  1400					      DEF	WHITE_BISHOP_on_WHITE_SQUARE_0
      1  1400				   BANK_WHITE_BISHOP_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  1400				   WHITE_BISHOP_on_WHITE_SQUARE_0
      3  1400				   TEMPORARY_VAR SET	Overlay
      4  1400				   TEMPORARY_OFFSET SET	0
      5  1400					      SUBROUTINE
      3  1400		       f0 e0 f0 b0*	      .byte.b	$f0,$e0,$f0,$b0,$d0,$e0,$40,$40,$f0,$60,$f0,$b0,$d0,$e0,$00,$40,$00,$00,$00,$40,$20,$00,$00,$00	;PF0
      4  1418		       00 00 80 80*	      .byte.b	$00,$00,$80,$80,$80,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1430		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BISHOP_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  1448					      include	"gfx/WHITE_BISHOP_on_WHITE_SQUARE_1.asm"
      0  1448					      OPTIONAL_PAGEBREAK	"WHITE_BISHOP_on_WHITE_SQUARE_1", 72
     10  1448					      LIST	ON
      0  1448					      DEF	WHITE_BISHOP_on_WHITE_SQUARE_1
      1  1448				   BANK_WHITE_BISHOP_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  1448				   WHITE_BISHOP_on_WHITE_SQUARE_1
      3  1448				   TEMPORARY_VAR SET	Overlay
      4  1448				   TEMPORARY_OFFSET SET	0
      5  1448					      SUBROUTINE
      3  1448		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1460		       78 38 7c 6c*	      .byte.b	$78,$38,$7c,$6c,$5c,$38,$10,$10,$7c,$30,$78,$68,$58,$38,$00,$10,$00,$00,$00,$10,$20,$00,$00,$00	;PF1
      5  1478		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BISHOP_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  1490					      include	"gfx/WHITE_BISHOP_on_WHITE_SQUARE_2.asm"
      0  1490					      OPTIONAL_PAGEBREAK	"WHITE_BISHOP_on_WHITE_SQUARE_2", 72
     10  1490					      LIST	ON
      0  1490					      DEF	WHITE_BISHOP_on_WHITE_SQUARE_2
      1  1490				   BANK_WHITE_BISHOP_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  1490				   WHITE_BISHOP_on_WHITE_SQUARE_2
      3  1490				   TEMPORARY_VAR SET	Overlay
      4  1490				   TEMPORARY_OFFSET SET	0
      5  1490					      SUBROUTINE
      3  1490		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  14a8		       03 01 03 03*	      .byte.b	$03,$01,$03,$03,$02,$01,$00,$00,$03,$01,$03,$03,$02,$01,$00,$00,$00,$00,$00,$00,$01,$00,$00,$00	;PF1
      5  14c0		       03 03 07 06*	      .byte.b	$03,$03,$07,$06,$07,$03,$01,$01,$07,$01,$03,$02,$03,$03,$00,$01,$00,$00,$00,$01,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BISHOP_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  14d8					      include	"gfx/WHITE_BISHOP_on_WHITE_SQUARE_3.asm"
      0  14d8					      OPTIONAL_PAGEBREAK	"WHITE_BISHOP_on_WHITE_SQUARE_3", 72
 PAGE BREAK INSERTED FOR WHITE_BISHOP_on_WHITE_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f500
     10  1500					      LIST	ON
      0  1500					      DEF	WHITE_BISHOP_on_WHITE_SQUARE_3
      1  1500				   BANK_WHITE_BISHOP_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  1500				   WHITE_BISHOP_on_WHITE_SQUARE_3
      3  1500				   TEMPORARY_VAR SET	Overlay
      4  1500				   TEMPORARY_OFFSET SET	0
      5  1500					      SUBROUTINE
      3  1500		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1518		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1530		       78 70 f8 d8*	      .byte.b	$78,$70,$f8,$d8,$e8,$70,$20,$20,$f8,$30,$78,$58,$68,$70,$00,$20,$00,$00,$00,$20,$10,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_ROOK_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  1548					      include	"gfx/WHITE_ROOK_on_WHITE_SQUARE_0.asm"
      0  1548					      OPTIONAL_PAGEBREAK	"WHITE_ROOK_on_WHITE_SQUARE_0", 72
     10  1548					      LIST	ON
      0  1548					      DEF	WHITE_ROOK_on_WHITE_SQUARE_0
      1  1548				   BANK_WHITE_ROOK_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  1548				   WHITE_ROOK_on_WHITE_SQUARE_0
      3  1548				   TEMPORARY_VAR SET	Overlay
      4  1548				   TEMPORARY_OFFSET SET	0
      5  1548					      SUBROUTINE
      3  1548		       f0 e0 e0 e0*	      .byte.b	$f0,$e0,$e0,$e0,$f0,$50,$50,$00,$f0,$60,$60,$60,$f0,$50,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1560		       00 00 00 80*	      .byte.b	$00,$00,$00,$80,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1578		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_ROOK_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  1590					      include	"gfx/WHITE_ROOK_on_WHITE_SQUARE_1.asm"
      0  1590					      OPTIONAL_PAGEBREAK	"WHITE_ROOK_on_WHITE_SQUARE_1", 72
     10  1590					      LIST	ON
      0  1590					      DEF	WHITE_ROOK_on_WHITE_SQUARE_1
      1  1590				   BANK_WHITE_ROOK_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  1590				   WHITE_ROOK_on_WHITE_SQUARE_1
      3  1590				   TEMPORARY_VAR SET	Overlay
      4  1590				   TEMPORARY_OFFSET SET	0
      5  1590					      SUBROUTINE
      3  1590		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  15a8		       78 38 38 3c*	      .byte.b	$78,$38,$38,$3c,$7c,$54,$54,$00,$7c,$30,$30,$30,$78,$50,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  15c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_ROOK_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  15d8					      include	"gfx/WHITE_ROOK_on_WHITE_SQUARE_2.asm"
      0  15d8					      OPTIONAL_PAGEBREAK	"WHITE_ROOK_on_WHITE_SQUARE_2", 72
 PAGE BREAK INSERTED FOR WHITE_ROOK_on_WHITE_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f600
     10  1600					      LIST	ON
      0  1600					      DEF	WHITE_ROOK_on_WHITE_SQUARE_2
      1  1600				   BANK_WHITE_ROOK_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  1600				   WHITE_ROOK_on_WHITE_SQUARE_2
      3  1600				   TEMPORARY_VAR SET	Overlay
      4  1600				   TEMPORARY_OFFSET SET	0
      5  1600					      SUBROUTINE
      3  1600		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1618		       03 01 01 01*	      .byte.b	$03,$01,$01,$01,$03,$02,$02,$00,$03,$01,$01,$01,$03,$02,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1630		       03 03 03 07*	      .byte.b	$03,$03,$03,$07,$07,$05,$05,$00,$07,$01,$01,$01,$03,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_ROOK_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  1648					      include	"gfx/WHITE_ROOK_on_WHITE_SQUARE_3.asm"
      0  1648					      OPTIONAL_PAGEBREAK	"WHITE_ROOK_on_WHITE_SQUARE_3", 72
     10  1648					      LIST	ON
      0  1648					      DEF	WHITE_ROOK_on_WHITE_SQUARE_3
      1  1648				   BANK_WHITE_ROOK_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  1648				   WHITE_ROOK_on_WHITE_SQUARE_3
      3  1648				   TEMPORARY_VAR SET	Overlay
      4  1648				   TEMPORARY_OFFSET SET	0
      5  1648					      SUBROUTINE
      3  1648		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1660		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1678		       78 70 70 f0*	      .byte.b	$78,$70,$70,$f0,$f8,$a8,$a8,$00,$f8,$30,$30,$30,$78,$28,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_QUEEN_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  1690					      include	"gfx/WHITE_QUEEN_on_WHITE_SQUARE_0.asm"
      0  1690					      OPTIONAL_PAGEBREAK	"WHITE_QUEEN_on_WHITE_SQUARE_0", 72
     10  1690					      LIST	ON
      0  1690					      DEF	WHITE_QUEEN_on_WHITE_SQUARE_0
      1  1690				   BANK_WHITE_QUEEN_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  1690				   WHITE_QUEEN_on_WHITE_SQUARE_0
      3  1690				   TEMPORARY_VAR SET	Overlay
      4  1690				   TEMPORARY_OFFSET SET	0
      5  1690					      SUBROUTINE
      3  1690		       e0 e0 f0 f0*	      .byte.b	$e0,$e0,$f0,$f0,$50,$00,$50,$00,$e0,$40,$f0,$f0,$50,$00,$50,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  16a8		       00 00 80 80*	      .byte.b	$00,$00,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  16c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_QUEEN_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  16d8					      include	"gfx/WHITE_QUEEN_on_WHITE_SQUARE_1.asm"
      0  16d8					      OPTIONAL_PAGEBREAK	"WHITE_QUEEN_on_WHITE_SQUARE_1", 72
 PAGE BREAK INSERTED FOR WHITE_QUEEN_on_WHITE_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f700
     10  1700					      LIST	ON
      0  1700					      DEF	WHITE_QUEEN_on_WHITE_SQUARE_1
      1  1700				   BANK_WHITE_QUEEN_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  1700				   WHITE_QUEEN_on_WHITE_SQUARE_1
      3  1700				   TEMPORARY_VAR SET	Overlay
      4  1700				   TEMPORARY_OFFSET SET	0
      5  1700					      SUBROUTINE
      3  1700		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1718		       38 38 7c 7c*	      .byte.b	$38,$38,$7c,$7c,$54,$00,$54,$00,$38,$10,$78,$78,$50,$00,$54,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1730		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_QUEEN_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  1748					      include	"gfx/WHITE_QUEEN_on_WHITE_SQUARE_2.asm"
      0  1748					      OPTIONAL_PAGEBREAK	"WHITE_QUEEN_on_WHITE_SQUARE_2", 72
     10  1748					      LIST	ON
      0  1748					      DEF	WHITE_QUEEN_on_WHITE_SQUARE_2
      1  1748				   BANK_WHITE_QUEEN_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  1748				   WHITE_QUEEN_on_WHITE_SQUARE_2
      3  1748				   TEMPORARY_VAR SET	Overlay
      4  1748				   TEMPORARY_OFFSET SET	0
      5  1748					      SUBROUTINE
      3  1748		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1760		       01 01 03 03*	      .byte.b	$01,$01,$03,$03,$02,$00,$02,$00,$01,$00,$03,$03,$02,$00,$02,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1778		       03 03 07 07*	      .byte.b	$03,$03,$07,$07,$05,$00,$05,$00,$03,$01,$03,$03,$01,$00,$05,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_QUEEN_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  1790					      include	"gfx/WHITE_QUEEN_on_WHITE_SQUARE_3.asm"
      0  1790					      OPTIONAL_PAGEBREAK	"WHITE_QUEEN_on_WHITE_SQUARE_3", 72
     10  1790					      LIST	ON
      0  1790					      DEF	WHITE_QUEEN_on_WHITE_SQUARE_3
      1  1790				   BANK_WHITE_QUEEN_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  1790				   WHITE_QUEEN_on_WHITE_SQUARE_3
      3  1790				   TEMPORARY_VAR SET	Overlay
      4  1790				   TEMPORARY_OFFSET SET	0
      5  1790					      SUBROUTINE
      3  1790		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  17a8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  17c0		       70 70 f8 f8*	      .byte.b	$70,$70,$f8,$f8,$a8,$00,$a8,$00,$70,$20,$78,$78,$28,$00,$a8,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
      0  17d8					      CHECK_BANK_SIZE	"PIECE_0 (2K)"
      1  17d8		       07 d8	   .TEMP      =	* - BANK_START
 PIECE_0 (2K) (2K) SIZE =  $7d8 , FREE= $28
      2  17d8					      ECHO	"PIECE_0 (2K)", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  17d8				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  17d8				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  17d8				  -	      ERR
      6  17d8					      endif
      0  17d8					      NEWBANK	PIECES_1
      1  1fd8 ????				      SEG	PIECES_1
      2  1800					      ORG	ORIGIN
      3  1800					      RORG	$F000
      4  1800				   BANK_START SET	*
      5  1800				   PIECES_1   SET	ORIGIN / 2048
      6  1800				   ORIGIN     SET	ORIGIN + 2048
      7  1800				   _CURRENT_BANK SET	PIECES_1
------- FILE gfx/WHITE_KING_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  1800					      include	"gfx/WHITE_KING_on_WHITE_SQUARE_0.asm"
      0  1800					      OPTIONAL_PAGEBREAK	"WHITE_KING_on_WHITE_SQUARE_0", 72
     10  1800					      LIST	ON
      0  1800					      DEF	WHITE_KING_on_WHITE_SQUARE_0
      1  1800				   BANK_WHITE_KING_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  1800				   WHITE_KING_on_WHITE_SQUARE_0
      3  1800				   TEMPORARY_VAR SET	Overlay
      4  1800				   TEMPORARY_OFFSET SET	0
      5  1800					      SUBROUTINE
      3  1800		       e0 f0 50 50*	      .byte.b	$e0,$f0,$50,$50,$f0,$40,$e0,$00,$e0,$60,$50,$50,$50,$40,$e0,$40,$00,$00,$00,$a0,$a0,$40,$00,$00	;PF0
      4  1818		       00 80 80 80*	      .byte.b	$00,$80,$80,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1830		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KING_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  1848					      include	"gfx/WHITE_KING_on_WHITE_SQUARE_1.asm"
      0  1848					      OPTIONAL_PAGEBREAK	"WHITE_KING_on_WHITE_SQUARE_1", 72
     10  1848					      LIST	ON
      0  1848					      DEF	WHITE_KING_on_WHITE_SQUARE_1
      1  1848				   BANK_WHITE_KING_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  1848				   WHITE_KING_on_WHITE_SQUARE_1
      3  1848				   TEMPORARY_VAR SET	Overlay
      4  1848				   TEMPORARY_OFFSET SET	0
      5  1848					      SUBROUTINE
      3  1848		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1860		       38 7c 54 54*	      .byte.b	$38,$7c,$54,$54,$7c,$10,$38,$00,$38,$30,$50,$50,$50,$10,$38,$10,$00,$00,$00,$28,$28,$10,$00,$00	;PF1
      5  1878		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KING_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  1890					      include	"gfx/WHITE_KING_on_WHITE_SQUARE_2.asm"
      0  1890					      OPTIONAL_PAGEBREAK	"WHITE_KING_on_WHITE_SQUARE_2", 72
     10  1890					      LIST	ON
      0  1890					      DEF	WHITE_KING_on_WHITE_SQUARE_2
      1  1890				   BANK_WHITE_KING_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  1890				   WHITE_KING_on_WHITE_SQUARE_2
      3  1890				   TEMPORARY_VAR SET	Overlay
      4  1890				   TEMPORARY_OFFSET SET	0
      5  1890					      SUBROUTINE
      3  1890		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  18a8		       01 03 02 02*	      .byte.b	$01,$03,$02,$02,$03,$00,$01,$00,$01,$01,$02,$02,$02,$00,$01,$00,$00,$00,$00,$01,$01,$00,$00,$00	;PF1
      5  18c0		       03 07 05 05*	      .byte.b	$03,$07,$05,$05,$07,$01,$03,$00,$03,$01,$01,$01,$01,$01,$03,$01,$00,$00,$00,$02,$02,$01,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KING_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  18d8					      include	"gfx/WHITE_KING_on_WHITE_SQUARE_3.asm"
      0  18d8					      OPTIONAL_PAGEBREAK	"WHITE_KING_on_WHITE_SQUARE_3", 72
 PAGE BREAK INSERTED FOR WHITE_KING_on_WHITE_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f100
     10  1900					      LIST	ON
      0  1900					      DEF	WHITE_KING_on_WHITE_SQUARE_3
      1  1900				   BANK_WHITE_KING_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  1900				   WHITE_KING_on_WHITE_SQUARE_3
      3  1900				   TEMPORARY_VAR SET	Overlay
      4  1900				   TEMPORARY_OFFSET SET	0
      5  1900					      SUBROUTINE
      3  1900		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1918		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1930		       70 f8 a8 a8*	      .byte.b	$70,$f8,$a8,$a8,$f8,$20,$70,$00,$70,$30,$28,$28,$28,$20,$70,$20,$00,$00,$00,$50,$50,$20,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BLANK_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  1948					      include	"gfx/WHITE_BLANK_on_BLACK_SQUARE_0.asm"
      0  1948					      OPTIONAL_PAGEBREAK	"WHITE_BLANK_on_BLACK_SQUARE_0", 72
     10  1948					      LIST	ON
      0  1948					      DEF	WHITE_BLANK_on_BLACK_SQUARE_0
      1  1948				   BANK_WHITE_BLANK_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  1948				   WHITE_BLANK_on_BLACK_SQUARE_0
      3  1948				   TEMPORARY_VAR SET	Overlay
      4  1948				   TEMPORARY_OFFSET SET	0
      5  1948					      SUBROUTINE
      3  1948		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1960		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1978		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BLANK_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  1990					      include	"gfx/WHITE_BLANK_on_BLACK_SQUARE_1.asm"
      0  1990					      OPTIONAL_PAGEBREAK	"WHITE_BLANK_on_BLACK_SQUARE_1", 72
     10  1990					      LIST	ON
      0  1990					      DEF	WHITE_BLANK_on_BLACK_SQUARE_1
      1  1990				   BANK_WHITE_BLANK_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  1990				   WHITE_BLANK_on_BLACK_SQUARE_1
      3  1990				   TEMPORARY_VAR SET	Overlay
      4  1990				   TEMPORARY_OFFSET SET	0
      5  1990					      SUBROUTINE
      3  1990		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  19a8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  19c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BLANK_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  19d8					      include	"gfx/WHITE_BLANK_on_BLACK_SQUARE_2.asm"
      0  19d8					      OPTIONAL_PAGEBREAK	"WHITE_BLANK_on_BLACK_SQUARE_2", 72
 PAGE BREAK INSERTED FOR WHITE_BLANK_on_BLACK_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f200
     10  1a00					      LIST	ON
      0  1a00					      DEF	WHITE_BLANK_on_BLACK_SQUARE_2
      1  1a00				   BANK_WHITE_BLANK_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  1a00				   WHITE_BLANK_on_BLACK_SQUARE_2
      3  1a00				   TEMPORARY_VAR SET	Overlay
      4  1a00				   TEMPORARY_OFFSET SET	0
      5  1a00					      SUBROUTINE
      3  1a00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1a18		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1a30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BLANK_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  1a48					      include	"gfx/WHITE_BLANK_on_BLACK_SQUARE_3.asm"
      0  1a48					      OPTIONAL_PAGEBREAK	"WHITE_BLANK_on_BLACK_SQUARE_3", 72
     10  1a48					      LIST	ON
      0  1a48					      DEF	WHITE_BLANK_on_BLACK_SQUARE_3
      1  1a48				   BANK_WHITE_BLANK_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  1a48				   WHITE_BLANK_on_BLACK_SQUARE_3
      3  1a48				   TEMPORARY_VAR SET	Overlay
      4  1a48				   TEMPORARY_OFFSET SET	0
      5  1a48					      SUBROUTINE
      3  1a48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1a60		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1a78		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PAWN_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  1a90					      include	"gfx/WHITE_PAWN_on_BLACK_SQUARE_0.asm"
      0  1a90					      OPTIONAL_PAGEBREAK	"WHITE_PAWN_on_BLACK_SQUARE_0", 72
     10  1a90					      LIST	ON
      0  1a90					      DEF	WHITE_PAWN_on_BLACK_SQUARE_0
      1  1a90				   BANK_WHITE_PAWN_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  1a90				   WHITE_PAWN_on_BLACK_SQUARE_0
      3  1a90				   TEMPORARY_VAR SET	Overlay
      4  1a90				   TEMPORARY_OFFSET SET	0
      5  1a90					      SUBROUTINE
      3  1a90		       e0 e0 40 40*	      .byte.b	$e0,$e0,$40,$40,$a0,$40,$40,$00,$00,$e0,$40,$40,$e0,$40,$40,$00,$00,$e0,$40,$40,$e0,$40,$40,$00	;PF0
      4  1aa8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1ac0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PAWN_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  1ad8					      include	"gfx/WHITE_PAWN_on_BLACK_SQUARE_1.asm"
      0  1ad8					      OPTIONAL_PAGEBREAK	"WHITE_PAWN_on_BLACK_SQUARE_1", 72
 PAGE BREAK INSERTED FOR WHITE_PAWN_on_BLACK_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f300
     10  1b00					      LIST	ON
      0  1b00					      DEF	WHITE_PAWN_on_BLACK_SQUARE_1
      1  1b00				   BANK_WHITE_PAWN_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  1b00				   WHITE_PAWN_on_BLACK_SQUARE_1
      3  1b00				   TEMPORARY_VAR SET	Overlay
      4  1b00				   TEMPORARY_OFFSET SET	0
      5  1b00					      SUBROUTINE
      3  1b00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1b18		       38 38 10 10*	      .byte.b	$38,$38,$10,$10,$28,$10,$10,$00,$00,$38,$10,$10,$38,$10,$10,$00,$00,$38,$10,$10,$38,$10,$10,$00	;PF1
      5  1b30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PAWN_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  1b48					      include	"gfx/WHITE_PAWN_on_BLACK_SQUARE_2.asm"
      0  1b48					      OPTIONAL_PAGEBREAK	"WHITE_PAWN_on_BLACK_SQUARE_2", 72
     10  1b48					      LIST	ON
      0  1b48					      DEF	WHITE_PAWN_on_BLACK_SQUARE_2
      1  1b48				   BANK_WHITE_PAWN_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  1b48				   WHITE_PAWN_on_BLACK_SQUARE_2
      3  1b48				   TEMPORARY_VAR SET	Overlay
      4  1b48				   TEMPORARY_OFFSET SET	0
      5  1b48					      SUBROUTINE
      3  1b48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1b60		       01 01 00 00*	      .byte.b	$01,$01,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$01,$00,$00,$00	;PF1
      5  1b78		       03 03 01 01*	      .byte.b	$03,$03,$01,$01,$02,$01,$01,$00,$00,$03,$01,$01,$03,$01,$01,$00,$00,$03,$01,$01,$03,$01,$01,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PAWN_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  1b90					      include	"gfx/WHITE_PAWN_on_BLACK_SQUARE_3.asm"
      0  1b90					      OPTIONAL_PAGEBREAK	"WHITE_PAWN_on_BLACK_SQUARE_3", 72
     10  1b90					      LIST	ON
      0  1b90					      DEF	WHITE_PAWN_on_BLACK_SQUARE_3
      1  1b90				   BANK_WHITE_PAWN_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  1b90				   WHITE_PAWN_on_BLACK_SQUARE_3
      3  1b90				   TEMPORARY_VAR SET	Overlay
      4  1b90				   TEMPORARY_OFFSET SET	0
      5  1b90					      SUBROUTINE
      3  1b90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1ba8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1bc0		       70 70 20 20*	      .byte.b	$70,$70,$20,$20,$50,$20,$20,$00,$00,$70,$20,$20,$70,$20,$20,$00,$00,$70,$20,$20,$70,$20,$20,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KNIGHT_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  1bd8					      include	"gfx/WHITE_KNIGHT_on_BLACK_SQUARE_0.asm"
      0  1bd8					      OPTIONAL_PAGEBREAK	"WHITE_KNIGHT_on_BLACK_SQUARE_0", 72
 PAGE BREAK INSERTED FOR WHITE_KNIGHT_on_BLACK_SQUARE_0
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f400
     10  1c00					      LIST	ON
      0  1c00					      DEF	WHITE_KNIGHT_on_BLACK_SQUARE_0
      1  1c00				   BANK_WHITE_KNIGHT_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  1c00				   WHITE_KNIGHT_on_BLACK_SQUARE_0
      3  1c00				   TEMPORARY_VAR SET	Overlay
      4  1c00				   TEMPORARY_OFFSET SET	0
      5  1c00					      SUBROUTINE
      3  1c00		       f0 f0 e0 f0*	      .byte.b	$f0,$f0,$e0,$f0,$f0,$a0,$40,$00,$f0,$70,$e0,$c0,$f0,$b0,$40,$00,$f0,$f0,$e0,$e0,$f0,$f0,$40,$00	;PF0
      4  1c18		       80 00 80 80*	      .byte.b	$80,$00,$80,$80,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$80,$00,$80,$00,$00,$80,$80,$80,$80,$00	;PF1
      5  1c30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KNIGHT_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  1c48					      include	"gfx/WHITE_KNIGHT_on_BLACK_SQUARE_1.asm"
      0  1c48					      OPTIONAL_PAGEBREAK	"WHITE_KNIGHT_on_BLACK_SQUARE_1", 72
     10  1c48					      LIST	ON
      0  1c48					      DEF	WHITE_KNIGHT_on_BLACK_SQUARE_1
      1  1c48				   BANK_WHITE_KNIGHT_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  1c48				   WHITE_KNIGHT_on_BLACK_SQUARE_1
      3  1c48				   TEMPORARY_VAR SET	Overlay
      4  1c48				   TEMPORARY_OFFSET SET	0
      5  1c48					      SUBROUTINE
      3  1c48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1c60		       7c 78 3c 7c*	      .byte.b	$7c,$78,$3c,$7c,$7c,$2c,$14,$00,$7c,$70,$38,$18,$78,$68,$14,$00,$7c,$78,$38,$3c,$7c,$7c,$14,$00	;PF1
      5  1c78		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KNIGHT_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  1c90					      include	"gfx/WHITE_KNIGHT_on_BLACK_SQUARE_2.asm"
      0  1c90					      OPTIONAL_PAGEBREAK	"WHITE_KNIGHT_on_BLACK_SQUARE_2", 72
     10  1c90					      LIST	ON
      0  1c90					      DEF	WHITE_KNIGHT_on_BLACK_SQUARE_2
      1  1c90				   BANK_WHITE_KNIGHT_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  1c90				   WHITE_KNIGHT_on_BLACK_SQUARE_2
      3  1c90				   TEMPORARY_VAR SET	Overlay
      4  1c90				   TEMPORARY_OFFSET SET	0
      5  1c90					      SUBROUTINE
      3  1c90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1ca8		       03 03 01 03*	      .byte.b	$03,$03,$01,$03,$03,$01,$00,$00,$03,$03,$01,$00,$03,$03,$00,$00,$03,$03,$01,$01,$03,$03,$00,$00	;PF1
      5  1cc0		       07 03 07 07*	      .byte.b	$07,$03,$07,$07,$07,$06,$05,$00,$07,$01,$03,$03,$03,$02,$05,$00,$07,$03,$03,$07,$07,$07,$05,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KNIGHT_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  1cd8					      include	"gfx/WHITE_KNIGHT_on_BLACK_SQUARE_3.asm"
      0  1cd8					      OPTIONAL_PAGEBREAK	"WHITE_KNIGHT_on_BLACK_SQUARE_3", 72
 PAGE BREAK INSERTED FOR WHITE_KNIGHT_on_BLACK_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f500
     10  1d00					      LIST	ON
      0  1d00					      DEF	WHITE_KNIGHT_on_BLACK_SQUARE_3
      1  1d00				   BANK_WHITE_KNIGHT_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  1d00				   WHITE_KNIGHT_on_BLACK_SQUARE_3
      3  1d00				   TEMPORARY_VAR SET	Overlay
      4  1d00				   TEMPORARY_OFFSET SET	0
      5  1d00					      SUBROUTINE
      3  1d00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1d18		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1d30		       f8 78 f0 f8*	      .byte.b	$f8,$78,$f0,$f8,$f8,$d0,$a0,$00,$f8,$38,$70,$60,$78,$58,$a0,$00,$f8,$78,$70,$f0,$f8,$f8,$a0,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BISHOP_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  1d48					      include	"gfx/WHITE_BISHOP_on_BLACK_SQUARE_0.asm"
      0  1d48					      OPTIONAL_PAGEBREAK	"WHITE_BISHOP_on_BLACK_SQUARE_0", 72
     10  1d48					      LIST	ON
      0  1d48					      DEF	WHITE_BISHOP_on_BLACK_SQUARE_0
      1  1d48				   BANK_WHITE_BISHOP_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  1d48				   WHITE_BISHOP_on_BLACK_SQUARE_0
      3  1d48				   TEMPORARY_VAR SET	Overlay
      4  1d48				   TEMPORARY_OFFSET SET	0
      5  1d48					      SUBROUTINE
      3  1d48		       f0 e0 f0 b0*	      .byte.b	$f0,$e0,$f0,$b0,$d0,$e0,$40,$40,$f0,$60,$f0,$b0,$d0,$e0,$00,$40,$f0,$e0,$f0,$b0,$d0,$e0,$40,$40	;PF0
      4  1d60		       00 00 80 80*	      .byte.b	$00,$00,$80,$80,$80,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$80,$80,$00,$00,$00	;PF1
      5  1d78		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BISHOP_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  1d90					      include	"gfx/WHITE_BISHOP_on_BLACK_SQUARE_1.asm"
      0  1d90					      OPTIONAL_PAGEBREAK	"WHITE_BISHOP_on_BLACK_SQUARE_1", 72
     10  1d90					      LIST	ON
      0  1d90					      DEF	WHITE_BISHOP_on_BLACK_SQUARE_1
      1  1d90				   BANK_WHITE_BISHOP_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  1d90				   WHITE_BISHOP_on_BLACK_SQUARE_1
      3  1d90				   TEMPORARY_VAR SET	Overlay
      4  1d90				   TEMPORARY_OFFSET SET	0
      5  1d90					      SUBROUTINE
      3  1d90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1da8		       78 38 7c 6c*	      .byte.b	$78,$38,$7c,$6c,$5c,$38,$10,$10,$7c,$30,$78,$68,$58,$38,$00,$10,$7c,$38,$78,$6c,$5c,$38,$10,$10	;PF1
      5  1dc0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BISHOP_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  1dd8					      include	"gfx/WHITE_BISHOP_on_BLACK_SQUARE_2.asm"
      0  1dd8					      OPTIONAL_PAGEBREAK	"WHITE_BISHOP_on_BLACK_SQUARE_2", 72
 PAGE BREAK INSERTED FOR WHITE_BISHOP_on_BLACK_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f600
     10  1e00					      LIST	ON
      0  1e00					      DEF	WHITE_BISHOP_on_BLACK_SQUARE_2
      1  1e00				   BANK_WHITE_BISHOP_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  1e00				   WHITE_BISHOP_on_BLACK_SQUARE_2
      3  1e00				   TEMPORARY_VAR SET	Overlay
      4  1e00				   TEMPORARY_OFFSET SET	0
      5  1e00					      SUBROUTINE
      3  1e00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1e18		       03 01 03 03*	      .byte.b	$03,$01,$03,$03,$02,$01,$00,$00,$03,$01,$03,$03,$02,$01,$00,$00,$03,$01,$03,$03,$02,$01,$00,$00	;PF1
      5  1e30		       03 03 07 06*	      .byte.b	$03,$03,$07,$06,$07,$03,$01,$01,$07,$01,$03,$02,$03,$03,$00,$01,$07,$03,$03,$06,$07,$03,$01,$01	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_BISHOP_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  1e48					      include	"gfx/WHITE_BISHOP_on_BLACK_SQUARE_3.asm"
      0  1e48					      OPTIONAL_PAGEBREAK	"WHITE_BISHOP_on_BLACK_SQUARE_3", 72
     10  1e48					      LIST	ON
      0  1e48					      DEF	WHITE_BISHOP_on_BLACK_SQUARE_3
      1  1e48				   BANK_WHITE_BISHOP_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  1e48				   WHITE_BISHOP_on_BLACK_SQUARE_3
      3  1e48				   TEMPORARY_VAR SET	Overlay
      4  1e48				   TEMPORARY_OFFSET SET	0
      5  1e48					      SUBROUTINE
      3  1e48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1e60		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1e78		       78 70 f8 d8*	      .byte.b	$78,$70,$f8,$d8,$e8,$70,$20,$20,$f8,$30,$78,$58,$68,$70,$00,$20,$f8,$70,$78,$d8,$e8,$70,$20,$20	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_ROOK_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  1e90					      include	"gfx/WHITE_ROOK_on_BLACK_SQUARE_0.asm"
      0  1e90					      OPTIONAL_PAGEBREAK	"WHITE_ROOK_on_BLACK_SQUARE_0", 72
     10  1e90					      LIST	ON
      0  1e90					      DEF	WHITE_ROOK_on_BLACK_SQUARE_0
      1  1e90				   BANK_WHITE_ROOK_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  1e90				   WHITE_ROOK_on_BLACK_SQUARE_0
      3  1e90				   TEMPORARY_VAR SET	Overlay
      4  1e90				   TEMPORARY_OFFSET SET	0
      5  1e90					      SUBROUTINE
      3  1e90		       f0 e0 e0 e0*	      .byte.b	$f0,$e0,$e0,$e0,$f0,$50,$50,$00,$f0,$60,$60,$60,$f0,$50,$00,$00,$f0,$e0,$e0,$e0,$f0,$f0,$50,$00	;PF0
      4  1ea8		       00 00 00 80*	      .byte.b	$00,$00,$00,$80,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$00,$80,$80,$80,$00	;PF1
      5  1ec0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_ROOK_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  1ed8					      include	"gfx/WHITE_ROOK_on_BLACK_SQUARE_1.asm"
      0  1ed8					      OPTIONAL_PAGEBREAK	"WHITE_ROOK_on_BLACK_SQUARE_1", 72
 PAGE BREAK INSERTED FOR WHITE_ROOK_on_BLACK_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f700
     10  1f00					      LIST	ON
      0  1f00					      DEF	WHITE_ROOK_on_BLACK_SQUARE_1
      1  1f00				   BANK_WHITE_ROOK_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  1f00				   WHITE_ROOK_on_BLACK_SQUARE_1
      3  1f00				   TEMPORARY_VAR SET	Overlay
      4  1f00				   TEMPORARY_OFFSET SET	0
      5  1f00					      SUBROUTINE
      3  1f00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1f18		       78 38 38 3c*	      .byte.b	$78,$38,$38,$3c,$7c,$54,$54,$00,$7c,$30,$30,$30,$78,$50,$00,$00,$7c,$38,$38,$38,$7c,$7c,$54,$00	;PF1
      5  1f30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_ROOK_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  1f48					      include	"gfx/WHITE_ROOK_on_BLACK_SQUARE_2.asm"
      0  1f48					      OPTIONAL_PAGEBREAK	"WHITE_ROOK_on_BLACK_SQUARE_2", 72
     10  1f48					      LIST	ON
      0  1f48					      DEF	WHITE_ROOK_on_BLACK_SQUARE_2
      1  1f48				   BANK_WHITE_ROOK_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  1f48				   WHITE_ROOK_on_BLACK_SQUARE_2
      3  1f48				   TEMPORARY_VAR SET	Overlay
      4  1f48				   TEMPORARY_OFFSET SET	0
      5  1f48					      SUBROUTINE
      3  1f48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1f60		       03 01 01 01*	      .byte.b	$03,$01,$01,$01,$03,$02,$02,$00,$03,$01,$01,$01,$03,$02,$00,$00,$03,$01,$01,$01,$03,$03,$02,$00	;PF1
      5  1f78		       03 03 03 07*	      .byte.b	$03,$03,$03,$07,$07,$05,$05,$00,$07,$01,$01,$01,$03,$01,$00,$00,$07,$03,$03,$03,$07,$07,$05,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_ROOK_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  1f90					      include	"gfx/WHITE_ROOK_on_BLACK_SQUARE_3.asm"
      0  1f90					      OPTIONAL_PAGEBREAK	"WHITE_ROOK_on_BLACK_SQUARE_3", 72
     10  1f90					      LIST	ON
      0  1f90					      DEF	WHITE_ROOK_on_BLACK_SQUARE_3
      1  1f90				   BANK_WHITE_ROOK_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  1f90				   WHITE_ROOK_on_BLACK_SQUARE_3
      3  1f90				   TEMPORARY_VAR SET	Overlay
      4  1f90				   TEMPORARY_OFFSET SET	0
      5  1f90					      SUBROUTINE
      3  1f90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  1fa8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  1fc0		       78 70 70 f0*	      .byte.b	$78,$70,$70,$f0,$f8,$a8,$a8,$00,$f8,$30,$30,$30,$78,$28,$00,$00,$f8,$70,$70,$70,$f8,$f8,$a8,$00	;PF2
------- FILE piece_graphics.asm
      0  1fd8					      CHECK_BANK_SIZE	"PIECE_1 (2K)"
      1  1fd8		       07 d8	   .TEMP      =	* - BANK_START
 PIECE_1 (2K) (2K) SIZE =  $7d8 , FREE= $28
      2  1fd8					      ECHO	"PIECE_1 (2K)", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  1fd8				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  1fd8				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  1fd8				  -	      ERR
      6  1fd8					      endif
      0  1fd8					      NEWBANK	PIECES_2
      1  27d8 ????				      SEG	PIECES_2
      2  2000					      ORG	ORIGIN
      3  2000					      RORG	$F000
      4  2000				   BANK_START SET	*
      5  2000				   PIECES_2   SET	ORIGIN / 2048
      6  2000				   ORIGIN     SET	ORIGIN + 2048
      7  2000				   _CURRENT_BANK SET	PIECES_2
------- FILE gfx/WHITE_QUEEN_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  2000					      include	"gfx/WHITE_QUEEN_on_BLACK_SQUARE_0.asm"
      0  2000					      OPTIONAL_PAGEBREAK	"WHITE_QUEEN_on_BLACK_SQUARE_0", 72
     10  2000					      LIST	ON
      0  2000					      DEF	WHITE_QUEEN_on_BLACK_SQUARE_0
      1  2000				   BANK_WHITE_QUEEN_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  2000				   WHITE_QUEEN_on_BLACK_SQUARE_0
      3  2000				   TEMPORARY_VAR SET	Overlay
      4  2000				   TEMPORARY_OFFSET SET	0
      5  2000					      SUBROUTINE
      3  2000		       e0 e0 f0 f0*	      .byte.b	$e0,$e0,$f0,$f0,$50,$00,$50,$00,$e0,$40,$f0,$f0,$50,$00,$50,$00,$e0,$e0,$f0,$f0,$50,$00,$50,$00	;PF0
      4  2018		       00 00 80 80*	      .byte.b	$00,$00,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$00,$80,$80,$80,$00,$80,$00	;PF1
      5  2030		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_QUEEN_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  2048					      include	"gfx/WHITE_QUEEN_on_BLACK_SQUARE_1.asm"
      0  2048					      OPTIONAL_PAGEBREAK	"WHITE_QUEEN_on_BLACK_SQUARE_1", 72
     10  2048					      LIST	ON
      0  2048					      DEF	WHITE_QUEEN_on_BLACK_SQUARE_1
      1  2048				   BANK_WHITE_QUEEN_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  2048				   WHITE_QUEEN_on_BLACK_SQUARE_1
      3  2048				   TEMPORARY_VAR SET	Overlay
      4  2048				   TEMPORARY_OFFSET SET	0
      5  2048					      SUBROUTINE
      3  2048		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2060		       38 38 7c 7c*	      .byte.b	$38,$38,$7c,$7c,$54,$00,$54,$00,$38,$10,$78,$78,$50,$00,$54,$00,$38,$38,$7c,$7c,$54,$00,$54,$00	;PF1
      5  2078		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_QUEEN_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  2090					      include	"gfx/WHITE_QUEEN_on_BLACK_SQUARE_2.asm"
      0  2090					      OPTIONAL_PAGEBREAK	"WHITE_QUEEN_on_BLACK_SQUARE_2", 72
     10  2090					      LIST	ON
      0  2090					      DEF	WHITE_QUEEN_on_BLACK_SQUARE_2
      1  2090				   BANK_WHITE_QUEEN_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  2090				   WHITE_QUEEN_on_BLACK_SQUARE_2
      3  2090				   TEMPORARY_VAR SET	Overlay
      4  2090				   TEMPORARY_OFFSET SET	0
      5  2090					      SUBROUTINE
      3  2090		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  20a8		       01 01 03 03*	      .byte.b	$01,$01,$03,$03,$02,$00,$02,$00,$01,$00,$03,$03,$02,$00,$02,$00,$01,$01,$03,$03,$02,$00,$02,$00	;PF1
      5  20c0		       03 03 07 07*	      .byte.b	$03,$03,$07,$07,$05,$00,$05,$00,$03,$01,$03,$03,$01,$00,$05,$00,$03,$03,$07,$07,$05,$00,$05,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_QUEEN_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  20d8					      include	"gfx/WHITE_QUEEN_on_BLACK_SQUARE_3.asm"
      0  20d8					      OPTIONAL_PAGEBREAK	"WHITE_QUEEN_on_BLACK_SQUARE_3", 72
 PAGE BREAK INSERTED FOR WHITE_QUEEN_on_BLACK_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f100
     10  2100					      LIST	ON
      0  2100					      DEF	WHITE_QUEEN_on_BLACK_SQUARE_3
      1  2100				   BANK_WHITE_QUEEN_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  2100				   WHITE_QUEEN_on_BLACK_SQUARE_3
      3  2100				   TEMPORARY_VAR SET	Overlay
      4  2100				   TEMPORARY_OFFSET SET	0
      5  2100					      SUBROUTINE
      3  2100		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2118		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2130		       70 70 f8 f8*	      .byte.b	$70,$70,$f8,$f8,$a8,$00,$a8,$00,$70,$20,$78,$78,$28,$00,$a8,$00,$70,$70,$f8,$f8,$a8,$00,$a8,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KING_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  2148					      include	"gfx/WHITE_KING_on_BLACK_SQUARE_0.asm"
      0  2148					      OPTIONAL_PAGEBREAK	"WHITE_KING_on_BLACK_SQUARE_0", 72
     10  2148					      LIST	ON
      0  2148					      DEF	WHITE_KING_on_BLACK_SQUARE_0
      1  2148				   BANK_WHITE_KING_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  2148				   WHITE_KING_on_BLACK_SQUARE_0
      3  2148				   TEMPORARY_VAR SET	Overlay
      4  2148				   TEMPORARY_OFFSET SET	0
      5  2148					      SUBROUTINE
      3  2148		       e0 f0 50 50*	      .byte.b	$e0,$f0,$50,$50,$f0,$40,$e0,$00,$e0,$60,$50,$50,$50,$40,$e0,$40,$e0,$e0,$f0,$50,$50,$b0,$e0,$40	;PF0
      4  2160		       00 80 80 80*	      .byte.b	$00,$80,$80,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$80,$80,$00,$00	;PF1
      5  2178		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KING_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  2190					      include	"gfx/WHITE_KING_on_BLACK_SQUARE_1.asm"
      0  2190					      OPTIONAL_PAGEBREAK	"WHITE_KING_on_BLACK_SQUARE_1", 72
     10  2190					      LIST	ON
      0  2190					      DEF	WHITE_KING_on_BLACK_SQUARE_1
      1  2190				   BANK_WHITE_KING_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  2190				   WHITE_KING_on_BLACK_SQUARE_1
      3  2190				   TEMPORARY_VAR SET	Overlay
      4  2190				   TEMPORARY_OFFSET SET	0
      5  2190					      SUBROUTINE
      3  2190		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  21a8		       38 7c 54 54*	      .byte.b	$38,$7c,$54,$54,$7c,$10,$38,$00,$38,$30,$50,$50,$50,$10,$38,$10,$38,$38,$7c,$54,$54,$6c,$38,$10	;PF1
      5  21c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KING_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  21d8					      include	"gfx/WHITE_KING_on_BLACK_SQUARE_2.asm"
      0  21d8					      OPTIONAL_PAGEBREAK	"WHITE_KING_on_BLACK_SQUARE_2", 72
 PAGE BREAK INSERTED FOR WHITE_KING_on_BLACK_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f200
     10  2200					      LIST	ON
      0  2200					      DEF	WHITE_KING_on_BLACK_SQUARE_2
      1  2200				   BANK_WHITE_KING_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  2200				   WHITE_KING_on_BLACK_SQUARE_2
      3  2200				   TEMPORARY_VAR SET	Overlay
      4  2200				   TEMPORARY_OFFSET SET	0
      5  2200					      SUBROUTINE
      3  2200		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2218		       01 03 02 02*	      .byte.b	$01,$03,$02,$02,$03,$00,$01,$00,$01,$01,$02,$02,$02,$00,$01,$00,$01,$01,$03,$02,$02,$03,$01,$00	;PF1
      5  2230		       03 07 05 05*	      .byte.b	$03,$07,$05,$05,$07,$01,$03,$00,$03,$01,$01,$01,$01,$01,$03,$01,$03,$03,$07,$05,$05,$06,$03,$01	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_KING_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  2248					      include	"gfx/WHITE_KING_on_BLACK_SQUARE_3.asm"
      0  2248					      OPTIONAL_PAGEBREAK	"WHITE_KING_on_BLACK_SQUARE_3", 72
     10  2248					      LIST	ON
      0  2248					      DEF	WHITE_KING_on_BLACK_SQUARE_3
      1  2248				   BANK_WHITE_KING_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  2248				   WHITE_KING_on_BLACK_SQUARE_3
      3  2248				   TEMPORARY_VAR SET	Overlay
      4  2248				   TEMPORARY_OFFSET SET	0
      5  2248					      SUBROUTINE
      3  2248		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2260		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2278		       70 f8 a8 a8*	      .byte.b	$70,$f8,$a8,$a8,$f8,$20,$70,$00,$70,$30,$28,$28,$28,$20,$70,$20,$70,$70,$f8,$a8,$a8,$d8,$70,$20	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BLANK_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  2290					      include	"gfx/BLACK_BLANK_on_WHITE_SQUARE_0.asm"
      0  2290					      OPTIONAL_PAGEBREAK	"BLACK_BLANK_on_WHITE_SQUARE_0", 72
     10  2290					      LIST	ON
      0  2290					      DEF	BLACK_BLANK_on_WHITE_SQUARE_0
      1  2290				   BANK_BLACK_BLANK_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  2290				   BLACK_BLANK_on_WHITE_SQUARE_0
      3  2290				   TEMPORARY_VAR SET	Overlay
      4  2290				   TEMPORARY_OFFSET SET	0
      5  2290					      SUBROUTINE
      3  2290		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$f0,$f0,$f0,$f0,$f0,$f0,$f0,$f0	;PF0
      4  22a8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$80,$80,$80,$80,$80,$80	;PF1
      5  22c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BLANK_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  22d8					      include	"gfx/BLACK_BLANK_on_WHITE_SQUARE_1.asm"
      0  22d8					      OPTIONAL_PAGEBREAK	"BLACK_BLANK_on_WHITE_SQUARE_1", 72
 PAGE BREAK INSERTED FOR BLACK_BLANK_on_WHITE_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f300
     10  2300					      LIST	ON
      0  2300					      DEF	BLACK_BLANK_on_WHITE_SQUARE_1
      1  2300				   BANK_BLACK_BLANK_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  2300				   BLACK_BLANK_on_WHITE_SQUARE_1
      3  2300				   TEMPORARY_VAR SET	Overlay
      4  2300				   TEMPORARY_OFFSET SET	0
      5  2300					      SUBROUTINE
      3  2300		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2318		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$7c,$7c,$7c,$7c,$7c,$7c,$7c,$7c	;PF1
      5  2330		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BLANK_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  2348					      include	"gfx/BLACK_BLANK_on_WHITE_SQUARE_2.asm"
      0  2348					      OPTIONAL_PAGEBREAK	"BLACK_BLANK_on_WHITE_SQUARE_2", 72
     10  2348					      LIST	ON
      0  2348					      DEF	BLACK_BLANK_on_WHITE_SQUARE_2
      1  2348				   BANK_BLACK_BLANK_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  2348				   BLACK_BLANK_on_WHITE_SQUARE_2
      3  2348				   TEMPORARY_VAR SET	Overlay
      4  2348				   TEMPORARY_OFFSET SET	0
      5  2348					      SUBROUTINE
      3  2348		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2360		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$03,$03,$03,$03,$03,$03,$03,$03	;PF1
      5  2378		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$07,$07,$07,$07,$07,$07,$07,$07	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BLANK_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  2390					      include	"gfx/BLACK_BLANK_on_WHITE_SQUARE_3.asm"
      0  2390					      OPTIONAL_PAGEBREAK	"BLACK_BLANK_on_WHITE_SQUARE_3", 72
     10  2390					      LIST	ON
      0  2390					      DEF	BLACK_BLANK_on_WHITE_SQUARE_3
      1  2390				   BANK_BLACK_BLANK_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  2390				   BLACK_BLANK_on_WHITE_SQUARE_3
      3  2390				   TEMPORARY_VAR SET	Overlay
      4  2390				   TEMPORARY_OFFSET SET	0
      5  2390					      SUBROUTINE
      3  2390		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  23a8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  23c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$f8,$f8,$f8,$f8,$f8,$f8,$f8,$f8	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PAWN_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  23d8					      include	"gfx/BLACK_PAWN_on_WHITE_SQUARE_0.asm"
      0  23d8					      OPTIONAL_PAGEBREAK	"BLACK_PAWN_on_WHITE_SQUARE_0", 72
 PAGE BREAK INSERTED FOR BLACK_PAWN_on_WHITE_SQUARE_0
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f400
     10  2400					      LIST	ON
      0  2400					      DEF	BLACK_PAWN_on_WHITE_SQUARE_0
      1  2400				   BANK_BLACK_PAWN_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  2400				   BLACK_PAWN_on_WHITE_SQUARE_0
      3  2400				   TEMPORARY_VAR SET	Overlay
      4  2400				   TEMPORARY_OFFSET SET	0
      5  2400					      SUBROUTINE
      3  2400		       e0 e0 40 40*	      .byte.b	$e0,$e0,$40,$40,$a0,$40,$40,$00,$00,$e0,$40,$40,$e0,$40,$40,$00,$00,$e0,$40,$40,$e0,$40,$40,$00	;PF0
      4  2418		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2430		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PAWN_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  2448					      include	"gfx/BLACK_PAWN_on_WHITE_SQUARE_1.asm"
      0  2448					      OPTIONAL_PAGEBREAK	"BLACK_PAWN_on_WHITE_SQUARE_1", 72
     10  2448					      LIST	ON
      0  2448					      DEF	BLACK_PAWN_on_WHITE_SQUARE_1
      1  2448				   BANK_BLACK_PAWN_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  2448				   BLACK_PAWN_on_WHITE_SQUARE_1
      3  2448				   TEMPORARY_VAR SET	Overlay
      4  2448				   TEMPORARY_OFFSET SET	0
      5  2448					      SUBROUTINE
      3  2448		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2460		       38 38 10 10*	      .byte.b	$38,$38,$10,$10,$28,$10,$10,$00,$00,$38,$10,$10,$38,$10,$10,$00,$00,$38,$10,$10,$38,$10,$10,$00	;PF1
      5  2478		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PAWN_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  2490					      include	"gfx/BLACK_PAWN_on_WHITE_SQUARE_2.asm"
      0  2490					      OPTIONAL_PAGEBREAK	"BLACK_PAWN_on_WHITE_SQUARE_2", 72
     10  2490					      LIST	ON
      0  2490					      DEF	BLACK_PAWN_on_WHITE_SQUARE_2
      1  2490				   BANK_BLACK_PAWN_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  2490				   BLACK_PAWN_on_WHITE_SQUARE_2
      3  2490				   TEMPORARY_VAR SET	Overlay
      4  2490				   TEMPORARY_OFFSET SET	0
      5  2490					      SUBROUTINE
      3  2490		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  24a8		       01 01 00 00*	      .byte.b	$01,$01,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$01,$00,$00,$00	;PF1
      5  24c0		       03 03 01 01*	      .byte.b	$03,$03,$01,$01,$02,$01,$01,$00,$00,$03,$01,$01,$03,$01,$01,$00,$00,$03,$01,$01,$03,$01,$01,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PAWN_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  24d8					      include	"gfx/BLACK_PAWN_on_WHITE_SQUARE_3.asm"
      0  24d8					      OPTIONAL_PAGEBREAK	"BLACK_PAWN_on_WHITE_SQUARE_3", 72
 PAGE BREAK INSERTED FOR BLACK_PAWN_on_WHITE_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f500
     10  2500					      LIST	ON
      0  2500					      DEF	BLACK_PAWN_on_WHITE_SQUARE_3
      1  2500				   BANK_BLACK_PAWN_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  2500				   BLACK_PAWN_on_WHITE_SQUARE_3
      3  2500				   TEMPORARY_VAR SET	Overlay
      4  2500				   TEMPORARY_OFFSET SET	0
      5  2500					      SUBROUTINE
      3  2500		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2518		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2530		       70 70 20 20*	      .byte.b	$70,$70,$20,$20,$50,$20,$20,$00,$00,$70,$20,$20,$70,$20,$20,$00,$00,$70,$20,$20,$70,$20,$20,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KNIGHT_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  2548					      include	"gfx/BLACK_KNIGHT_on_WHITE_SQUARE_0.asm"
      0  2548					      OPTIONAL_PAGEBREAK	"BLACK_KNIGHT_on_WHITE_SQUARE_0", 72
     10  2548					      LIST	ON
      0  2548					      DEF	BLACK_KNIGHT_on_WHITE_SQUARE_0
      1  2548				   BANK_BLACK_KNIGHT_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  2548				   BLACK_KNIGHT_on_WHITE_SQUARE_0
      3  2548				   TEMPORARY_VAR SET	Overlay
      4  2548				   TEMPORARY_OFFSET SET	0
      5  2548					      SUBROUTINE
      3  2548		       f0 f0 e0 f0*	      .byte.b	$f0,$f0,$e0,$f0,$f0,$a0,$40,$00,$f0,$70,$e0,$c0,$f0,$b0,$40,$00,$f0,$70,$e0,$c0,$f0,$b0,$40,$00	;PF0
      4  2560		       80 00 80 80*	      .byte.b	$80,$00,$80,$80,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$80,$00,$80,$00,$00,$80,$80,$80,$80,$00	;PF1
      5  2578		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KNIGHT_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  2590					      include	"gfx/BLACK_KNIGHT_on_WHITE_SQUARE_1.asm"
      0  2590					      OPTIONAL_PAGEBREAK	"BLACK_KNIGHT_on_WHITE_SQUARE_1", 72
     10  2590					      LIST	ON
      0  2590					      DEF	BLACK_KNIGHT_on_WHITE_SQUARE_1
      1  2590				   BANK_BLACK_KNIGHT_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  2590				   BLACK_KNIGHT_on_WHITE_SQUARE_1
      3  2590				   TEMPORARY_VAR SET	Overlay
      4  2590				   TEMPORARY_OFFSET SET	0
      5  2590					      SUBROUTINE
      3  2590		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  25a8		       7c 78 3c 7c*	      .byte.b	$7c,$78,$3c,$7c,$7c,$2c,$14,$00,$7c,$70,$38,$18,$78,$68,$14,$00,$7c,$70,$38,$1c,$7c,$6c,$14,$00	;PF1
      5  25c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KNIGHT_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  25d8					      include	"gfx/BLACK_KNIGHT_on_WHITE_SQUARE_2.asm"
      0  25d8					      OPTIONAL_PAGEBREAK	"BLACK_KNIGHT_on_WHITE_SQUARE_2", 72
 PAGE BREAK INSERTED FOR BLACK_KNIGHT_on_WHITE_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f600
     10  2600					      LIST	ON
      0  2600					      DEF	BLACK_KNIGHT_on_WHITE_SQUARE_2
      1  2600				   BANK_BLACK_KNIGHT_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  2600				   BLACK_KNIGHT_on_WHITE_SQUARE_2
      3  2600				   TEMPORARY_VAR SET	Overlay
      4  2600				   TEMPORARY_OFFSET SET	0
      5  2600					      SUBROUTINE
      3  2600		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2618		       03 03 01 03*	      .byte.b	$03,$03,$01,$03,$03,$01,$00,$00,$03,$03,$01,$00,$03,$03,$00,$00,$03,$03,$01,$00,$03,$03,$00,$00	;PF1
      5  2630		       07 03 07 07*	      .byte.b	$07,$03,$07,$07,$07,$06,$05,$00,$07,$01,$03,$03,$03,$02,$05,$00,$07,$01,$03,$07,$07,$06,$05,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KNIGHT_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  2648					      include	"gfx/BLACK_KNIGHT_on_WHITE_SQUARE_3.asm"
      0  2648					      OPTIONAL_PAGEBREAK	"BLACK_KNIGHT_on_WHITE_SQUARE_3", 72
     10  2648					      LIST	ON
      0  2648					      DEF	BLACK_KNIGHT_on_WHITE_SQUARE_3
      1  2648				   BANK_BLACK_KNIGHT_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  2648				   BLACK_KNIGHT_on_WHITE_SQUARE_3
      3  2648				   TEMPORARY_VAR SET	Overlay
      4  2648				   TEMPORARY_OFFSET SET	0
      5  2648					      SUBROUTINE
      3  2648		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2660		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2678		       f8 78 f0 f8*	      .byte.b	$f8,$78,$f0,$f8,$f8,$d0,$a0,$00,$f8,$38,$70,$60,$78,$58,$a0,$00,$f8,$38,$70,$e0,$f8,$d8,$a0,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BISHOP_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  2690					      include	"gfx/BLACK_BISHOP_on_WHITE_SQUARE_0.asm"
      0  2690					      OPTIONAL_PAGEBREAK	"BLACK_BISHOP_on_WHITE_SQUARE_0", 72
     10  2690					      LIST	ON
      0  2690					      DEF	BLACK_BISHOP_on_WHITE_SQUARE_0
      1  2690				   BANK_BLACK_BISHOP_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  2690				   BLACK_BISHOP_on_WHITE_SQUARE_0
      3  2690				   TEMPORARY_VAR SET	Overlay
      4  2690				   TEMPORARY_OFFSET SET	0
      5  2690					      SUBROUTINE
      3  2690		       f0 e0 f0 b0*	      .byte.b	$f0,$e0,$f0,$b0,$d0,$e0,$40,$40,$f0,$60,$f0,$b0,$d0,$e0,$00,$40,$f0,$e0,$f0,$f0,$f0,$e0,$00,$40	;PF0
      4  26a8		       00 00 80 80*	      .byte.b	$00,$00,$80,$80,$80,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$80,$80,$00,$00,$00	;PF1
      5  26c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BISHOP_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  26d8					      include	"gfx/BLACK_BISHOP_on_WHITE_SQUARE_1.asm"
      0  26d8					      OPTIONAL_PAGEBREAK	"BLACK_BISHOP_on_WHITE_SQUARE_1", 72
 PAGE BREAK INSERTED FOR BLACK_BISHOP_on_WHITE_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f700
     10  2700					      LIST	ON
      0  2700					      DEF	BLACK_BISHOP_on_WHITE_SQUARE_1
      1  2700				   BANK_BLACK_BISHOP_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  2700				   BLACK_BISHOP_on_WHITE_SQUARE_1
      3  2700				   TEMPORARY_VAR SET	Overlay
      4  2700				   TEMPORARY_OFFSET SET	0
      5  2700					      SUBROUTINE
      3  2700		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2718		       78 38 7c 6c*	      .byte.b	$78,$38,$7c,$6c,$5c,$38,$10,$10,$7c,$30,$78,$68,$58,$38,$00,$10,$7c,$38,$78,$7c,$7c,$38,$00,$10	;PF1
      5  2730		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BISHOP_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  2748					      include	"gfx/BLACK_BISHOP_on_WHITE_SQUARE_2.asm"
      0  2748					      OPTIONAL_PAGEBREAK	"BLACK_BISHOP_on_WHITE_SQUARE_2", 72
     10  2748					      LIST	ON
      0  2748					      DEF	BLACK_BISHOP_on_WHITE_SQUARE_2
      1  2748				   BANK_BLACK_BISHOP_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  2748				   BLACK_BISHOP_on_WHITE_SQUARE_2
      3  2748				   TEMPORARY_VAR SET	Overlay
      4  2748				   TEMPORARY_OFFSET SET	0
      5  2748					      SUBROUTINE
      3  2748		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2760		       03 01 03 03*	      .byte.b	$03,$01,$03,$03,$02,$01,$00,$00,$03,$01,$03,$03,$02,$01,$00,$00,$03,$01,$03,$03,$03,$01,$00,$00	;PF1
      5  2778		       03 03 07 06*	      .byte.b	$03,$03,$07,$06,$07,$03,$01,$01,$07,$01,$03,$02,$03,$03,$00,$01,$07,$03,$03,$07,$07,$03,$00,$01	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BISHOP_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  2790					      include	"gfx/BLACK_BISHOP_on_WHITE_SQUARE_3.asm"
      0  2790					      OPTIONAL_PAGEBREAK	"BLACK_BISHOP_on_WHITE_SQUARE_3", 72
     10  2790					      LIST	ON
      0  2790					      DEF	BLACK_BISHOP_on_WHITE_SQUARE_3
      1  2790				   BANK_BLACK_BISHOP_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  2790				   BLACK_BISHOP_on_WHITE_SQUARE_3
      3  2790				   TEMPORARY_VAR SET	Overlay
      4  2790				   TEMPORARY_OFFSET SET	0
      5  2790					      SUBROUTINE
      3  2790		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  27a8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  27c0		       78 70 f8 d8*	      .byte.b	$78,$70,$f8,$d8,$e8,$70,$20,$20,$f8,$30,$78,$58,$68,$70,$00,$20,$f8,$70,$78,$f8,$f8,$70,$00,$20	;PF2
------- FILE piece_graphics.asm
      0  27d8					      CHECK_BANK_SIZE	"PIECE_2 (2K)"
      1  27d8		       07 d8	   .TEMP      =	* - BANK_START
 PIECE_2 (2K) (2K) SIZE =  $7d8 , FREE= $28
      2  27d8					      ECHO	"PIECE_2 (2K)", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  27d8				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  27d8				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  27d8				  -	      ERR
      6  27d8					      endif
      0  27d8					      NEWBANK	PIECES_3
      1  2fd8 ????				      SEG	PIECES_3
      2  2800					      ORG	ORIGIN
      3  2800					      RORG	$F000
      4  2800				   BANK_START SET	*
      5  2800				   PIECES_3   SET	ORIGIN / 2048
      6  2800				   ORIGIN     SET	ORIGIN + 2048
      7  2800				   _CURRENT_BANK SET	PIECES_3
------- FILE gfx/BLACK_ROOK_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  2800					      include	"gfx/BLACK_ROOK_on_WHITE_SQUARE_0.asm"
      0  2800					      OPTIONAL_PAGEBREAK	"BLACK_ROOK_on_WHITE_SQUARE_0", 72
     10  2800					      LIST	ON
      0  2800					      DEF	BLACK_ROOK_on_WHITE_SQUARE_0
      1  2800				   BANK_BLACK_ROOK_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  2800				   BLACK_ROOK_on_WHITE_SQUARE_0
      3  2800				   TEMPORARY_VAR SET	Overlay
      4  2800				   TEMPORARY_OFFSET SET	0
      5  2800					      SUBROUTINE
      3  2800		       f0 e0 e0 e0*	      .byte.b	$f0,$e0,$e0,$e0,$f0,$50,$50,$00,$f0,$60,$60,$60,$f0,$50,$00,$00,$f0,$e0,$e0,$e0,$f0,$50,$50,$00	;PF0
      4  2818		       00 00 00 80*	      .byte.b	$00,$00,$00,$80,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$00,$80,$80,$80,$00	;PF1
      5  2830		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_ROOK_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  2848					      include	"gfx/BLACK_ROOK_on_WHITE_SQUARE_1.asm"
      0  2848					      OPTIONAL_PAGEBREAK	"BLACK_ROOK_on_WHITE_SQUARE_1", 72
     10  2848					      LIST	ON
      0  2848					      DEF	BLACK_ROOK_on_WHITE_SQUARE_1
      1  2848				   BANK_BLACK_ROOK_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  2848				   BLACK_ROOK_on_WHITE_SQUARE_1
      3  2848				   TEMPORARY_VAR SET	Overlay
      4  2848				   TEMPORARY_OFFSET SET	0
      5  2848					      SUBROUTINE
      3  2848		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2860		       78 38 38 3c*	      .byte.b	$78,$38,$38,$3c,$7c,$54,$54,$00,$7c,$30,$30,$30,$78,$50,$00,$00,$7c,$38,$38,$38,$7c,$54,$54,$00	;PF1
      5  2878		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_ROOK_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  2890					      include	"gfx/BLACK_ROOK_on_WHITE_SQUARE_2.asm"
      0  2890					      OPTIONAL_PAGEBREAK	"BLACK_ROOK_on_WHITE_SQUARE_2", 72
     10  2890					      LIST	ON
      0  2890					      DEF	BLACK_ROOK_on_WHITE_SQUARE_2
      1  2890				   BANK_BLACK_ROOK_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  2890				   BLACK_ROOK_on_WHITE_SQUARE_2
      3  2890				   TEMPORARY_VAR SET	Overlay
      4  2890				   TEMPORARY_OFFSET SET	0
      5  2890					      SUBROUTINE
      3  2890		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  28a8		       03 01 01 01*	      .byte.b	$03,$01,$01,$01,$03,$02,$02,$00,$03,$01,$01,$01,$03,$02,$00,$00,$03,$01,$01,$01,$03,$02,$02,$00	;PF1
      5  28c0		       03 03 03 07*	      .byte.b	$03,$03,$03,$07,$07,$05,$05,$00,$07,$01,$01,$01,$03,$01,$00,$00,$07,$03,$03,$03,$07,$05,$05,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_ROOK_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  28d8					      include	"gfx/BLACK_ROOK_on_WHITE_SQUARE_3.asm"
      0  28d8					      OPTIONAL_PAGEBREAK	"BLACK_ROOK_on_WHITE_SQUARE_3", 72
 PAGE BREAK INSERTED FOR BLACK_ROOK_on_WHITE_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f100
     10  2900					      LIST	ON
      0  2900					      DEF	BLACK_ROOK_on_WHITE_SQUARE_3
      1  2900				   BANK_BLACK_ROOK_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  2900				   BLACK_ROOK_on_WHITE_SQUARE_3
      3  2900				   TEMPORARY_VAR SET	Overlay
      4  2900				   TEMPORARY_OFFSET SET	0
      5  2900					      SUBROUTINE
      3  2900		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2918		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2930		       78 70 70 f0*	      .byte.b	$78,$70,$70,$f0,$f8,$a8,$a8,$00,$f8,$30,$30,$30,$78,$28,$00,$00,$f8,$70,$70,$70,$f8,$a8,$a8,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_QUEEN_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  2948					      include	"gfx/BLACK_QUEEN_on_WHITE_SQUARE_0.asm"
      0  2948					      OPTIONAL_PAGEBREAK	"BLACK_QUEEN_on_WHITE_SQUARE_0", 72
     10  2948					      LIST	ON
      0  2948					      DEF	BLACK_QUEEN_on_WHITE_SQUARE_0
      1  2948				   BANK_BLACK_QUEEN_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  2948				   BLACK_QUEEN_on_WHITE_SQUARE_0
      3  2948				   TEMPORARY_VAR SET	Overlay
      4  2948				   TEMPORARY_OFFSET SET	0
      5  2948					      SUBROUTINE
      3  2948		       e0 e0 f0 f0*	      .byte.b	$e0,$e0,$f0,$f0,$50,$00,$50,$00,$e0,$40,$f0,$f0,$50,$00,$50,$00,$e0,$e0,$f0,$f0,$50,$00,$50,$00	;PF0
      4  2960		       00 00 80 80*	      .byte.b	$00,$00,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$00,$00,$80,$80,$00,$80,$00	;PF1
      5  2978		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_QUEEN_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  2990					      include	"gfx/BLACK_QUEEN_on_WHITE_SQUARE_1.asm"
      0  2990					      OPTIONAL_PAGEBREAK	"BLACK_QUEEN_on_WHITE_SQUARE_1", 72
     10  2990					      LIST	ON
      0  2990					      DEF	BLACK_QUEEN_on_WHITE_SQUARE_1
      1  2990				   BANK_BLACK_QUEEN_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  2990				   BLACK_QUEEN_on_WHITE_SQUARE_1
      3  2990				   TEMPORARY_VAR SET	Overlay
      4  2990				   TEMPORARY_OFFSET SET	0
      5  2990					      SUBROUTINE
      3  2990		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  29a8		       38 38 7c 7c*	      .byte.b	$38,$38,$7c,$7c,$54,$00,$54,$00,$38,$10,$78,$78,$50,$00,$54,$00,$38,$38,$78,$7c,$54,$00,$54,$00	;PF1
      5  29c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_QUEEN_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  29d8					      include	"gfx/BLACK_QUEEN_on_WHITE_SQUARE_2.asm"
      0  29d8					      OPTIONAL_PAGEBREAK	"BLACK_QUEEN_on_WHITE_SQUARE_2", 72
 PAGE BREAK INSERTED FOR BLACK_QUEEN_on_WHITE_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f200
     10  2a00					      LIST	ON
      0  2a00					      DEF	BLACK_QUEEN_on_WHITE_SQUARE_2
      1  2a00				   BANK_BLACK_QUEEN_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  2a00				   BLACK_QUEEN_on_WHITE_SQUARE_2
      3  2a00				   TEMPORARY_VAR SET	Overlay
      4  2a00				   TEMPORARY_OFFSET SET	0
      5  2a00					      SUBROUTINE
      3  2a00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2a18		       01 01 03 03*	      .byte.b	$01,$01,$03,$03,$02,$00,$02,$00,$01,$00,$03,$03,$02,$00,$02,$00,$01,$01,$03,$03,$02,$00,$02,$00	;PF1
      5  2a30		       03 03 07 07*	      .byte.b	$03,$03,$07,$07,$05,$00,$05,$00,$03,$01,$03,$03,$01,$00,$05,$00,$03,$03,$03,$07,$05,$00,$05,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_QUEEN_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  2a48					      include	"gfx/BLACK_QUEEN_on_WHITE_SQUARE_3.asm"
      0  2a48					      OPTIONAL_PAGEBREAK	"BLACK_QUEEN_on_WHITE_SQUARE_3", 72
     10  2a48					      LIST	ON
      0  2a48					      DEF	BLACK_QUEEN_on_WHITE_SQUARE_3
      1  2a48				   BANK_BLACK_QUEEN_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  2a48				   BLACK_QUEEN_on_WHITE_SQUARE_3
      3  2a48				   TEMPORARY_VAR SET	Overlay
      4  2a48				   TEMPORARY_OFFSET SET	0
      5  2a48					      SUBROUTINE
      3  2a48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2a60		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2a78		       70 70 f8 f8*	      .byte.b	$70,$70,$f8,$f8,$a8,$00,$a8,$00,$70,$20,$78,$78,$28,$00,$a8,$00,$70,$70,$78,$f8,$a8,$00,$a8,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KING_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  2a90					      include	"gfx/BLACK_KING_on_WHITE_SQUARE_0.asm"
      0  2a90					      OPTIONAL_PAGEBREAK	"BLACK_KING_on_WHITE_SQUARE_0", 72
     10  2a90					      LIST	ON
      0  2a90					      DEF	BLACK_KING_on_WHITE_SQUARE_0
      1  2a90				   BANK_BLACK_KING_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  2a90				   BLACK_KING_on_WHITE_SQUARE_0
      3  2a90				   TEMPORARY_VAR SET	Overlay
      4  2a90				   TEMPORARY_OFFSET SET	0
      5  2a90					      SUBROUTINE
      3  2a90		       e0 f0 50 50*	      .byte.b	$e0,$f0,$50,$50,$f0,$40,$e0,$40,$e0,$60,$50,$50,$50,$40,$e0,$40,$e0,$e0,$50,$f0,$f0,$40,$e0,$40	;PF0
      4  2aa8		       00 80 80 80*	      .byte.b	$00,$80,$80,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$80,$80,$00,$00,$00	;PF1
      5  2ac0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KING_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  2ad8					      include	"gfx/BLACK_KING_on_WHITE_SQUARE_1.asm"
      0  2ad8					      OPTIONAL_PAGEBREAK	"BLACK_KING_on_WHITE_SQUARE_1", 72
 PAGE BREAK INSERTED FOR BLACK_KING_on_WHITE_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f300
     10  2b00					      LIST	ON
      0  2b00					      DEF	BLACK_KING_on_WHITE_SQUARE_1
      1  2b00				   BANK_BLACK_KING_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  2b00				   BLACK_KING_on_WHITE_SQUARE_1
      3  2b00				   TEMPORARY_VAR SET	Overlay
      4  2b00				   TEMPORARY_OFFSET SET	0
      5  2b00					      SUBROUTINE
      3  2b00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2b18		       38 7c 54 54*	      .byte.b	$38,$7c,$54,$54,$7c,$10,$38,$10,$38,$30,$50,$50,$50,$10,$38,$10,$38,$38,$54,$7c,$7c,$10,$38,$10	;PF1
      5  2b30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KING_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  2b48					      include	"gfx/BLACK_KING_on_WHITE_SQUARE_2.asm"
      0  2b48					      OPTIONAL_PAGEBREAK	"BLACK_KING_on_WHITE_SQUARE_2", 72
     10  2b48					      LIST	ON
      0  2b48					      DEF	BLACK_KING_on_WHITE_SQUARE_2
      1  2b48				   BANK_BLACK_KING_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  2b48				   BLACK_KING_on_WHITE_SQUARE_2
      3  2b48				   TEMPORARY_VAR SET	Overlay
      4  2b48				   TEMPORARY_OFFSET SET	0
      5  2b48					      SUBROUTINE
      3  2b48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2b60		       01 03 02 02*	      .byte.b	$01,$03,$02,$02,$03,$00,$01,$00,$01,$01,$02,$02,$02,$00,$01,$00,$01,$01,$02,$03,$03,$00,$01,$00	;PF1
      5  2b78		       03 07 05 05*	      .byte.b	$03,$07,$05,$05,$07,$01,$03,$01,$03,$01,$01,$01,$01,$01,$03,$01,$03,$03,$05,$07,$07,$01,$03,$01	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KING_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  2b90					      include	"gfx/BLACK_KING_on_WHITE_SQUARE_3.asm"
      0  2b90					      OPTIONAL_PAGEBREAK	"BLACK_KING_on_WHITE_SQUARE_3", 72
     10  2b90					      LIST	ON
      0  2b90					      DEF	BLACK_KING_on_WHITE_SQUARE_3
      1  2b90				   BANK_BLACK_KING_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  2b90				   BLACK_KING_on_WHITE_SQUARE_3
      3  2b90				   TEMPORARY_VAR SET	Overlay
      4  2b90				   TEMPORARY_OFFSET SET	0
      5  2b90					      SUBROUTINE
      3  2b90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2ba8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2bc0		       70 f8 a8 a8*	      .byte.b	$70,$f8,$a8,$a8,$f8,$20,$70,$20,$70,$30,$28,$28,$28,$20,$70,$20,$70,$70,$a8,$f8,$f8,$20,$70,$20	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BLANK_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  2bd8					      include	"gfx/BLACK_BLANK_on_BLACK_SQUARE_0.asm"
      0  2bd8					      OPTIONAL_PAGEBREAK	"BLACK_BLANK_on_BLACK_SQUARE_0", 72
 PAGE BREAK INSERTED FOR BLACK_BLANK_on_BLACK_SQUARE_0
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f400
     10  2c00					      LIST	ON
      0  2c00					      DEF	BLACK_BLANK_on_BLACK_SQUARE_0
      1  2c00				   BANK_BLACK_BLANK_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  2c00				   BLACK_BLANK_on_BLACK_SQUARE_0
      3  2c00				   TEMPORARY_VAR SET	Overlay
      4  2c00				   TEMPORARY_OFFSET SET	0
      5  2c00					      SUBROUTINE
      3  2c00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2c18		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2c30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BLANK_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  2c48					      include	"gfx/BLACK_BLANK_on_BLACK_SQUARE_1.asm"
      0  2c48					      OPTIONAL_PAGEBREAK	"BLACK_BLANK_on_BLACK_SQUARE_1", 72
     10  2c48					      LIST	ON
      0  2c48					      DEF	BLACK_BLANK_on_BLACK_SQUARE_1
      1  2c48				   BANK_BLACK_BLANK_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  2c48				   BLACK_BLANK_on_BLACK_SQUARE_1
      3  2c48				   TEMPORARY_VAR SET	Overlay
      4  2c48				   TEMPORARY_OFFSET SET	0
      5  2c48					      SUBROUTINE
      3  2c48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2c60		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2c78		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BLANK_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  2c90					      include	"gfx/BLACK_BLANK_on_BLACK_SQUARE_2.asm"
      0  2c90					      OPTIONAL_PAGEBREAK	"BLACK_BLANK_on_BLACK_SQUARE_2", 72
     10  2c90					      LIST	ON
      0  2c90					      DEF	BLACK_BLANK_on_BLACK_SQUARE_2
      1  2c90				   BANK_BLACK_BLANK_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  2c90				   BLACK_BLANK_on_BLACK_SQUARE_2
      3  2c90				   TEMPORARY_VAR SET	Overlay
      4  2c90				   TEMPORARY_OFFSET SET	0
      5  2c90					      SUBROUTINE
      3  2c90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2ca8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2cc0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BLANK_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  2cd8					      include	"gfx/BLACK_BLANK_on_BLACK_SQUARE_3.asm"
      0  2cd8					      OPTIONAL_PAGEBREAK	"BLACK_BLANK_on_BLACK_SQUARE_3", 72
 PAGE BREAK INSERTED FOR BLACK_BLANK_on_BLACK_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f500
     10  2d00					      LIST	ON
      0  2d00					      DEF	BLACK_BLANK_on_BLACK_SQUARE_3
      1  2d00				   BANK_BLACK_BLANK_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  2d00				   BLACK_BLANK_on_BLACK_SQUARE_3
      3  2d00				   TEMPORARY_VAR SET	Overlay
      4  2d00				   TEMPORARY_OFFSET SET	0
      5  2d00					      SUBROUTINE
      3  2d00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2d18		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2d30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PAWN_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  2d48					      include	"gfx/BLACK_PAWN_on_BLACK_SQUARE_0.asm"
      0  2d48					      OPTIONAL_PAGEBREAK	"BLACK_PAWN_on_BLACK_SQUARE_0", 72
     10  2d48					      LIST	ON
      0  2d48					      DEF	BLACK_PAWN_on_BLACK_SQUARE_0
      1  2d48				   BANK_BLACK_PAWN_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  2d48				   BLACK_PAWN_on_BLACK_SQUARE_0
      3  2d48				   TEMPORARY_VAR SET	Overlay
      4  2d48				   TEMPORARY_OFFSET SET	0
      5  2d48					      SUBROUTINE
      3  2d48		       e0 e0 40 40*	      .byte.b	$e0,$e0,$40,$40,$a0,$40,$40,$00,$00,$e0,$40,$40,$e0,$40,$40,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2d60		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2d78		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PAWN_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  2d90					      include	"gfx/BLACK_PAWN_on_BLACK_SQUARE_1.asm"
      0  2d90					      OPTIONAL_PAGEBREAK	"BLACK_PAWN_on_BLACK_SQUARE_1", 72
     10  2d90					      LIST	ON
      0  2d90					      DEF	BLACK_PAWN_on_BLACK_SQUARE_1
      1  2d90				   BANK_BLACK_PAWN_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  2d90				   BLACK_PAWN_on_BLACK_SQUARE_1
      3  2d90				   TEMPORARY_VAR SET	Overlay
      4  2d90				   TEMPORARY_OFFSET SET	0
      5  2d90					      SUBROUTINE
      3  2d90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2da8		       38 38 10 10*	      .byte.b	$38,$38,$10,$10,$28,$10,$10,$00,$00,$38,$10,$10,$38,$10,$10,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2dc0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PAWN_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  2dd8					      include	"gfx/BLACK_PAWN_on_BLACK_SQUARE_2.asm"
      0  2dd8					      OPTIONAL_PAGEBREAK	"BLACK_PAWN_on_BLACK_SQUARE_2", 72
 PAGE BREAK INSERTED FOR BLACK_PAWN_on_BLACK_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f600
     10  2e00					      LIST	ON
      0  2e00					      DEF	BLACK_PAWN_on_BLACK_SQUARE_2
      1  2e00				   BANK_BLACK_PAWN_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  2e00				   BLACK_PAWN_on_BLACK_SQUARE_2
      3  2e00				   TEMPORARY_VAR SET	Overlay
      4  2e00				   TEMPORARY_OFFSET SET	0
      5  2e00					      SUBROUTINE
      3  2e00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2e18		       01 01 00 00*	      .byte.b	$01,$01,$00,$00,$01,$00,$00,$00,$00,$01,$00,$00,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2e30		       03 03 01 01*	      .byte.b	$03,$03,$01,$01,$02,$01,$01,$00,$00,$03,$01,$01,$03,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PAWN_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  2e48					      include	"gfx/BLACK_PAWN_on_BLACK_SQUARE_3.asm"
      0  2e48					      OPTIONAL_PAGEBREAK	"BLACK_PAWN_on_BLACK_SQUARE_3", 72
     10  2e48					      LIST	ON
      0  2e48					      DEF	BLACK_PAWN_on_BLACK_SQUARE_3
      1  2e48				   BANK_BLACK_PAWN_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  2e48				   BLACK_PAWN_on_BLACK_SQUARE_3
      3  2e48				   TEMPORARY_VAR SET	Overlay
      4  2e48				   TEMPORARY_OFFSET SET	0
      5  2e48					      SUBROUTINE
      3  2e48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2e60		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2e78		       70 70 20 20*	      .byte.b	$70,$70,$20,$20,$50,$20,$20,$00,$00,$70,$20,$20,$70,$20,$20,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KNIGHT_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  2e90					      include	"gfx/BLACK_KNIGHT_on_BLACK_SQUARE_0.asm"
      0  2e90					      OPTIONAL_PAGEBREAK	"BLACK_KNIGHT_on_BLACK_SQUARE_0", 72
     10  2e90					      LIST	ON
      0  2e90					      DEF	BLACK_KNIGHT_on_BLACK_SQUARE_0
      1  2e90				   BANK_BLACK_KNIGHT_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  2e90				   BLACK_KNIGHT_on_BLACK_SQUARE_0
      3  2e90				   TEMPORARY_VAR SET	Overlay
      4  2e90				   TEMPORARY_OFFSET SET	0
      5  2e90					      SUBROUTINE
      3  2e90		       f0 f0 e0 f0*	      .byte.b	$f0,$f0,$e0,$f0,$f0,$a0,$40,$00,$f0,$70,$e0,$c0,$f0,$b0,$40,$00,$00,$00,$00,$00,$00,$40,$00,$00	;PF0
      4  2ea8		       80 00 80 80*	      .byte.b	$80,$00,$80,$80,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2ec0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KNIGHT_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  2ed8					      include	"gfx/BLACK_KNIGHT_on_BLACK_SQUARE_1.asm"
      0  2ed8					      OPTIONAL_PAGEBREAK	"BLACK_KNIGHT_on_BLACK_SQUARE_1", 72
 PAGE BREAK INSERTED FOR BLACK_KNIGHT_on_BLACK_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f700
     10  2f00					      LIST	ON
      0  2f00					      DEF	BLACK_KNIGHT_on_BLACK_SQUARE_1
      1  2f00				   BANK_BLACK_KNIGHT_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  2f00				   BLACK_KNIGHT_on_BLACK_SQUARE_1
      3  2f00				   TEMPORARY_VAR SET	Overlay
      4  2f00				   TEMPORARY_OFFSET SET	0
      5  2f00					      SUBROUTINE
      3  2f00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2f18		       7c 78 3c 7c*	      .byte.b	$7c,$78,$3c,$7c,$7c,$2c,$14,$00,$7c,$70,$38,$18,$78,$68,$14,$00,$00,$00,$00,$00,$00,$10,$00,$00	;PF1
      5  2f30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KNIGHT_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  2f48					      include	"gfx/BLACK_KNIGHT_on_BLACK_SQUARE_2.asm"
      0  2f48					      OPTIONAL_PAGEBREAK	"BLACK_KNIGHT_on_BLACK_SQUARE_2", 72
     10  2f48					      LIST	ON
      0  2f48					      DEF	BLACK_KNIGHT_on_BLACK_SQUARE_2
      1  2f48				   BANK_BLACK_KNIGHT_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  2f48				   BLACK_KNIGHT_on_BLACK_SQUARE_2
      3  2f48				   TEMPORARY_VAR SET	Overlay
      4  2f48				   TEMPORARY_OFFSET SET	0
      5  2f48					      SUBROUTINE
      3  2f48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2f60		       03 03 01 03*	      .byte.b	$03,$03,$01,$03,$03,$01,$00,$00,$03,$03,$01,$00,$03,$03,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2f78		       07 03 07 07*	      .byte.b	$07,$03,$07,$07,$07,$06,$05,$00,$07,$01,$03,$03,$03,$02,$05,$00,$00,$00,$00,$00,$00,$01,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KNIGHT_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  2f90					      include	"gfx/BLACK_KNIGHT_on_BLACK_SQUARE_3.asm"
      0  2f90					      OPTIONAL_PAGEBREAK	"BLACK_KNIGHT_on_BLACK_SQUARE_3", 72
     10  2f90					      LIST	ON
      0  2f90					      DEF	BLACK_KNIGHT_on_BLACK_SQUARE_3
      1  2f90				   BANK_BLACK_KNIGHT_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  2f90				   BLACK_KNIGHT_on_BLACK_SQUARE_3
      3  2f90				   TEMPORARY_VAR SET	Overlay
      4  2f90				   TEMPORARY_OFFSET SET	0
      5  2f90					      SUBROUTINE
      3  2f90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  2fa8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  2fc0		       f8 78 f0 f8*	      .byte.b	$f8,$78,$f0,$f8,$f8,$d0,$a0,$00,$f8,$38,$70,$60,$78,$58,$a0,$00,$00,$00,$00,$00,$00,$20,$00,$00	;PF2
------- FILE piece_graphics.asm
      0  2fd8					      CHECK_BANK_SIZE	"PIECES_3 (2K)"
      1  2fd8		       07 d8	   .TEMP      =	* - BANK_START
 PIECES_3 (2K) (2K) SIZE =  $7d8 , FREE= $28
      2  2fd8					      ECHO	"PIECES_3 (2K)", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  2fd8				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  2fd8				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  2fd8				  -	      ERR
      6  2fd8					      endif
      0  2fd8					      NEWBANK	PIECES_4
      1  37d8 ????				      SEG	PIECES_4
      2  3000					      ORG	ORIGIN
      3  3000					      RORG	$F000
      4  3000				   BANK_START SET	*
      5  3000				   PIECES_4   SET	ORIGIN / 2048
      6  3000				   ORIGIN     SET	ORIGIN + 2048
      7  3000				   _CURRENT_BANK SET	PIECES_4
------- FILE gfx/BLACK_BISHOP_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  3000					      include	"gfx/BLACK_BISHOP_on_BLACK_SQUARE_0.asm"
      0  3000					      OPTIONAL_PAGEBREAK	"BLACK_BISHOP_on_BLACK_SQUARE_0", 72
     10  3000					      LIST	ON
      0  3000					      DEF	BLACK_BISHOP_on_BLACK_SQUARE_0
      1  3000				   BANK_BLACK_BISHOP_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  3000				   BLACK_BISHOP_on_BLACK_SQUARE_0
      3  3000				   TEMPORARY_VAR SET	Overlay
      4  3000				   TEMPORARY_OFFSET SET	0
      5  3000					      SUBROUTINE
      3  3000		       f0 e0 f0 b0*	      .byte.b	$f0,$e0,$f0,$b0,$d0,$e0,$40,$40,$f0,$60,$f0,$b0,$d0,$e0,$00,$40,$00,$00,$00,$00,$00,$00,$40,$00	;PF0
      4  3018		       00 00 80 80*	      .byte.b	$00,$00,$80,$80,$80,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3030		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BISHOP_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  3048					      include	"gfx/BLACK_BISHOP_on_BLACK_SQUARE_1.asm"
      0  3048					      OPTIONAL_PAGEBREAK	"BLACK_BISHOP_on_BLACK_SQUARE_1", 72
     10  3048					      LIST	ON
      0  3048					      DEF	BLACK_BISHOP_on_BLACK_SQUARE_1
      1  3048				   BANK_BLACK_BISHOP_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  3048				   BLACK_BISHOP_on_BLACK_SQUARE_1
      3  3048				   TEMPORARY_VAR SET	Overlay
      4  3048				   TEMPORARY_OFFSET SET	0
      5  3048					      SUBROUTINE
      3  3048		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3060		       78 38 7c 6c*	      .byte.b	$78,$38,$7c,$6c,$5c,$38,$10,$10,$7c,$30,$78,$68,$58,$38,$00,$10,$00,$00,$00,$00,$00,$00,$10,$00	;PF1
      5  3078		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BISHOP_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  3090					      include	"gfx/BLACK_BISHOP_on_BLACK_SQUARE_2.asm"
      0  3090					      OPTIONAL_PAGEBREAK	"BLACK_BISHOP_on_BLACK_SQUARE_2", 72
     10  3090					      LIST	ON
      0  3090					      DEF	BLACK_BISHOP_on_BLACK_SQUARE_2
      1  3090				   BANK_BLACK_BISHOP_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  3090				   BLACK_BISHOP_on_BLACK_SQUARE_2
      3  3090				   TEMPORARY_VAR SET	Overlay
      4  3090				   TEMPORARY_OFFSET SET	0
      5  3090					      SUBROUTINE
      3  3090		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  30a8		       03 01 03 03*	      .byte.b	$03,$01,$03,$03,$02,$01,$00,$00,$03,$01,$03,$03,$02,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  30c0		       03 03 07 06*	      .byte.b	$03,$03,$07,$06,$07,$03,$01,$01,$07,$01,$03,$02,$03,$03,$00,$01,$00,$00,$00,$00,$00,$00,$01,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_BISHOP_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  30d8					      include	"gfx/BLACK_BISHOP_on_BLACK_SQUARE_3.asm"
      0  30d8					      OPTIONAL_PAGEBREAK	"BLACK_BISHOP_on_BLACK_SQUARE_3", 72
 PAGE BREAK INSERTED FOR BLACK_BISHOP_on_BLACK_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f100
     10  3100					      LIST	ON
      0  3100					      DEF	BLACK_BISHOP_on_BLACK_SQUARE_3
      1  3100				   BANK_BLACK_BISHOP_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  3100				   BLACK_BISHOP_on_BLACK_SQUARE_3
      3  3100				   TEMPORARY_VAR SET	Overlay
      4  3100				   TEMPORARY_OFFSET SET	0
      5  3100					      SUBROUTINE
      3  3100		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3118		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3130		       78 70 f8 d8*	      .byte.b	$78,$70,$f8,$d8,$e8,$70,$20,$20,$f8,$30,$78,$58,$68,$70,$00,$20,$00,$00,$00,$00,$00,$00,$20,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_ROOK_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  3148					      include	"gfx/BLACK_ROOK_on_BLACK_SQUARE_0.asm"
      0  3148					      OPTIONAL_PAGEBREAK	"BLACK_ROOK_on_BLACK_SQUARE_0", 72
     10  3148					      LIST	ON
      0  3148					      DEF	BLACK_ROOK_on_BLACK_SQUARE_0
      1  3148				   BANK_BLACK_ROOK_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  3148				   BLACK_ROOK_on_BLACK_SQUARE_0
      3  3148				   TEMPORARY_VAR SET	Overlay
      4  3148				   TEMPORARY_OFFSET SET	0
      5  3148					      SUBROUTINE
      3  3148		       f0 e0 e0 e0*	      .byte.b	$f0,$e0,$e0,$e0,$f0,$50,$50,$00,$f0,$60,$60,$60,$f0,$50,$00,$00,$00,$00,$00,$00,$00,$a0,$00,$00	;PF0
      4  3160		       00 00 00 80*	      .byte.b	$00,$00,$00,$80,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3178		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_ROOK_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  3190					      include	"gfx/BLACK_ROOK_on_BLACK_SQUARE_1.asm"
      0  3190					      OPTIONAL_PAGEBREAK	"BLACK_ROOK_on_BLACK_SQUARE_1", 72
     10  3190					      LIST	ON
      0  3190					      DEF	BLACK_ROOK_on_BLACK_SQUARE_1
      1  3190				   BANK_BLACK_ROOK_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  3190				   BLACK_ROOK_on_BLACK_SQUARE_1
      3  3190				   TEMPORARY_VAR SET	Overlay
      4  3190				   TEMPORARY_OFFSET SET	0
      5  3190					      SUBROUTINE
      3  3190		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  31a8		       78 38 38 3c*	      .byte.b	$78,$38,$38,$3c,$7c,$54,$54,$00,$7c,$30,$30,$30,$78,$50,$00,$00,$00,$00,$00,$00,$00,$28,$00,$00	;PF1
      5  31c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_ROOK_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  31d8					      include	"gfx/BLACK_ROOK_on_BLACK_SQUARE_2.asm"
      0  31d8					      OPTIONAL_PAGEBREAK	"BLACK_ROOK_on_BLACK_SQUARE_2", 72
 PAGE BREAK INSERTED FOR BLACK_ROOK_on_BLACK_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f200
     10  3200					      LIST	ON
      0  3200					      DEF	BLACK_ROOK_on_BLACK_SQUARE_2
      1  3200				   BANK_BLACK_ROOK_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  3200				   BLACK_ROOK_on_BLACK_SQUARE_2
      3  3200				   TEMPORARY_VAR SET	Overlay
      4  3200				   TEMPORARY_OFFSET SET	0
      5  3200					      SUBROUTINE
      3  3200		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3218		       03 01 01 01*	      .byte.b	$03,$01,$01,$01,$03,$02,$02,$00,$03,$01,$01,$01,$03,$02,$00,$00,$00,$00,$00,$00,$00,$01,$00,$00	;PF1
      5  3230		       03 03 03 07*	      .byte.b	$03,$03,$03,$07,$07,$05,$05,$00,$07,$01,$01,$01,$03,$01,$00,$00,$00,$00,$00,$00,$00,$02,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_ROOK_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  3248					      include	"gfx/BLACK_ROOK_on_BLACK_SQUARE_3.asm"
      0  3248					      OPTIONAL_PAGEBREAK	"BLACK_ROOK_on_BLACK_SQUARE_3", 72
     10  3248					      LIST	ON
      0  3248					      DEF	BLACK_ROOK_on_BLACK_SQUARE_3
      1  3248				   BANK_BLACK_ROOK_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  3248				   BLACK_ROOK_on_BLACK_SQUARE_3
      3  3248				   TEMPORARY_VAR SET	Overlay
      4  3248				   TEMPORARY_OFFSET SET	0
      5  3248					      SUBROUTINE
      3  3248		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3260		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3278		       78 70 70 f0*	      .byte.b	$78,$70,$70,$f0,$f8,$a8,$a8,$00,$f8,$30,$30,$30,$78,$28,$00,$00,$00,$00,$00,$00,$00,$50,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_QUEEN_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  3290					      include	"gfx/BLACK_QUEEN_on_BLACK_SQUARE_0.asm"
      0  3290					      OPTIONAL_PAGEBREAK	"BLACK_QUEEN_on_BLACK_SQUARE_0", 72
     10  3290					      LIST	ON
      0  3290					      DEF	BLACK_QUEEN_on_BLACK_SQUARE_0
      1  3290				   BANK_BLACK_QUEEN_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  3290				   BLACK_QUEEN_on_BLACK_SQUARE_0
      3  3290				   TEMPORARY_VAR SET	Overlay
      4  3290				   TEMPORARY_OFFSET SET	0
      5  3290					      SUBROUTINE
      3  3290		       e0 e0 f0 f0*	      .byte.b	$e0,$e0,$f0,$f0,$50,$00,$50,$00,$e0,$40,$f0,$f0,$50,$00,$50,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  32a8		       00 00 80 80*	      .byte.b	$00,$00,$80,$80,$80,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  32c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_QUEEN_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  32d8					      include	"gfx/BLACK_QUEEN_on_BLACK_SQUARE_1.asm"
      0  32d8					      OPTIONAL_PAGEBREAK	"BLACK_QUEEN_on_BLACK_SQUARE_1", 72
 PAGE BREAK INSERTED FOR BLACK_QUEEN_on_BLACK_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f300
     10  3300					      LIST	ON
      0  3300					      DEF	BLACK_QUEEN_on_BLACK_SQUARE_1
      1  3300				   BANK_BLACK_QUEEN_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  3300				   BLACK_QUEEN_on_BLACK_SQUARE_1
      3  3300				   TEMPORARY_VAR SET	Overlay
      4  3300				   TEMPORARY_OFFSET SET	0
      5  3300					      SUBROUTINE
      3  3300		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3318		       38 38 7c 7c*	      .byte.b	$38,$38,$7c,$7c,$54,$00,$54,$00,$38,$10,$78,$78,$50,$00,$54,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3330		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_QUEEN_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  3348					      include	"gfx/BLACK_QUEEN_on_BLACK_SQUARE_2.asm"
      0  3348					      OPTIONAL_PAGEBREAK	"BLACK_QUEEN_on_BLACK_SQUARE_2", 72
     10  3348					      LIST	ON
      0  3348					      DEF	BLACK_QUEEN_on_BLACK_SQUARE_2
      1  3348				   BANK_BLACK_QUEEN_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  3348				   BLACK_QUEEN_on_BLACK_SQUARE_2
      3  3348				   TEMPORARY_VAR SET	Overlay
      4  3348				   TEMPORARY_OFFSET SET	0
      5  3348					      SUBROUTINE
      3  3348		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3360		       01 01 03 03*	      .byte.b	$01,$01,$03,$03,$02,$00,$02,$00,$01,$00,$03,$03,$02,$00,$02,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3378		       03 03 07 07*	      .byte.b	$03,$03,$07,$07,$05,$00,$05,$00,$03,$01,$03,$03,$01,$00,$05,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_QUEEN_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  3390					      include	"gfx/BLACK_QUEEN_on_BLACK_SQUARE_3.asm"
      0  3390					      OPTIONAL_PAGEBREAK	"BLACK_QUEEN_on_BLACK_SQUARE_3", 72
     10  3390					      LIST	ON
      0  3390					      DEF	BLACK_QUEEN_on_BLACK_SQUARE_3
      1  3390				   BANK_BLACK_QUEEN_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  3390				   BLACK_QUEEN_on_BLACK_SQUARE_3
      3  3390				   TEMPORARY_VAR SET	Overlay
      4  3390				   TEMPORARY_OFFSET SET	0
      5  3390					      SUBROUTINE
      3  3390		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  33a8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  33c0		       70 70 f8 f8*	      .byte.b	$70,$70,$f8,$f8,$a8,$00,$a8,$00,$70,$20,$78,$78,$28,$00,$a8,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KING_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  33d8					      include	"gfx/BLACK_KING_on_BLACK_SQUARE_0.asm"
      0  33d8					      OPTIONAL_PAGEBREAK	"BLACK_KING_on_BLACK_SQUARE_0", 72
 PAGE BREAK INSERTED FOR BLACK_KING_on_BLACK_SQUARE_0
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f400
     10  3400					      LIST	ON
      0  3400					      DEF	BLACK_KING_on_BLACK_SQUARE_0
      1  3400				   BANK_BLACK_KING_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  3400				   BLACK_KING_on_BLACK_SQUARE_0
      3  3400				   TEMPORARY_VAR SET	Overlay
      4  3400				   TEMPORARY_OFFSET SET	0
      5  3400					      SUBROUTINE
      3  3400		       e0 f0 50 50*	      .byte.b	$e0,$f0,$50,$50,$f0,$40,$e0,$40,$e0,$60,$50,$50,$50,$40,$e0,$40,$00,$00,$a0,$00,$00,$b0,$00,$00	;PF0
      4  3418		       00 80 80 80*	      .byte.b	$00,$80,$80,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00	;PF1
      5  3430		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KING_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  3448					      include	"gfx/BLACK_KING_on_BLACK_SQUARE_1.asm"
      0  3448					      OPTIONAL_PAGEBREAK	"BLACK_KING_on_BLACK_SQUARE_1", 72
     10  3448					      LIST	ON
      0  3448					      DEF	BLACK_KING_on_BLACK_SQUARE_1
      1  3448				   BANK_BLACK_KING_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  3448				   BLACK_KING_on_BLACK_SQUARE_1
      3  3448				   TEMPORARY_VAR SET	Overlay
      4  3448				   TEMPORARY_OFFSET SET	0
      5  3448					      SUBROUTINE
      3  3448		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3460		       38 7c 54 54*	      .byte.b	$38,$7c,$54,$54,$7c,$10,$38,$10,$38,$30,$50,$50,$50,$10,$38,$10,$00,$00,$28,$00,$00,$6c,$00,$00	;PF1
      5  3478		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KING_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  3490					      include	"gfx/BLACK_KING_on_BLACK_SQUARE_2.asm"
      0  3490					      OPTIONAL_PAGEBREAK	"BLACK_KING_on_BLACK_SQUARE_2", 72
     10  3490					      LIST	ON
      0  3490					      DEF	BLACK_KING_on_BLACK_SQUARE_2
      1  3490				   BANK_BLACK_KING_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  3490				   BLACK_KING_on_BLACK_SQUARE_2
      3  3490				   TEMPORARY_VAR SET	Overlay
      4  3490				   TEMPORARY_OFFSET SET	0
      5  3490					      SUBROUTINE
      3  3490		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  34a8		       01 03 02 02*	      .byte.b	$01,$03,$02,$02,$03,$00,$01,$00,$01,$01,$02,$02,$02,$00,$01,$00,$00,$00,$01,$00,$00,$03,$00,$00	;PF1
      5  34c0		       03 07 05 05*	      .byte.b	$03,$07,$05,$05,$07,$01,$03,$01,$03,$01,$01,$01,$01,$01,$03,$01,$00,$00,$02,$00,$00,$06,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_KING_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  34d8					      include	"gfx/BLACK_KING_on_BLACK_SQUARE_3.asm"
      0  34d8					      OPTIONAL_PAGEBREAK	"BLACK_KING_on_BLACK_SQUARE_3", 72
 PAGE BREAK INSERTED FOR BLACK_KING_on_BLACK_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f500
     10  3500					      LIST	ON
      0  3500					      DEF	BLACK_KING_on_BLACK_SQUARE_3
      1  3500				   BANK_BLACK_KING_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  3500				   BLACK_KING_on_BLACK_SQUARE_3
      3  3500				   TEMPORARY_VAR SET	Overlay
      4  3500				   TEMPORARY_OFFSET SET	0
      5  3500					      SUBROUTINE
      3  3500		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3518		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3530		       70 f8 a8 a8*	      .byte.b	$70,$f8,$a8,$a8,$f8,$20,$70,$20,$70,$30,$28,$28,$28,$20,$70,$20,$00,$00,$50,$00,$00,$d8,$00,$00	;PF2
------- FILE piece_graphics.asm
    124  3548
------- FILE gfx/WHITE_MARKER_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  3548					      include	"gfx/WHITE_MARKER_on_BLACK_SQUARE_0.asm"
      0  3548					      OPTIONAL_PAGEBREAK	"WHITE_MARKER_on_BLACK_SQUARE_0", 72
     10  3548					      LIST	ON
      0  3548					      DEF	WHITE_MARKER_on_BLACK_SQUARE_0
      1  3548				   BANK_WHITE_MARKER_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  3548				   WHITE_MARKER_on_BLACK_SQUARE_0
      3  3548				   TEMPORARY_VAR SET	Overlay
      4  3548				   TEMPORARY_OFFSET SET	0
      5  3548					      SUBROUTINE
      3  3548		       00 00 00 40*	      .byte.b	$00,$00,$00,$40,$40,$00,$00,$00,$00,$00,$00,$40,$40,$00,$00,$00,$00,$00,$00,$40,$40,$00,$00,$00	;PF0
      4  3560		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3578		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_MARKER_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  3590					      include	"gfx/WHITE_MARKER_on_BLACK_SQUARE_1.asm"
      0  3590					      OPTIONAL_PAGEBREAK	"WHITE_MARKER_on_BLACK_SQUARE_1", 72
     10  3590					      LIST	ON
      0  3590					      DEF	WHITE_MARKER_on_BLACK_SQUARE_1
      1  3590				   BANK_WHITE_MARKER_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  3590				   WHITE_MARKER_on_BLACK_SQUARE_1
      3  3590				   TEMPORARY_VAR SET	Overlay
      4  3590				   TEMPORARY_OFFSET SET	0
      5  3590					      SUBROUTINE
      3  3590		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  35a8		       00 00 00 10*	      .byte.b	$00,$00,$00,$10,$10,$00,$00,$00,$00,$00,$00,$10,$10,$00,$00,$00,$00,$00,$00,$10,$10,$00,$00,$00	;PF1
      5  35c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_MARKER_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  35d8					      include	"gfx/WHITE_MARKER_on_BLACK_SQUARE_2.asm"
      0  35d8					      OPTIONAL_PAGEBREAK	"WHITE_MARKER_on_BLACK_SQUARE_2", 72
 PAGE BREAK INSERTED FOR WHITE_MARKER_on_BLACK_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f600
     10  3600					      LIST	ON
      0  3600					      DEF	WHITE_MARKER_on_BLACK_SQUARE_2
      1  3600				   BANK_WHITE_MARKER_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  3600				   WHITE_MARKER_on_BLACK_SQUARE_2
      3  3600				   TEMPORARY_VAR SET	Overlay
      4  3600				   TEMPORARY_OFFSET SET	0
      5  3600					      SUBROUTINE
      3  3600		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3618		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3630		       00 00 00 01*	      .byte.b	$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$01,$01,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_MARKER_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  3648					      include	"gfx/WHITE_MARKER_on_BLACK_SQUARE_3.asm"
      0  3648					      OPTIONAL_PAGEBREAK	"WHITE_MARKER_on_BLACK_SQUARE_3", 72
     10  3648					      LIST	ON
      0  3648					      DEF	WHITE_MARKER_on_BLACK_SQUARE_3
      1  3648				   BANK_WHITE_MARKER_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  3648				   WHITE_MARKER_on_BLACK_SQUARE_3
      3  3648				   TEMPORARY_VAR SET	Overlay
      4  3648				   TEMPORARY_OFFSET SET	0
      5  3648					      SUBROUTINE
      3  3648		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3660		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3678		       00 00 00 20*	      .byte.b	$00,$00,$00,$20,$20,$00,$00,$00,$00,$00,$00,$20,$20,$00,$00,$00,$00,$00,$00,$20,$20,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_MARKER_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  3690					      include	"gfx/WHITE_MARKER_on_WHITE_SQUARE_0.asm"
      0  3690					      OPTIONAL_PAGEBREAK	"WHITE_MARKER_on_WHITE_SQUARE_0", 72
     10  3690					      LIST	ON
      0  3690					      DEF	WHITE_MARKER_on_WHITE_SQUARE_0
      1  3690				   BANK_WHITE_MARKER_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  3690				   WHITE_MARKER_on_WHITE_SQUARE_0
      3  3690				   TEMPORARY_VAR SET	Overlay
      4  3690				   TEMPORARY_OFFSET SET	0
      5  3690					      SUBROUTINE
      3  3690		       00 00 00 40*	      .byte.b	$00,$00,$00,$40,$40,$00,$00,$00,$00,$00,$00,$40,$40,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  36a8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  36c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_MARKER_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  36d8					      include	"gfx/WHITE_MARKER_on_WHITE_SQUARE_1.asm"
      0  36d8					      OPTIONAL_PAGEBREAK	"WHITE_MARKER_on_WHITE_SQUARE_1", 72
 PAGE BREAK INSERTED FOR WHITE_MARKER_on_WHITE_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f700
     10  3700					      LIST	ON
      0  3700					      DEF	WHITE_MARKER_on_WHITE_SQUARE_1
      1  3700				   BANK_WHITE_MARKER_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  3700				   WHITE_MARKER_on_WHITE_SQUARE_1
      3  3700				   TEMPORARY_VAR SET	Overlay
      4  3700				   TEMPORARY_OFFSET SET	0
      5  3700					      SUBROUTINE
      3  3700		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3718		       00 00 00 10*	      .byte.b	$00,$00,$00,$10,$10,$00,$00,$00,$00,$00,$00,$10,$10,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3730		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_MARKER_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  3748					      include	"gfx/WHITE_MARKER_on_WHITE_SQUARE_2.asm"
      0  3748					      OPTIONAL_PAGEBREAK	"WHITE_MARKER_on_WHITE_SQUARE_2", 72
     10  3748					      LIST	ON
      0  3748					      DEF	WHITE_MARKER_on_WHITE_SQUARE_2
      1  3748				   BANK_WHITE_MARKER_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  3748				   WHITE_MARKER_on_WHITE_SQUARE_2
      3  3748				   TEMPORARY_VAR SET	Overlay
      4  3748				   TEMPORARY_OFFSET SET	0
      5  3748					      SUBROUTINE
      3  3748		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3760		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3778		       00 00 00 01*	      .byte.b	$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_MARKER_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  3790					      include	"gfx/WHITE_MARKER_on_WHITE_SQUARE_3.asm"
      0  3790					      OPTIONAL_PAGEBREAK	"WHITE_MARKER_on_WHITE_SQUARE_3", 72
     10  3790					      LIST	ON
      0  3790					      DEF	WHITE_MARKER_on_WHITE_SQUARE_3
      1  3790				   BANK_WHITE_MARKER_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  3790				   WHITE_MARKER_on_WHITE_SQUARE_3
      3  3790				   TEMPORARY_VAR SET	Overlay
      4  3790				   TEMPORARY_OFFSET SET	0
      5  3790					      SUBROUTINE
      3  3790		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  37a8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  37c0		       00 00 00 20*	      .byte.b	$00,$00,$00,$20,$20,$00,$00,$00,$00,$00,$00,$20,$20,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
      0  37d8					      CHECK_BANK_SIZE	"PIECES_4 (2K)"
      1  37d8		       07 d8	   .TEMP      =	* - BANK_START
 PIECES_4 (2K) (2K) SIZE =  $7d8 , FREE= $28
      2  37d8					      ECHO	"PIECES_4 (2K)", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  37d8				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  37d8				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  37d8				  -	      ERR
      6  37d8					      endif
    134  37d8
      0  37d8					      NEWBANK	PIECES_5
      1  3fd8 ????				      SEG	PIECES_5
      2  3800					      ORG	ORIGIN
      3  3800					      RORG	$F000
      4  3800				   BANK_START SET	*
      5  3800				   PIECES_5   SET	ORIGIN / 2048
      6  3800				   ORIGIN     SET	ORIGIN + 2048
      7  3800				   _CURRENT_BANK SET	PIECES_5
------- FILE gfx/BLACK_MARKER_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  3800					      include	"gfx/BLACK_MARKER_on_BLACK_SQUARE_0.asm"
      0  3800					      OPTIONAL_PAGEBREAK	"BLACK_MARKER_on_BLACK_SQUARE_0", 72
     10  3800					      LIST	ON
      0  3800					      DEF	BLACK_MARKER_on_BLACK_SQUARE_0
      1  3800				   BANK_BLACK_MARKER_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  3800				   BLACK_MARKER_on_BLACK_SQUARE_0
      3  3800				   TEMPORARY_VAR SET	Overlay
      4  3800				   TEMPORARY_OFFSET SET	0
      5  3800					      SUBROUTINE
      3  3800		       00 10 20 40*	      .byte.b	$00,$10,$20,$40,$40,$80,$00,$00,$00,$10,$20,$40,$40,$80,$00,$00,$00,$10,$20,$40,$40,$80,$00,$00	;PF0
      4  3818		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00	;PF1
      5  3830		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_MARKER_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  3848					      include	"gfx/BLACK_MARKER_on_BLACK_SQUARE_1.asm"
      0  3848					      OPTIONAL_PAGEBREAK	"BLACK_MARKER_on_BLACK_SQUARE_1", 72
     10  3848					      LIST	ON
      0  3848					      DEF	BLACK_MARKER_on_BLACK_SQUARE_1
      1  3848				   BANK_BLACK_MARKER_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  3848				   BLACK_MARKER_on_BLACK_SQUARE_1
      3  3848				   TEMPORARY_VAR SET	Overlay
      4  3848				   TEMPORARY_OFFSET SET	0
      5  3848					      SUBROUTINE
      3  3848		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3860		       00 40 20 10*	      .byte.b	$00,$40,$20,$10,$10,$08,$04,$00,$00,$40,$20,$10,$10,$08,$04,$00,$00,$40,$20,$10,$10,$08,$04,$00	;PF1
      5  3878		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_MARKER_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  3890					      include	"gfx/BLACK_MARKER_on_BLACK_SQUARE_2.asm"
      0  3890					      OPTIONAL_PAGEBREAK	"BLACK_MARKER_on_BLACK_SQUARE_2", 72
     10  3890					      LIST	ON
      0  3890					      DEF	BLACK_MARKER_on_BLACK_SQUARE_2
      1  3890				   BANK_BLACK_MARKER_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  3890				   BLACK_MARKER_on_BLACK_SQUARE_2
      3  3890				   TEMPORARY_VAR SET	Overlay
      4  3890				   TEMPORARY_OFFSET SET	0
      5  3890					      SUBROUTINE
      3  3890		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  38a8		       00 02 01 00*	      .byte.b	$00,$02,$01,$00,$00,$00,$00,$00,$00,$02,$01,$00,$00,$00,$00,$00,$00,$02,$01,$00,$00,$00,$00,$00	;PF1
      5  38c0		       00 00 00 01*	      .byte.b	$00,$00,$00,$01,$01,$02,$04,$00,$00,$00,$00,$01,$01,$02,$04,$00,$00,$00,$00,$01,$01,$02,$04,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_MARKER_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  38d8					      include	"gfx/BLACK_MARKER_on_BLACK_SQUARE_3.asm"
      0  38d8					      OPTIONAL_PAGEBREAK	"BLACK_MARKER_on_BLACK_SQUARE_3", 72
 PAGE BREAK INSERTED FOR BLACK_MARKER_on_BLACK_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f100
     10  3900					      LIST	ON
      0  3900					      DEF	BLACK_MARKER_on_BLACK_SQUARE_3
      1  3900				   BANK_BLACK_MARKER_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  3900				   BLACK_MARKER_on_BLACK_SQUARE_3
      3  3900				   TEMPORARY_VAR SET	Overlay
      4  3900				   TEMPORARY_OFFSET SET	0
      5  3900					      SUBROUTINE
      3  3900		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3918		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3930		       00 08 10 20*	      .byte.b	$00,$08,$10,$20,$20,$40,$80,$00,$00,$08,$10,$20,$20,$40,$80,$00,$00,$08,$10,$20,$20,$40,$80,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_MARKER_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  3948					      include	"gfx/BLACK_MARKER_on_WHITE_SQUARE_0.asm"
      0  3948					      OPTIONAL_PAGEBREAK	"BLACK_MARKER_on_WHITE_SQUARE_0", 72
     10  3948					      LIST	ON
      0  3948					      DEF	BLACK_MARKER_on_WHITE_SQUARE_0
      1  3948				   BANK_BLACK_MARKER_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  3948				   BLACK_MARKER_on_WHITE_SQUARE_0
      3  3948				   TEMPORARY_VAR SET	Overlay
      4  3948				   TEMPORARY_OFFSET SET	0
      5  3948					      SUBROUTINE
      3  3948		       10 20 20 40*	      .byte.b	$10,$20,$20,$40,$40,$80,$80,$00,$10,$20,$20,$40,$40,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3960		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$80,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3978		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_MARKER_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  3990					      include	"gfx/BLACK_MARKER_on_WHITE_SQUARE_1.asm"
      0  3990					      OPTIONAL_PAGEBREAK	"BLACK_MARKER_on_WHITE_SQUARE_1", 72
     10  3990					      LIST	ON
      0  3990					      DEF	BLACK_MARKER_on_WHITE_SQUARE_1
      1  3990				   BANK_BLACK_MARKER_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  3990				   BLACK_MARKER_on_WHITE_SQUARE_1
      3  3990				   TEMPORARY_VAR SET	Overlay
      4  3990				   TEMPORARY_OFFSET SET	0
      5  3990					      SUBROUTINE
      3  3990		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  39a8		       40 20 20 10*	      .byte.b	$40,$20,$20,$10,$10,$08,$08,$04,$40,$20,$20,$10,$10,$08,$08,$04,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  39c0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_MARKER_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  39d8					      include	"gfx/BLACK_MARKER_on_WHITE_SQUARE_2.asm"
      0  39d8					      OPTIONAL_PAGEBREAK	"BLACK_MARKER_on_WHITE_SQUARE_2", 72
 PAGE BREAK INSERTED FOR BLACK_MARKER_on_WHITE_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f200
     10  3a00					      LIST	ON
      0  3a00					      DEF	BLACK_MARKER_on_WHITE_SQUARE_2
      1  3a00				   BANK_BLACK_MARKER_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  3a00				   BLACK_MARKER_on_WHITE_SQUARE_2
      3  3a00				   TEMPORARY_VAR SET	Overlay
      4  3a00				   TEMPORARY_OFFSET SET	0
      5  3a00					      SUBROUTINE
      3  3a00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3a18		       02 01 01 00*	      .byte.b	$02,$01,$01,$00,$00,$00,$00,$00,$02,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3a30		       00 00 00 01*	      .byte.b	$00,$00,$00,$01,$01,$02,$02,$04,$00,$00,$00,$01,$01,$02,$02,$04,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_MARKER_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  3a48					      include	"gfx/BLACK_MARKER_on_WHITE_SQUARE_3.asm"
      0  3a48					      OPTIONAL_PAGEBREAK	"BLACK_MARKER_on_WHITE_SQUARE_3", 72
     10  3a48					      LIST	ON
      0  3a48					      DEF	BLACK_MARKER_on_WHITE_SQUARE_3
      1  3a48				   BANK_BLACK_MARKER_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  3a48				   BLACK_MARKER_on_WHITE_SQUARE_3
      3  3a48				   TEMPORARY_VAR SET	Overlay
      4  3a48				   TEMPORARY_OFFSET SET	0
      5  3a48					      SUBROUTINE
      3  3a48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3a60		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3a78		       08 10 10 20*	      .byte.b	$08,$10,$10,$20,$20,$40,$40,$80,$08,$10,$10,$20,$20,$40,$40,$80,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
    144  3a90
------- FILE gfx/WHITE_PROMOTE_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  3a90					      include	"gfx/WHITE_PROMOTE_on_BLACK_SQUARE_0.asm"
      0  3a90					      OPTIONAL_PAGEBREAK	"WHITE_PROMOTE_on_BLACK_SQUARE_0", 72
     10  3a90					      LIST	ON
      0  3a90					      DEF	WHITE_PROMOTE_on_BLACK_SQUARE_0
      1  3a90				   BANK_WHITE_PROMOTE_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  3a90				   WHITE_PROMOTE_on_BLACK_SQUARE_0
      3  3a90				   TEMPORARY_VAR SET	Overlay
      4  3a90				   TEMPORARY_OFFSET SET	0
      5  3a90					      SUBROUTINE
      3  3a90		       40 00 40 c0*	      .byte.b	$40,$00,$40,$c0,$80,$a0,$e0,$40,$40,$00,$40,$c0,$80,$a0,$e0,$40,$40,$00,$40,$c0,$80,$a0,$e0,$40	;PF0
      4  3aa8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3ac0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PROMOTE_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  3ad8					      include	"gfx/WHITE_PROMOTE_on_BLACK_SQUARE_1.asm"
      0  3ad8					      OPTIONAL_PAGEBREAK	"WHITE_PROMOTE_on_BLACK_SQUARE_1", 72
 PAGE BREAK INSERTED FOR WHITE_PROMOTE_on_BLACK_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f300
     10  3b00					      LIST	ON
      0  3b00					      DEF	WHITE_PROMOTE_on_BLACK_SQUARE_1
      1  3b00				   BANK_WHITE_PROMOTE_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  3b00				   WHITE_PROMOTE_on_BLACK_SQUARE_1
      3  3b00				   TEMPORARY_VAR SET	Overlay
      4  3b00				   TEMPORARY_OFFSET SET	0
      5  3b00					      SUBROUTINE
      3  3b00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3b18		       10 00 10 18*	      .byte.b	$10,$00,$10,$18,$08,$28,$38,$10,$10,$00,$10,$18,$08,$28,$38,$10,$10,$00,$10,$18,$08,$28,$38,$10	;PF1
      5  3b30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PROMOTE_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  3b48					      include	"gfx/WHITE_PROMOTE_on_BLACK_SQUARE_2.asm"
      0  3b48					      OPTIONAL_PAGEBREAK	"WHITE_PROMOTE_on_BLACK_SQUARE_2", 72
     10  3b48					      LIST	ON
      0  3b48					      DEF	WHITE_PROMOTE_on_BLACK_SQUARE_2
      1  3b48				   BANK_WHITE_PROMOTE_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  3b48				   WHITE_PROMOTE_on_BLACK_SQUARE_2
      3  3b48				   TEMPORARY_VAR SET	Overlay
      4  3b48				   TEMPORARY_OFFSET SET	0
      5  3b48					      SUBROUTINE
      3  3b48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3b60		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$01,$01,$00	;PF1
      5  3b78		       01 00 01 03*	      .byte.b	$01,$00,$01,$03,$02,$02,$03,$01,$01,$00,$01,$03,$02,$02,$03,$01,$01,$00,$01,$03,$02,$02,$03,$01	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PROMOTE_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  3b90					      include	"gfx/WHITE_PROMOTE_on_BLACK_SQUARE_3.asm"
      0  3b90					      OPTIONAL_PAGEBREAK	"WHITE_PROMOTE_on_BLACK_SQUARE_3", 72
     10  3b90					      LIST	ON
      0  3b90					      DEF	WHITE_PROMOTE_on_BLACK_SQUARE_3
      1  3b90				   BANK_WHITE_PROMOTE_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  3b90				   WHITE_PROMOTE_on_BLACK_SQUARE_3
      3  3b90				   TEMPORARY_VAR SET	Overlay
      4  3b90				   TEMPORARY_OFFSET SET	0
      5  3b90					      SUBROUTINE
      3  3b90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3ba8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3bc0		       20 00 20 60*	      .byte.b	$20,$00,$20,$60,$40,$50,$70,$20,$20,$00,$20,$60,$40,$50,$70,$20,$20,$00,$20,$60,$40,$50,$70,$20	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PROMOTE_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  3bd8					      include	"gfx/WHITE_PROMOTE_on_WHITE_SQUARE_0.asm"
      0  3bd8					      OPTIONAL_PAGEBREAK	"WHITE_PROMOTE_on_WHITE_SQUARE_0", 72
 PAGE BREAK INSERTED FOR WHITE_PROMOTE_on_WHITE_SQUARE_0
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f400
     10  3c00					      LIST	ON
      0  3c00					      DEF	WHITE_PROMOTE_on_WHITE_SQUARE_0
      1  3c00				   BANK_WHITE_PROMOTE_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  3c00				   WHITE_PROMOTE_on_WHITE_SQUARE_0
      3  3c00				   TEMPORARY_VAR SET	Overlay
      4  3c00				   TEMPORARY_OFFSET SET	0
      5  3c00					      SUBROUTINE
      3  3c00		       40 00 40 c0*	      .byte.b	$40,$00,$40,$c0,$80,$a0,$e0,$40,$40,$00,$40,$c0,$80,$a0,$e0,$40,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3c18		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3c30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PROMOTE_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  3c48					      include	"gfx/WHITE_PROMOTE_on_WHITE_SQUARE_1.asm"
      0  3c48					      OPTIONAL_PAGEBREAK	"WHITE_PROMOTE_on_WHITE_SQUARE_1", 72
     10  3c48					      LIST	ON
      0  3c48					      DEF	WHITE_PROMOTE_on_WHITE_SQUARE_1
      1  3c48				   BANK_WHITE_PROMOTE_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  3c48				   WHITE_PROMOTE_on_WHITE_SQUARE_1
      3  3c48				   TEMPORARY_VAR SET	Overlay
      4  3c48				   TEMPORARY_OFFSET SET	0
      5  3c48					      SUBROUTINE
      3  3c48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3c60		       10 00 10 18*	      .byte.b	$10,$00,$10,$18,$08,$28,$38,$10,$10,$00,$10,$18,$08,$28,$38,$10,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3c78		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PROMOTE_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  3c90					      include	"gfx/WHITE_PROMOTE_on_WHITE_SQUARE_2.asm"
      0  3c90					      OPTIONAL_PAGEBREAK	"WHITE_PROMOTE_on_WHITE_SQUARE_2", 72
     10  3c90					      LIST	ON
      0  3c90					      DEF	WHITE_PROMOTE_on_WHITE_SQUARE_2
      1  3c90				   BANK_WHITE_PROMOTE_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  3c90				   WHITE_PROMOTE_on_WHITE_SQUARE_2
      3  3c90				   TEMPORARY_VAR SET	Overlay
      4  3c90				   TEMPORARY_OFFSET SET	0
      5  3c90					      SUBROUTINE
      3  3c90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3ca8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$01,$01,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3cc0		       01 00 01 03*	      .byte.b	$01,$00,$01,$03,$02,$02,$03,$01,$01,$00,$01,$03,$02,$02,$03,$01,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/WHITE_PROMOTE_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  3cd8					      include	"gfx/WHITE_PROMOTE_on_WHITE_SQUARE_3.asm"
      0  3cd8					      OPTIONAL_PAGEBREAK	"WHITE_PROMOTE_on_WHITE_SQUARE_3", 72
 PAGE BREAK INSERTED FOR WHITE_PROMOTE_on_WHITE_SQUARE_3
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f500
     10  3d00					      LIST	ON
      0  3d00					      DEF	WHITE_PROMOTE_on_WHITE_SQUARE_3
      1  3d00				   BANK_WHITE_PROMOTE_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  3d00				   WHITE_PROMOTE_on_WHITE_SQUARE_3
      3  3d00				   TEMPORARY_VAR SET	Overlay
      4  3d00				   TEMPORARY_OFFSET SET	0
      5  3d00					      SUBROUTINE
      3  3d00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3d18		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3d30		       20 00 20 60*	      .byte.b	$20,$00,$20,$60,$40,$50,$70,$20,$20,$00,$20,$60,$40,$50,$70,$20,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
    153  3d48
------- FILE gfx/BLACK_PROMOTE_on_BLACK_SQUARE_0.asm LEVEL 4 PASS 2
      0  3d48					      include	"gfx/BLACK_PROMOTE_on_BLACK_SQUARE_0.asm"
      0  3d48					      OPTIONAL_PAGEBREAK	"BLACK_PROMOTE_on_BLACK_SQUARE_0", 72
     10  3d48					      LIST	ON
      0  3d48					      DEF	BLACK_PROMOTE_on_BLACK_SQUARE_0
      1  3d48				   BANK_BLACK_PROMOTE_on_BLACK_SQUARE_0 SET	_CURRENT_BANK
      2  3d48				   BLACK_PROMOTE_on_BLACK_SQUARE_0
      3  3d48				   TEMPORARY_VAR SET	Overlay
      4  3d48				   TEMPORARY_OFFSET SET	0
      5  3d48					      SUBROUTINE
      3  3d48		       50 10 50 d0*	      .byte.b	$50,$10,$50,$d0,$90,$b0,$f0,$50,$50,$10,$50,$d0,$90,$b0,$f0,$50,$50,$10,$50,$d0,$90,$b0,$f0,$50	;PF0
      4  3d60		       80 80 80 80*	      .byte.b	$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80	;PF1
      5  3d78		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PROMOTE_on_BLACK_SQUARE_1.asm LEVEL 4 PASS 2
      0  3d90					      include	"gfx/BLACK_PROMOTE_on_BLACK_SQUARE_1.asm"
      0  3d90					      OPTIONAL_PAGEBREAK	"BLACK_PROMOTE_on_BLACK_SQUARE_1", 72
     10  3d90					      LIST	ON
      0  3d90					      DEF	BLACK_PROMOTE_on_BLACK_SQUARE_1
      1  3d90				   BANK_BLACK_PROMOTE_on_BLACK_SQUARE_1 SET	_CURRENT_BANK
      2  3d90				   BLACK_PROMOTE_on_BLACK_SQUARE_1
      3  3d90				   TEMPORARY_VAR SET	Overlay
      4  3d90				   TEMPORARY_OFFSET SET	0
      5  3d90					      SUBROUTINE
      3  3d90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3da8		       54 44 54 5c*	      .byte.b	$54,$44,$54,$5c,$4c,$6c,$7c,$54,$54,$44,$54,$5c,$4c,$6c,$7c,$54,$54,$44,$54,$5c,$4c,$6c,$7c,$54	;PF1
      5  3dc0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PROMOTE_on_BLACK_SQUARE_2.asm LEVEL 4 PASS 2
      0  3dd8					      include	"gfx/BLACK_PROMOTE_on_BLACK_SQUARE_2.asm"
      0  3dd8					      OPTIONAL_PAGEBREAK	"BLACK_PROMOTE_on_BLACK_SQUARE_2", 72
 PAGE BREAK INSERTED FOR BLACK_PROMOTE_on_BLACK_SQUARE_2
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f600
     10  3e00					      LIST	ON
      0  3e00					      DEF	BLACK_PROMOTE_on_BLACK_SQUARE_2
      1  3e00				   BANK_BLACK_PROMOTE_on_BLACK_SQUARE_2 SET	_CURRENT_BANK
      2  3e00				   BLACK_PROMOTE_on_BLACK_SQUARE_2
      3  3e00				   TEMPORARY_VAR SET	Overlay
      4  3e00				   TEMPORARY_OFFSET SET	0
      5  3e00					      SUBROUTINE
      3  3e00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3e18		       02 02 02 02*	      .byte.b	$02,$02,$02,$02,$02,$03,$03,$02,$02,$02,$02,$02,$02,$03,$03,$02,$02,$02,$02,$02,$02,$03,$03,$02	;PF1
      5  3e30		       05 04 05 07*	      .byte.b	$05,$04,$05,$07,$06,$06,$07,$05,$05,$04,$05,$07,$06,$06,$07,$05,$05,$04,$05,$07,$06,$06,$07,$05	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PROMOTE_on_BLACK_SQUARE_3.asm LEVEL 4 PASS 2
      0  3e48					      include	"gfx/BLACK_PROMOTE_on_BLACK_SQUARE_3.asm"
      0  3e48					      OPTIONAL_PAGEBREAK	"BLACK_PROMOTE_on_BLACK_SQUARE_3", 72
     10  3e48					      LIST	ON
      0  3e48					      DEF	BLACK_PROMOTE_on_BLACK_SQUARE_3
      1  3e48				   BANK_BLACK_PROMOTE_on_BLACK_SQUARE_3 SET	_CURRENT_BANK
      2  3e48				   BLACK_PROMOTE_on_BLACK_SQUARE_3
      3  3e48				   TEMPORARY_VAR SET	Overlay
      4  3e48				   TEMPORARY_OFFSET SET	0
      5  3e48					      SUBROUTINE
      3  3e48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3e60		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3e78		       a8 88 a8 e8*	      .byte.b	$a8,$88,$a8,$e8,$c8,$d8,$f8,$a8,$a8,$88,$a8,$e8,$c8,$d8,$f8,$a8,$a8,$88,$a8,$e8,$c8,$d8,$f8,$a8	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PROMOTE_on_WHITE_SQUARE_0.asm LEVEL 4 PASS 2
      0  3e90					      include	"gfx/BLACK_PROMOTE_on_WHITE_SQUARE_0.asm"
      0  3e90					      OPTIONAL_PAGEBREAK	"BLACK_PROMOTE_on_WHITE_SQUARE_0", 72
     10  3e90					      LIST	ON
      0  3e90					      DEF	BLACK_PROMOTE_on_WHITE_SQUARE_0
      1  3e90				   BANK_BLACK_PROMOTE_on_WHITE_SQUARE_0 SET	_CURRENT_BANK
      2  3e90				   BLACK_PROMOTE_on_WHITE_SQUARE_0
      3  3e90				   TEMPORARY_VAR SET	Overlay
      4  3e90				   TEMPORARY_OFFSET SET	0
      5  3e90					      SUBROUTINE
      3  3e90		       50 10 50 d0*	      .byte.b	$50,$10,$50,$d0,$90,$b0,$f0,$50,$50,$10,$50,$d0,$90,$b0,$f0,$50,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3ea8		       80 80 80 80*	      .byte.b	$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$80,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3ec0		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PROMOTE_on_WHITE_SQUARE_1.asm LEVEL 4 PASS 2
      0  3ed8					      include	"gfx/BLACK_PROMOTE_on_WHITE_SQUARE_1.asm"
      0  3ed8					      OPTIONAL_PAGEBREAK	"BLACK_PROMOTE_on_WHITE_SQUARE_1", 72
 PAGE BREAK INSERTED FOR BLACK_PROMOTE_on_WHITE_SQUARE_1
 REQUESTED SIZE = $48
 WASTED SPACE = $28
 PAGEBREAK LOCATION = $f700
     10  3f00					      LIST	ON
      0  3f00					      DEF	BLACK_PROMOTE_on_WHITE_SQUARE_1
      1  3f00				   BANK_BLACK_PROMOTE_on_WHITE_SQUARE_1 SET	_CURRENT_BANK
      2  3f00				   BLACK_PROMOTE_on_WHITE_SQUARE_1
      3  3f00				   TEMPORARY_VAR SET	Overlay
      4  3f00				   TEMPORARY_OFFSET SET	0
      5  3f00					      SUBROUTINE
      3  3f00		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3f18		       54 44 54 5c*	      .byte.b	$54,$44,$54,$5c,$4c,$6c,$7c,$54,$54,$44,$54,$5c,$4c,$6c,$7c,$54,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3f30		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PROMOTE_on_WHITE_SQUARE_2.asm LEVEL 4 PASS 2
      0  3f48					      include	"gfx/BLACK_PROMOTE_on_WHITE_SQUARE_2.asm"
      0  3f48					      OPTIONAL_PAGEBREAK	"BLACK_PROMOTE_on_WHITE_SQUARE_2", 72
     10  3f48					      LIST	ON
      0  3f48					      DEF	BLACK_PROMOTE_on_WHITE_SQUARE_2
      1  3f48				   BANK_BLACK_PROMOTE_on_WHITE_SQUARE_2 SET	_CURRENT_BANK
      2  3f48				   BLACK_PROMOTE_on_WHITE_SQUARE_2
      3  3f48				   TEMPORARY_VAR SET	Overlay
      4  3f48				   TEMPORARY_OFFSET SET	0
      5  3f48					      SUBROUTINE
      3  3f48		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3f60		       02 02 02 02*	      .byte.b	$02,$02,$02,$02,$02,$03,$03,$02,$02,$02,$02,$02,$02,$03,$03,$02,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3f78		       05 04 05 07*	      .byte.b	$05,$04,$05,$07,$06,$06,$07,$05,$05,$04,$05,$07,$06,$06,$07,$05,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
------- FILE gfx/BLACK_PROMOTE_on_WHITE_SQUARE_3.asm LEVEL 4 PASS 2
      0  3f90					      include	"gfx/BLACK_PROMOTE_on_WHITE_SQUARE_3.asm"
      0  3f90					      OPTIONAL_PAGEBREAK	"BLACK_PROMOTE_on_WHITE_SQUARE_3", 72
     10  3f90					      LIST	ON
      0  3f90					      DEF	BLACK_PROMOTE_on_WHITE_SQUARE_3
      1  3f90				   BANK_BLACK_PROMOTE_on_WHITE_SQUARE_3 SET	_CURRENT_BANK
      2  3f90				   BLACK_PROMOTE_on_WHITE_SQUARE_3
      3  3f90				   TEMPORARY_VAR SET	Overlay
      4  3f90				   TEMPORARY_OFFSET SET	0
      5  3f90					      SUBROUTINE
      3  3f90		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF0
      4  3fa8		       00 00 00 00*	      .byte.b	$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00	;PF1
      5  3fc0		       a8 88 a8 e8*	      .byte.b	$a8,$88,$a8,$e8,$c8,$d8,$f8,$a8,$a8,$88,$a8,$e8,$c8,$d8,$f8,$a8,$00,$00,$00,$00,$00,$00,$00,$00	;PF2
------- FILE piece_graphics.asm
    162  3fd8
    163  3fd8
    164  3fd8				  -	      if	0
    165  3fd8				  -	      include	"gfx/WHITE_MARKED_BLANK_on_WHITE_SQUARE_0.asm"
    166  3fd8				  -	      include	"gfx/WHITE_MARKED_BLANK_on_WHITE_SQUARE_1.asm"
    167  3fd8				  -	      include	"gfx/WHITE_MARKED_BLANK_on_WHITE_SQUARE_2.asm"
    168  3fd8				  -	      include	"gfx/WHITE_MARKED_BLANK_on_WHITE_SQUARE_3.asm"
    169  3fd8				  -	      include	"gfx/WHITE_MARKED_PAWN_on_WHITE_SQUARE_0.asm"
    170  3fd8				  -	      include	"gfx/WHITE_MARKED_PAWN_on_WHITE_SQUARE_1.asm"
    171  3fd8				  -	      include	"gfx/WHITE_MARKED_PAWN_on_WHITE_SQUARE_2.asm"
    172  3fd8				  -	      include	"gfx/WHITE_MARKED_PAWN_on_WHITE_SQUARE_3.asm"
    173  3fd8				  -	      include	"gfx/WHITE_MARKED_KNIGHT_on_WHITE_SQUARE_0.asm"
    174  3fd8				  -	      include	"gfx/WHITE_MARKED_KNIGHT_on_WHITE_SQUARE_1.asm"
    175  3fd8				  -	      include	"gfx/WHITE_MARKED_KNIGHT_on_WHITE_SQUARE_2.asm"
    176  3fd8				  -	      include	"gfx/WHITE_MARKED_KNIGHT_on_WHITE_SQUARE_3.asm"
    177  3fd8				  -	      include	"gfx/WHITE_MARKED_BISHOP_on_WHITE_SQUARE_0.asm"
    178  3fd8				  -	      include	"gfx/WHITE_MARKED_BISHOP_on_WHITE_SQUARE_1.asm"
    179  3fd8				  -	      include	"gfx/WHITE_MARKED_BISHOP_on_WHITE_SQUARE_2.asm"
    180  3fd8				  -	      include	"gfx/WHITE_MARKED_BISHOP_on_WHITE_SQUARE_3.asm"
    181  3fd8					      endif
      0  3fd8					      CHECK_BANK_SIZE	"PIECES_5 (2K)"
      1  3fd8		       07 d8	   .TEMP      =	* - BANK_START
 PIECES_5 (2K) (2K) SIZE =  $7d8 , FREE= $28
      2  3fd8					      ECHO	"PIECES_5 (2K)", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  3fd8				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  3fd8				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  3fd8				  -	      ERR
      6  3fd8					      endif
    183  3fd8
    184  3fd8				  -	      if	0
    185  3fd8				  -	      NEWBANK	PIECES_6
    186  3fd8				  -	      include	"gfx/WHITE_MARKED_ROOK_on_WHITE_SQUARE_0.asm"
    187  3fd8				  -	      include	"gfx/WHITE_MARKED_ROOK_on_WHITE_SQUARE_1.asm"
    188  3fd8				  -	      include	"gfx/WHITE_MARKED_ROOK_on_WHITE_SQUARE_2.asm"
    189  3fd8				  -	      include	"gfx/WHITE_MARKED_ROOK_on_WHITE_SQUARE_3.asm"
    190  3fd8				  -	      include	"gfx/WHITE_MARKED_QUEEN_on_WHITE_SQUARE_0.asm"
    191  3fd8				  -	      include	"gfx/WHITE_MARKED_QUEEN_on_WHITE_SQUARE_1.asm"
    192  3fd8				  -	      include	"gfx/WHITE_MARKED_QUEEN_on_WHITE_SQUARE_2.asm"
    193  3fd8				  -	      include	"gfx/WHITE_MARKED_QUEEN_on_WHITE_SQUARE_3.asm"
    194  3fd8				  -
    195  3fd8				  -	      include	"gfx/WHITE_MARKED_KING_on_WHITE_SQUARE_0.asm"
    196  3fd8				  -	      include	"gfx/WHITE_MARKED_KING_on_WHITE_SQUARE_1.asm"
    197  3fd8				  -	      include	"gfx/WHITE_MARKED_KING_on_WHITE_SQUARE_2.asm"
    198  3fd8				  -	      include	"gfx/WHITE_MARKED_KING_on_WHITE_SQUARE_3.asm"
    199  3fd8				  -	      include	"gfx/WHITE_MARKED_BLANK_on_BLACK_SQUARE_0.asm"
    200  3fd8				  -	      include	"gfx/WHITE_MARKED_BLANK_on_BLACK_SQUARE_1.asm"
    201  3fd8				  -	      include	"gfx/WHITE_MARKED_BLANK_on_BLACK_SQUARE_2.asm"
    202  3fd8				  -	      include	"gfx/WHITE_MARKED_BLANK_on_BLACK_SQUARE_3.asm"
    203  3fd8				  -	      include	"gfx/WHITE_MARKED_PAWN_on_BLACK_SQUARE_0.asm"
    204  3fd8				  -	      include	"gfx/WHITE_MARKED_PAWN_on_BLACK_SQUARE_1.asm"
    205  3fd8				  -
    206  3fd8				  -	      include	"gfx/WHITE_MARKED_PAWN_on_BLACK_SQUARE_2.asm"
    207  3fd8				  -	      include	"gfx/WHITE_MARKED_PAWN_on_BLACK_SQUARE_3.asm"
    208  3fd8				  -	      include	"gfx/WHITE_MARKED_KNIGHT_on_BLACK_SQUARE_0.asm"
    209  3fd8				  -	      include	"gfx/WHITE_MARKED_KNIGHT_on_BLACK_SQUARE_1.asm"
    210  3fd8				  -	      include	"gfx/WHITE_MARKED_KNIGHT_on_BLACK_SQUARE_2.asm"
    211  3fd8				  -	      include	"gfx/WHITE_MARKED_KNIGHT_on_BLACK_SQUARE_3.asm"
    212  3fd8				  -	      CHECK_BANK_SIZE	"PIECES_6 (2K)"
    213  3fd8				  -
    214  3fd8				  -
    215  3fd8				  -	      NEWBANK	PIECES_7
    216  3fd8				  -	      include	"gfx/WHITE_MARKED_BISHOP_on_BLACK_SQUARE_0.asm"
    217  3fd8				  -	      include	"gfx/WHITE_MARKED_BISHOP_on_BLACK_SQUARE_1.asm"
    218  3fd8				  -	      include	"gfx/WHITE_MARKED_BISHOP_on_BLACK_SQUARE_2.asm"
    219  3fd8				  -	      include	"gfx/WHITE_MARKED_BISHOP_on_BLACK_SQUARE_3.asm"
    220  3fd8				  -	      include	"gfx/WHITE_MARKED_ROOK_on_BLACK_SQUARE_0.asm"
    221  3fd8				  -	      include	"gfx/WHITE_MARKED_ROOK_on_BLACK_SQUARE_1.asm"
    222  3fd8				  -	      include	"gfx/WHITE_MARKED_ROOK_on_BLACK_SQUARE_2.asm"
    223  3fd8				  -	      include	"gfx/WHITE_MARKED_ROOK_on_BLACK_SQUARE_3.asm"
    224  3fd8				  -	      include	"gfx/WHITE_MARKED_QUEEN_on_BLACK_SQUARE_0.asm"
    225  3fd8				  -	      include	"gfx/WHITE_MARKED_QUEEN_on_BLACK_SQUARE_1.asm"
    226  3fd8				  -	      include	"gfx/WHITE_MARKED_QUEEN_on_BLACK_SQUARE_2.asm"
    227  3fd8				  -	      include	"gfx/WHITE_MARKED_QUEEN_on_BLACK_SQUARE_3.asm"
    228  3fd8				  -	      include	"gfx/WHITE_MARKED_KING_on_BLACK_SQUARE_0.asm"
    229  3fd8				  -	      include	"gfx/WHITE_MARKED_KING_on_BLACK_SQUARE_1.asm"
    230  3fd8				  -	      include	"gfx/WHITE_MARKED_KING_on_BLACK_SQUARE_2.asm"
    231  3fd8				  -	      include	"gfx/WHITE_MARKED_KING_on_BLACK_SQUARE_3.asm"
    232  3fd8				  -	      include	"gfx/BLACK_MARKED_BLANK_on_WHITE_SQUARE_0.asm"
    233  3fd8				  -	      include	"gfx/BLACK_MARKED_BLANK_on_WHITE_SQUARE_1.asm"
    234  3fd8				  -	      include	"gfx/BLACK_MARKED_BLANK_on_WHITE_SQUARE_2.asm"
    235  3fd8				  -	      include	"gfx/BLACK_MARKED_BLANK_on_WHITE_SQUARE_3.asm"
    236  3fd8				  -	      include	"gfx/BLACK_MARKED_PAWN_on_WHITE_SQUARE_0.asm"
    237  3fd8				  -	      include	"gfx/BLACK_MARKED_PAWN_on_WHITE_SQUARE_1.asm"
    238  3fd8				  -	      include	"gfx/BLACK_MARKED_PAWN_on_WHITE_SQUARE_2.asm"
    239  3fd8				  -	      include	"gfx/BLACK_MARKED_PAWN_on_WHITE_SQUARE_3.asm"
    240  3fd8				  -	      CHECK_BANK_SIZE	"PIECES_7 (2K)"
    241  3fd8				  -
    242  3fd8				  -
    243  3fd8				  -	      NEWBANK	PIECES_8
    244  3fd8				  -
    245  3fd8				  -	      include	"gfx/BLACK_MARKED_KNIGHT_on_WHITE_SQUARE_0.asm"
    246  3fd8				  -	      include	"gfx/BLACK_MARKED_KNIGHT_on_WHITE_SQUARE_1.asm"
    247  3fd8				  -	      include	"gfx/BLACK_MARKED_KNIGHT_on_WHITE_SQUARE_2.asm"
    248  3fd8				  -	      include	"gfx/BLACK_MARKED_KNIGHT_on_WHITE_SQUARE_3.asm"
    249  3fd8				  -	      include	"gfx/BLACK_MARKED_BISHOP_on_WHITE_SQUARE_0.asm"
    250  3fd8				  -	      include	"gfx/BLACK_MARKED_BISHOP_on_WHITE_SQUARE_1.asm"
    251  3fd8				  -	      include	"gfx/BLACK_MARKED_BISHOP_on_WHITE_SQUARE_2.asm"
    252  3fd8				  -	      include	"gfx/BLACK_MARKED_BISHOP_on_WHITE_SQUARE_3.asm"
    253  3fd8				  -	      include	"gfx/BLACK_MARKED_ROOK_on_WHITE_SQUARE_0.asm"
    254  3fd8				  -	      include	"gfx/BLACK_MARKED_ROOK_on_WHITE_SQUARE_1.asm"
    255  3fd8				  -	      include	"gfx/BLACK_MARKED_ROOK_on_WHITE_SQUARE_2.asm"
    256  3fd8				  -	      include	"gfx/BLACK_MARKED_ROOK_on_WHITE_SQUARE_3.asm"
    257  3fd8				  -	      include	"gfx/BLACK_MARKED_QUEEN_on_WHITE_SQUARE_0.asm"
    258  3fd8				  -	      include	"gfx/BLACK_MARKED_QUEEN_on_WHITE_SQUARE_1.asm"
    259  3fd8				  -	      include	"gfx/BLACK_MARKED_QUEEN_on_WHITE_SQUARE_2.asm"
    260  3fd8				  -	      include	"gfx/BLACK_MARKED_QUEEN_on_WHITE_SQUARE_3.asm"
    261  3fd8				  -	      include	"gfx/BLACK_MARKED_KING_on_WHITE_SQUARE_0.asm"
    262  3fd8				  -	      include	"gfx/BLACK_MARKED_KING_on_WHITE_SQUARE_1.asm"
    263  3fd8				  -	      include	"gfx/BLACK_MARKED_KING_on_WHITE_SQUARE_2.asm"
    264  3fd8				  -	      include	"gfx/BLACK_MARKED_KING_on_WHITE_SQUARE_3.asm"
    265  3fd8				  -
    266  3fd8				  -	      include	"gfx/BLACK_MARKED_PAWN_on_BLACK_SQUARE_0.asm"
    267  3fd8				  -	      include	"gfx/BLACK_MARKED_PAWN_on_BLACK_SQUARE_1.asm"
    268  3fd8				  -	      include	"gfx/BLACK_MARKED_PAWN_on_BLACK_SQUARE_2.asm"
    269  3fd8				  -	      include	"gfx/BLACK_MARKED_PAWN_on_BLACK_SQUARE_3.asm"
    270  3fd8				  -	      CHECK_BANK_SIZE	"PIECES_8 (2K)"
    271  3fd8				  -
    272  3fd8					      endif
    273  3fd8
    274  3fd8							;    NEWBANK PIECES_9
    275  3fd8
    276  3fd8							; include "gfx/BLACK_MARKED_BLANK_on_BLACK_SQUARE_0.asm"
    277  3fd8							; include "gfx/BLACK_MARKED_BLANK_on_BLACK_SQUARE_1.asm"
    278  3fd8							; include "gfx/BLACK_MARKED_BLANK_on_BLACK_SQUARE_2.asm"
    279  3fd8							; include "gfx/BLACK_MARKED_BLANK_on_BLACK_SQUARE_3.asm"
    280  3fd8							; include "gfx/BLACK_MARKED_KNIGHT_on_BLACK_SQUARE_0.asm"
    281  3fd8
    282  3fd8				  -	      if	0
    283  3fd8				  -	      include	"gfx/BLACK_MARKED_KNIGHT_on_BLACK_SQUARE_1.asm"
    284  3fd8				  -	      include	"gfx/BLACK_MARKED_KNIGHT_on_BLACK_SQUARE_2.asm"
    285  3fd8				  -	      include	"gfx/BLACK_MARKED_KNIGHT_on_BLACK_SQUARE_3.asm"
    286  3fd8					      endif
    287  3fd8
    288  3fd8							;    CHECK_BANK_SIZE "PIECES_9 (2K)"
    289  3fd8
    290  3fd8				  -	      if	0
    291  3fd8				  -
    292  3fd8				  -
    293  3fd8				  -
    294  3fd8				  -
    295  3fd8				  -	      include	"gfx/BLACK_MARKED_BISHOP_on_BLACK_SQUARE_0.asm"
    296  3fd8				  -	      include	"gfx/BLACK_MARKED_BISHOP_on_BLACK_SQUARE_1.asm"
    297  3fd8				  -	      include	"gfx/BLACK_MARKED_BISHOP_on_BLACK_SQUARE_2.asm"
    298  3fd8				  -	      include	"gfx/BLACK_MARKED_BISHOP_on_BLACK_SQUARE_3.asm"
    299  3fd8				  -	      include	"gfx/BLACK_MARKED_ROOK_on_BLACK_SQUARE_0.asm"
    300  3fd8				  -	      include	"gfx/BLACK_MARKED_ROOK_on_BLACK_SQUARE_1.asm"
    301  3fd8				  -	      include	"gfx/BLACK_MARKED_ROOK_on_BLACK_SQUARE_2.asm"
    302  3fd8				  -	      include	"gfx/BLACK_MARKED_ROOK_on_BLACK_SQUARE_3.asm"
    303  3fd8				  -	      include	"gfx/BLACK_MARKED_QUEEN_on_BLACK_SQUARE_0.asm"
    304  3fd8				  -	      include	"gfx/BLACK_MARKED_QUEEN_on_BLACK_SQUARE_1.asm"
    305  3fd8				  -	      include	"gfx/BLACK_MARKED_QUEEN_on_BLACK_SQUARE_2.asm"
    306  3fd8				  -	      include	"gfx/BLACK_MARKED_QUEEN_on_BLACK_SQUARE_3.asm"
    307  3fd8				  -	      include	"gfx/BLACK_MARKED_KING_on_BLACK_SQUARE_0.asm"
    308  3fd8				  -	      include	"gfx/BLACK_MARKED_KING_on_BLACK_SQUARE_1.asm"
    309  3fd8				  -	      include	"gfx/BLACK_MARKED_KING_on_BLACK_SQUARE_2.asm"
    310  3fd8				  -	      include	"gfx/BLACK_MARKED_KING_on_BLACK_SQUARE_3.asm"
    311  3fd8				  -
    312  3fd8				  -
    313  3fd8					      endif
------- FILE BANK_CHESS_INCLUDES.asm
     42  3fd8
      0  3fd8					      NEWBANK	PIECE_VECTORS
      1  41b0 ????				      SEG	PIECE_VECTORS
      2  4000					      ORG	ORIGIN
      3  4000					      RORG	$F000
      4  4000				   BANK_START SET	*
      5  4000				   PIECE_VECTORS SET	ORIGIN / 2048
      6  4000				   ORIGIN     SET	ORIGIN + 2048
      7  4000				   _CURRENT_BANK SET	PIECE_VECTORS
------- FILE piece_vectors.asm LEVEL 3 PASS 2
      0  4000					      include	"piece_vectors.asm"
      1  4000							; Created by ConvertChessPieces.py
      0  4000					      DEF	PIECE_VECTOR_LO
      1  4000				   BANK_PIECE_VECTOR_LO SET	_CURRENT_BANK
      2  4000				   PIECE_VECTOR_LO
      3  4000				   TEMPORARY_VAR SET	Overlay
      4  4000				   TEMPORARY_OFFSET SET	0
      5  4000					      SUBROUTINE
      3  4000		       00		      .byte.b	<WHITE_BLANK_on_WHITE_SQUARE_0
      4  4001		       48		      .byte.b	<WHITE_BLANK_on_WHITE_SQUARE_1
      5  4002		       90		      .byte.b	<WHITE_BLANK_on_WHITE_SQUARE_2
      6  4003		       00		      .byte.b	<WHITE_BLANK_on_WHITE_SQUARE_3
      7  4004		       48		      .byte.b	<WHITE_PAWN_on_WHITE_SQUARE_0
      8  4005		       90		      .byte.b	<WHITE_PAWN_on_WHITE_SQUARE_1
      9  4006		       00		      .byte.b	<WHITE_PAWN_on_WHITE_SQUARE_2
     10  4007		       48		      .byte.b	<WHITE_PAWN_on_WHITE_SQUARE_3
     11  4008		       90		      .byte.b	<WHITE_KNIGHT_on_WHITE_SQUARE_0
     12  4009		       00		      .byte.b	<WHITE_KNIGHT_on_WHITE_SQUARE_1
     13  400a		       48		      .byte.b	<WHITE_KNIGHT_on_WHITE_SQUARE_2
     14  400b		       90		      .byte.b	<WHITE_KNIGHT_on_WHITE_SQUARE_3
     15  400c		       00		      .byte.b	<WHITE_BISHOP_on_WHITE_SQUARE_0
     16  400d		       48		      .byte.b	<WHITE_BISHOP_on_WHITE_SQUARE_1
     17  400e		       90		      .byte.b	<WHITE_BISHOP_on_WHITE_SQUARE_2
     18  400f		       00		      .byte.b	<WHITE_BISHOP_on_WHITE_SQUARE_3
     19  4010		       48		      .byte.b	<WHITE_ROOK_on_WHITE_SQUARE_0
     20  4011		       90		      .byte.b	<WHITE_ROOK_on_WHITE_SQUARE_1
     21  4012		       00		      .byte.b	<WHITE_ROOK_on_WHITE_SQUARE_2
     22  4013		       48		      .byte.b	<WHITE_ROOK_on_WHITE_SQUARE_3
     23  4014		       90		      .byte.b	<WHITE_QUEEN_on_WHITE_SQUARE_0
     24  4015		       00		      .byte.b	<WHITE_QUEEN_on_WHITE_SQUARE_1
     25  4016		       48		      .byte.b	<WHITE_QUEEN_on_WHITE_SQUARE_2
     26  4017		       90		      .byte.b	<WHITE_QUEEN_on_WHITE_SQUARE_3
     27  4018		       00		      .byte.b	<WHITE_KING_on_WHITE_SQUARE_0
     28  4019		       48		      .byte.b	<WHITE_KING_on_WHITE_SQUARE_1
     29  401a		       90		      .byte.b	<WHITE_KING_on_WHITE_SQUARE_2
     30  401b		       00		      .byte.b	<WHITE_KING_on_WHITE_SQUARE_3
     31  401c		       90		      .byte.b	<WHITE_MARKER_on_WHITE_SQUARE_0
     32  401d		       00		      .byte.b	<WHITE_MARKER_on_WHITE_SQUARE_1
     33  401e		       48		      .byte.b	<WHITE_MARKER_on_WHITE_SQUARE_2
     34  401f		       90		      .byte.b	<WHITE_MARKER_on_WHITE_SQUARE_3
     35  4020		       00		      .byte.b	<WHITE_PROMOTE_on_WHITE_SQUARE_0
     36  4021		       48		      .byte.b	<WHITE_PROMOTE_on_WHITE_SQUARE_1
     37  4022		       90		      .byte.b	<WHITE_PROMOTE_on_WHITE_SQUARE_2
     38  4023		       00		      .byte.b	<WHITE_PROMOTE_on_WHITE_SQUARE_3
     39  4024		       48		      .byte.b	<WHITE_BLANK_on_BLACK_SQUARE_0
     40  4025		       90		      .byte.b	<WHITE_BLANK_on_BLACK_SQUARE_1
     41  4026		       00		      .byte.b	<WHITE_BLANK_on_BLACK_SQUARE_2
     42  4027		       48		      .byte.b	<WHITE_BLANK_on_BLACK_SQUARE_3
     43  4028		       90		      .byte.b	<WHITE_PAWN_on_BLACK_SQUARE_0
     44  4029		       00		      .byte.b	<WHITE_PAWN_on_BLACK_SQUARE_1
     45  402a		       48		      .byte.b	<WHITE_PAWN_on_BLACK_SQUARE_2
     46  402b		       90		      .byte.b	<WHITE_PAWN_on_BLACK_SQUARE_3
     47  402c		       00		      .byte.b	<WHITE_KNIGHT_on_BLACK_SQUARE_0
     48  402d		       48		      .byte.b	<WHITE_KNIGHT_on_BLACK_SQUARE_1
     49  402e		       90		      .byte.b	<WHITE_KNIGHT_on_BLACK_SQUARE_2
     50  402f		       00		      .byte.b	<WHITE_KNIGHT_on_BLACK_SQUARE_3
     51  4030		       48		      .byte.b	<WHITE_BISHOP_on_BLACK_SQUARE_0
     52  4031		       90		      .byte.b	<WHITE_BISHOP_on_BLACK_SQUARE_1
     53  4032		       00		      .byte.b	<WHITE_BISHOP_on_BLACK_SQUARE_2
     54  4033		       48		      .byte.b	<WHITE_BISHOP_on_BLACK_SQUARE_3
     55  4034		       90		      .byte.b	<WHITE_ROOK_on_BLACK_SQUARE_0
     56  4035		       00		      .byte.b	<WHITE_ROOK_on_BLACK_SQUARE_1
     57  4036		       48		      .byte.b	<WHITE_ROOK_on_BLACK_SQUARE_2
     58  4037		       90		      .byte.b	<WHITE_ROOK_on_BLACK_SQUARE_3
     59  4038		       00		      .byte.b	<WHITE_QUEEN_on_BLACK_SQUARE_0
     60  4039		       48		      .byte.b	<WHITE_QUEEN_on_BLACK_SQUARE_1
     61  403a		       90		      .byte.b	<WHITE_QUEEN_on_BLACK_SQUARE_2
     62  403b		       00		      .byte.b	<WHITE_QUEEN_on_BLACK_SQUARE_3
     63  403c		       48		      .byte.b	<WHITE_KING_on_BLACK_SQUARE_0
     64  403d		       90		      .byte.b	<WHITE_KING_on_BLACK_SQUARE_1
     65  403e		       00		      .byte.b	<WHITE_KING_on_BLACK_SQUARE_2
     66  403f		       48		      .byte.b	<WHITE_KING_on_BLACK_SQUARE_3
     67  4040		       48		      .byte.b	<WHITE_MARKER_on_BLACK_SQUARE_0
     68  4041		       90		      .byte.b	<WHITE_MARKER_on_BLACK_SQUARE_1
     69  4042		       00		      .byte.b	<WHITE_MARKER_on_BLACK_SQUARE_2
     70  4043		       48		      .byte.b	<WHITE_MARKER_on_BLACK_SQUARE_3
     71  4044		       90		      .byte.b	<WHITE_PROMOTE_on_BLACK_SQUARE_0
     72  4045		       00		      .byte.b	<WHITE_PROMOTE_on_BLACK_SQUARE_1
     73  4046		       48		      .byte.b	<WHITE_PROMOTE_on_BLACK_SQUARE_2
     74  4047		       90		      .byte.b	<WHITE_PROMOTE_on_BLACK_SQUARE_3
     75  4048		       90		      .byte.b	<BLACK_BLANK_on_WHITE_SQUARE_0
     76  4049		       00		      .byte.b	<BLACK_BLANK_on_WHITE_SQUARE_1
     77  404a		       48		      .byte.b	<BLACK_BLANK_on_WHITE_SQUARE_2
     78  404b		       90		      .byte.b	<BLACK_BLANK_on_WHITE_SQUARE_3
     79  404c		       00		      .byte.b	<BLACK_PAWN_on_WHITE_SQUARE_0
     80  404d		       48		      .byte.b	<BLACK_PAWN_on_WHITE_SQUARE_1
     81  404e		       90		      .byte.b	<BLACK_PAWN_on_WHITE_SQUARE_2
     82  404f		       00		      .byte.b	<BLACK_PAWN_on_WHITE_SQUARE_3
     83  4050		       48		      .byte.b	<BLACK_KNIGHT_on_WHITE_SQUARE_0
     84  4051		       90		      .byte.b	<BLACK_KNIGHT_on_WHITE_SQUARE_1
     85  4052		       00		      .byte.b	<BLACK_KNIGHT_on_WHITE_SQUARE_2
     86  4053		       48		      .byte.b	<BLACK_KNIGHT_on_WHITE_SQUARE_3
     87  4054		       90		      .byte.b	<BLACK_BISHOP_on_WHITE_SQUARE_0
     88  4055		       00		      .byte.b	<BLACK_BISHOP_on_WHITE_SQUARE_1
     89  4056		       48		      .byte.b	<BLACK_BISHOP_on_WHITE_SQUARE_2
     90  4057		       90		      .byte.b	<BLACK_BISHOP_on_WHITE_SQUARE_3
     91  4058		       00		      .byte.b	<BLACK_ROOK_on_WHITE_SQUARE_0
     92  4059		       48		      .byte.b	<BLACK_ROOK_on_WHITE_SQUARE_1
     93  405a		       90		      .byte.b	<BLACK_ROOK_on_WHITE_SQUARE_2
     94  405b		       00		      .byte.b	<BLACK_ROOK_on_WHITE_SQUARE_3
     95  405c		       48		      .byte.b	<BLACK_QUEEN_on_WHITE_SQUARE_0
     96  405d		       90		      .byte.b	<BLACK_QUEEN_on_WHITE_SQUARE_1
     97  405e		       00		      .byte.b	<BLACK_QUEEN_on_WHITE_SQUARE_2
     98  405f		       48		      .byte.b	<BLACK_QUEEN_on_WHITE_SQUARE_3
     99  4060		       90		      .byte.b	<BLACK_KING_on_WHITE_SQUARE_0
    100  4061		       00		      .byte.b	<BLACK_KING_on_WHITE_SQUARE_1
    101  4062		       48		      .byte.b	<BLACK_KING_on_WHITE_SQUARE_2
    102  4063		       90		      .byte.b	<BLACK_KING_on_WHITE_SQUARE_3
    103  4064		       48		      .byte.b	<BLACK_MARKER_on_WHITE_SQUARE_0
    104  4065		       90		      .byte.b	<BLACK_MARKER_on_WHITE_SQUARE_1
    105  4066		       00		      .byte.b	<BLACK_MARKER_on_WHITE_SQUARE_2
    106  4067		       48		      .byte.b	<BLACK_MARKER_on_WHITE_SQUARE_3
    107  4068		       90		      .byte.b	<BLACK_PROMOTE_on_WHITE_SQUARE_0
    108  4069		       00		      .byte.b	<BLACK_PROMOTE_on_WHITE_SQUARE_1
    109  406a		       48		      .byte.b	<BLACK_PROMOTE_on_WHITE_SQUARE_2
    110  406b		       90		      .byte.b	<BLACK_PROMOTE_on_WHITE_SQUARE_3
    111  406c		       00		      .byte.b	<BLACK_BLANK_on_BLACK_SQUARE_0
    112  406d		       48		      .byte.b	<BLACK_BLANK_on_BLACK_SQUARE_1
    113  406e		       90		      .byte.b	<BLACK_BLANK_on_BLACK_SQUARE_2
    114  406f		       00		      .byte.b	<BLACK_BLANK_on_BLACK_SQUARE_3
    115  4070		       48		      .byte.b	<BLACK_PAWN_on_BLACK_SQUARE_0
    116  4071		       90		      .byte.b	<BLACK_PAWN_on_BLACK_SQUARE_1
    117  4072		       00		      .byte.b	<BLACK_PAWN_on_BLACK_SQUARE_2
    118  4073		       48		      .byte.b	<BLACK_PAWN_on_BLACK_SQUARE_3
    119  4074		       90		      .byte.b	<BLACK_KNIGHT_on_BLACK_SQUARE_0
    120  4075		       00		      .byte.b	<BLACK_KNIGHT_on_BLACK_SQUARE_1
    121  4076		       48		      .byte.b	<BLACK_KNIGHT_on_BLACK_SQUARE_2
    122  4077		       90		      .byte.b	<BLACK_KNIGHT_on_BLACK_SQUARE_3
    123  4078		       00		      .byte.b	<BLACK_BISHOP_on_BLACK_SQUARE_0
    124  4079		       48		      .byte.b	<BLACK_BISHOP_on_BLACK_SQUARE_1
    125  407a		       90		      .byte.b	<BLACK_BISHOP_on_BLACK_SQUARE_2
    126  407b		       00		      .byte.b	<BLACK_BISHOP_on_BLACK_SQUARE_3
    127  407c		       48		      .byte.b	<BLACK_ROOK_on_BLACK_SQUARE_0
    128  407d		       90		      .byte.b	<BLACK_ROOK_on_BLACK_SQUARE_1
    129  407e		       00		      .byte.b	<BLACK_ROOK_on_BLACK_SQUARE_2
    130  407f		       48		      .byte.b	<BLACK_ROOK_on_BLACK_SQUARE_3
    131  4080		       90		      .byte.b	<BLACK_QUEEN_on_BLACK_SQUARE_0
    132  4081		       00		      .byte.b	<BLACK_QUEEN_on_BLACK_SQUARE_1
    133  4082		       48		      .byte.b	<BLACK_QUEEN_on_BLACK_SQUARE_2
    134  4083		       90		      .byte.b	<BLACK_QUEEN_on_BLACK_SQUARE_3
    135  4084		       00		      .byte.b	<BLACK_KING_on_BLACK_SQUARE_0
    136  4085		       48		      .byte.b	<BLACK_KING_on_BLACK_SQUARE_1
    137  4086		       90		      .byte.b	<BLACK_KING_on_BLACK_SQUARE_2
    138  4087		       00		      .byte.b	<BLACK_KING_on_BLACK_SQUARE_3
    139  4088		       00		      .byte.b	<BLACK_MARKER_on_BLACK_SQUARE_0
    140  4089		       48		      .byte.b	<BLACK_MARKER_on_BLACK_SQUARE_1
    141  408a		       90		      .byte.b	<BLACK_MARKER_on_BLACK_SQUARE_2
    142  408b		       00		      .byte.b	<BLACK_MARKER_on_BLACK_SQUARE_3
    143  408c		       48		      .byte.b	<BLACK_PROMOTE_on_BLACK_SQUARE_0
    144  408d		       90		      .byte.b	<BLACK_PROMOTE_on_BLACK_SQUARE_1
    145  408e		       00		      .byte.b	<BLACK_PROMOTE_on_BLACK_SQUARE_2
    146  408f		       48		      .byte.b	<BLACK_PROMOTE_on_BLACK_SQUARE_3
      0  4090					      DEF	PIECE_VECTOR_HI
      1  4090				   BANK_PIECE_VECTOR_HI SET	_CURRENT_BANK
      2  4090				   PIECE_VECTOR_HI
      3  4090				   TEMPORARY_VAR SET	Overlay
      4  4090				   TEMPORARY_OFFSET SET	0
      5  4090					      SUBROUTINE
    148  4090		       f0		      .byte.b	>WHITE_BLANK_on_WHITE_SQUARE_0
    149  4091		       f0		      .byte.b	>WHITE_BLANK_on_WHITE_SQUARE_1
    150  4092		       f0		      .byte.b	>WHITE_BLANK_on_WHITE_SQUARE_2
    151  4093		       f1		      .byte.b	>WHITE_BLANK_on_WHITE_SQUARE_3
    152  4094		       f1		      .byte.b	>WHITE_PAWN_on_WHITE_SQUARE_0
    153  4095		       f1		      .byte.b	>WHITE_PAWN_on_WHITE_SQUARE_1
    154  4096		       f2		      .byte.b	>WHITE_PAWN_on_WHITE_SQUARE_2
    155  4097		       f2		      .byte.b	>WHITE_PAWN_on_WHITE_SQUARE_3
    156  4098		       f2		      .byte.b	>WHITE_KNIGHT_on_WHITE_SQUARE_0
    157  4099		       f3		      .byte.b	>WHITE_KNIGHT_on_WHITE_SQUARE_1
    158  409a		       f3		      .byte.b	>WHITE_KNIGHT_on_WHITE_SQUARE_2
    159  409b		       f3		      .byte.b	>WHITE_KNIGHT_on_WHITE_SQUARE_3
    160  409c		       f4		      .byte.b	>WHITE_BISHOP_on_WHITE_SQUARE_0
    161  409d		       f4		      .byte.b	>WHITE_BISHOP_on_WHITE_SQUARE_1
    162  409e		       f4		      .byte.b	>WHITE_BISHOP_on_WHITE_SQUARE_2
    163  409f		       f5		      .byte.b	>WHITE_BISHOP_on_WHITE_SQUARE_3
    164  40a0		       f5		      .byte.b	>WHITE_ROOK_on_WHITE_SQUARE_0
    165  40a1		       f5		      .byte.b	>WHITE_ROOK_on_WHITE_SQUARE_1
    166  40a2		       f6		      .byte.b	>WHITE_ROOK_on_WHITE_SQUARE_2
    167  40a3		       f6		      .byte.b	>WHITE_ROOK_on_WHITE_SQUARE_3
    168  40a4		       f6		      .byte.b	>WHITE_QUEEN_on_WHITE_SQUARE_0
    169  40a5		       f7		      .byte.b	>WHITE_QUEEN_on_WHITE_SQUARE_1
    170  40a6		       f7		      .byte.b	>WHITE_QUEEN_on_WHITE_SQUARE_2
    171  40a7		       f7		      .byte.b	>WHITE_QUEEN_on_WHITE_SQUARE_3
    172  40a8		       f0		      .byte.b	>WHITE_KING_on_WHITE_SQUARE_0
    173  40a9		       f0		      .byte.b	>WHITE_KING_on_WHITE_SQUARE_1
    174  40aa		       f0		      .byte.b	>WHITE_KING_on_WHITE_SQUARE_2
    175  40ab		       f1		      .byte.b	>WHITE_KING_on_WHITE_SQUARE_3
    176  40ac		       f6		      .byte.b	>WHITE_MARKER_on_WHITE_SQUARE_0
    177  40ad		       f7		      .byte.b	>WHITE_MARKER_on_WHITE_SQUARE_1
    178  40ae		       f7		      .byte.b	>WHITE_MARKER_on_WHITE_SQUARE_2
    179  40af		       f7		      .byte.b	>WHITE_MARKER_on_WHITE_SQUARE_3
    180  40b0		       f4		      .byte.b	>WHITE_PROMOTE_on_WHITE_SQUARE_0
    181  40b1		       f4		      .byte.b	>WHITE_PROMOTE_on_WHITE_SQUARE_1
    182  40b2		       f4		      .byte.b	>WHITE_PROMOTE_on_WHITE_SQUARE_2
    183  40b3		       f5		      .byte.b	>WHITE_PROMOTE_on_WHITE_SQUARE_3
    184  40b4		       f1		      .byte.b	>WHITE_BLANK_on_BLACK_SQUARE_0
    185  40b5		       f1		      .byte.b	>WHITE_BLANK_on_BLACK_SQUARE_1
    186  40b6		       f2		      .byte.b	>WHITE_BLANK_on_BLACK_SQUARE_2
    187  40b7		       f2		      .byte.b	>WHITE_BLANK_on_BLACK_SQUARE_3
    188  40b8		       f2		      .byte.b	>WHITE_PAWN_on_BLACK_SQUARE_0
    189  40b9		       f3		      .byte.b	>WHITE_PAWN_on_BLACK_SQUARE_1
    190  40ba		       f3		      .byte.b	>WHITE_PAWN_on_BLACK_SQUARE_2
    191  40bb		       f3		      .byte.b	>WHITE_PAWN_on_BLACK_SQUARE_3
    192  40bc		       f4		      .byte.b	>WHITE_KNIGHT_on_BLACK_SQUARE_0
    193  40bd		       f4		      .byte.b	>WHITE_KNIGHT_on_BLACK_SQUARE_1
    194  40be		       f4		      .byte.b	>WHITE_KNIGHT_on_BLACK_SQUARE_2
    195  40bf		       f5		      .byte.b	>WHITE_KNIGHT_on_BLACK_SQUARE_3
    196  40c0		       f5		      .byte.b	>WHITE_BISHOP_on_BLACK_SQUARE_0
    197  40c1		       f5		      .byte.b	>WHITE_BISHOP_on_BLACK_SQUARE_1
    198  40c2		       f6		      .byte.b	>WHITE_BISHOP_on_BLACK_SQUARE_2
    199  40c3		       f6		      .byte.b	>WHITE_BISHOP_on_BLACK_SQUARE_3
    200  40c4		       f6		      .byte.b	>WHITE_ROOK_on_BLACK_SQUARE_0
    201  40c5		       f7		      .byte.b	>WHITE_ROOK_on_BLACK_SQUARE_1
    202  40c6		       f7		      .byte.b	>WHITE_ROOK_on_BLACK_SQUARE_2
    203  40c7		       f7		      .byte.b	>WHITE_ROOK_on_BLACK_SQUARE_3
    204  40c8		       f0		      .byte.b	>WHITE_QUEEN_on_BLACK_SQUARE_0
    205  40c9		       f0		      .byte.b	>WHITE_QUEEN_on_BLACK_SQUARE_1
    206  40ca		       f0		      .byte.b	>WHITE_QUEEN_on_BLACK_SQUARE_2
    207  40cb		       f1		      .byte.b	>WHITE_QUEEN_on_BLACK_SQUARE_3
    208  40cc		       f1		      .byte.b	>WHITE_KING_on_BLACK_SQUARE_0
    209  40cd		       f1		      .byte.b	>WHITE_KING_on_BLACK_SQUARE_1
    210  40ce		       f2		      .byte.b	>WHITE_KING_on_BLACK_SQUARE_2
    211  40cf		       f2		      .byte.b	>WHITE_KING_on_BLACK_SQUARE_3
    212  40d0		       f5		      .byte.b	>WHITE_MARKER_on_BLACK_SQUARE_0
    213  40d1		       f5		      .byte.b	>WHITE_MARKER_on_BLACK_SQUARE_1
    214  40d2		       f6		      .byte.b	>WHITE_MARKER_on_BLACK_SQUARE_2
    215  40d3		       f6		      .byte.b	>WHITE_MARKER_on_BLACK_SQUARE_3
    216  40d4		       f2		      .byte.b	>WHITE_PROMOTE_on_BLACK_SQUARE_0
    217  40d5		       f3		      .byte.b	>WHITE_PROMOTE_on_BLACK_SQUARE_1
    218  40d6		       f3		      .byte.b	>WHITE_PROMOTE_on_BLACK_SQUARE_2
    219  40d7		       f3		      .byte.b	>WHITE_PROMOTE_on_BLACK_SQUARE_3
    220  40d8		       f2		      .byte.b	>BLACK_BLANK_on_WHITE_SQUARE_0
    221  40d9		       f3		      .byte.b	>BLACK_BLANK_on_WHITE_SQUARE_1
    222  40da		       f3		      .byte.b	>BLACK_BLANK_on_WHITE_SQUARE_2
    223  40db		       f3		      .byte.b	>BLACK_BLANK_on_WHITE_SQUARE_3
    224  40dc		       f4		      .byte.b	>BLACK_PAWN_on_WHITE_SQUARE_0
    225  40dd		       f4		      .byte.b	>BLACK_PAWN_on_WHITE_SQUARE_1
    226  40de		       f4		      .byte.b	>BLACK_PAWN_on_WHITE_SQUARE_2
    227  40df		       f5		      .byte.b	>BLACK_PAWN_on_WHITE_SQUARE_3
    228  40e0		       f5		      .byte.b	>BLACK_KNIGHT_on_WHITE_SQUARE_0
    229  40e1		       f5		      .byte.b	>BLACK_KNIGHT_on_WHITE_SQUARE_1
    230  40e2		       f6		      .byte.b	>BLACK_KNIGHT_on_WHITE_SQUARE_2
    231  40e3		       f6		      .byte.b	>BLACK_KNIGHT_on_WHITE_SQUARE_3
    232  40e4		       f6		      .byte.b	>BLACK_BISHOP_on_WHITE_SQUARE_0
    233  40e5		       f7		      .byte.b	>BLACK_BISHOP_on_WHITE_SQUARE_1
    234  40e6		       f7		      .byte.b	>BLACK_BISHOP_on_WHITE_SQUARE_2
    235  40e7		       f7		      .byte.b	>BLACK_BISHOP_on_WHITE_SQUARE_3
    236  40e8		       f0		      .byte.b	>BLACK_ROOK_on_WHITE_SQUARE_0
    237  40e9		       f0		      .byte.b	>BLACK_ROOK_on_WHITE_SQUARE_1
    238  40ea		       f0		      .byte.b	>BLACK_ROOK_on_WHITE_SQUARE_2
    239  40eb		       f1		      .byte.b	>BLACK_ROOK_on_WHITE_SQUARE_3
    240  40ec		       f1		      .byte.b	>BLACK_QUEEN_on_WHITE_SQUARE_0
    241  40ed		       f1		      .byte.b	>BLACK_QUEEN_on_WHITE_SQUARE_1
    242  40ee		       f2		      .byte.b	>BLACK_QUEEN_on_WHITE_SQUARE_2
    243  40ef		       f2		      .byte.b	>BLACK_QUEEN_on_WHITE_SQUARE_3
    244  40f0		       f2		      .byte.b	>BLACK_KING_on_WHITE_SQUARE_0
    245  40f1		       f3		      .byte.b	>BLACK_KING_on_WHITE_SQUARE_1
    246  40f2		       f3		      .byte.b	>BLACK_KING_on_WHITE_SQUARE_2
    247  40f3		       f3		      .byte.b	>BLACK_KING_on_WHITE_SQUARE_3
    248  40f4		       f1		      .byte.b	>BLACK_MARKER_on_WHITE_SQUARE_0
    249  40f5		       f1		      .byte.b	>BLACK_MARKER_on_WHITE_SQUARE_1
    250  40f6		       f2		      .byte.b	>BLACK_MARKER_on_WHITE_SQUARE_2
    251  40f7		       f2		      .byte.b	>BLACK_MARKER_on_WHITE_SQUARE_3
    252  40f8		       f6		      .byte.b	>BLACK_PROMOTE_on_WHITE_SQUARE_0
    253  40f9		       f7		      .byte.b	>BLACK_PROMOTE_on_WHITE_SQUARE_1
    254  40fa		       f7		      .byte.b	>BLACK_PROMOTE_on_WHITE_SQUARE_2
    255  40fb		       f7		      .byte.b	>BLACK_PROMOTE_on_WHITE_SQUARE_3
    256  40fc		       f4		      .byte.b	>BLACK_BLANK_on_BLACK_SQUARE_0
    257  40fd		       f4		      .byte.b	>BLACK_BLANK_on_BLACK_SQUARE_1
    258  40fe		       f4		      .byte.b	>BLACK_BLANK_on_BLACK_SQUARE_2
    259  40ff		       f5		      .byte.b	>BLACK_BLANK_on_BLACK_SQUARE_3
    260  4100		       f5		      .byte.b	>BLACK_PAWN_on_BLACK_SQUARE_0
    261  4101		       f5		      .byte.b	>BLACK_PAWN_on_BLACK_SQUARE_1
    262  4102		       f6		      .byte.b	>BLACK_PAWN_on_BLACK_SQUARE_2
    263  4103		       f6		      .byte.b	>BLACK_PAWN_on_BLACK_SQUARE_3
    264  4104		       f6		      .byte.b	>BLACK_KNIGHT_on_BLACK_SQUARE_0
    265  4105		       f7		      .byte.b	>BLACK_KNIGHT_on_BLACK_SQUARE_1
    266  4106		       f7		      .byte.b	>BLACK_KNIGHT_on_BLACK_SQUARE_2
    267  4107		       f7		      .byte.b	>BLACK_KNIGHT_on_BLACK_SQUARE_3
    268  4108		       f0		      .byte.b	>BLACK_BISHOP_on_BLACK_SQUARE_0
    269  4109		       f0		      .byte.b	>BLACK_BISHOP_on_BLACK_SQUARE_1
    270  410a		       f0		      .byte.b	>BLACK_BISHOP_on_BLACK_SQUARE_2
    271  410b		       f1		      .byte.b	>BLACK_BISHOP_on_BLACK_SQUARE_3
    272  410c		       f1		      .byte.b	>BLACK_ROOK_on_BLACK_SQUARE_0
    273  410d		       f1		      .byte.b	>BLACK_ROOK_on_BLACK_SQUARE_1
    274  410e		       f2		      .byte.b	>BLACK_ROOK_on_BLACK_SQUARE_2
    275  410f		       f2		      .byte.b	>BLACK_ROOK_on_BLACK_SQUARE_3
    276  4110		       f2		      .byte.b	>BLACK_QUEEN_on_BLACK_SQUARE_0
    277  4111		       f3		      .byte.b	>BLACK_QUEEN_on_BLACK_SQUARE_1
    278  4112		       f3		      .byte.b	>BLACK_QUEEN_on_BLACK_SQUARE_2
    279  4113		       f3		      .byte.b	>BLACK_QUEEN_on_BLACK_SQUARE_3
    280  4114		       f4		      .byte.b	>BLACK_KING_on_BLACK_SQUARE_0
    281  4115		       f4		      .byte.b	>BLACK_KING_on_BLACK_SQUARE_1
    282  4116		       f4		      .byte.b	>BLACK_KING_on_BLACK_SQUARE_2
    283  4117		       f5		      .byte.b	>BLACK_KING_on_BLACK_SQUARE_3
    284  4118		       f0		      .byte.b	>BLACK_MARKER_on_BLACK_SQUARE_0
    285  4119		       f0		      .byte.b	>BLACK_MARKER_on_BLACK_SQUARE_1
    286  411a		       f0		      .byte.b	>BLACK_MARKER_on_BLACK_SQUARE_2
    287  411b		       f1		      .byte.b	>BLACK_MARKER_on_BLACK_SQUARE_3
    288  411c		       f5		      .byte.b	>BLACK_PROMOTE_on_BLACK_SQUARE_0
    289  411d		       f5		      .byte.b	>BLACK_PROMOTE_on_BLACK_SQUARE_1
    290  411e		       f6		      .byte.b	>BLACK_PROMOTE_on_BLACK_SQUARE_2
    291  411f		       f6		      .byte.b	>BLACK_PROMOTE_on_BLACK_SQUARE_3
      0  4120					      DEF	PIECE_VECTOR_BANK
      1  4120				   BANK_PIECE_VECTOR_BANK SET	_CURRENT_BANK
      2  4120				   PIECE_VECTOR_BANK
      3  4120				   TEMPORARY_VAR SET	Overlay
      4  4120				   TEMPORARY_OFFSET SET	0
      5  4120					      SUBROUTINE
    293  4120		       02		      .byte.b	BANK_WHITE_BLANK_on_WHITE_SQUARE_0
    294  4121		       02		      .byte.b	BANK_WHITE_BLANK_on_WHITE_SQUARE_1
    295  4122		       02		      .byte.b	BANK_WHITE_BLANK_on_WHITE_SQUARE_2
    296  4123		       02		      .byte.b	BANK_WHITE_BLANK_on_WHITE_SQUARE_3
    297  4124		       02		      .byte.b	BANK_WHITE_PAWN_on_WHITE_SQUARE_0
    298  4125		       02		      .byte.b	BANK_WHITE_PAWN_on_WHITE_SQUARE_1
    299  4126		       02		      .byte.b	BANK_WHITE_PAWN_on_WHITE_SQUARE_2
    300  4127		       02		      .byte.b	BANK_WHITE_PAWN_on_WHITE_SQUARE_3
    301  4128		       02		      .byte.b	BANK_WHITE_KNIGHT_on_WHITE_SQUARE_0
    302  4129		       02		      .byte.b	BANK_WHITE_KNIGHT_on_WHITE_SQUARE_1
    303  412a		       02		      .byte.b	BANK_WHITE_KNIGHT_on_WHITE_SQUARE_2
    304  412b		       02		      .byte.b	BANK_WHITE_KNIGHT_on_WHITE_SQUARE_3
    305  412c		       02		      .byte.b	BANK_WHITE_BISHOP_on_WHITE_SQUARE_0
    306  412d		       02		      .byte.b	BANK_WHITE_BISHOP_on_WHITE_SQUARE_1
    307  412e		       02		      .byte.b	BANK_WHITE_BISHOP_on_WHITE_SQUARE_2
    308  412f		       02		      .byte.b	BANK_WHITE_BISHOP_on_WHITE_SQUARE_3
    309  4130		       02		      .byte.b	BANK_WHITE_ROOK_on_WHITE_SQUARE_0
    310  4131		       02		      .byte.b	BANK_WHITE_ROOK_on_WHITE_SQUARE_1
    311  4132		       02		      .byte.b	BANK_WHITE_ROOK_on_WHITE_SQUARE_2
    312  4133		       02		      .byte.b	BANK_WHITE_ROOK_on_WHITE_SQUARE_3
    313  4134		       02		      .byte.b	BANK_WHITE_QUEEN_on_WHITE_SQUARE_0
    314  4135		       02		      .byte.b	BANK_WHITE_QUEEN_on_WHITE_SQUARE_1
    315  4136		       02		      .byte.b	BANK_WHITE_QUEEN_on_WHITE_SQUARE_2
    316  4137		       02		      .byte.b	BANK_WHITE_QUEEN_on_WHITE_SQUARE_3
    317  4138		       03		      .byte.b	BANK_WHITE_KING_on_WHITE_SQUARE_0
    318  4139		       03		      .byte.b	BANK_WHITE_KING_on_WHITE_SQUARE_1
    319  413a		       03		      .byte.b	BANK_WHITE_KING_on_WHITE_SQUARE_2
    320  413b		       03		      .byte.b	BANK_WHITE_KING_on_WHITE_SQUARE_3
    321  413c		       06		      .byte.b	BANK_WHITE_MARKER_on_WHITE_SQUARE_0
    322  413d		       06		      .byte.b	BANK_WHITE_MARKER_on_WHITE_SQUARE_1
    323  413e		       06		      .byte.b	BANK_WHITE_MARKER_on_WHITE_SQUARE_2
    324  413f		       06		      .byte.b	BANK_WHITE_MARKER_on_WHITE_SQUARE_3
    325  4140		       07		      .byte.b	BANK_WHITE_PROMOTE_on_WHITE_SQUARE_0
    326  4141		       07		      .byte.b	BANK_WHITE_PROMOTE_on_WHITE_SQUARE_1
    327  4142		       07		      .byte.b	BANK_WHITE_PROMOTE_on_WHITE_SQUARE_2
    328  4143		       07		      .byte.b	BANK_WHITE_PROMOTE_on_WHITE_SQUARE_3
    329  4144		       03		      .byte.b	BANK_WHITE_BLANK_on_BLACK_SQUARE_0
    330  4145		       03		      .byte.b	BANK_WHITE_BLANK_on_BLACK_SQUARE_1
    331  4146		       03		      .byte.b	BANK_WHITE_BLANK_on_BLACK_SQUARE_2
    332  4147		       03		      .byte.b	BANK_WHITE_BLANK_on_BLACK_SQUARE_3
    333  4148		       03		      .byte.b	BANK_WHITE_PAWN_on_BLACK_SQUARE_0
    334  4149		       03		      .byte.b	BANK_WHITE_PAWN_on_BLACK_SQUARE_1
    335  414a		       03		      .byte.b	BANK_WHITE_PAWN_on_BLACK_SQUARE_2
    336  414b		       03		      .byte.b	BANK_WHITE_PAWN_on_BLACK_SQUARE_3
    337  414c		       03		      .byte.b	BANK_WHITE_KNIGHT_on_BLACK_SQUARE_0
    338  414d		       03		      .byte.b	BANK_WHITE_KNIGHT_on_BLACK_SQUARE_1
    339  414e		       03		      .byte.b	BANK_WHITE_KNIGHT_on_BLACK_SQUARE_2
    340  414f		       03		      .byte.b	BANK_WHITE_KNIGHT_on_BLACK_SQUARE_3
    341  4150		       03		      .byte.b	BANK_WHITE_BISHOP_on_BLACK_SQUARE_0
    342  4151		       03		      .byte.b	BANK_WHITE_BISHOP_on_BLACK_SQUARE_1
    343  4152		       03		      .byte.b	BANK_WHITE_BISHOP_on_BLACK_SQUARE_2
    344  4153		       03		      .byte.b	BANK_WHITE_BISHOP_on_BLACK_SQUARE_3
    345  4154		       03		      .byte.b	BANK_WHITE_ROOK_on_BLACK_SQUARE_0
    346  4155		       03		      .byte.b	BANK_WHITE_ROOK_on_BLACK_SQUARE_1
    347  4156		       03		      .byte.b	BANK_WHITE_ROOK_on_BLACK_SQUARE_2
    348  4157		       03		      .byte.b	BANK_WHITE_ROOK_on_BLACK_SQUARE_3
    349  4158		       04		      .byte.b	BANK_WHITE_QUEEN_on_BLACK_SQUARE_0
    350  4159		       04		      .byte.b	BANK_WHITE_QUEEN_on_BLACK_SQUARE_1
    351  415a		       04		      .byte.b	BANK_WHITE_QUEEN_on_BLACK_SQUARE_2
    352  415b		       04		      .byte.b	BANK_WHITE_QUEEN_on_BLACK_SQUARE_3
    353  415c		       04		      .byte.b	BANK_WHITE_KING_on_BLACK_SQUARE_0
    354  415d		       04		      .byte.b	BANK_WHITE_KING_on_BLACK_SQUARE_1
    355  415e		       04		      .byte.b	BANK_WHITE_KING_on_BLACK_SQUARE_2
    356  415f		       04		      .byte.b	BANK_WHITE_KING_on_BLACK_SQUARE_3
    357  4160		       06		      .byte.b	BANK_WHITE_MARKER_on_BLACK_SQUARE_0
    358  4161		       06		      .byte.b	BANK_WHITE_MARKER_on_BLACK_SQUARE_1
    359  4162		       06		      .byte.b	BANK_WHITE_MARKER_on_BLACK_SQUARE_2
    360  4163		       06		      .byte.b	BANK_WHITE_MARKER_on_BLACK_SQUARE_3
    361  4164		       07		      .byte.b	BANK_WHITE_PROMOTE_on_BLACK_SQUARE_0
    362  4165		       07		      .byte.b	BANK_WHITE_PROMOTE_on_BLACK_SQUARE_1
    363  4166		       07		      .byte.b	BANK_WHITE_PROMOTE_on_BLACK_SQUARE_2
    364  4167		       07		      .byte.b	BANK_WHITE_PROMOTE_on_BLACK_SQUARE_3
    365  4168		       04		      .byte.b	BANK_BLACK_BLANK_on_WHITE_SQUARE_0
    366  4169		       04		      .byte.b	BANK_BLACK_BLANK_on_WHITE_SQUARE_1
    367  416a		       04		      .byte.b	BANK_BLACK_BLANK_on_WHITE_SQUARE_2
    368  416b		       04		      .byte.b	BANK_BLACK_BLANK_on_WHITE_SQUARE_3
    369  416c		       04		      .byte.b	BANK_BLACK_PAWN_on_WHITE_SQUARE_0
    370  416d		       04		      .byte.b	BANK_BLACK_PAWN_on_WHITE_SQUARE_1
    371  416e		       04		      .byte.b	BANK_BLACK_PAWN_on_WHITE_SQUARE_2
    372  416f		       04		      .byte.b	BANK_BLACK_PAWN_on_WHITE_SQUARE_3
    373  4170		       04		      .byte.b	BANK_BLACK_KNIGHT_on_WHITE_SQUARE_0
    374  4171		       04		      .byte.b	BANK_BLACK_KNIGHT_on_WHITE_SQUARE_1
    375  4172		       04		      .byte.b	BANK_BLACK_KNIGHT_on_WHITE_SQUARE_2
    376  4173		       04		      .byte.b	BANK_BLACK_KNIGHT_on_WHITE_SQUARE_3
    377  4174		       04		      .byte.b	BANK_BLACK_BISHOP_on_WHITE_SQUARE_0
    378  4175		       04		      .byte.b	BANK_BLACK_BISHOP_on_WHITE_SQUARE_1
    379  4176		       04		      .byte.b	BANK_BLACK_BISHOP_on_WHITE_SQUARE_2
    380  4177		       04		      .byte.b	BANK_BLACK_BISHOP_on_WHITE_SQUARE_3
    381  4178		       05		      .byte.b	BANK_BLACK_ROOK_on_WHITE_SQUARE_0
    382  4179		       05		      .byte.b	BANK_BLACK_ROOK_on_WHITE_SQUARE_1
    383  417a		       05		      .byte.b	BANK_BLACK_ROOK_on_WHITE_SQUARE_2
    384  417b		       05		      .byte.b	BANK_BLACK_ROOK_on_WHITE_SQUARE_3
    385  417c		       05		      .byte.b	BANK_BLACK_QUEEN_on_WHITE_SQUARE_0
    386  417d		       05		      .byte.b	BANK_BLACK_QUEEN_on_WHITE_SQUARE_1
    387  417e		       05		      .byte.b	BANK_BLACK_QUEEN_on_WHITE_SQUARE_2
    388  417f		       05		      .byte.b	BANK_BLACK_QUEEN_on_WHITE_SQUARE_3
    389  4180		       05		      .byte.b	BANK_BLACK_KING_on_WHITE_SQUARE_0
    390  4181		       05		      .byte.b	BANK_BLACK_KING_on_WHITE_SQUARE_1
    391  4182		       05		      .byte.b	BANK_BLACK_KING_on_WHITE_SQUARE_2
    392  4183		       05		      .byte.b	BANK_BLACK_KING_on_WHITE_SQUARE_3
    393  4184		       07		      .byte.b	BANK_BLACK_MARKER_on_WHITE_SQUARE_0
    394  4185		       07		      .byte.b	BANK_BLACK_MARKER_on_WHITE_SQUARE_1
    395  4186		       07		      .byte.b	BANK_BLACK_MARKER_on_WHITE_SQUARE_2
    396  4187		       07		      .byte.b	BANK_BLACK_MARKER_on_WHITE_SQUARE_3
    397  4188		       07		      .byte.b	BANK_BLACK_PROMOTE_on_WHITE_SQUARE_0
    398  4189		       07		      .byte.b	BANK_BLACK_PROMOTE_on_WHITE_SQUARE_1
    399  418a		       07		      .byte.b	BANK_BLACK_PROMOTE_on_WHITE_SQUARE_2
    400  418b		       07		      .byte.b	BANK_BLACK_PROMOTE_on_WHITE_SQUARE_3
    401  418c		       05		      .byte.b	BANK_BLACK_BLANK_on_BLACK_SQUARE_0
    402  418d		       05		      .byte.b	BANK_BLACK_BLANK_on_BLACK_SQUARE_1
    403  418e		       05		      .byte.b	BANK_BLACK_BLANK_on_BLACK_SQUARE_2
    404  418f		       05		      .byte.b	BANK_BLACK_BLANK_on_BLACK_SQUARE_3
    405  4190		       05		      .byte.b	BANK_BLACK_PAWN_on_BLACK_SQUARE_0
    406  4191		       05		      .byte.b	BANK_BLACK_PAWN_on_BLACK_SQUARE_1
    407  4192		       05		      .byte.b	BANK_BLACK_PAWN_on_BLACK_SQUARE_2
    408  4193		       05		      .byte.b	BANK_BLACK_PAWN_on_BLACK_SQUARE_3
    409  4194		       05		      .byte.b	BANK_BLACK_KNIGHT_on_BLACK_SQUARE_0
    410  4195		       05		      .byte.b	BANK_BLACK_KNIGHT_on_BLACK_SQUARE_1
    411  4196		       05		      .byte.b	BANK_BLACK_KNIGHT_on_BLACK_SQUARE_2
    412  4197		       05		      .byte.b	BANK_BLACK_KNIGHT_on_BLACK_SQUARE_3
    413  4198		       06		      .byte.b	BANK_BLACK_BISHOP_on_BLACK_SQUARE_0
    414  4199		       06		      .byte.b	BANK_BLACK_BISHOP_on_BLACK_SQUARE_1
    415  419a		       06		      .byte.b	BANK_BLACK_BISHOP_on_BLACK_SQUARE_2
    416  419b		       06		      .byte.b	BANK_BLACK_BISHOP_on_BLACK_SQUARE_3
    417  419c		       06		      .byte.b	BANK_BLACK_ROOK_on_BLACK_SQUARE_0
    418  419d		       06		      .byte.b	BANK_BLACK_ROOK_on_BLACK_SQUARE_1
    419  419e		       06		      .byte.b	BANK_BLACK_ROOK_on_BLACK_SQUARE_2
    420  419f		       06		      .byte.b	BANK_BLACK_ROOK_on_BLACK_SQUARE_3
    421  41a0		       06		      .byte.b	BANK_BLACK_QUEEN_on_BLACK_SQUARE_0
    422  41a1		       06		      .byte.b	BANK_BLACK_QUEEN_on_BLACK_SQUARE_1
    423  41a2		       06		      .byte.b	BANK_BLACK_QUEEN_on_BLACK_SQUARE_2
    424  41a3		       06		      .byte.b	BANK_BLACK_QUEEN_on_BLACK_SQUARE_3
    425  41a4		       06		      .byte.b	BANK_BLACK_KING_on_BLACK_SQUARE_0
    426  41a5		       06		      .byte.b	BANK_BLACK_KING_on_BLACK_SQUARE_1
    427  41a6		       06		      .byte.b	BANK_BLACK_KING_on_BLACK_SQUARE_2
    428  41a7		       06		      .byte.b	BANK_BLACK_KING_on_BLACK_SQUARE_3
    429  41a8		       07		      .byte.b	BANK_BLACK_MARKER_on_BLACK_SQUARE_0
    430  41a9		       07		      .byte.b	BANK_BLACK_MARKER_on_BLACK_SQUARE_1
    431  41aa		       07		      .byte.b	BANK_BLACK_MARKER_on_BLACK_SQUARE_2
    432  41ab		       07		      .byte.b	BANK_BLACK_MARKER_on_BLACK_SQUARE_3
    433  41ac		       07		      .byte.b	BANK_BLACK_PROMOTE_on_BLACK_SQUARE_0
    434  41ad		       07		      .byte.b	BANK_BLACK_PROMOTE_on_BLACK_SQUARE_1
    435  41ae		       07		      .byte.b	BANK_BLACK_PROMOTE_on_BLACK_SQUARE_2
    436  41af		       07		      .byte.b	BANK_BLACK_PROMOTE_on_BLACK_SQUARE_3
    437  41b0
    438  41b0							; piece index equates...
    439  41b0		       00 00	   INDEX_WHITE_BLANK_on_WHITE_SQUARE_0 =	0
    440  41b0		       00 01	   INDEX_WHITE_BLANK_on_WHITE_SQUARE_1 =	1
    441  41b0		       00 02	   INDEX_WHITE_BLANK_on_WHITE_SQUARE_2 =	2
    442  41b0		       00 03	   INDEX_WHITE_BLANK_on_WHITE_SQUARE_3 =	3
    443  41b0		       00 04	   INDEX_WHITE_PAWN_on_WHITE_SQUARE_0 =	4
    444  41b0		       00 05	   INDEX_WHITE_PAWN_on_WHITE_SQUARE_1 =	5
    445  41b0		       00 06	   INDEX_WHITE_PAWN_on_WHITE_SQUARE_2 =	6
    446  41b0		       00 07	   INDEX_WHITE_PAWN_on_WHITE_SQUARE_3 =	7
    447  41b0		       00 08	   INDEX_WHITE_KNIGHT_on_WHITE_SQUARE_0 =	8
    448  41b0		       00 09	   INDEX_WHITE_KNIGHT_on_WHITE_SQUARE_1 =	9
    449  41b0		       00 0a	   INDEX_WHITE_KNIGHT_on_WHITE_SQUARE_2 =	10
    450  41b0		       00 0b	   INDEX_WHITE_KNIGHT_on_WHITE_SQUARE_3 =	11
    451  41b0		       00 0c	   INDEX_WHITE_BISHOP_on_WHITE_SQUARE_0 =	12
    452  41b0		       00 0d	   INDEX_WHITE_BISHOP_on_WHITE_SQUARE_1 =	13
    453  41b0		       00 0e	   INDEX_WHITE_BISHOP_on_WHITE_SQUARE_2 =	14
    454  41b0		       00 0f	   INDEX_WHITE_BISHOP_on_WHITE_SQUARE_3 =	15
    455  41b0		       00 10	   INDEX_WHITE_ROOK_on_WHITE_SQUARE_0 =	16
    456  41b0		       00 11	   INDEX_WHITE_ROOK_on_WHITE_SQUARE_1 =	17
    457  41b0		       00 12	   INDEX_WHITE_ROOK_on_WHITE_SQUARE_2 =	18
    458  41b0		       00 13	   INDEX_WHITE_ROOK_on_WHITE_SQUARE_3 =	19
    459  41b0		       00 14	   INDEX_WHITE_QUEEN_on_WHITE_SQUARE_0 =	20
    460  41b0		       00 15	   INDEX_WHITE_QUEEN_on_WHITE_SQUARE_1 =	21
    461  41b0		       00 16	   INDEX_WHITE_QUEEN_on_WHITE_SQUARE_2 =	22
    462  41b0		       00 17	   INDEX_WHITE_QUEEN_on_WHITE_SQUARE_3 =	23
    463  41b0		       00 18	   INDEX_WHITE_KING_on_WHITE_SQUARE_0 =	24
    464  41b0		       00 19	   INDEX_WHITE_KING_on_WHITE_SQUARE_1 =	25
    465  41b0		       00 1a	   INDEX_WHITE_KING_on_WHITE_SQUARE_2 =	26
    466  41b0		       00 1b	   INDEX_WHITE_KING_on_WHITE_SQUARE_3 =	27
    467  41b0		       00 1c	   INDEX_WHITE_MARKER_on_WHITE_SQUARE_0 =	28
    468  41b0		       00 1d	   INDEX_WHITE_MARKER_on_WHITE_SQUARE_1 =	29
    469  41b0		       00 1e	   INDEX_WHITE_MARKER_on_WHITE_SQUARE_2 =	30
    470  41b0		       00 1f	   INDEX_WHITE_MARKER_on_WHITE_SQUARE_3 =	31
    471  41b0		       00 20	   INDEX_WHITE_PROMOTE_on_WHITE_SQUARE_0 =	32
    472  41b0		       00 21	   INDEX_WHITE_PROMOTE_on_WHITE_SQUARE_1 =	33
    473  41b0		       00 22	   INDEX_WHITE_PROMOTE_on_WHITE_SQUARE_2 =	34
    474  41b0		       00 23	   INDEX_WHITE_PROMOTE_on_WHITE_SQUARE_3 =	35
    475  41b0		       00 24	   INDEX_WHITE_BLANK_on_BLACK_SQUARE_0 =	36
    476  41b0		       00 25	   INDEX_WHITE_BLANK_on_BLACK_SQUARE_1 =	37
    477  41b0		       00 26	   INDEX_WHITE_BLANK_on_BLACK_SQUARE_2 =	38
    478  41b0		       00 27	   INDEX_WHITE_BLANK_on_BLACK_SQUARE_3 =	39
    479  41b0		       00 28	   INDEX_WHITE_PAWN_on_BLACK_SQUARE_0 =	40
    480  41b0		       00 29	   INDEX_WHITE_PAWN_on_BLACK_SQUARE_1 =	41
    481  41b0		       00 2a	   INDEX_WHITE_PAWN_on_BLACK_SQUARE_2 =	42
    482  41b0		       00 2b	   INDEX_WHITE_PAWN_on_BLACK_SQUARE_3 =	43
    483  41b0		       00 2c	   INDEX_WHITE_KNIGHT_on_BLACK_SQUARE_0 =	44
    484  41b0		       00 2d	   INDEX_WHITE_KNIGHT_on_BLACK_SQUARE_1 =	45
    485  41b0		       00 2e	   INDEX_WHITE_KNIGHT_on_BLACK_SQUARE_2 =	46
    486  41b0		       00 2f	   INDEX_WHITE_KNIGHT_on_BLACK_SQUARE_3 =	47
    487  41b0		       00 30	   INDEX_WHITE_BISHOP_on_BLACK_SQUARE_0 =	48
    488  41b0		       00 31	   INDEX_WHITE_BISHOP_on_BLACK_SQUARE_1 =	49
    489  41b0		       00 32	   INDEX_WHITE_BISHOP_on_BLACK_SQUARE_2 =	50
    490  41b0		       00 33	   INDEX_WHITE_BISHOP_on_BLACK_SQUARE_3 =	51
    491  41b0		       00 34	   INDEX_WHITE_ROOK_on_BLACK_SQUARE_0 =	52
    492  41b0		       00 35	   INDEX_WHITE_ROOK_on_BLACK_SQUARE_1 =	53
    493  41b0		       00 36	   INDEX_WHITE_ROOK_on_BLACK_SQUARE_2 =	54
    494  41b0		       00 37	   INDEX_WHITE_ROOK_on_BLACK_SQUARE_3 =	55
    495  41b0		       00 38	   INDEX_WHITE_QUEEN_on_BLACK_SQUARE_0 =	56
    496  41b0		       00 39	   INDEX_WHITE_QUEEN_on_BLACK_SQUARE_1 =	57
    497  41b0		       00 3a	   INDEX_WHITE_QUEEN_on_BLACK_SQUARE_2 =	58
    498  41b0		       00 3b	   INDEX_WHITE_QUEEN_on_BLACK_SQUARE_3 =	59
    499  41b0		       00 3c	   INDEX_WHITE_KING_on_BLACK_SQUARE_0 =	60
    500  41b0		       00 3d	   INDEX_WHITE_KING_on_BLACK_SQUARE_1 =	61
    501  41b0		       00 3e	   INDEX_WHITE_KING_on_BLACK_SQUARE_2 =	62
    502  41b0		       00 3f	   INDEX_WHITE_KING_on_BLACK_SQUARE_3 =	63
    503  41b0		       00 40	   INDEX_WHITE_MARKER_on_BLACK_SQUARE_0 =	64
    504  41b0		       00 41	   INDEX_WHITE_MARKER_on_BLACK_SQUARE_1 =	65
    505  41b0		       00 42	   INDEX_WHITE_MARKER_on_BLACK_SQUARE_2 =	66
    506  41b0		       00 43	   INDEX_WHITE_MARKER_on_BLACK_SQUARE_3 =	67
    507  41b0		       00 44	   INDEX_WHITE_PROMOTE_on_BLACK_SQUARE_0 =	68
    508  41b0		       00 45	   INDEX_WHITE_PROMOTE_on_BLACK_SQUARE_1 =	69
    509  41b0		       00 46	   INDEX_WHITE_PROMOTE_on_BLACK_SQUARE_2 =	70
    510  41b0		       00 47	   INDEX_WHITE_PROMOTE_on_BLACK_SQUARE_3 =	71
    511  41b0		       00 48	   INDEX_BLACK_BLANK_on_WHITE_SQUARE_0 =	72
    512  41b0		       00 49	   INDEX_BLACK_BLANK_on_WHITE_SQUARE_1 =	73
    513  41b0		       00 4a	   INDEX_BLACK_BLANK_on_WHITE_SQUARE_2 =	74
    514  41b0		       00 4b	   INDEX_BLACK_BLANK_on_WHITE_SQUARE_3 =	75
    515  41b0		       00 4c	   INDEX_BLACK_PAWN_on_WHITE_SQUARE_0 =	76
    516  41b0		       00 4d	   INDEX_BLACK_PAWN_on_WHITE_SQUARE_1 =	77
    517  41b0		       00 4e	   INDEX_BLACK_PAWN_on_WHITE_SQUARE_2 =	78
    518  41b0		       00 4f	   INDEX_BLACK_PAWN_on_WHITE_SQUARE_3 =	79
    519  41b0		       00 50	   INDEX_BLACK_KNIGHT_on_WHITE_SQUARE_0 =	80
    520  41b0		       00 51	   INDEX_BLACK_KNIGHT_on_WHITE_SQUARE_1 =	81
    521  41b0		       00 52	   INDEX_BLACK_KNIGHT_on_WHITE_SQUARE_2 =	82
    522  41b0		       00 53	   INDEX_BLACK_KNIGHT_on_WHITE_SQUARE_3 =	83
    523  41b0		       00 54	   INDEX_BLACK_BISHOP_on_WHITE_SQUARE_0 =	84
    524  41b0		       00 55	   INDEX_BLACK_BISHOP_on_WHITE_SQUARE_1 =	85
    525  41b0		       00 56	   INDEX_BLACK_BISHOP_on_WHITE_SQUARE_2 =	86
    526  41b0		       00 57	   INDEX_BLACK_BISHOP_on_WHITE_SQUARE_3 =	87
    527  41b0		       00 58	   INDEX_BLACK_ROOK_on_WHITE_SQUARE_0 =	88
    528  41b0		       00 59	   INDEX_BLACK_ROOK_on_WHITE_SQUARE_1 =	89
    529  41b0		       00 5a	   INDEX_BLACK_ROOK_on_WHITE_SQUARE_2 =	90
    530  41b0		       00 5b	   INDEX_BLACK_ROOK_on_WHITE_SQUARE_3 =	91
    531  41b0		       00 5c	   INDEX_BLACK_QUEEN_on_WHITE_SQUARE_0 =	92
    532  41b0		       00 5d	   INDEX_BLACK_QUEEN_on_WHITE_SQUARE_1 =	93
    533  41b0		       00 5e	   INDEX_BLACK_QUEEN_on_WHITE_SQUARE_2 =	94
    534  41b0		       00 5f	   INDEX_BLACK_QUEEN_on_WHITE_SQUARE_3 =	95
    535  41b0		       00 60	   INDEX_BLACK_KING_on_WHITE_SQUARE_0 =	96
    536  41b0		       00 61	   INDEX_BLACK_KING_on_WHITE_SQUARE_1 =	97
    537  41b0		       00 62	   INDEX_BLACK_KING_on_WHITE_SQUARE_2 =	98
    538  41b0		       00 63	   INDEX_BLACK_KING_on_WHITE_SQUARE_3 =	99
    539  41b0		       00 64	   INDEX_BLACK_MARKER_on_WHITE_SQUARE_0 =	100
    540  41b0		       00 65	   INDEX_BLACK_MARKER_on_WHITE_SQUARE_1 =	101
    541  41b0		       00 66	   INDEX_BLACK_MARKER_on_WHITE_SQUARE_2 =	102
    542  41b0		       00 67	   INDEX_BLACK_MARKER_on_WHITE_SQUARE_3 =	103
    543  41b0		       00 68	   INDEX_BLACK_PROMOTE_on_WHITE_SQUARE_0 =	104
    544  41b0		       00 69	   INDEX_BLACK_PROMOTE_on_WHITE_SQUARE_1 =	105
    545  41b0		       00 6a	   INDEX_BLACK_PROMOTE_on_WHITE_SQUARE_2 =	106
    546  41b0		       00 6b	   INDEX_BLACK_PROMOTE_on_WHITE_SQUARE_3 =	107
    547  41b0		       00 6c	   INDEX_BLACK_BLANK_on_BLACK_SQUARE_0 =	108
    548  41b0		       00 6d	   INDEX_BLACK_BLANK_on_BLACK_SQUARE_1 =	109
    549  41b0		       00 6e	   INDEX_BLACK_BLANK_on_BLACK_SQUARE_2 =	110
    550  41b0		       00 6f	   INDEX_BLACK_BLANK_on_BLACK_SQUARE_3 =	111
    551  41b0		       00 70	   INDEX_BLACK_PAWN_on_BLACK_SQUARE_0 =	112
    552  41b0		       00 71	   INDEX_BLACK_PAWN_on_BLACK_SQUARE_1 =	113
    553  41b0		       00 72	   INDEX_BLACK_PAWN_on_BLACK_SQUARE_2 =	114
    554  41b0		       00 73	   INDEX_BLACK_PAWN_on_BLACK_SQUARE_3 =	115
    555  41b0		       00 74	   INDEX_BLACK_KNIGHT_on_BLACK_SQUARE_0 =	116
    556  41b0		       00 75	   INDEX_BLACK_KNIGHT_on_BLACK_SQUARE_1 =	117
    557  41b0		       00 76	   INDEX_BLACK_KNIGHT_on_BLACK_SQUARE_2 =	118
    558  41b0		       00 77	   INDEX_BLACK_KNIGHT_on_BLACK_SQUARE_3 =	119
    559  41b0		       00 78	   INDEX_BLACK_BISHOP_on_BLACK_SQUARE_0 =	120
    560  41b0		       00 79	   INDEX_BLACK_BISHOP_on_BLACK_SQUARE_1 =	121
    561  41b0		       00 7a	   INDEX_BLACK_BISHOP_on_BLACK_SQUARE_2 =	122
    562  41b0		       00 7b	   INDEX_BLACK_BISHOP_on_BLACK_SQUARE_3 =	123
    563  41b0		       00 7c	   INDEX_BLACK_ROOK_on_BLACK_SQUARE_0 =	124
    564  41b0		       00 7d	   INDEX_BLACK_ROOK_on_BLACK_SQUARE_1 =	125
    565  41b0		       00 7e	   INDEX_BLACK_ROOK_on_BLACK_SQUARE_2 =	126
    566  41b0		       00 7f	   INDEX_BLACK_ROOK_on_BLACK_SQUARE_3 =	127
    567  41b0		       00 80	   INDEX_BLACK_QUEEN_on_BLACK_SQUARE_0 =	128
    568  41b0		       00 81	   INDEX_BLACK_QUEEN_on_BLACK_SQUARE_1 =	129
    569  41b0		       00 82	   INDEX_BLACK_QUEEN_on_BLACK_SQUARE_2 =	130
    570  41b0		       00 83	   INDEX_BLACK_QUEEN_on_BLACK_SQUARE_3 =	131
    571  41b0		       00 84	   INDEX_BLACK_KING_on_BLACK_SQUARE_0 =	132
    572  41b0		       00 85	   INDEX_BLACK_KING_on_BLACK_SQUARE_1 =	133
    573  41b0		       00 86	   INDEX_BLACK_KING_on_BLACK_SQUARE_2 =	134
    574  41b0		       00 87	   INDEX_BLACK_KING_on_BLACK_SQUARE_3 =	135
    575  41b0		       00 88	   INDEX_BLACK_MARKER_on_BLACK_SQUARE_0 =	136
    576  41b0		       00 89	   INDEX_BLACK_MARKER_on_BLACK_SQUARE_1 =	137
    577  41b0		       00 8a	   INDEX_BLACK_MARKER_on_BLACK_SQUARE_2 =	138
    578  41b0		       00 8b	   INDEX_BLACK_MARKER_on_BLACK_SQUARE_3 =	139
    579  41b0		       00 8c	   INDEX_BLACK_PROMOTE_on_BLACK_SQUARE_0 =	140
    580  41b0		       00 8d	   INDEX_BLACK_PROMOTE_on_BLACK_SQUARE_1 =	141
    581  41b0		       00 8e	   INDEX_BLACK_PROMOTE_on_BLACK_SQUARE_2 =	142
    582  41b0		       00 8f	   INDEX_BLACK_PROMOTE_on_BLACK_SQUARE_3 =	143
------- FILE BANK_CHESS_INCLUDES.asm
      0  41b0					      CHECK_BANK_SIZE	"PIECE_VECTORS (2K)"
      1  41b0		       01 b0	   .TEMP      =	* - BANK_START
 PIECE_VECTORS (2K) (2K) SIZE =  $1b0 , FREE= $650
      2  41b0					      ECHO	"PIECE_VECTORS (2K)", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  41b0				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  41b0				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  41b0				  -	      ERR
      6  41b0					      endif
------- FILE ./chess.asm
------- FILE BANK_StateMachine.asm LEVEL 2 PASS 2
      0  41b0					      include	"BANK_StateMachine.asm"
      0  41b0					      NEWBANK	STATEMACHINE
      1  4c30 ????				      SEG	STATEMACHINE
      2  4800					      ORG	ORIGIN
      3  4800					      RORG	$F000
      4  4800				   BANK_START SET	*
      5  4800				   STATEMACHINE SET	ORIGIN / 2048
      6  4800				   ORIGIN     SET	ORIGIN + 2048
      7  4800				   _CURRENT_BANK SET	STATEMACHINE
      2  4800
      3  4800
      4  4800							; Banks holding data (ply 0 doubles as WHITE, and ply 1 as BLACK)
      5  4800
      6  4800		       00 09	   PLAYER     =	RAMBANK_PLY
      7  4800		       00 0a	   OPPONENT   =	PLAYER + 1
      8  4800
      9  4800		       00 08	   CURSOR_MOVE_SPEED =	16/2
     10  4800		       00 08	   CAP_SPEED  =	16/2
     11  4800		       00 0f	   HOLD_DELAY =	30/2
     12  4800
     13  4800							;---------------------------------------------------------------------------------------------------
     14  4800
     15  4800				   P	      SET	0
     16  4800					      MAC	ain
     17  4800				   AI_{1}     SET	P
     18  4800				   P	      SET	P+1
     19  4800					      ENDM
     20  4800
     21  4800					      MAC	lo
     22  4800					      .byte	<ai{1}
     23  4800					      ENDM
     24  4800
     25  4800					      MAC	hi
     26  4800					      .byte	>ai{1}
     27  4800					      ENDM
     28  4800
     29  4800					      MAC	bk
     30  4800					      .byte	BANK_ai{1}
     31  4800					      ENDM
     32  4800
     33  4800					      MAC	tm
     34  4800					      .byte	{2}
     35  4800					      ENDM
     36  4800
     37  4800
     38  4800		       00 28	   ONCEPERFRAME =	40
     39  4800
     40  4800					      MAC	tabdef
     41  4800							; and per-line, {1} = #, {2} = name, {3} = time
     42  4800
     43  4800					      {1}	BeginSelectMovePhase, 1
     44  4800					      {1}	SelectStartSquare, ONCEPERFRAME
     45  4800					      {1}	StartSquareSelected, ONCEPERFRAME
     46  4800					      {1}	DrawMoves, ONCEPERFRAME
     47  4800					      {1}	ShowMoveCaptures, ONCEPERFRAME
     48  4800					      {1}	SlowFlash, ONCEPERFRAME
     49  4800					      {1}	DrawTargetSquares, ONCEPERFRAME
     50  4800					      {1}	SelectDestinationSquare, ONCEPERFRAME
     51  4800					      {1}	Quiescent, ONCEPERFRAME
     52  4800					      {1}	ReselectDebounce, ONCEPERFRAME
     53  4800					      {1}	StartMoveGen, ONCEPERFRAME
     54  4800					      {1}	StepMoveGen, ONCEPERFRAME
     55  4800					      {1}	LookForCheck, ONCEPERFRAME
     56  4800					      {1}	StartClearBoard, ONCEPERFRAME
     57  4800					      {1}	ClearEachRow, ONCEPERFRAME
     58  4800					      {1}	DrawEntireBoard, ONCEPERFRAME
     59  4800					      {1}	DrawPart2, ONCEPERFRAME
     60  4800					      {1}	FlipBuffers, ONCEPERFRAME
     61  4800					      {1}	GenerateMoves, ONCEPERFRAME
     62  4800					      {1}	ComputerMove, ONCEPERFRAME
     63  4800					      {1}	PrepForPhysicalMove, ONCEPERFRAME
     64  4800					      {1}	WriteStartPieceBlank, ONCEPERFRAME
     65  4800					      {1}	MarchToTargetA, ONCEPERFRAME
     66  4800					      {1}	MarchB, ONCEPERFRAME
     67  4800					      {1}	MarchToTargetB, ONCEPERFRAME
     68  4800					      {1}	MarchB2, ONCEPERFRAME
     69  4800					      {1}	FinalFlash, ONCEPERFRAME
     70  4800					      {1}	SpecialMoveFixup, ONCEPERFRAME
     71  4800					      {1}	InCheckBackup, ONCEPERFRAME
     72  4800					      {1}	InCheckDelay, ONCEPERFRAME
     73  4800					      {1}	PromotePawnStart, ONCEPERFRAME
     74  4800					      {1}	RollPromotionPiece, ONCEPERFRAME
     75  4800					      {1}	ChoosePromotePiece, ONCEPERFRAME
     76  4800					      {1}	ChooseDebounce, ONCEPERFRAME
     77  4800					      ENDM		; {1} = macro to use
     78  4800
      0  4800					      TABDEF	AIN
      1  4800
      2  4800
      0  4800					      AIN	BeginSelectMovePhase, 1
      1  4800				   AI_BeginSelectMovePhase SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	SelectStartSquare, ONCEPERFRAME
      1  4800				   AI_SelectStartSquare SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	StartSquareSelected, ONCEPERFRAME
      1  4800				   AI_StartSquareSelected SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	DrawMoves, ONCEPERFRAME
      1  4800				   AI_DrawMoves SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	ShowMoveCaptures, ONCEPERFRAME
      1  4800				   AI_ShowMoveCaptures SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	SlowFlash, ONCEPERFRAME
      1  4800				   AI_SlowFlash SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	DrawTargetSquares, ONCEPERFRAME
      1  4800				   AI_DrawTargetSquares SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	SelectDestinationSquare, ONCEPERFRAME
      1  4800				   AI_SelectDestinationSquare SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	Quiescent, ONCEPERFRAME
      1  4800				   AI_Quiescent SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	ReselectDebounce, ONCEPERFRAME
      1  4800				   AI_ReselectDebounce SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	StartMoveGen, ONCEPERFRAME
      1  4800				   AI_StartMoveGen SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	StepMoveGen, ONCEPERFRAME
      1  4800				   AI_StepMoveGen SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	LookForCheck, ONCEPERFRAME
      1  4800				   AI_LookForCheck SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	StartClearBoard, ONCEPERFRAME
      1  4800				   AI_StartClearBoard SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	ClearEachRow, ONCEPERFRAME
      1  4800				   AI_ClearEachRow SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	DrawEntireBoard, ONCEPERFRAME
      1  4800				   AI_DrawEntireBoard SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	DrawPart2, ONCEPERFRAME
      1  4800				   AI_DrawPart2 SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	FlipBuffers, ONCEPERFRAME
      1  4800				   AI_FlipBuffers SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	GenerateMoves, ONCEPERFRAME
      1  4800				   AI_GenerateMoves SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	ComputerMove, ONCEPERFRAME
      1  4800				   AI_ComputerMove SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	PrepForPhysicalMove, ONCEPERFRAME
      1  4800				   AI_PrepForPhysicalMove SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	WriteStartPieceBlank, ONCEPERFRAME
      1  4800				   AI_WriteStartPieceBlank SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	MarchToTargetA, ONCEPERFRAME
      1  4800				   AI_MarchToTargetA SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	MarchB, ONCEPERFRAME
      1  4800				   AI_MarchB  SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	MarchToTargetB, ONCEPERFRAME
      1  4800				   AI_MarchToTargetB SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	MarchB2, ONCEPERFRAME
      1  4800				   AI_MarchB2 SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	FinalFlash, ONCEPERFRAME
      1  4800				   AI_FinalFlash SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	SpecialMoveFixup, ONCEPERFRAME
      1  4800				   AI_SpecialMoveFixup SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	InCheckBackup, ONCEPERFRAME
      1  4800				   AI_InCheckBackup SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	InCheckDelay, ONCEPERFRAME
      1  4800				   AI_InCheckDelay SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	PromotePawnStart, ONCEPERFRAME
      1  4800				   AI_PromotePawnStart SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	RollPromotionPiece, ONCEPERFRAME
      1  4800				   AI_RollPromotionPiece SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	ChoosePromotePiece, ONCEPERFRAME
      1  4800				   AI_ChoosePromotePiece SET	P
      2  4800				   P	      SET	P+1
      0  4800					      AIN	ChooseDebounce, ONCEPERFRAME
      1  4800				   AI_ChooseDebounce SET	P
      2  4800				   P	      SET	P+1
      0  4800					      DEF	AiVectorLO
      1  4800				   BANK_AiVectorLO SET	_CURRENT_BANK
      2  4800				   AiVectorLO
      3  4800				   TEMPORARY_VAR SET	Overlay
      4  4800				   TEMPORARY_OFFSET SET	0
      5  4800					      SUBROUTINE
      0  4800					      TABDEF	LO
      1  4800
      2  4800
      0  4800					      LO	BeginSelectMovePhase, 1
      1  4800		       06		      .byte.b	<aiBeginSelectMovePhase
      0  4801					      LO	SelectStartSquare, ONCEPERFRAME
      1  4801		       1d		      .byte.b	<aiSelectStartSquare
      0  4802					      LO	StartSquareSelected, ONCEPERFRAME
      1  4802		       95		      .byte.b	<aiStartSquareSelected
      0  4803					      LO	DrawMoves, ONCEPERFRAME
      1  4803		       b7		      .byte.b	<aiDrawMoves
      0  4804					      LO	ShowMoveCaptures, ONCEPERFRAME
      1  4804		       10		      .byte.b	<aiShowMoveCaptures
      0  4805					      LO	SlowFlash, ONCEPERFRAME
      1  4805		       2e		      .byte.b	<aiSlowFlash
      0  4806					      LO	DrawTargetSquares, ONCEPERFRAME
      1  4806		       ee		      .byte.b	<aiDrawTargetSquares
      0  4807					      LO	SelectDestinationSquare, ONCEPERFRAME
      1  4807		       99		      .byte.b	<aiSelectDestinationSquare
      0  4808					      LO	Quiescent, ONCEPERFRAME
      1  4808		       da		      .byte.b	<aiQuiescent
      0  4809					      LO	ReselectDebounce, ONCEPERFRAME
      1  4809		       d1		      .byte.b	<aiReselectDebounce
      0  480a					      LO	StartMoveGen, ONCEPERFRAME
      1  480a		       a3		      .byte.b	<aiStartMoveGen
      0  480b					      LO	StepMoveGen, ONCEPERFRAME
      1  480b		       b5		      .byte.b	<aiStepMoveGen
      0  480c					      LO	LookForCheck, ONCEPERFRAME
      1  480c		       c5		      .byte.b	<aiLookForCheck
      0  480d					      LO	StartClearBoard, ONCEPERFRAME
      1  480d		       41		      .byte.b	<aiStartClearBoard
      0  480e					      LO	ClearEachRow, ONCEPERFRAME
      1  480e		       4e		      .byte.b	<aiClearEachRow
      0  480f					      LO	DrawEntireBoard, ONCEPERFRAME
      1  480f		       c2		      .byte.b	<aiDrawEntireBoard
      0  4810					      LO	DrawPart2, ONCEPERFRAME
      1  4810		       8f		      .byte.b	<aiDrawPart2
      0  4811					      LO	FlipBuffers, ONCEPERFRAME
      1  4811		       eb		      .byte.b	<aiFlipBuffers
      0  4812					      LO	GenerateMoves, ONCEPERFRAME
      1  4812		       2d		      .byte.b	<aiGenerateMoves
      0  4813					      LO	ComputerMove, ONCEPERFRAME
      1  4813		       40		      .byte.b	<aiComputerMove
      0  4814					      LO	PrepForPhysicalMove, ONCEPERFRAME
      1  4814		       60		      .byte.b	<aiPrepForPhysicalMove
      0  4815					      LO	WriteStartPieceBlank, ONCEPERFRAME
      1  4815		       71		      .byte.b	<aiWriteStartPieceBlank
      0  4816					      LO	MarchToTargetA, ONCEPERFRAME
      1  4816		       5c		      .byte.b	<aiMarchToTargetA
      0  4817					      LO	MarchB, ONCEPERFRAME
      1  4817		       a0		      .byte.b	<aiMarchB
      0  4818					      LO	MarchToTargetB, ONCEPERFRAME
      1  4818		       92		      .byte.b	<aiMarchToTargetB
      0  4819					      LO	MarchB2, ONCEPERFRAME
      1  4819		       b0		      .byte.b	<aiMarchB2
      0  481a					      LO	FinalFlash, ONCEPERFRAME
      1  481a		       b0		      .byte.b	<aiFinalFlash
      0  481b					      LO	SpecialMoveFixup, ONCEPERFRAME
      1  481b		       e2		      .byte.b	<aiSpecialMoveFixup
      0  481c					      LO	InCheckBackup, ONCEPERFRAME
      1  481c		       eb		      .byte.b	<aiInCheckBackup
      0  481d					      LO	InCheckDelay, ONCEPERFRAME
      1  481d		       f9		      .byte.b	<aiInCheckDelay
      0  481e					      LO	PromotePawnStart, ONCEPERFRAME
      1  481e		       0a		      .byte.b	<aiPromotePawnStart
      0  481f					      LO	RollPromotionPiece, ONCEPERFRAME
      1  481f		       1e		      .byte.b	<aiRollPromotionPiece
      0  4820					      LO	ChoosePromotePiece, ONCEPERFRAME
      1  4820		       51		      .byte.b	<aiChoosePromotePiece
      0  4821					      LO	ChooseDebounce, ONCEPERFRAME
      1  4821		       b0		      .byte.b	<aiChooseDebounce
      0  4822					      DEF	AiVectorHI
      1  4822				   BANK_AiVectorHI SET	_CURRENT_BANK
      2  4822				   AiVectorHI
      3  4822				   TEMPORARY_VAR SET	Overlay
      4  4822				   TEMPORARY_OFFSET SET	0
      5  4822					      SUBROUTINE
      0  4822					      TABDEF	HI
      1  4822
      2  4822
      0  4822					      HI	BeginSelectMovePhase, 1
      1  4822		       f1		      .byte.b	>aiBeginSelectMovePhase
      0  4823					      HI	SelectStartSquare, ONCEPERFRAME
      1  4823		       f1		      .byte.b	>aiSelectStartSquare
      0  4824					      HI	StartSquareSelected, ONCEPERFRAME
      1  4824		       f1		      .byte.b	>aiStartSquareSelected
      0  4825					      HI	DrawMoves, ONCEPERFRAME
      1  4825		       f1		      .byte.b	>aiDrawMoves
      0  4826					      HI	ShowMoveCaptures, ONCEPERFRAME
      1  4826		       f2		      .byte.b	>aiShowMoveCaptures
      0  4827					      HI	SlowFlash, ONCEPERFRAME
      1  4827		       f2		      .byte.b	>aiSlowFlash
      0  4828					      HI	DrawTargetSquares, ONCEPERFRAME
      1  4828		       f1		      .byte.b	>aiDrawTargetSquares
      0  4829					      HI	SelectDestinationSquare, ONCEPERFRAME
      1  4829		       f2		      .byte.b	>aiSelectDestinationSquare
      0  482a					      HI	Quiescent, ONCEPERFRAME
      1  482a		       f2		      .byte.b	>aiQuiescent
      0  482b					      HI	ReselectDebounce, ONCEPERFRAME
      1  482b		       f2		      .byte.b	>aiReselectDebounce
      0  482c					      HI	StartMoveGen, ONCEPERFRAME
      1  482c		       f0		      .byte.b	>aiStartMoveGen
      0  482d					      HI	StepMoveGen, ONCEPERFRAME
      1  482d		       f0		      .byte.b	>aiStepMoveGen
      0  482e					      HI	LookForCheck, ONCEPERFRAME
      1  482e		       f0		      .byte.b	>aiLookForCheck
      0  482f					      HI	StartClearBoard, ONCEPERFRAME
      1  482f		       f0		      .byte.b	>aiStartClearBoard
      0  4830					      HI	ClearEachRow, ONCEPERFRAME
      1  4830		       f0		      .byte.b	>aiClearEachRow
      0  4831					      HI	DrawEntireBoard, ONCEPERFRAME
      1  4831		       f8		      .byte.b	>aiDrawEntireBoard
      0  4832					      HI	DrawPart2, ONCEPERFRAME
      1  4832		       f0		      .byte.b	>aiDrawPart2
      0  4833					      HI	FlipBuffers, ONCEPERFRAME
      1  4833		       f8		      .byte.b	>aiFlipBuffers
      0  4834					      HI	GenerateMoves, ONCEPERFRAME
      1  4834		       f9		      .byte.b	>aiGenerateMoves
      0  4835					      HI	ComputerMove, ONCEPERFRAME
      1  4835		       f9		      .byte.b	>aiComputerMove
      0  4836					      HI	PrepForPhysicalMove, ONCEPERFRAME
      1  4836		       f0		      .byte.b	>aiPrepForPhysicalMove
      0  4837					      HI	WriteStartPieceBlank, ONCEPERFRAME
      1  4837		       f0		      .byte.b	>aiWriteStartPieceBlank
      0  4838					      HI	MarchToTargetA, ONCEPERFRAME
      1  4838		       f9		      .byte.b	>aiMarchToTargetA
      0  4839					      HI	MarchB, ONCEPERFRAME
      1  4839		       f0		      .byte.b	>aiMarchB
      0  483a					      HI	MarchToTargetB, ONCEPERFRAME
      1  483a		       f9		      .byte.b	>aiMarchToTargetB
      0  483b					      HI	MarchB2, ONCEPERFRAME
      1  483b		       f9		      .byte.b	>aiMarchB2
      0  483c					      HI	FinalFlash, ONCEPERFRAME
      1  483c		       f0		      .byte.b	>aiFinalFlash
      0  483d					      HI	SpecialMoveFixup, ONCEPERFRAME
      1  483d		       f9		      .byte.b	>aiSpecialMoveFixup
      0  483e					      HI	InCheckBackup, ONCEPERFRAME
      1  483e		       f0		      .byte.b	>aiInCheckBackup
      0  483f					      HI	InCheckDelay, ONCEPERFRAME
      1  483f		       f0		      .byte.b	>aiInCheckDelay
      0  4840					      HI	PromotePawnStart, ONCEPERFRAME
      1  4840		       f3		      .byte.b	>aiPromotePawnStart
      0  4841					      HI	RollPromotionPiece, ONCEPERFRAME
      1  4841		       f3		      .byte.b	>aiRollPromotionPiece
      0  4842					      HI	ChoosePromotePiece, ONCEPERFRAME
      1  4842		       f3		      .byte.b	>aiChoosePromotePiece
      0  4843					      HI	ChooseDebounce, ONCEPERFRAME
      1  4843		       f3		      .byte.b	>aiChooseDebounce
      0  4844					      DEF	AiVectorBANK
      1  4844				   BANK_AiVectorBANK SET	_CURRENT_BANK
      2  4844				   AiVectorBANK
      3  4844				   TEMPORARY_VAR SET	Overlay
      4  4844				   TEMPORARY_OFFSET SET	0
      5  4844					      SUBROUTINE
      0  4844					      TABDEF	BK
      1  4844
      2  4844
      0  4844					      BK	BeginSelectMovePhase, 1
      1  4844		       09		      .byte.b	BANK_aiBeginSelectMovePhase
      0  4845					      BK	SelectStartSquare, ONCEPERFRAME
      1  4845		       09		      .byte.b	BANK_aiSelectStartSquare
      0  4846					      BK	StartSquareSelected, ONCEPERFRAME
      1  4846		       09		      .byte.b	BANK_aiStartSquareSelected
      0  4847					      BK	DrawMoves, ONCEPERFRAME
      1  4847		       09		      .byte.b	BANK_aiDrawMoves
      0  4848					      BK	ShowMoveCaptures, ONCEPERFRAME
      1  4848		       09		      .byte.b	BANK_aiShowMoveCaptures
      0  4849					      BK	SlowFlash, ONCEPERFRAME
      1  4849		       09		      .byte.b	BANK_aiSlowFlash
      0  484a					      BK	DrawTargetSquares, ONCEPERFRAME
      1  484a		       09		      .byte.b	BANK_aiDrawTargetSquares
      0  484b					      BK	SelectDestinationSquare, ONCEPERFRAME
      1  484b		       09		      .byte.b	BANK_aiSelectDestinationSquare
      0  484c					      BK	Quiescent, ONCEPERFRAME
      1  484c		       09		      .byte.b	BANK_aiQuiescent
      0  484d					      BK	ReselectDebounce, ONCEPERFRAME
      1  484d		       09		      .byte.b	BANK_aiReselectDebounce
      0  484e					      BK	StartMoveGen, ONCEPERFRAME
      1  484e		       09		      .byte.b	BANK_aiStartMoveGen
      0  484f					      BK	StepMoveGen, ONCEPERFRAME
      1  484f		       09		      .byte.b	BANK_aiStepMoveGen
      0  4850					      BK	LookForCheck, ONCEPERFRAME
      1  4850		       09		      .byte.b	BANK_aiLookForCheck
      0  4851					      BK	StartClearBoard, ONCEPERFRAME
      1  4851		       00		      .byte.b	BANK_aiStartClearBoard
      0  4852					      BK	ClearEachRow, ONCEPERFRAME
      1  4852		       00		      .byte.b	BANK_aiClearEachRow
      0  4853					      BK	DrawEntireBoard, ONCEPERFRAME
      1  4853		       1f		      .byte.b	BANK_aiDrawEntireBoard
      0  4854					      BK	DrawPart2, ONCEPERFRAME
      1  4854		       00		      .byte.b	BANK_aiDrawPart2
      0  4855					      BK	FlipBuffers, ONCEPERFRAME
      1  4855		       1f		      .byte.b	BANK_aiFlipBuffers
      0  4856					      BK	GenerateMoves, ONCEPERFRAME
      1  4856		       1f		      .byte.b	BANK_aiGenerateMoves
      0  4857					      BK	ComputerMove, ONCEPERFRAME
      1  4857		       1f		      .byte.b	BANK_aiComputerMove
      0  4858					      BK	PrepForPhysicalMove, ONCEPERFRAME
      1  4858		       00		      .byte.b	BANK_aiPrepForPhysicalMove
      0  4859					      BK	WriteStartPieceBlank, ONCEPERFRAME
      1  4859		       00		      .byte.b	BANK_aiWriteStartPieceBlank
      0  485a					      BK	MarchToTargetA, ONCEPERFRAME
      1  485a		       1f		      .byte.b	BANK_aiMarchToTargetA
      0  485b					      BK	MarchB, ONCEPERFRAME
      1  485b		       00		      .byte.b	BANK_aiMarchB
      0  485c					      BK	MarchToTargetB, ONCEPERFRAME
      1  485c		       1f		      .byte.b	BANK_aiMarchToTargetB
      0  485d					      BK	MarchB2, ONCEPERFRAME
      1  485d		       1f		      .byte.b	BANK_aiMarchB2
      0  485e					      BK	FinalFlash, ONCEPERFRAME
      1  485e		       00		      .byte.b	BANK_aiFinalFlash
      0  485f					      BK	SpecialMoveFixup, ONCEPERFRAME
      1  485f		       1f		      .byte.b	BANK_aiSpecialMoveFixup
      0  4860					      BK	InCheckBackup, ONCEPERFRAME
      1  4860		       09		      .byte.b	BANK_aiInCheckBackup
      0  4861					      BK	InCheckDelay, ONCEPERFRAME
      1  4861		       09		      .byte.b	BANK_aiInCheckDelay
      0  4862					      BK	PromotePawnStart, ONCEPERFRAME
      1  4862		       09		      .byte.b	BANK_aiPromotePawnStart
      0  4863					      BK	RollPromotionPiece, ONCEPERFRAME
      1  4863		       09		      .byte.b	BANK_aiRollPromotionPiece
      0  4864					      BK	ChoosePromotePiece, ONCEPERFRAME
      1  4864		       09		      .byte.b	BANK_aiChoosePromotePiece
      0  4865					      BK	ChooseDebounce, ONCEPERFRAME
      1  4865		       09		      .byte.b	BANK_aiChooseDebounce
      0  4866					      DEF	AiTimeRequired
      1  4866				   BANK_AiTimeRequired SET	_CURRENT_BANK
      2  4866				   AiTimeRequired
      3  4866				   TEMPORARY_VAR SET	Overlay
      4  4866				   TEMPORARY_OFFSET SET	0
      5  4866					      SUBROUTINE
      0  4866					      TABDEF	TM
      1  4866
      2  4866
      0  4866					      TM	BeginSelectMovePhase, 1
      1  4866		       01		      .byte.b	1
      0  4867					      TM	SelectStartSquare, ONCEPERFRAME
      1  4867		       28		      .byte.b	ONCEPERFRAME
      0  4868					      TM	StartSquareSelected, ONCEPERFRAME
      1  4868		       28		      .byte.b	ONCEPERFRAME
      0  4869					      TM	DrawMoves, ONCEPERFRAME
      1  4869		       28		      .byte.b	ONCEPERFRAME
      0  486a					      TM	ShowMoveCaptures, ONCEPERFRAME
      1  486a		       28		      .byte.b	ONCEPERFRAME
      0  486b					      TM	SlowFlash, ONCEPERFRAME
      1  486b		       28		      .byte.b	ONCEPERFRAME
      0  486c					      TM	DrawTargetSquares, ONCEPERFRAME
      1  486c		       28		      .byte.b	ONCEPERFRAME
      0  486d					      TM	SelectDestinationSquare, ONCEPERFRAME
      1  486d		       28		      .byte.b	ONCEPERFRAME
      0  486e					      TM	Quiescent, ONCEPERFRAME
      1  486e		       28		      .byte.b	ONCEPERFRAME
      0  486f					      TM	ReselectDebounce, ONCEPERFRAME
      1  486f		       28		      .byte.b	ONCEPERFRAME
      0  4870					      TM	StartMoveGen, ONCEPERFRAME
      1  4870		       28		      .byte.b	ONCEPERFRAME
      0  4871					      TM	StepMoveGen, ONCEPERFRAME
      1  4871		       28		      .byte.b	ONCEPERFRAME
      0  4872					      TM	LookForCheck, ONCEPERFRAME
      1  4872		       28		      .byte.b	ONCEPERFRAME
      0  4873					      TM	StartClearBoard, ONCEPERFRAME
      1  4873		       28		      .byte.b	ONCEPERFRAME
      0  4874					      TM	ClearEachRow, ONCEPERFRAME
      1  4874		       28		      .byte.b	ONCEPERFRAME
      0  4875					      TM	DrawEntireBoard, ONCEPERFRAME
      1  4875		       28		      .byte.b	ONCEPERFRAME
      0  4876					      TM	DrawPart2, ONCEPERFRAME
      1  4876		       28		      .byte.b	ONCEPERFRAME
      0  4877					      TM	FlipBuffers, ONCEPERFRAME
      1  4877		       28		      .byte.b	ONCEPERFRAME
      0  4878					      TM	GenerateMoves, ONCEPERFRAME
      1  4878		       28		      .byte.b	ONCEPERFRAME
      0  4879					      TM	ComputerMove, ONCEPERFRAME
      1  4879		       28		      .byte.b	ONCEPERFRAME
      0  487a					      TM	PrepForPhysicalMove, ONCEPERFRAME
      1  487a		       28		      .byte.b	ONCEPERFRAME
      0  487b					      TM	WriteStartPieceBlank, ONCEPERFRAME
      1  487b		       28		      .byte.b	ONCEPERFRAME
      0  487c					      TM	MarchToTargetA, ONCEPERFRAME
      1  487c		       28		      .byte.b	ONCEPERFRAME
      0  487d					      TM	MarchB, ONCEPERFRAME
      1  487d		       28		      .byte.b	ONCEPERFRAME
      0  487e					      TM	MarchToTargetB, ONCEPERFRAME
      1  487e		       28		      .byte.b	ONCEPERFRAME
      0  487f					      TM	MarchB2, ONCEPERFRAME
      1  487f		       28		      .byte.b	ONCEPERFRAME
      0  4880					      TM	FinalFlash, ONCEPERFRAME
      1  4880		       28		      .byte.b	ONCEPERFRAME
      0  4881					      TM	SpecialMoveFixup, ONCEPERFRAME
      1  4881		       28		      .byte.b	ONCEPERFRAME
      0  4882					      TM	InCheckBackup, ONCEPERFRAME
      1  4882		       28		      .byte.b	ONCEPERFRAME
      0  4883					      TM	InCheckDelay, ONCEPERFRAME
      1  4883		       28		      .byte.b	ONCEPERFRAME
      0  4884					      TM	PromotePawnStart, ONCEPERFRAME
      1  4884		       28		      .byte.b	ONCEPERFRAME
      0  4885					      TM	RollPromotionPiece, ONCEPERFRAME
      1  4885		       28		      .byte.b	ONCEPERFRAME
      0  4886					      TM	ChoosePromotePiece, ONCEPERFRAME
      1  4886		       28		      .byte.b	ONCEPERFRAME
      0  4887					      TM	ChooseDebounce, ONCEPERFRAME
      1  4887		       28		      .byte.b	ONCEPERFRAME
     88  4888
     89  4888
     90  4888							;---------------------------------------------------------------------------------------------------
     91  4888
      0  4888					      DEF	AiSetupVectors
      1  4888				   BANK_AiSetupVectors SET	_CURRENT_BANK
      2  4888				   AiSetupVectors
      3  4888				   TEMPORARY_VAR SET	Overlay
      4  4888				   TEMPORARY_OFFSET SET	0
      5  4888					      SUBROUTINE
     93  4888							;SUBROUTINE
     94  4888
     95  4888							; State machine vector setup - points to current routine to execute
     96  4888
     97  4888		       a6 8c		      ldx	aiPhase
     98  488a
     99  488a		       bd 66 f0 	      lda	AiTimeRequired,x
    100  488d		       cd 84 02 	      cmp	INTIM	; is there enough time left?
    101  4890		       b0 10		      bcs	.exit	; nope
    102  4892
    103  4892		       bd 00 f0 	      lda	AiVectorLO,x
    104  4895		       85 ed		      sta	__ptr
    105  4897		       bd 22 f0 	      lda	AiVectorHI,x
    106  489a		       85 ee		      sta	__ptr+1
    107  489c
    108  489c		       bd 44 f0 	      lda	AiVectorBANK,x
    109  489f		       85 8b		      sta	savedBank
    110  48a1
    111  48a1		       18		      clc
    112  48a2		       60	   .exit      rts
    113  48a3
    114  48a3
    115  48a3							;---------------------------------------------------------------------------------------------------
    116  48a3
      0  48a3					      DEF	aiStartMoveGen
      1  48a3				   BANK_aiStartMoveGen SET	_CURRENT_BANK
      2  48a3				   aiStartMoveGen
      3  48a3				   TEMPORARY_VAR SET	Overlay
      4  48a3				   TEMPORARY_OFFSET SET	0
      5  48a3					      SUBROUTINE
    118  48a3					      SUBROUTINE
    119  48a3
    120  48a3							; To assist with castling, generate the moves for the opponent, giving us effectively
    121  48a3							; a list of squares that are being attacked. The castling can't happen if the king is
    122  48a3							; in check or if the squares it would have to move over are in check
    123  48a3
    124  48a3							; we don't need to worry about this if K has moved, or relevant R has moved or if
    125  48a3							; the squares between are occupied. We can tell THAT by examining the movelist to see
    126  48a3							; if there are K-moves marked "FLAG_CASTLE" - and the relevant squares
    127  48a3
    128  48a3		       a9 0a		      lda	#OPPONENT
    129  48a5		       85 9b		      sta	currentPly
    130  48a7		       20 f7 f8 	      jsr	SAFE_InitialiseMoveGeneration
    131  48aa
    132  48aa		       a5 9d		      lda	sideToMove
    133  48ac		       49 80		      eor	#128
    134  48ae		       85 9d		      sta	sideToMove	; for movegen to know
    135  48b0
      0  48b0					      PHASE	AI_StepMoveGen
      1  48b0		       a9 0b		      lda	#AI_StepMoveGen
      2  48b2		       85 8c		      sta	aiPhase
    137  48b4		       60		      rts
    138  48b5
    139  48b5
    140  48b5							;---------------------------------------------------------------------------------------------------
    141  48b5
      0  48b5					      DEF	aiStepMoveGen
      1  48b5				   BANK_aiStepMoveGen SET	_CURRENT_BANK
      2  48b5				   aiStepMoveGen
      3  48b5				   TEMPORARY_VAR SET	Overlay
      4  48b5				   TEMPORARY_OFFSET SET	0
      5  48b5					      SUBROUTINE
    143  48b5					      SUBROUTINE
    144  48b5
    145  48b5							; Because we're (possibly) running with the screen on, processing time is very short and
    146  48b5							; we generate the opponent moves piece by piece. Time isn't really an isssue here, so
    147  48b5							; this happens over multiple frames.
    148  48b5
    149  48b5		       20 03 f9 	      jsr	SAFE_GenerateOneMove
    150  48b8		       90 0a		      bcc	.wait
    151  48ba
    152  48ba		       a5 9d		      lda	sideToMove
    153  48bc		       49 80		      eor	#128
    154  48be		       85 9d		      sta	sideToMove
    155  48c0
      0  48c0					      PHASE	AI_LookForCheck
      1  48c0		       a9 0c		      lda	#AI_LookForCheck
      2  48c2		       85 8c		      sta	aiPhase
    157  48c4		       60	   .wait      rts
    158  48c5
    159  48c5
    160  48c5							;---------------------------------------------------------------------------------------------------
    161  48c5
      0  48c5					      DEF	aiLookForCheck
      1  48c5				   BANK_aiLookForCheck SET	_CURRENT_BANK
      2  48c5				   aiLookForCheck
      3  48c5				   TEMPORARY_VAR SET	Overlay
      4  48c5				   TEMPORARY_OFFSET SET	0
      5  48c5					      SUBROUTINE
    163  48c5					      SUBROUTINE
    164  48c5
    165  48c5							; now we've finished generating the opponent moves
    166  48c5							; See if the square our king is on is an attacked square (that is, it appears as a TO
    167  48c5							; square in the opponent's movelist)
    168  48c5
    169  48c5		       a9 09		      lda	#PLAYER
    170  48c7		       85 9b		      sta	currentPly
    171  48c9		       20 45 fd 	      jsr	SAFE_GetKingSquare	; king's current X12 square
    172  48cc
    173  48cc		       e6 9b		      inc	currentPly
    174  48ce		       20 bb fe 	      jsr	SAFE_IsSquareUnderAttack
    175  48d1		       c6 9b		      dec	currentPly
    176  48d3		       90 11		      bcc	.exit
    177  48d5
    178  48d5							; in check!
    179  48d5
    180  48d5		       a9 40		      lda	#$40
    181  48d7		       85 49		      sta	COLUBK
    182  48d9
    183  48d9		       a9 32		      lda	#50
    184  48db		       85 89		      sta	mdelay
    185  48dd
    186  48dd		       a9 08		      lda	#8
    187  48df		       85 84		      sta	drawCount	; row #
    188  48e1
      0  48e1					      PHASE	AI_InCheckBackup
      1  48e1		       a9 1c		      lda	#AI_InCheckBackup
      2  48e3		       85 8c		      sta	aiPhase
    190  48e5		       60		      rts
    191  48e6
      0  48e6				   .exit      PHASE	AI_BeginSelectMovePhase
      1  48e6		       a9 00		      lda	#AI_BeginSelectMovePhase
      2  48e8		       85 8c		      sta	aiPhase
    193  48ea		       60		      rts
    194  48eb
    195  48eb
    196  48eb							;---------------------------------------------------------------------------------------------------
    197  48eb
      0  48eb					      DEF	aiInCheckBackup
      1  48eb				   BANK_aiInCheckBackup SET	_CURRENT_BANK
      2  48eb				   aiInCheckBackup
      3  48eb				   TEMPORARY_VAR SET	Overlay
      4  48eb				   TEMPORARY_OFFSET SET	0
      5  48eb					      SUBROUTINE
    199  48eb					      SUBROUTINE
    200  48eb
    201  48eb							; We're about to draw some large text on the screen
    202  48eb							; Make a backup copy of all of the row bitmaps, so that we can restore once text is done
    203  48eb
    204  48eb		       c6 84		      dec	drawCount
    205  48ed		       30 05		      bmi	.exit	; done all rows
    206  48ef		       a4 84		      ldy	drawCount
    207  48f1		       4c b1 fe 	      jmp	SAFE_BackupBitmaps
    208  48f4
      0  48f4				   .exit      PHASE	AI_InCheckDelay
      1  48f4		       a9 1d		      lda	#AI_InCheckDelay
      2  48f6		       85 8c		      sta	aiPhase
    210  48f8		       60		      rts
    211  48f9
    212  48f9
    213  48f9							;---------------------------------------------------------------------------------------------------
    214  48f9
      0  48f9					      DEF	aiInCheckDelay
      1  48f9				   BANK_aiInCheckDelay SET	_CURRENT_BANK
      2  48f9				   aiInCheckDelay
      3  48f9				   TEMPORARY_VAR SET	Overlay
      4  48f9				   TEMPORARY_OFFSET SET	0
      5  48f9					      SUBROUTINE
    216  48f9					      SUBROUTINE
    217  48f9
    218  48f9		       c6 89		      dec	mdelay
    219  48fb		       d0 08		      bne	.exit
    220  48fd
    221  48fd		       a9 00		      lda	#0
    222  48ff		       85 49		      sta	COLUBK
    223  4901
      0  4901					      PHASE	AI_BeginSelectMovePhase
      1  4901		       a9 00		      lda	#AI_BeginSelectMovePhase
      2  4903		       85 8c		      sta	aiPhase
    225  4905		       60	   .exit      rts
    226  4906
    227  4906
    228  4906							;---------------------------------------------------------------------------------------------------
    229  4906
      0  4906					      DEF	aiBeginSelectMovePhase
      1  4906				   BANK_aiBeginSelectMovePhase SET	_CURRENT_BANK
      2  4906				   aiBeginSelectMovePhase
      3  4906				   TEMPORARY_VAR SET	Overlay
      4  4906				   TEMPORARY_OFFSET SET	0
      5  4906					      SUBROUTINE
    231  4906					      SUBROUTINE
    232  4906
    233  4906		       a9 04		      lda	#4
    234  4908		       85 87		      sta	highlight_row
    235  490a		       85 88		      sta	highlight_col
    236  490c
    237  490c		       a9 00		      lda	#0
    238  490e		       85 89		      sta	mdelay	;?
    239  4910		       85 93		      sta	aiFlashPhase	;?
    240  4912
    241  4912		       a9 ff		      lda	#-1
    242  4914		       85 8e		      sta	aiFromSquare
    243  4916		       85 8f		      sta	aiToSquare
    244  4918
      0  4918					      PHASE	AI_SelectStartSquare
      1  4918		       a9 01		      lda	#AI_SelectStartSquare
      2  491a		       85 8c		      sta	aiPhase
    246  491c		       60		      rts
    247  491d
    248  491d							;---------------------------------------------------------------------------------------------------
    249  491d
      0  491d					      DEF	aiSelectStartSquare
      1  491d				   BANK_aiSelectStartSquare SET	_CURRENT_BANK
      2  491d				   aiSelectStartSquare
      3  491d				   TEMPORARY_VAR SET	Overlay
      4  491d				   TEMPORARY_OFFSET SET	0
      5  491d					      SUBROUTINE
    251  491d					      SUBROUTINE
    252  491d
    253  491d		       20 53 f2 	      jsr	moveCursor
    254  4920		       20 6a fd 	      jsr	SAFE_IsValidMoveFromSquare
    255  4923
    256  4923		       c6 8a		      dec	ccur	; pulse colour for valid squares
    257  4925		       20 52 f1 	      jsr	setCursorColours
    258  4928
    259  4928		       98		      tya
    260  4929		       05 4c		      ora	INPT4
    261  492b		       30 04		      bmi	.exit	; illegal square or no button press
    262  492d
      0  492d					      PHASE	AI_StartSquareSelected
      1  492d		       a9 02		      lda	#AI_StartSquareSelected
      2  492f		       85 8c		      sta	aiPhase
    264  4931
    265  4931		       60	   .exit      rts
    266  4932
    267  4932							;---------------------------------------------------------------------------------------------------
    268  4932
      0  4932					      DEF	setCursorPriority
      1  4932				   BANK_setCursorPriority SET	_CURRENT_BANK
      2  4932				   setCursorPriority
      3  4932				   TEMPORARY_VAR SET	Overlay
      4  4932				   TEMPORARY_OFFSET SET	0
      5  4932					      SUBROUTINE
    270  4932					      SUBROUTINE
    271  4932
    272  4932		       98		      tya
    273  4933		       48		      pha
    274  4934
    275  4934		       a2 04		      ldx	#%100
    276  4936
    277  4936		       a5 87		      lda	highlight_row
    278  4938		       30 13		      bmi	.under
    279  493a
    280  493a		       49 07		      eor	#7
    281  493c		       0a		      asl
    282  493d		       0a		      asl
    283  493e		       0a		      asl
    284  493f		       05 88		      ora	highlight_col
    285  4941		       aa		      tax
    286  4942
    287  4942		       20 b3 f8 	      jsr	SAFE_Get64toX12Board
    288  4945		       a2 04		      ldx	#%100
    289  4947		       c9 00		      cmp	#0
    290  4949		       d0 02		      bne	.under
    291  494b		       a2 00		      ldx	#0
    292  494d		       86 4a	   .under     stx	CTRLPF	; UNDER
    293  494f
    294  494f		       68		      pla
    295  4950		       a8		      tay
    296  4951		       60		      rts
    297  4952
    298  4952							;---------------------------------------------------------------------------------------------------
    299  4952
      0  4952					      DEF	setCursorColours
      1  4952				   BANK_setCursorColours SET	_CURRENT_BANK
      2  4952				   setCursorColours
      3  4952				   TEMPORARY_VAR SET	Overlay
      4  4952				   TEMPORARY_OFFSET SET	0
      5  4952					      SUBROUTINE
    301  4952					      SUBROUTINE
    302  4952
    303  4952							; pass y=-1 if move is NOT in the movelist
    304  4952							; preserve y
    305  4952
    306  4952		       a9 44		      lda	#$44
    307  4954
    308  4954		       c0 ff		      cpy	#-1
    309  4956		       f0 0a		      beq	.writeCursorCol	; NOT in the movelist
    310  4958
    311  4958		       a5 8a		      lda	ccur
    312  495a		       4a		      lsr
    313  495b		       4a		      lsr
    314  495c		       4a		      lsr
    315  495d		       29 03		      and	#3
    316  495f		       18		      clc
    317  4960		       69 c0		      adc	#$C0	;COLOUR_LINE_1
    318  4962
    319  4962		       85 46	   .writeCursorCol sta	COLUP0
    320  4964		       60		      rts
    321  4965
    322  4965
    323  4965							;	    RLDU RLD  RL U RL	R DU R D  R  U R     LDU  LD   L U  L	  DU   D     U
    324  4965							;	   0000 0001 0010 0011 0100 0101 0110 0111 1000 1001 1010 1011 1100 1101 1110 1111
    325  4965
      0  4965					      ALLOCATE	JoyMoveX, 16
      0  4965					      OPTIONAL_PAGEBREAK	"Table", 16
     10  4965					      LIST	ON
      0  4965					      DEF	JoyMoveX
      1  4965				   BANK_JoyMoveX SET	_CURRENT_BANK
      2  4965				   JoyMoveX
      3  4965				   TEMPORARY_VAR SET	Overlay
      4  4965				   TEMPORARY_OFFSET SET	0
      5  4965					      SUBROUTINE
    327  4965		       00 00 00 00*	      .byte.b	0, 0, 0, 0, 0, 1, 1, 1, 0, -1, -1, -1, 0, 0, 0, 0
      0  4975					      ALLOCATE	JoyMoveY, 16
      0  4975					      OPTIONAL_PAGEBREAK	"Table", 16
     10  4975					      LIST	ON
      0  4975					      DEF	JoyMoveY
      1  4975				   BANK_JoyMoveY SET	_CURRENT_BANK
      2  4975				   JoyMoveY
      3  4975				   TEMPORARY_VAR SET	Overlay
      4  4975				   TEMPORARY_OFFSET SET	0
      5  4975					      SUBROUTINE
    329  4975		       00 00 00 00*	      .byte.b	0, 0, 0, 0, 0, 1, -1, 0, 0, 1, -1, 0, 0, 1, -1, 0
      0  4985					      ALLOCATE	JoyCombined, 16
      0  4985					      OPTIONAL_PAGEBREAK	"Table", 16
     10  4985					      LIST	ON
      0  4985					      DEF	JoyCombined
      1  4985				   BANK_JoyCombined SET	_CURRENT_BANK
      2  4985				   JoyCombined
      3  4985				   TEMPORARY_VAR SET	Overlay
      4  4985				   TEMPORARY_OFFSET SET	0
      5  4985					      SUBROUTINE
    331  4985		       00 00 00 00*	      .byte.b	0, 0, 0, 0, 0, 1, 1, 1, 0, -1, -1, -1, 0, 1, -1, 0
    332  4995
    333  4995
    334  4995							;---------------------------------------------------------------------------------------------------
    335  4995
      0  4995					      DEF	aiStartSquareSelected
      1  4995				   BANK_aiStartSquareSelected SET	_CURRENT_BANK
      2  4995				   aiStartSquareSelected
      3  4995				   TEMPORARY_VAR SET	Overlay
      4  4995				   TEMPORARY_OFFSET SET	0
      5  4995					      SUBROUTINE
    337  4995					      SUBROUTINE
    338  4995
    339  4995							; Mark all the valid moves for the selected piece on the board
    340  4995							; and then start pulsing the piece
    341  4995							; AND start choosing for selection of TO square
    342  4995
    343  4995							; Iterate the movelist and for all from squares which = drawPieceNumber
    344  4995							; then draw a BLANK at that square
    345  4995							; do 1 by one, when none found then increment state
    346  4995
    347  4995		       a5 87		      lda	highlight_row
    348  4997		       49 07		      eor	#7
    349  4999		       0a		      asl
    350  499a		       0a		      asl
    351  499b		       0a		      asl
    352  499c		       05 88		      ora	highlight_col
    353  499e		       85 80		      sta	drawPieceNumber
    354  49a0
    355  49a0		       a9 0a		      lda	#10
    356  49a2		       85 8d		      sta	aiFlashDelay
    357  49a4		       a9 00		      lda	#0
    358  49a6		       85 8f		      sta	aiToSquare
    359  49a8		       85 93		      sta	aiFlashPhase	; for debounce exit timing
    360  49aa
    361  49aa		       a9 ff		      lda	#-1
    362  49ac		       85 92		      sta	aiMoveIndex
    363  49ae
    364  49ae		       a9 0f		      lda	#HOLD_DELAY
    365  49b0		       85 89		      sta	mdelay	; hold-down delay before moves are shown
    366  49b2
      0  49b2					      PHASE	AI_DrawMoves
      1  49b2		       a9 03		      lda	#AI_DrawMoves
      2  49b4		       85 8c		      sta	aiPhase
    368  49b6		       60		      rts
    369  49b7
    370  49b7							;---------------------------------------------------------------------------------------------------
    371  49b7
      0  49b7					      DEF	aiDrawMoves
      1  49b7				   BANK_aiDrawMoves SET	_CURRENT_BANK
      2  49b7				   aiDrawMoves
      3  49b7				   TEMPORARY_VAR SET	Overlay
      4  49b7				   TEMPORARY_OFFSET SET	0
      5  49b7					      SUBROUTINE
    373  49b7					      SUBROUTINE
    374  49b7
    375  49b7		       c6 8a		      dec	ccur
    376  49b9		       20 52 f1 	      jsr	setCursorColours
    377  49bc
    378  49bc		       c6 89		      dec	mdelay
    379  49be		       d0 21		      bne	.exit
    380  49c0		       a9 01		      lda	#1	; larger number will slow the draw of available moves
    381  49c2		       85 89		      sta	mdelay	; once triggered, runs always
    382  49c4
    383  49c4		       a5 92		      lda	aiMoveIndex
    384  49c6		       10 05		      bpl	.valid
    385  49c8		       20 49 fe 	      jsr	SAFE_getMoveIndex
    386  49cb		       85 92		      sta	aiMoveIndex
    387  49cd				   .valid
    388  49cd
    389  49cd		       20 55 fe 	      jsr	SAFE_showMoveOptions	; draw potential moves one at a time
    390  49d0		       a5 92		      lda	aiMoveIndex
    391  49d2		       10 19		      bpl	.unsure	; still drawing in this phase
    392  49d4
    393  49d4		       a9 08		      lda	#CAP_SPEED
    394  49d6		       85 89		      sta	mdelay
    395  49d8
    396  49d8		       a9 00		      lda	#0
    397  49da		       85 93		      sta	aiFlashPhase	; controls odd/even exit of flashing
    398  49dc
      0  49dc					      PHASE	AI_ShowMoveCaptures
      1  49dc		       a9 04		      lda	#AI_ShowMoveCaptures
      2  49de		       85 8c		      sta	aiPhase
    400  49e0		       60		      rts
    401  49e1
    402  49e1				   .exit
    403  49e1
    404  49e1							; Initial piece selection has happened, but the button hasn't been released yet
    405  49e1							; AND we're still in the waiting phase to see if the button was held long enough for move show
    406  49e1
    407  49e1		       a5 4c		      lda	INPT4
    408  49e3		       10 08		      bpl	.unsure	; button still pressed, so still unsure what to do
    409  49e5
    410  49e5							; Aha! Button released, so we know the selected piece and can start flashing it
    411  49e5							; and allowing movement of the selector to a destination square...
    412  49e5
    413  49e5		       a9 18		      lda	#6*4
    414  49e7		       85 8a		      sta	ccur	; bright green square for selection
    415  49e9
      0  49e9					      PHASE	AI_SelectDestinationSquare
      1  49e9		       a9 07		      lda	#AI_SelectDestinationSquare
      2  49eb		       85 8c		      sta	aiPhase
    417  49ed
    418  49ed		       60	   .unsure    rts
    419  49ee
    420  49ee
    421  49ee							;---------------------------------------------------------------------------------------------------
    422  49ee
      0  49ee					      DEF	aiDrawTargetSquares
      1  49ee				   BANK_aiDrawTargetSquares SET	_CURRENT_BANK
      2  49ee				   aiDrawTargetSquares
      3  49ee				   TEMPORARY_VAR SET	Overlay
      4  49ee				   TEMPORARY_OFFSET SET	0
      5  49ee					      SUBROUTINE
    424  49ee					      SUBROUTINE
    425  49ee
    426  49ee		       c6 8a		      dec	ccur
    427  49f0		       20 52 f1 	      jsr	setCursorColours
    428  49f3
    429  49f3		       c6 89		      dec	mdelay
    430  49f5		       d0 18		      bne	.exit
    431  49f7		       a9 01		      lda	#1
    432  49f9		       85 89		      sta	mdelay	; once triggered, runs always
    433  49fb
    434  49fb		       a5 92		      lda	aiMoveIndex
    435  49fd		       10 05		      bpl	.valid
    436  49ff		       20 49 fe 	      jsr	SAFE_getMoveIndex
    437  4a02		       85 92		      sta	aiMoveIndex
    438  4a04				   .valid
    439  4a04
    440  4a04		       20 55 fe 	      jsr	SAFE_showMoveOptions	; draw potential moves one at a time
    441  4a07		       a5 92		      lda	aiMoveIndex
    442  4a09		       10 04		      bpl	.exit	; still drawing in this phase
    443  4a0b
      0  4a0b					      PHASE	AI_SelectStartSquare
      1  4a0b		       a9 01		      lda	#AI_SelectStartSquare
      2  4a0d		       85 8c		      sta	aiPhase
    445  4a0f
    446  4a0f		       60	   .exit      rts
    447  4a10
    448  4a10
    449  4a10							;---------------------------------------------------------------------------------------------------
    450  4a10
    451  4a10
      0  4a10					      DEF	aiShowMoveCaptures
      1  4a10				   BANK_aiShowMoveCaptures SET	_CURRENT_BANK
      2  4a10				   aiShowMoveCaptures
      3  4a10				   TEMPORARY_VAR SET	Overlay
      4  4a10				   TEMPORARY_OFFSET SET	0
      5  4a10					      SUBROUTINE
    453  4a10					      SUBROUTINE
    454  4a10
    455  4a10							; draw/undraw ALL captured pieces
    456  4a10							; we should do this an even number of times so that pieces don't disappEOR
    457  4a10
    458  4a10		       c6 8a		      dec	ccur
    459  4a12		       20 52 f1 	      jsr	setCursorColours
    460  4a15
    461  4a15		       c6 89		      dec	mdelay	; flash speed UNVARYING despite draw happening
    462  4a17
    463  4a17		       a5 92		      lda	aiMoveIndex
    464  4a19		       10 05		      bpl	.valid	; guaranteed -1 on 1st call
    465  4a1b		       20 49 fe 	      jsr	SAFE_getMoveIndex
    466  4a1e		       85 92		      sta	aiMoveIndex
    467  4a20				   .valid
    468  4a20
    469  4a20		       20 c7 fe 	      jsr	SAFE_showMoveCaptures
    470  4a23		       a5 92		      lda	aiMoveIndex
    471  4a25		       10 06		      bpl	.exit
    472  4a27
    473  4a27		       e6 93		      inc	aiFlashPhase
    474  4a29
      0  4a29					      PHASE	AI_SlowFlash
      1  4a29		       a9 05		      lda	#AI_SlowFlash
      2  4a2b		       85 8c		      sta	aiPhase
    476  4a2d
    477  4a2d		       60	   .exit      rts
    478  4a2e
    479  4a2e
    480  4a2e							;---------------------------------------------------------------------------------------------------
    481  4a2e
      0  4a2e					      DEF	aiSlowFlash
      1  4a2e				   BANK_aiSlowFlash SET	_CURRENT_BANK
      2  4a2e				   aiSlowFlash
      3  4a2e				   TEMPORARY_VAR SET	Overlay
      4  4a2e				   TEMPORARY_OFFSET SET	0
      5  4a2e					      SUBROUTINE
    483  4a2e					      SUBROUTINE
    484  4a2e
    485  4a2e							; Joystick button is held down, so we're displaying the available moves
    486  4a2e							; They have all been drawn, so now we "slow" flash any pieces that can be captures
    487  4a2e
    488  4a2e		       c6 8a		      dec	ccur
    489  4a30		       20 52 f1 	      jsr	setCursorColours
    490  4a33
    491  4a33		       a5 93		      lda	aiFlashPhase
    492  4a35		       29 01		      and	#1
    493  4a37		       d0 04		      bne	.notEven	; only exit after even # EOR-draws
    494  4a39
    495  4a39		       a5 4c		      lda	INPT4
    496  4a3b		       30 0d		      bmi	.butpress	; exit on button release
    497  4a3d
    498  4a3d				   .notEven
    499  4a3d
    500  4a3d							; Wait for delay to expire then back and flash 'em again
    501  4a3d
    502  4a3d		       c6 89		      dec	mdelay
    503  4a3f		       10 08		      bpl	.slowWait
    504  4a41
    505  4a41		       a9 08		      lda	#CAP_SPEED
    506  4a43		       85 89		      sta	mdelay
    507  4a45
      0  4a45					      PHASE	AI_ShowMoveCaptures	; go back and rEORdraw all captures again
      1  4a45		       a9 04		      lda	#AI_ShowMoveCaptures
      2  4a47		       85 8c		      sta	aiPhase
    509  4a49
    510  4a49		       60	   .slowWait  rts
    511  4a4a
    512  4a4a
    513  4a4a		       a9 01	   .butpress  lda	#1
    514  4a4c		       85 89		      sta	mdelay
    515  4a4e
      0  4a4e					      PHASE	AI_DrawTargetSquares
      1  4a4e		       a9 06		      lda	#AI_DrawTargetSquares
      2  4a50		       85 8c		      sta	aiPhase
    517  4a52		       60		      rts
    518  4a53
    519  4a53
    520  4a53							;---------------------------------------------------------------------------------------------------
    521  4a53
      0  4a53					      DEF	moveCursor
      1  4a53				   BANK_moveCursor SET	_CURRENT_BANK
      2  4a53				   moveCursor
      3  4a53				   TEMPORARY_VAR SET	Overlay
      4  4a53				   TEMPORARY_OFFSET SET	0
      5  4a53					      SUBROUTINE
    523  4a53					      SUBROUTINE
    524  4a53
    525  4a53							; Part (a) move cursor around the board waiting for joystick press
    526  4a53
    527  4a53
    528  4a53		       ad 80 02 	      lda	SWCHA
    529  4a56		       4a		      lsr
    530  4a57		       4a		      lsr
    531  4a58		       4a		      lsr
    532  4a59		       4a		      lsr
    533  4a5a		       a8		      tay
    534  4a5b
    535  4a5b		       c9 0f		      cmp	#15
    536  4a5d		       f0 24		      beq	.cursor	; nothing pressed - skip delays
    537  4a5f
    538  4a5f		       c6 89		      dec	mdelay
    539  4a61		       10 27		      bpl	.delaym
    540  4a63
    541  4a63
    542  4a63		       18		      clc
    543  4a64		       a5 87		      lda	highlight_row
    544  4a66		       79 75 f1 	      adc	JoyMoveY,y
    545  4a69		       c9 08		      cmp	#$8
    546  4a6b		       b0 02		      bcs	.abandon
    547  4a6d		       85 87		      sta	highlight_row
    548  4a6f				   .abandon
    549  4a6f		       18		      clc
    550  4a70		       a5 88		      lda	highlight_col
    551  4a72		       79 65 f1 	      adc	JoyMoveX,y
    552  4a75		       c9 08		      cmp	#$8
    553  4a77		       b0 02		      bcs	.abandon2
    554  4a79		       85 88		      sta	highlight_col
    555  4a7b				   .abandon2
    556  4a7b
    557  4a7b		       a9 08		      lda	#CURSOR_MOVE_SPEED
    558  4a7d		       85 89		      sta	mdelay
    559  4a7f		       20 32 f1 	      jsr	setCursorPriority
    560  4a82		       60		      rts
    561  4a83
    562  4a83
    563  4a83		       a9 00	   .cursor    lda	#0
    564  4a85		       85 89		      sta	mdelay
    565  4a87		       20 32 f1 	      jsr	setCursorPriority
    566  4a8a
    567  4a8a		       60	   .delaym    rts
    568  4a8b
    569  4a8b
    570  4a8b							;---------------------------------------------------------------------------------------------------
    571  4a8b
      0  4a8b					      DEF	FlashPiece
      1  4a8b				   BANK_FlashPiece SET	_CURRENT_BANK
      2  4a8b				   FlashPiece
      3  4a8b				   TEMPORARY_VAR SET	Overlay
      4  4a8b				   TEMPORARY_OFFSET SET	0
      5  4a8b					      SUBROUTINE
    573  4a8b					      SUBROUTINE
    574  4a8b
    575  4a8b							; Flash the selected piece
    576  4a8b
    577  4a8b		       c6 8d		      dec	aiFlashDelay
    578  4a8d		       d0 09		      bne	.noFlashAi
    579  4a8f
    580  4a8f		       e6 93		      inc	aiFlashPhase
    581  4a91
    582  4a91		       a9 0a		      lda	#10
    583  4a93		       85 8d		      sta	aiFlashDelay
    584  4a95
    585  4a95		       20 ea fd 	      jsr	SAFE_CopySinglePiece
    586  4a98
    587  4a98		       60	   .noFlashAi rts
    588  4a99
    589  4a99							;---------------------------------------------------------------------------------------------------
    590  4a99
      0  4a99					      DEF	aiSelectDestinationSquare
      1  4a99				   BANK_aiSelectDestinationSquare SET	_CURRENT_BANK
      2  4a99				   aiSelectDestinationSquare
      3  4a99				   TEMPORARY_VAR SET	Overlay
      4  4a99				   TEMPORARY_OFFSET SET	0
      5  4a99					      SUBROUTINE
    592  4a99					      SUBROUTINE
    593  4a99
    594  4a99							; Piece is selected and now we're looking for a button press on a destination square
    595  4a99							; we flash the piece on-and-off while we're doing that
    596  4a99
    597  4a99		       20 8b f2 	      jsr	FlashPiece
    598  4a9c		       20 53 f2 	      jsr	moveCursor
    599  4a9f		       20 91 fd 	      jsr	SAFE_IsValidMoveToSquare
    600  4aa2		       20 52 f1 	      jsr	setCursorColours
    601  4aa5
    602  4aa5							; y = valid square
    603  4aa5
    604  4aa5		       a5 4c		      lda	INPT4
    605  4aa7		       30 27		      bmi	.noButton
    606  4aa9
    607  4aa9		       a5 8f		      lda	aiToSquare
    608  4aab		       c5 8e		      cmp	aiFromSquare	; is to==from?  that's a cancelllation
    609  4aad		       f0 0d		      beq	.cancel
    610  4aaf
    611  4aaf		       c0 ff		      cpy	#-1
    612  4ab1		       f0 1d		      beq	.noButton	; not a valid square
    613  4ab3
    614  4ab3		       a5 93		      lda	aiFlashPhase
    615  4ab5		       29 01		      and	#1
    616  4ab7		       f0 13		      beq	.done
    617  4ab9		       85 8d		      sta	aiFlashDelay	; EOR-phase incorrect - force quick fix to allow next-frame button detect
    618  4abb		       60		      rts
    619  4abc
    620  4abc				   .cancel
    621  4abc
    622  4abc		       a5 93		      lda	aiFlashPhase
    623  4abe		       29 01		      and	#1
    624  4ac0		       f0 05		      beq	.doCancel
    625  4ac2
    626  4ac2							; EOR-phase incorrect - force quick fix to allow next-frame button detect
    627  4ac2
    628  4ac2		       a9 01		      lda	#1
    629  4ac4		       85 8d		      sta	aiFlashDelay
    630  4ac6		       60		      rts
    631  4ac7
    632  4ac7
      0  4ac7				   .doCancel  PHASE	AI_ReselectDebounce
      1  4ac7		       a9 09		      lda	#AI_ReselectDebounce
      2  4ac9		       85 8c		      sta	aiPhase
    634  4acb		       60		      rts
    635  4acc
      0  4acc				   .done      PHASE	AI_Quiescent	; destination selected!
      1  4acc		       a9 08		      lda	#AI_Quiescent
      2  4ace		       85 8c		      sta	aiPhase
    637  4ad0		       60	   .noButton  rts
    638  4ad1
    639  4ad1
    640  4ad1							;---------------------------------------------------------------------------------------------------
    641  4ad1
      0  4ad1					      DEF	aiReselectDebounce
      1  4ad1				   BANK_aiReselectDebounce SET	_CURRENT_BANK
      2  4ad1				   aiReselectDebounce
      3  4ad1				   TEMPORARY_VAR SET	Overlay
      4  4ad1				   TEMPORARY_OFFSET SET	0
      5  4ad1					      SUBROUTINE
    643  4ad1					      SUBROUTINE
    644  4ad1
    645  4ad1							; We've just cancelled the move. Wait for the button to be released
    646  4ad1							; and then go back to selecting a piece to move
    647  4ad1
    648  4ad1		       a5 4c		      lda	INPT4
    649  4ad3		       10 04		      bpl	.exit	; button still pressed, so wait
    650  4ad5
      0  4ad5					      PHASE	AI_SelectStartSquare
      1  4ad5		       a9 01		      lda	#AI_SelectStartSquare
      2  4ad7		       85 8c		      sta	aiPhase
    652  4ad9		       60	   .exit      rts
    653  4ada
    654  4ada							;---------------------------------------------------------------------------------------------------
    655  4ada
      0  4ada					      DEF	aiQuiescent
      1  4ada				   BANK_aiQuiescent SET	_CURRENT_BANK
      2  4ada				   aiQuiescent
      3  4ada				   TEMPORARY_VAR SET	Overlay
      4  4ada				   TEMPORARY_OFFSET SET	0
      5  4ada					      SUBROUTINE
    657  4ada					      SUBROUTINE
      0  4ada					      TAG	MOVE_SELECTED
      1  4ada
    659  4ada
    660  4ada		       a9 ff		      lda	#-1
    661  4adc		       85 87		      sta	highlight_row	; turn off cursor
    662  4ade
    663  4ade		       a5 8e		      lda	aiFromSquare
    664  4ae0		       85 9e		      sta	fromSquare
    665  4ae2		       a5 8f		      lda	aiToSquare
    666  4ae4		       85 a0		      sta	toSquare
    667  4ae6
    668  4ae6		       a5 90		      lda	aiFromSquareX12
    669  4ae8		       85 85		      sta	fromX12
    670  4aea		       a5 91		      lda	aiToSquareX12
    671  4aec		       85 86		      sta	toX12
    672  4aee
    673  4aee		       20 85 fd 	      jsr	SAFE_GetPiece
    674  4af1
    675  4af1							; With en-passant flag, it is essentially dual-use.
    676  4af1							; First, it marks if the move is *involved* somehow in an en-passant
    677  4af1							; if the piece has MOVED already, then it's an en-passant capture
    678  4af1							; if it has NOT moved, then it's a pawn leaving home rank, and sets the en-passant square
    679  4af1
    680  4af1
    681  4af1				  -	      if	0
    682  4af1				  -	      ldx	#0
    683  4af1				  -	      lda	aiPiece
    684  4af1				  -	      and	#FLAG_ENPASSANT|FLAG_MOVED
    685  4af1				  -	      cmp	#FLAG_ENPASSANT
    686  4af1				  -	      bne	.noep	; HAS moved, or not en-passant
    687  4af1				  -
    688  4af1				  -	      lda	aiPiece
    689  4af1				  -	      and	#~FLAG_ENPASSANT	; clear flag as it's been handled
    690  4af1				  -	      sta	aiPiece
    691  4af1				  -
    692  4af1				  -	      ldx	toX12	; this IS an en-passantable opening, so record the square
    693  4af1				  -.noep		;stx enPassantPawn		  ; capturable square for en-passant move
    694  4af1					      endif
    695  4af1
    696  4af1							; End of en-passant handling
    697  4af1
    698  4af1		       a5 a4		      lda	aiPiece
    699  4af3		       85 9f		      sta	fromPiece
    700  4af5							;ora #FLAG_MOVED		 ; for K/R prevents usage in castling
    701  4af5							;sta toPiece
    702  4af5
    703  4af5
    704  4af5
    705  4af5		       a4 85		      ldy	fromX12
    706  4af7		       20 4f fd 	      jsr	GetBoard	; get the piece
    707  4afa
    708  4afa		       45 9f		      eor	fromPiece
    709  4afc		       29 0f		      and	#PIECE_MASK	; if not the same piece board/movelist...
    710  4afe		       d0 05		      bne	.promote	; promote a pawn
    711  4b00
      0  4b00					      PHASE	AI_PrepForPhysicalMove
      1  4b00		       a9 14		      lda	#AI_PrepForPhysicalMove
      2  4b02		       85 8c		      sta	aiPhase
    713  4b04		       60		      rts
    714  4b05
      0  4b05				   .promote   PHASE	AI_PromotePawnStart
      1  4b05		       a9 1e		      lda	#AI_PromotePawnStart
      2  4b07		       85 8c		      sta	aiPhase
    716  4b09		       60		      rts
    717  4b0a
    718  4b0a
    719  4b0a							;---------------------------------------------------------------------------------------------------
    720  4b0a
      0  4b0a					      DEF	aiPromotePawnStart
      1  4b0a				   BANK_aiPromotePawnStart SET	_CURRENT_BANK
      2  4b0a				   aiPromotePawnStart
      3  4b0a				   TEMPORARY_VAR SET	Overlay
      4  4b0a				   TEMPORARY_OFFSET SET	0
      5  4b0a					      SUBROUTINE
    722  4b0a					      SUBROUTINE
    723  4b0a
    724  4b0a		       a9 00		      lda	#0
    725  4b0c		       85 93		      sta	aiFlashPhase
    726  4b0e		       85 8d		      sta	aiFlashDelay
    727  4b10
    728  4b10		       a4 8f		      ldy	aiToSquare
    729  4b12		       84 80		      sty	drawPieceNumber
    730  4b14
    731  4b14		       a4 91		      ldy	aiToSquareX12
    732  4b16		       20 df fd 	      jsr	SAFE_PromoteStart	; remove any capturable piece for display purposes
    733  4b19
      0  4b19					      PHASE	AI_RollPromotionPiece
      1  4b19		       a9 1f		      lda	#AI_RollPromotionPiece
      2  4b1b		       85 8c		      sta	aiPhase
    735  4b1d		       60		      rts
    736  4b1e
    737  4b1e
    738  4b1e							;---------------------------------------------------------------------------------------------------
    739  4b1e
      0  4b1e					      DEF	aiRollPromotionPiece
      1  4b1e				   BANK_aiRollPromotionPiece SET	_CURRENT_BANK
      2  4b1e				   aiRollPromotionPiece
      3  4b1e				   TEMPORARY_VAR SET	Overlay
      4  4b1e				   TEMPORARY_OFFSET SET	0
      5  4b1e					      SUBROUTINE
    741  4b1e					      SUBROUTINE
    742  4b1e
    743  4b1e							; Flash the '?' and wait for an UDLR move
    744  4b1e
    745  4b1e		       ad 80 02 	      lda	SWCHA
    746  4b21		       29 f0		      and	#$F0
    747  4b23		       c9 f0		      cmp	#$F0
    748  4b25		       f0 0a		      beq	.nojoy
    749  4b27
    750  4b27		       a9 00		      lda	#0
    751  4b29		       85 8d		      sta	aiFlashDelay
    752  4b2b
    753  4b2b		       a5 93		      lda	aiFlashPhase
    754  4b2d		       29 01		      and	#1
    755  4b2f		       f0 10		      beq	.even
    756  4b31
    757  4b31		       c6 8d	   .nojoy     dec	aiFlashDelay
    758  4b33		       10 0b		      bpl	.exit
    759  4b35
    760  4b35		       a9 0a		      lda	#10
    761  4b37		       85 8d		      sta	aiFlashDelay
    762  4b39
    763  4b39		       a2 20		      ldx	#INDEX_WHITE_PROMOTE_on_WHITE_SQUARE_0
    764  4b3b		       20 97 fe 	      jsr	SAFE_showPromoteOptions
    765  4b3e
    766  4b3e		       e6 93		      inc	aiFlashPhase
    767  4b40
    768  4b40		       60	   .exit      rts
    769  4b41
    770  4b41
    771  4b41		       a9 03	   .even      lda	#3	; QUEEN
    772  4b43		       85 a4		      sta	aiPiece	; cycles as index to NBRQ
    773  4b45
    774  4b45		       e6 93		      inc	aiFlashPhase
    775  4b47
    776  4b47		       a2 14		      ldx	#INDEX_WHITE_QUEEN_on_WHITE_SQUARE_0	;TODO: fix for colour
    777  4b49		       20 97 fe 	      jsr	SAFE_showPromoteOptions
    778  4b4c
      0  4b4c					      PHASE	AI_ChooseDebounce
      1  4b4c		       a9 21		      lda	#AI_ChooseDebounce
      2  4b4e		       85 8c		      sta	aiPhase
    780  4b50		       60		      rts
    781  4b51
    782  4b51
    783  4b51							;---------------------------------------------------------------------------------------------------
    784  4b51
      0  4b51					      DEF	aiChoosePromotePiece
      1  4b51				   BANK_aiChoosePromotePiece SET	_CURRENT_BANK
      2  4b51				   aiChoosePromotePiece
      3  4b51				   TEMPORARY_VAR SET	Overlay
      4  4b51				   TEMPORARY_OFFSET SET	0
      5  4b51					      SUBROUTINE
    786  4b51					      SUBROUTINE
    787  4b51
    788  4b51							; Question-mark phase has exited via joystick direction
    789  4b51							; Now we cycle through the selectable pieces
    790  4b51
    791  4b51		       a5 4c		      lda	INPT4
    792  4b53		       30 0a		      bmi	.nobut	; no press
    793  4b55
    794  4b55							; button pressed but make sure phase is correct for exit
    795  4b55
    796  4b55		       a9 00		      lda	#0
    797  4b57		       85 8d		      sta	aiFlashDelay
    798  4b59
    799  4b59		       a5 93		      lda	aiFlashPhase
    800  4b5b		       29 01		      and	#1
    801  4b5d		       f0 35		      beq	.chosen	; button pressed --> selection made
    802  4b5f
    803  4b5f				   .nobut
    804  4b5f
    805  4b5f		       ad 80 02 	      lda	SWCHA
    806  4b62		       29 f0		      and	#$F0
    807  4b64		       c9 f0		      cmp	#$F0
    808  4b66		       f0 19		      beq	.odd	; no direction pressed
    809  4b68
    810  4b68		       4a		      lsr
    811  4b69		       4a		      lsr
    812  4b6a		       4a		      lsr
    813  4b6b		       4a		      lsr
    814  4b6c		       a8		      tay
    815  4b6d
    816  4b6d							; joystick but make sure phase is correct
    817  4b6d
    818  4b6d		       a5 93		      lda	aiFlashPhase
    819  4b6f		       29 01		      and	#1
    820  4b71		       d0 0e		      bne	.odd	; must wait until piece undrawn
    821  4b73
    822  4b73							; cycle to the next promotable piece (N/B/R/Q)
    823  4b73							; TODO; use joy table for mod instead of just incrementing all the time
    824  4b73
    825  4b73		       18		      clc
    826  4b74		       a5 a4		      lda	aiPiece
    827  4b76		       79 85 f1 	      adc	JoyCombined,y
    828  4b79		       29 03		      and	#3
    829  4b7b		       85 a4		      sta	aiPiece
    830  4b7d
      0  4b7d					      PHASE	AI_ChooseDebounce	; wait for release
      1  4b7d		       a9 21		      lda	#AI_ChooseDebounce
      2  4b7f		       85 8c		      sta	aiPhase
    832  4b81
    833  4b81		       c6 8d	   .odd       dec	aiFlashDelay
    834  4b83		       10 0e		      bpl	.exit
    835  4b85
    836  4b85		       a9 0a	   .force     lda	#10
    837  4b87		       85 8d		      sta	aiFlashDelay
    838  4b89
    839  4b89		       e6 93		      inc	aiFlashPhase
    840  4b8b
    841  4b8b		       a4 a4		      ldy	aiPiece
    842  4b8d		       be a8 f3 	      ldx	promotePiece,y
    843  4b90		       20 97 fe 	      jsr	SAFE_showPromoteOptions
    844  4b93
    845  4b93		       60	   .exit      rts
    846  4b94
    847  4b94
    848  4b94				   .chosen
    849  4b94		       a5 a4		      lda	aiPiece
    850  4b96		       29 0f		      and	#PIECE_MASK
    851  4b98		       aa		      tax
    852  4b99
    853  4b99		       bd ac f3 	      lda	promoteType,x
    854  4b9c		       85 9f		      sta	fromPiece
    855  4b9e
    856  4b9e		       a4 91		      ldy	aiToSquareX12
    857  4ba0		       20 df fd 	      jsr	SAFE_PromoteStart
    858  4ba3
      0  4ba3					      PHASE	AI_PrepForPhysicalMove
      1  4ba3		       a9 14		      lda	#AI_PrepForPhysicalMove
      2  4ba5		       85 8c		      sta	aiPhase
    860  4ba7		       60		      rts
    861  4ba8
      0  4ba8					      ALLOCATE	promotePiece, 4
      0  4ba8					      OPTIONAL_PAGEBREAK	"Table", 4
     10  4ba8					      LIST	ON
      0  4ba8					      DEF	promotePiece
      1  4ba8				   BANK_promotePiece SET	_CURRENT_BANK
      2  4ba8				   promotePiece
      3  4ba8				   TEMPORARY_VAR SET	Overlay
      4  4ba8				   TEMPORARY_OFFSET SET	0
      5  4ba8					      SUBROUTINE
    863  4ba8		       08		      .byte.b	INDEX_WHITE_KNIGHT_on_WHITE_SQUARE_0
    864  4ba9		       0c		      .byte.b	INDEX_WHITE_BISHOP_on_WHITE_SQUARE_0
    865  4baa		       10		      .byte.b	INDEX_WHITE_ROOK_on_WHITE_SQUARE_0
    866  4bab		       14		      .byte.b	INDEX_WHITE_QUEEN_on_WHITE_SQUARE_0
    867  4bac
      0  4bac					      ALLOCATE	promoteType,4
      0  4bac					      OPTIONAL_PAGEBREAK	"Table", 4
     10  4bac					      LIST	ON
      0  4bac					      DEF	promoteType
      1  4bac				   BANK_promoteType SET	_CURRENT_BANK
      2  4bac				   promoteType
      3  4bac				   TEMPORARY_VAR SET	Overlay
      4  4bac				   TEMPORARY_OFFSET SET	0
      5  4bac					      SUBROUTINE
    869  4bac		       03 04 05 06	      .byte.b	KNIGHT, BISHOP, ROOK, QUEEN
    870  4bb0
    871  4bb0
    872  4bb0							;---------------------------------------------------------------------------------------------------
    873  4bb0
      0  4bb0					      DEF	aiChooseDebounce
      1  4bb0				   BANK_aiChooseDebounce SET	_CURRENT_BANK
      2  4bb0				   aiChooseDebounce
      3  4bb0				   TEMPORARY_VAR SET	Overlay
      4  4bb0				   TEMPORARY_OFFSET SET	0
      5  4bb0					      SUBROUTINE
    875  4bb0					      SUBROUTINE
    876  4bb0
    877  4bb0							; We've changed promotion piece, but wait for joystick to be released
    878  4bb0
    879  4bb0		       ad 80 02 	      lda	SWCHA
    880  4bb3		       29 f0		      and	#$F0
    881  4bb5		       c9 f0		      cmp	#$F0
    882  4bb7		       d0 08		      bne	.exit	; wait while joystick still pressed
    883  4bb9
    884  4bb9		       a9 01		      lda	#1
    885  4bbb		       85 8d		      sta	aiFlashDelay
    886  4bbd
      0  4bbd					      PHASE	AI_ChoosePromotePiece
      1  4bbd		       a9 20		      lda	#AI_ChoosePromotePiece
      2  4bbf		       85 8c		      sta	aiPhase
    888  4bc1		       60	   .exit      rts
    889  4bc2
    890  4bc2							;---------------------------------------------------------------------------------------------------
    891  4bc2
    892  4c00		       00 00 00 00*	      align	256
      0  4c00					      DEF	PositionSprites
      1  4c00				   BANK_PositionSprites SET	_CURRENT_BANK
      2  4c00				   PositionSprites
      3  4c00				   TEMPORARY_VAR SET	Overlay
      4  4c00				   TEMPORARY_OFFSET SET	0
      5  4c00					      SUBROUTINE
    894  4c00					      SUBROUTINE
    895  4c00
    896  4c00		       a4 88		      ldy	highlight_col
    897  4c02
    898  4c02		       85 42		      sta	WSYNC	; 00	  Sync to start of scanline.
    899  4c04
    900  4c04		       b9 28 f4 	      lda	colToPixel,y
    901  4c07
    902  4c07		       38		      sec		; 02	  Set the carry flag so no borrow will be applied during the division.
    903  4c08		       e9 0f	   .divideby15 sbc	#15	; 04	  Waste the necessary amount of time dividing X-pos by 15!
    904  4c0a		       b0 fc		      bcs	.divideby15	; 06/07  11/16/21/26/31/36/41/46/51/56/61/66
    905  4c0c
    906  4c0c		       a8		      tay
    907  4c0d		       b9 28 f3 	      lda	fineAdjustTable,y	; 13 -> Consume 5 cycles by guaranteeing we cross a page boundary
    908  4c10		       85 60		      sta	HMP0
    909  4c12		       85 50		      sta	RESP0	; 21/ 26/31/36/41/46/51/56/61/66/71 - Set the rough position.
    910  4c14
    911  4c14		       85 42		      sta	WSYNC
    912  4c16		       85 6a		      sta	HMOVE
    913  4c18
    914  4c18		       60		      rts
    915  4c19
    916  4c19							; This table converts the "remainder" of the division by 15 (-1 to -15) to the correct
    917  4c19							; fine adjustment value. This table is on a page boundary to guarantee the processor
    918  4c19							; will cross a page boundary and waste a cycle in order to be at the precise position
    919  4c19							; for a RESP0,x write
    920  4c19
    921  4c19				   fineAdjustBegin
    922  4c19
    923  4c19		       70		      DC.B	%01110000	; Left 7
    924  4c1a		       60		      DC.B	%01100000	; Left 6
    925  4c1b		       50		      DC.B	%01010000	; Left 5
    926  4c1c		       40		      DC.B	%01000000	; Left 4
    927  4c1d		       30		      DC.B	%00110000	; Left 3
    928  4c1e		       20		      DC.B	%00100000	; Left 2
    929  4c1f		       10		      DC.B	%00010000	; Left 1
    930  4c20		       00		      DC.B	%00000000	; No movement.
    931  4c21		       f0		      DC.B	%11110000	; Right 1
    932  4c22		       e0		      DC.B	%11100000	; Right 2
    933  4c23		       d0		      DC.B	%11010000	; Right 3
    934  4c24		       c0		      DC.B	%11000000	; Right 4
    935  4c25		       b0		      DC.B	%10110000	; Right 5
    936  4c26		       a0		      DC.B	%10100000	; Right 6
    937  4c27		       90		      DC.B	%10010000	; Right 7
    938  4c28
    939  4c28		       f3 28	   fineAdjustTable EQU	fineAdjustBegin - %11110001	; NOTE: %11110001 = -15
    940  4c28
    941  4c28
      0  4c28					      ALLOCATE	colToPixel, 8
      0  4c28					      OPTIONAL_PAGEBREAK	"Table", 8
     10  4c28					      LIST	ON
      0  4c28					      DEF	colToPixel
      1  4c28				   BANK_colToPixel SET	_CURRENT_BANK
      2  4c28				   colToPixel
      3  4c28				   TEMPORARY_VAR SET	Overlay
      4  4c28				   TEMPORARY_OFFSET SET	0
      5  4c28					      SUBROUTINE
    943  4c28		       00 14 28 3c*	      .byte.b	0,20,40,60,80,100,120,140
    944  4c30
      0  4c30					      CHECK_BANK_SIZE	"BANK_StateMachine"
      1  4c30		       04 30	   .TEMP      =	* - BANK_START
 BANK_StateMachine (2K) SIZE =  $430 , FREE= $3d0
      2  4c30					      ECHO	"BANK_StateMachine", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  4c30				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  4c30				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  4c30				  -	      ERR
      6  4c30					      endif
    946  4c30
    947  4c30
    948  4c30							; EOF
------- FILE ./chess.asm
------- FILE BANK_TEXT_OVERLAYS.asm LEVEL 2 PASS 2
      0  4c30					      include	"BANK_TEXT_OVERLAYS.asm"
      0  4c30					      NEWBANK	TEXT_OVERLAYS
      1  5002 ????				      SEG	TEXT_OVERLAYS
      2  5000					      ORG	ORIGIN
      3  5000					      RORG	$F000
      4  5000				   BANK_START SET	*
      5  5000				   TEXT_OVERLAYS SET	ORIGIN / 2048
      6  5000				   ORIGIN     SET	ORIGIN + 2048
      7  5000				   _CURRENT_BANK SET	TEXT_OVERLAYS
      2  5000
      3  5000
      4  5000
      5  5000
      6  5000				   sample
      7  5000		       48 aa		      .byte.b	72,%10101010
      8  5002
      9  5002
     10  5002
     11  5002							;EOF
------- FILE ./chess.asm
    469  5002
------- FILE titleScreen.asm LEVEL 2 PASS 2
      0  5002					      include	"titleScreen.asm"
      0  5002					      NEWBANK	TITLESCREEN
      1  5fc0 ????				      SEG	TITLESCREEN
      2  5800					      ORG	ORIGIN
      3  5800					      RORG	$F000
      4  5800				   BANK_START SET	*
      5  5800				   TITLESCREEN SET	ORIGIN / 2048
      6  5800				   ORIGIN     SET	ORIGIN + 2048
      7  5800				   _CURRENT_BANK SET	TITLESCREEN
      2  5800
      3  5800				   OverscanTime2
      4  5800		       1a 1a		      .byte.b	26, 26
      5  5802		       20 20		      .byte.b	32, 32
      6  5804
      7  5804				   colvec
      8  5804		       00 f1 d8 f1	      .word.w	colr_ntsc2, colr_pal
      9  5808
     10  5808
     11  5808		       32 32	   VBlankTime .byte.b	50,50
     12  580a
      0  580a					      DEF	TitleScreen
      1  580a				   BANK_TitleScreen SET	_CURRENT_BANK
      2  580a				   TitleScreen
      3  580a				   TEMPORARY_VAR SET	Overlay
      4  580a				   TEMPORARY_OFFSET SET	0
      5  580a					      SUBROUTINE
     14  580a					      SUBROUTINE
     15  580a
      0  580a					      VAR	__colour_table, 2
      1  580a				   __colour_table SET	TEMPORARY_VAR
      2  580a				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 2
      3  580a
      4  580a				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  580a				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  580a				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  580a					      ENDIF
      8  580a				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  580a				  -	      ECHO	"Temporary Variable", __colour_table, "overflow!"
     10  580a				  -	      ERR
     11  580a					      ENDIF
     12  580a					      LIST	ON
     17  580a
     18  580a							; Start of new frame
     19  580a
     20  580a							; Start of vertical blank processing
     21  580a
     22  580a				   TitleSequence
     23  580a
     24  580a		       a9 00		      lda	#%00000000
     25  580c		       85 4a		      sta	CTRLPF
     26  580e		       85 49		      sta	COLUBK
     27  5810
     28  5810		       a2 00		      ldx	#0	;Platform
     29  5812		       a9 00		      lda	#<colr_ntsc2	;colvec,x
     30  5814		       85 a5		      sta	__colour_table
     31  5816		       a9 f1		      lda	#>colr_ntsc2	;colvec+1,x
     32  5818		       85 a6		      sta	__colour_table+1
     33  581a
     34  581a							;		  sta rndHi
     35  581a							;		  sta rnd
     36  581a
     37  581a
     38  581a				  -	      if	0
     39  581a				  -	      lda	#0
     40  581a				  -	      sta	digit
     41  581a				  -	      lda	#$10
     42  581a				  -	      sta	digit+1
     43  581a				  -	      lda	#$20
     44  581a				  -	      sta	digit+2
     45  581a					      endif
     46  581a
     47  581a
     48  581a
     49  581a
      0  581a					      RESYNC
      1  581a
      2  581a		       a9 02		      lda	#%10
      3  581c		       85 41		      sta	VBLANK
      4  581e
      5  581e		       a2 08		      ldx	#8
      6  5820				   .loopResync
      0  5820					      VERTICAL_SYNC
      1  5820		       a9 0e		      lda	#%1110
      2  5822		       85 42	   .VSLP1     sta	WSYNC
      3  5824		       85 40		      sta	VSYNC
      4  5826		       4a		      lsr
      5  5827		       d0 f9		      bne	.VSLP1
      8  5829
      9  5829		       a0 88		      ldy	#SCANLINES_NTSC/2 - 2
     10  582b		       a5 a3		      lda	Platform
     11  582d		       49 02		      eor	#PAL_50
     12  582f		       d0 02		      bne	.ntsc
     13  5831		       a0 9a		      ldy	#SCANLINES_PAL/2 - 2
     14  5833				   .ntsc
     15  5833				   .loopWait
     16  5833		       85 42		      sta	WSYNC
     17  5835		       85 42		      sta	WSYNC
     18  5837		       88		      dey
     19  5838		       d0 f9		      bne	.loopWait
     20  583a		       ca		      dex
     21  583b		       d0 e3		      bne	.loopResync
     51  583d
     52  583d				   RestartFrame0
     53  583d
     54  583d				  -	      if	0
     55  583d				  -	      ldx	#2
     56  583d				  -rollcols   clc
     57  583d				  -	      lda	digit+2
     58  583d				  -	      adc	#$10
     59  583d				  -	      sta	digit+2
     60  583d				  -	      bcc	finxc
     61  583d				  -	      dex
     62  583d				  -	      bpl	rollcols
     63  583d				  -finxc
     64  583d					      endif
     65  583d
      0  583d					      DEF	RestartFrame
      1  583d				   BANK_RestartFrame SET	_CURRENT_BANK
      2  583d				   RestartFrame
      3  583d				   TEMPORARY_VAR SET	Overlay
      4  583d				   TEMPORARY_OFFSET SET	0
      5  583d					      SUBROUTINE
     67  583d		       a9 00		      LDA	#0
     68  583f		       a9 0e		      lda	#%1110	; VSYNC ON
     69  5841		       85 42	   .loopVSync2 sta	WSYNC
     70  5843		       85 40		      sta	VSYNC
     71  5845		       4a		      lsr
     72  5846		       d0 f9		      bne	.loopVSync2	; branch until VYSNC has been reset
     73  5848
     74  5848							;------------------------------------------------------------------
     75  5848
     76  5848		       a6 a3		      ldx	Platform
     77  584a		       bc 08 f0 	      ldy	VBlankTime,x
     78  584d		       8c 96 02 	      sty	TIM64T
     79  5850
     80  5850
     81  5850				  -	      if	0
     82  5850				  -	      lda	SWCHB
     83  5850				  -	      rol
     84  5850				  -	      rol
     85  5850				  -	      rol
     86  5850				  -	      and	#%11
     87  5850				  -	      eor	#PAL
     88  5850				  -	      cmp	Platform
     89  5850				  -	      beq	platOK
     90  5850				  -	      sta	Platform
     91  5850				  -	      jmp	TitleSequence
     92  5850				  -platOK
     93  5850					      endif
     94  5850
     95  5850		       e6 81	   k2	      inc	rnd
     96  5852		       f0 fc		      beq	k2
     97  5854
     98  5854
     99  5854		       85 42	   VerticalBlank sta	WSYNC
    100  5856		       ad 84 02 	      lda	INTIM
    101  5859		       d0 f9		      bne	VerticalBlank
    102  585b		       85 41		      sta	VBLANK
    103  585d
    104  585d							;sta COLUBK
    105  585d
    106  585d							;------------------------------------------------------------------
    107  585d
    108  585d							; Do X scanlines of color-changing (our picture)
    109  585d
    110  585d		       a0 d1		      ldy	#210-1	; this counts our scanline number
    111  585f		       a2 03	   SokoLogo   ldx	#3
    112  5861		       b1 a5	   triplet    lda	(__colour_table),y
    113  5863							;    eor digit-1,x
    114  5863		       85 42		      sta	WSYNC
    115  5865		       85 48		      sta	COLUPF	; 3
    116  5867
    117  5867		       b9 b0 f2 	      lda	COL_0,y	; 5
    118  586a		       85 4d		      sta	PF0	; 3   @11
    119  586c		       b9 88 f3 	      lda	COL_1,y	; 5
    120  586f		       85 4e		      sta	PF1	; 3   @19
    121  5871		       b9 60 f4 	      lda	COL_2,y	; 5
    122  5874		       85 4f		      sta	PF2	; 3   @27
    123  5876
    124  5876		       b9 38 f5 	      lda	COL_3,y	; 5
    125  5879		       85 4d		      sta	PF0	; 3   @35
      0  587b					      SLEEP	2	; @37
      1  587b				   .CYCLES    SET	2
      2  587b
      3  587b				  -	      IF	.CYCLES < 2
      4  587b				  -	      ECHO	"MACRO ERROR: 'SLEEP': Duration must be > 1"
      5  587b				  -	      ERR
      6  587b					      ENDIF
      7  587b
      8  587b				  -	      IF	.CYCLES & 1
      9  587b				  -	      IFNCONST	NO_ILLEGAL_OPCODES
     10  587b				  -	      nop	0
     11  587b				  -	      ELSE
     12  587b				  -	      bit	VSYNC
     13  587b				  -	      ENDIF
     14  587b				  -.CYCLES    SET	.CYCLES - 3
     15  587b					      ENDIF
     16  587b
     17  587b					      REPEAT	.CYCLES / 2
     18  587b		       ea		      nop
     19  587c					      REPEND
    127  587c		       b9 10 f6 	      lda	COL_4,y	; 5
    128  587f		       85 4e		      sta	PF1	; 3   @45
      0  5881					      SLEEP	3	; @45
      1  5881				   .CYCLES    SET	3
      2  5881
      3  5881				  -	      IF	.CYCLES < 2
      4  5881				  -	      ECHO	"MACRO ERROR: 'SLEEP': Duration must be > 1"
      5  5881				  -	      ERR
      6  5881					      ENDIF
      7  5881
      8  5881					      IF	.CYCLES & 1
      9  5881					      IFNCONST	NO_ILLEGAL_OPCODES
     10  5881		       04 00		      nop	0
     11  5883				  -	      ELSE
     12  5883				  -	      bit	VSYNC
     13  5883					      ENDIF
     14  5883				   .CYCLES    SET	.CYCLES - 3
     15  5883					      ENDIF
     16  5883
     17  5883				  -	      REPEAT	.CYCLES / 2
     18  5883				  -	      nop
     19  5883					      REPEND
    130  5883		       b9 e8 f6 	      lda	COL_5,y	; 5
    131  5886		       85 4f		      sta	PF2	; 3
    132  5888
    133  5888		       88		      dey		; 2
    134  5889		       ca		      dex		; 2
    135  588a		       d0 d5		      bne	triplet	; 2(3)
    136  588c
    137  588c		       c0 ff		      cpy	#-1	; 2
    138  588e		       d0 cf		      bne	SokoLogo	; 2(3)
    139  5890
    140  5890							;lda #0
    141  5890							;sta PF0
    142  5890							;sta PF1
    143  5890							;sta PF2
    144  5890
    145  5890		       a6 a3		      ldx	Platform
    146  5892		       bd 00 f0 	      lda	OverscanTime2,x
    147  5895		       8d 96 02 	      sta	TIM64T
    148  5898
    149  5898				  -	      if	0
    150  5898				  -	      sta	WSYNC
    151  5898				  -	      sta	WSYNC
    152  5898				  -	      sta	WSYNC
    153  5898				  -	      sta	WSYNC
    154  5898				  -	      sta	WSYNC
    155  5898				  -	      SLEEP	8
    156  5898				  -	      jsr	SokoScreen
    157  5898				  -
    158  5898				  -	      lda	#0
    159  5898				  -	      sta	BoardScrollX
    160  5898				  -	      sta	BoardScrollY
    161  5898					      endif
    162  5898
    163  5898							;		ldy #63
    164  5898							;bot2		 sta WSYNC
    165  5898							;		dey
    166  5898							;		bpl bot2
    167  5898
    168  5898							;--------------------------------------------------------------------------
    169  5898
    170  5898		       a9 00		      lda	#0
    171  589a		       85 4d		      sta	PF0
    172  589c		       85 4e		      sta	PF1
    173  589e		       85 4f		      sta	PF2
    174  58a0
    175  58a0
      0  58a0					      NEXT_RANDOM
      1  58a0		       a5 81		      lda	rnd
      2  58a2		       4a		      lsr
      3  58a3		       90 02		      bcc	.skipEOR
      4  58a5		       49 fe		      eor	#RND_EOR_VAL
      5  58a7		       85 81	   .skipEOR   sta	rnd
    177  58a9
    178  58a9							; D1 VBLANK turns off beam
    179  58a9							; It needs to be turned on 37 scanlines later
    180  58a9
    181  58a9				   oscan
    182  58a9		       ad 84 02 	      lda	INTIM
    183  58ac		       d0 fb		      bne	oscan
    184  58ae
    185  58ae		       a9 42		      lda	#%01000010	; bit6 is not required
    186  58b0		       85 41		      sta	VBLANK	; end of screen - enter blanking
    187  58b2
    188  58b2				  -	      if	0
    189  58b2				  -	      inc	rnd
    190  58b2				  -	      bne	rdd
    191  58b2				  -	      inc	rndHi
    192  58b2				  -rdd
    193  58b2				  -
    194  58b2				  -	      dec	digitick
    195  58b2				  -	      bpl	ret2
    196  58b2				  -	      lda	#40
    197  58b2				  -	      sta	digitick
    198  58b2				  -
    199  58b2				  -	      jsr	Random
    200  58b2				  -	      and	#3
    201  58b2				  -	      beq	ret2
    202  58b2				  -	      tax
    203  58b2				  -	      jsr	Random
    204  58b2				  -	      and	#$F0
    205  58b2				  -	      sta	digit-1,x
    206  58b2				  -	      jmp	RestartFrame0
    207  58b2				  -
    208  58b2				  -ret2
    209  58b2					      endif
    210  58b2
    211  58b2
    212  58b2		       a5 4c		      lda	INPT4
    213  58b4		       10 03		      bpl	ret
    214  58b6
    215  58b6		       4c 3d f0 	      jmp	RestartFrame
    216  58b9
    217  58b9				   ret
    218  58b9		       60		      rts
    219  58ba
    220  58ba
    221  58ba
    222  58ba					      MAC	lumtable
    223  58ba							; {4} MIN LUM 1
    224  58ba							; {5} MIN LUM 2
    225  58ba							; {6} MIN LUM 3
    226  58ba
    227  58ba				   .LUM1      SET	{4}*256
    228  58ba				   .LUM2      SET	{5}*256
    229  58ba				   .LUM3      SET	{6}*256
    230  58ba
    231  58ba				   .STEP1     =	(256*({7}-{4}))/72
    232  58ba				   .STEP2     =	(256*({8}-{5}))/72
    233  58ba				   .STEP3     =	(256*({9}-{6}))/72
    234  58ba
    235  58ba					      REPEAT	72
    236  58ba					      .byte	{1}+(.LUM1/256)
    237  58ba					      .byte	{2}+(.LUM2/256)
    238  58ba					      .byte	{3}+(.LUM3/256)
    239  58ba
    240  58ba							;    ECHO {1}+(.LUM1/256)
    241  58ba							;    ECHO {2}+(.LUM1/256)
    242  58ba							;    ECHO {3}+(.LUM1/256)
    243  58ba
    244  58ba				   .LUM1      SET	.LUM1 + .STEP1
    245  58ba				   .LUM2      SET	.LUM2 + .STEP2
    246  58ba				   .LUM3      SET	.LUM3 + .STEP3
    247  58ba					      REPEND
    248  58ba					      ENDM		;{1}{2}{3} base colours
    249  58ba
    250  58ba							;colr_pal    LUMTABLE $B0,$30,$A0,0,8,4 ;2,4,6
    251  58ba							;    OPTIONAL_PAGEBREAK "colr_ntsc", 72*3
    252  58ba
    253  5900		       00 00 00 00*	      align	256
    254  5900							;    ECHO "NTSC LUMS"
    255  5900				   colr_ntsc2
      0  5900					      LUMTABLE	$40,$20,$90,$4,$6,$8,$4,$6,$8
      1  5900
      2  5900
      3  5900
      4  5900
      5  5900				   .LUM1      SET	$4*256
      6  5900				   .LUM2      SET	$6*256
      7  5900				   .LUM3      SET	$8*256
      8  5900
      9  5900		       00 00	   .STEP1     =	(256*($4-$4))/72
     10  5900		       00 00	   .STEP2     =	(256*($6-$6))/72
     11  5900		       00 00	   .STEP3     =	(256*($8-$8))/72
     12  5900
     13  5900					      REPEAT	72
     14  5900		       44		      .byte.b	$40+(.LUM1/256)
     15  5901		       26		      .byte.b	$20+(.LUM2/256)
     16  5902		       98		      .byte.b	$90+(.LUM3/256)
     17  5903
     18  5903
     19  5903
     20  5903
     21  5903
     22  5903				   .LUM1      SET	.LUM1 + .STEP1
     23  5903				   .LUM2      SET	.LUM2 + .STEP2
     24  5903				   .LUM3      SET	.LUM3 + .STEP3
     13  5903					      REPEND
     14  5903		       44		      .byte.b	$40+(.LUM1/256)
     15  5904		       26		      .byte.b	$20+(.LUM2/256)
     16  5905		       98		      .byte.b	$90+(.LUM3/256)
     17  5906
     18  5906
     19  5906
     20  5906
     21  5906
     22  5906				   .LUM1      SET	.LUM1 + .STEP1
     23  5906				   .LUM2      SET	.LUM2 + .STEP2
     24  5906				   .LUM3      SET	.LUM3 + .STEP3
     13  5906					      REPEND
     14  5906		       44		      .byte.b	$40+(.LUM1/256)
     15  5907		       26		      .byte.b	$20+(.LUM2/256)
     16  5908		       98		      .byte.b	$90+(.LUM3/256)
     17  5909
     18  5909
     19  5909
     20  5909
     21  5909
     22  5909				   .LUM1      SET	.LUM1 + .STEP1
     23  5909				   .LUM2      SET	.LUM2 + .STEP2
     24  5909				   .LUM3      SET	.LUM3 + .STEP3
     13  5909					      REPEND
     14  5909		       44		      .byte.b	$40+(.LUM1/256)
     15  590a		       26		      .byte.b	$20+(.LUM2/256)
     16  590b		       98		      .byte.b	$90+(.LUM3/256)
     17  590c
     18  590c
     19  590c
     20  590c
     21  590c
     22  590c				   .LUM1      SET	.LUM1 + .STEP1
     23  590c				   .LUM2      SET	.LUM2 + .STEP2
     24  590c				   .LUM3      SET	.LUM3 + .STEP3
     13  590c					      REPEND
     14  590c		       44		      .byte.b	$40+(.LUM1/256)
     15  590d		       26		      .byte.b	$20+(.LUM2/256)
     16  590e		       98		      .byte.b	$90+(.LUM3/256)
     17  590f
     18  590f
     19  590f
     20  590f
     21  590f
     22  590f				   .LUM1      SET	.LUM1 + .STEP1
     23  590f				   .LUM2      SET	.LUM2 + .STEP2
     24  590f				   .LUM3      SET	.LUM3 + .STEP3
     13  590f					      REPEND
     14  590f		       44		      .byte.b	$40+(.LUM1/256)
     15  5910		       26		      .byte.b	$20+(.LUM2/256)
     16  5911		       98		      .byte.b	$90+(.LUM3/256)
     17  5912
     18  5912
     19  5912
     20  5912
     21  5912
     22  5912				   .LUM1      SET	.LUM1 + .STEP1
     23  5912				   .LUM2      SET	.LUM2 + .STEP2
     24  5912				   .LUM3      SET	.LUM3 + .STEP3
     13  5912					      REPEND
     14  5912		       44		      .byte.b	$40+(.LUM1/256)
     15  5913		       26		      .byte.b	$20+(.LUM2/256)
     16  5914		       98		      .byte.b	$90+(.LUM3/256)
     17  5915
     18  5915
     19  5915
     20  5915
     21  5915
     22  5915				   .LUM1      SET	.LUM1 + .STEP1
     23  5915				   .LUM2      SET	.LUM2 + .STEP2
     24  5915				   .LUM3      SET	.LUM3 + .STEP3
     13  5915					      REPEND
     14  5915		       44		      .byte.b	$40+(.LUM1/256)
     15  5916		       26		      .byte.b	$20+(.LUM2/256)
     16  5917		       98		      .byte.b	$90+(.LUM3/256)
     17  5918
     18  5918
     19  5918
     20  5918
     21  5918
     22  5918				   .LUM1      SET	.LUM1 + .STEP1
     23  5918				   .LUM2      SET	.LUM2 + .STEP2
     24  5918				   .LUM3      SET	.LUM3 + .STEP3
     13  5918					      REPEND
     14  5918		       44		      .byte.b	$40+(.LUM1/256)
     15  5919		       26		      .byte.b	$20+(.LUM2/256)
     16  591a		       98		      .byte.b	$90+(.LUM3/256)
     17  591b
     18  591b
     19  591b
     20  591b
     21  591b
     22  591b				   .LUM1      SET	.LUM1 + .STEP1
     23  591b				   .LUM2      SET	.LUM2 + .STEP2
     24  591b				   .LUM3      SET	.LUM3 + .STEP3
     13  591b					      REPEND
     14  591b		       44		      .byte.b	$40+(.LUM1/256)
     15  591c		       26		      .byte.b	$20+(.LUM2/256)
     16  591d		       98		      .byte.b	$90+(.LUM3/256)
     17  591e
     18  591e
     19  591e
     20  591e
     21  591e
     22  591e				   .LUM1      SET	.LUM1 + .STEP1
     23  591e				   .LUM2      SET	.LUM2 + .STEP2
     24  591e				   .LUM3      SET	.LUM3 + .STEP3
     13  591e					      REPEND
     14  591e		       44		      .byte.b	$40+(.LUM1/256)
     15  591f		       26		      .byte.b	$20+(.LUM2/256)
     16  5920		       98		      .byte.b	$90+(.LUM3/256)
     17  5921
     18  5921
     19  5921
     20  5921
     21  5921
     22  5921				   .LUM1      SET	.LUM1 + .STEP1
     23  5921				   .LUM2      SET	.LUM2 + .STEP2
     24  5921				   .LUM3      SET	.LUM3 + .STEP3
     13  5921					      REPEND
     14  5921		       44		      .byte.b	$40+(.LUM1/256)
     15  5922		       26		      .byte.b	$20+(.LUM2/256)
     16  5923		       98		      .byte.b	$90+(.LUM3/256)
     17  5924
     18  5924
     19  5924
     20  5924
     21  5924
     22  5924				   .LUM1      SET	.LUM1 + .STEP1
     23  5924				   .LUM2      SET	.LUM2 + .STEP2
     24  5924				   .LUM3      SET	.LUM3 + .STEP3
     13  5924					      REPEND
     14  5924		       44		      .byte.b	$40+(.LUM1/256)
     15  5925		       26		      .byte.b	$20+(.LUM2/256)
     16  5926		       98		      .byte.b	$90+(.LUM3/256)
     17  5927
     18  5927
     19  5927
     20  5927
     21  5927
     22  5927				   .LUM1      SET	.LUM1 + .STEP1
     23  5927				   .LUM2      SET	.LUM2 + .STEP2
     24  5927				   .LUM3      SET	.LUM3 + .STEP3
     13  5927					      REPEND
     14  5927		       44		      .byte.b	$40+(.LUM1/256)
     15  5928		       26		      .byte.b	$20+(.LUM2/256)
     16  5929		       98		      .byte.b	$90+(.LUM3/256)
     17  592a
     18  592a
     19  592a
     20  592a
     21  592a
     22  592a				   .LUM1      SET	.LUM1 + .STEP1
     23  592a				   .LUM2      SET	.LUM2 + .STEP2
     24  592a				   .LUM3      SET	.LUM3 + .STEP3
     13  592a					      REPEND
     14  592a		       44		      .byte.b	$40+(.LUM1/256)
     15  592b		       26		      .byte.b	$20+(.LUM2/256)
     16  592c		       98		      .byte.b	$90+(.LUM3/256)
     17  592d
     18  592d
     19  592d
     20  592d
     21  592d
     22  592d				   .LUM1      SET	.LUM1 + .STEP1
     23  592d				   .LUM2      SET	.LUM2 + .STEP2
     24  592d				   .LUM3      SET	.LUM3 + .STEP3
     13  592d					      REPEND
     14  592d		       44		      .byte.b	$40+(.LUM1/256)
     15  592e		       26		      .byte.b	$20+(.LUM2/256)
     16  592f		       98		      .byte.b	$90+(.LUM3/256)
     17  5930
     18  5930
     19  5930
     20  5930
     21  5930
     22  5930				   .LUM1      SET	.LUM1 + .STEP1
     23  5930				   .LUM2      SET	.LUM2 + .STEP2
     24  5930				   .LUM3      SET	.LUM3 + .STEP3
     13  5930					      REPEND
     14  5930		       44		      .byte.b	$40+(.LUM1/256)
     15  5931		       26		      .byte.b	$20+(.LUM2/256)
     16  5932		       98		      .byte.b	$90+(.LUM3/256)
     17  5933
     18  5933
     19  5933
     20  5933
     21  5933
     22  5933				   .LUM1      SET	.LUM1 + .STEP1
     23  5933				   .LUM2      SET	.LUM2 + .STEP2
     24  5933				   .LUM3      SET	.LUM3 + .STEP3
     13  5933					      REPEND
     14  5933		       44		      .byte.b	$40+(.LUM1/256)
     15  5934		       26		      .byte.b	$20+(.LUM2/256)
     16  5935		       98		      .byte.b	$90+(.LUM3/256)
     17  5936
     18  5936
     19  5936
     20  5936
     21  5936
     22  5936				   .LUM1      SET	.LUM1 + .STEP1
     23  5936				   .LUM2      SET	.LUM2 + .STEP2
     24  5936				   .LUM3      SET	.LUM3 + .STEP3
     13  5936					      REPEND
     14  5936		       44		      .byte.b	$40+(.LUM1/256)
     15  5937		       26		      .byte.b	$20+(.LUM2/256)
     16  5938		       98		      .byte.b	$90+(.LUM3/256)
     17  5939
     18  5939
     19  5939
     20  5939
     21  5939
     22  5939				   .LUM1      SET	.LUM1 + .STEP1
     23  5939				   .LUM2      SET	.LUM2 + .STEP2
     24  5939				   .LUM3      SET	.LUM3 + .STEP3
     13  5939					      REPEND
     14  5939		       44		      .byte.b	$40+(.LUM1/256)
     15  593a		       26		      .byte.b	$20+(.LUM2/256)
     16  593b		       98		      .byte.b	$90+(.LUM3/256)
     17  593c
     18  593c
     19  593c
     20  593c
     21  593c
     22  593c				   .LUM1      SET	.LUM1 + .STEP1
     23  593c				   .LUM2      SET	.LUM2 + .STEP2
     24  593c				   .LUM3      SET	.LUM3 + .STEP3
     13  593c					      REPEND
     14  593c		       44		      .byte.b	$40+(.LUM1/256)
     15  593d		       26		      .byte.b	$20+(.LUM2/256)
     16  593e		       98		      .byte.b	$90+(.LUM3/256)
     17  593f
     18  593f
     19  593f
     20  593f
     21  593f
     22  593f				   .LUM1      SET	.LUM1 + .STEP1
     23  593f				   .LUM2      SET	.LUM2 + .STEP2
     24  593f				   .LUM3      SET	.LUM3 + .STEP3
     13  593f					      REPEND
     14  593f		       44		      .byte.b	$40+(.LUM1/256)
     15  5940		       26		      .byte.b	$20+(.LUM2/256)
     16  5941		       98		      .byte.b	$90+(.LUM3/256)
     17  5942
     18  5942
     19  5942
     20  5942
     21  5942
     22  5942				   .LUM1      SET	.LUM1 + .STEP1
     23  5942				   .LUM2      SET	.LUM2 + .STEP2
     24  5942				   .LUM3      SET	.LUM3 + .STEP3
     13  5942					      REPEND
     14  5942		       44		      .byte.b	$40+(.LUM1/256)
     15  5943		       26		      .byte.b	$20+(.LUM2/256)
     16  5944		       98		      .byte.b	$90+(.LUM3/256)
     17  5945
     18  5945
     19  5945
     20  5945
     21  5945
     22  5945				   .LUM1      SET	.LUM1 + .STEP1
     23  5945				   .LUM2      SET	.LUM2 + .STEP2
     24  5945				   .LUM3      SET	.LUM3 + .STEP3
     13  5945					      REPEND
     14  5945		       44		      .byte.b	$40+(.LUM1/256)
     15  5946		       26		      .byte.b	$20+(.LUM2/256)
     16  5947		       98		      .byte.b	$90+(.LUM3/256)
     17  5948
     18  5948
     19  5948
     20  5948
     21  5948
     22  5948				   .LUM1      SET	.LUM1 + .STEP1
     23  5948				   .LUM2      SET	.LUM2 + .STEP2
     24  5948				   .LUM3      SET	.LUM3 + .STEP3
     13  5948					      REPEND
     14  5948		       44		      .byte.b	$40+(.LUM1/256)
     15  5949		       26		      .byte.b	$20+(.LUM2/256)
     16  594a		       98		      .byte.b	$90+(.LUM3/256)
     17  594b
     18  594b
     19  594b
     20  594b
     21  594b
     22  594b				   .LUM1      SET	.LUM1 + .STEP1
     23  594b				   .LUM2      SET	.LUM2 + .STEP2
     24  594b				   .LUM3      SET	.LUM3 + .STEP3
     13  594b					      REPEND
     14  594b		       44		      .byte.b	$40+(.LUM1/256)
     15  594c		       26		      .byte.b	$20+(.LUM2/256)
     16  594d		       98		      .byte.b	$90+(.LUM3/256)
     17  594e
     18  594e
     19  594e
     20  594e
     21  594e
     22  594e				   .LUM1      SET	.LUM1 + .STEP1
     23  594e				   .LUM2      SET	.LUM2 + .STEP2
     24  594e				   .LUM3      SET	.LUM3 + .STEP3
     13  594e					      REPEND
     14  594e		       44		      .byte.b	$40+(.LUM1/256)
     15  594f		       26		      .byte.b	$20+(.LUM2/256)
     16  5950		       98		      .byte.b	$90+(.LUM3/256)
     17  5951
     18  5951
     19  5951
     20  5951
     21  5951
     22  5951				   .LUM1      SET	.LUM1 + .STEP1
     23  5951				   .LUM2      SET	.LUM2 + .STEP2
     24  5951				   .LUM3      SET	.LUM3 + .STEP3
     13  5951					      REPEND
     14  5951		       44		      .byte.b	$40+(.LUM1/256)
     15  5952		       26		      .byte.b	$20+(.LUM2/256)
     16  5953		       98		      .byte.b	$90+(.LUM3/256)
     17  5954
     18  5954
     19  5954
     20  5954
     21  5954
     22  5954				   .LUM1      SET	.LUM1 + .STEP1
     23  5954				   .LUM2      SET	.LUM2 + .STEP2
     24  5954				   .LUM3      SET	.LUM3 + .STEP3
     13  5954					      REPEND
     14  5954		       44		      .byte.b	$40+(.LUM1/256)
     15  5955		       26		      .byte.b	$20+(.LUM2/256)
     16  5956		       98		      .byte.b	$90+(.LUM3/256)
     17  5957
     18  5957
     19  5957
     20  5957
     21  5957
     22  5957				   .LUM1      SET	.LUM1 + .STEP1
     23  5957				   .LUM2      SET	.LUM2 + .STEP2
     24  5957				   .LUM3      SET	.LUM3 + .STEP3
     13  5957					      REPEND
     14  5957		       44		      .byte.b	$40+(.LUM1/256)
     15  5958		       26		      .byte.b	$20+(.LUM2/256)
     16  5959		       98		      .byte.b	$90+(.LUM3/256)
     17  595a
     18  595a
     19  595a
     20  595a
     21  595a
     22  595a				   .LUM1      SET	.LUM1 + .STEP1
     23  595a				   .LUM2      SET	.LUM2 + .STEP2
     24  595a				   .LUM3      SET	.LUM3 + .STEP3
     13  595a					      REPEND
     14  595a		       44		      .byte.b	$40+(.LUM1/256)
     15  595b		       26		      .byte.b	$20+(.LUM2/256)
     16  595c		       98		      .byte.b	$90+(.LUM3/256)
     17  595d
     18  595d
     19  595d
     20  595d
     21  595d
     22  595d				   .LUM1      SET	.LUM1 + .STEP1
     23  595d				   .LUM2      SET	.LUM2 + .STEP2
     24  595d				   .LUM3      SET	.LUM3 + .STEP3
     13  595d					      REPEND
     14  595d		       44		      .byte.b	$40+(.LUM1/256)
     15  595e		       26		      .byte.b	$20+(.LUM2/256)
     16  595f		       98		      .byte.b	$90+(.LUM3/256)
     17  5960
     18  5960
     19  5960
     20  5960
     21  5960
     22  5960				   .LUM1      SET	.LUM1 + .STEP1
     23  5960				   .LUM2      SET	.LUM2 + .STEP2
     24  5960				   .LUM3      SET	.LUM3 + .STEP3
     13  5960					      REPEND
     14  5960		       44		      .byte.b	$40+(.LUM1/256)
     15  5961		       26		      .byte.b	$20+(.LUM2/256)
     16  5962		       98		      .byte.b	$90+(.LUM3/256)
     17  5963
     18  5963
     19  5963
     20  5963
     21  5963
     22  5963				   .LUM1      SET	.LUM1 + .STEP1
     23  5963				   .LUM2      SET	.LUM2 + .STEP2
     24  5963				   .LUM3      SET	.LUM3 + .STEP3
     13  5963					      REPEND
     14  5963		       44		      .byte.b	$40+(.LUM1/256)
     15  5964		       26		      .byte.b	$20+(.LUM2/256)
     16  5965		       98		      .byte.b	$90+(.LUM3/256)
     17  5966
     18  5966
     19  5966
     20  5966
     21  5966
     22  5966				   .LUM1      SET	.LUM1 + .STEP1
     23  5966				   .LUM2      SET	.LUM2 + .STEP2
     24  5966				   .LUM3      SET	.LUM3 + .STEP3
     13  5966					      REPEND
     14  5966		       44		      .byte.b	$40+(.LUM1/256)
     15  5967		       26		      .byte.b	$20+(.LUM2/256)
     16  5968		       98		      .byte.b	$90+(.LUM3/256)
     17  5969
     18  5969
     19  5969
     20  5969
     21  5969
     22  5969				   .LUM1      SET	.LUM1 + .STEP1
     23  5969				   .LUM2      SET	.LUM2 + .STEP2
     24  5969				   .LUM3      SET	.LUM3 + .STEP3
     13  5969					      REPEND
     14  5969		       44		      .byte.b	$40+(.LUM1/256)
     15  596a		       26		      .byte.b	$20+(.LUM2/256)
     16  596b		       98		      .byte.b	$90+(.LUM3/256)
     17  596c
     18  596c
     19  596c
     20  596c
     21  596c
     22  596c				   .LUM1      SET	.LUM1 + .STEP1
     23  596c				   .LUM2      SET	.LUM2 + .STEP2
     24  596c				   .LUM3      SET	.LUM3 + .STEP3
     13  596c					      REPEND
     14  596c		       44		      .byte.b	$40+(.LUM1/256)
     15  596d		       26		      .byte.b	$20+(.LUM2/256)
     16  596e		       98		      .byte.b	$90+(.LUM3/256)
     17  596f
     18  596f
     19  596f
     20  596f
     21  596f
     22  596f				   .LUM1      SET	.LUM1 + .STEP1
     23  596f				   .LUM2      SET	.LUM2 + .STEP2
     24  596f				   .LUM3      SET	.LUM3 + .STEP3
     13  596f					      REPEND
     14  596f		       44		      .byte.b	$40+(.LUM1/256)
     15  5970		       26		      .byte.b	$20+(.LUM2/256)
     16  5971		       98		      .byte.b	$90+(.LUM3/256)
     17  5972
     18  5972
     19  5972
     20  5972
     21  5972
     22  5972				   .LUM1      SET	.LUM1 + .STEP1
     23  5972				   .LUM2      SET	.LUM2 + .STEP2
     24  5972				   .LUM3      SET	.LUM3 + .STEP3
     13  5972					      REPEND
     14  5972		       44		      .byte.b	$40+(.LUM1/256)
     15  5973		       26		      .byte.b	$20+(.LUM2/256)
     16  5974		       98		      .byte.b	$90+(.LUM3/256)
     17  5975
     18  5975
     19  5975
     20  5975
     21  5975
     22  5975				   .LUM1      SET	.LUM1 + .STEP1
     23  5975				   .LUM2      SET	.LUM2 + .STEP2
     24  5975				   .LUM3      SET	.LUM3 + .STEP3
     13  5975					      REPEND
     14  5975		       44		      .byte.b	$40+(.LUM1/256)
     15  5976		       26		      .byte.b	$20+(.LUM2/256)
     16  5977		       98		      .byte.b	$90+(.LUM3/256)
     17  5978
     18  5978
     19  5978
     20  5978
     21  5978
     22  5978				   .LUM1      SET	.LUM1 + .STEP1
     23  5978				   .LUM2      SET	.LUM2 + .STEP2
     24  5978				   .LUM3      SET	.LUM3 + .STEP3
     13  5978					      REPEND
     14  5978		       44		      .byte.b	$40+(.LUM1/256)
     15  5979		       26		      .byte.b	$20+(.LUM2/256)
     16  597a		       98		      .byte.b	$90+(.LUM3/256)
     17  597b
     18  597b
     19  597b
     20  597b
     21  597b
     22  597b				   .LUM1      SET	.LUM1 + .STEP1
     23  597b				   .LUM2      SET	.LUM2 + .STEP2
     24  597b				   .LUM3      SET	.LUM3 + .STEP3
     13  597b					      REPEND
     14  597b		       44		      .byte.b	$40+(.LUM1/256)
     15  597c		       26		      .byte.b	$20+(.LUM2/256)
     16  597d		       98		      .byte.b	$90+(.LUM3/256)
     17  597e
     18  597e
     19  597e
     20  597e
     21  597e
     22  597e				   .LUM1      SET	.LUM1 + .STEP1
     23  597e				   .LUM2      SET	.LUM2 + .STEP2
     24  597e				   .LUM3      SET	.LUM3 + .STEP3
     13  597e					      REPEND
     14  597e		       44		      .byte.b	$40+(.LUM1/256)
     15  597f		       26		      .byte.b	$20+(.LUM2/256)
     16  5980		       98		      .byte.b	$90+(.LUM3/256)
     17  5981
     18  5981
     19  5981
     20  5981
     21  5981
     22  5981				   .LUM1      SET	.LUM1 + .STEP1
     23  5981				   .LUM2      SET	.LUM2 + .STEP2
     24  5981				   .LUM3      SET	.LUM3 + .STEP3
     13  5981					      REPEND
     14  5981		       44		      .byte.b	$40+(.LUM1/256)
     15  5982		       26		      .byte.b	$20+(.LUM2/256)
     16  5983		       98		      .byte.b	$90+(.LUM3/256)
     17  5984
     18  5984
     19  5984
     20  5984
     21  5984
     22  5984				   .LUM1      SET	.LUM1 + .STEP1
     23  5984				   .LUM2      SET	.LUM2 + .STEP2
     24  5984				   .LUM3      SET	.LUM3 + .STEP3
     13  5984					      REPEND
     14  5984		       44		      .byte.b	$40+(.LUM1/256)
     15  5985		       26		      .byte.b	$20+(.LUM2/256)
     16  5986		       98		      .byte.b	$90+(.LUM3/256)
     17  5987
     18  5987
     19  5987
     20  5987
     21  5987
     22  5987				   .LUM1      SET	.LUM1 + .STEP1
     23  5987				   .LUM2      SET	.LUM2 + .STEP2
     24  5987				   .LUM3      SET	.LUM3 + .STEP3
     13  5987					      REPEND
     14  5987		       44		      .byte.b	$40+(.LUM1/256)
     15  5988		       26		      .byte.b	$20+(.LUM2/256)
     16  5989		       98		      .byte.b	$90+(.LUM3/256)
     17  598a
     18  598a
     19  598a
     20  598a
     21  598a
     22  598a				   .LUM1      SET	.LUM1 + .STEP1
     23  598a				   .LUM2      SET	.LUM2 + .STEP2
     24  598a				   .LUM3      SET	.LUM3 + .STEP3
     13  598a					      REPEND
     14  598a		       44		      .byte.b	$40+(.LUM1/256)
     15  598b		       26		      .byte.b	$20+(.LUM2/256)
     16  598c		       98		      .byte.b	$90+(.LUM3/256)
     17  598d
     18  598d
     19  598d
     20  598d
     21  598d
     22  598d				   .LUM1      SET	.LUM1 + .STEP1
     23  598d				   .LUM2      SET	.LUM2 + .STEP2
     24  598d				   .LUM3      SET	.LUM3 + .STEP3
     13  598d					      REPEND
     14  598d		       44		      .byte.b	$40+(.LUM1/256)
     15  598e		       26		      .byte.b	$20+(.LUM2/256)
     16  598f		       98		      .byte.b	$90+(.LUM3/256)
     17  5990
     18  5990
     19  5990
     20  5990
     21  5990
     22  5990				   .LUM1      SET	.LUM1 + .STEP1
     23  5990				   .LUM2      SET	.LUM2 + .STEP2
     24  5990				   .LUM3      SET	.LUM3 + .STEP3
     13  5990					      REPEND
     14  5990		       44		      .byte.b	$40+(.LUM1/256)
     15  5991		       26		      .byte.b	$20+(.LUM2/256)
     16  5992		       98		      .byte.b	$90+(.LUM3/256)
     17  5993
     18  5993
     19  5993
     20  5993
     21  5993
     22  5993				   .LUM1      SET	.LUM1 + .STEP1
     23  5993				   .LUM2      SET	.LUM2 + .STEP2
     24  5993				   .LUM3      SET	.LUM3 + .STEP3
     13  5993					      REPEND
     14  5993		       44		      .byte.b	$40+(.LUM1/256)
     15  5994		       26		      .byte.b	$20+(.LUM2/256)
     16  5995		       98		      .byte.b	$90+(.LUM3/256)
     17  5996
     18  5996
     19  5996
     20  5996
     21  5996
     22  5996				   .LUM1      SET	.LUM1 + .STEP1
     23  5996				   .LUM2      SET	.LUM2 + .STEP2
     24  5996				   .LUM3      SET	.LUM3 + .STEP3
     13  5996					      REPEND
     14  5996		       44		      .byte.b	$40+(.LUM1/256)
     15  5997		       26		      .byte.b	$20+(.LUM2/256)
     16  5998		       98		      .byte.b	$90+(.LUM3/256)
     17  5999
     18  5999
     19  5999
     20  5999
     21  5999
     22  5999				   .LUM1      SET	.LUM1 + .STEP1
     23  5999				   .LUM2      SET	.LUM2 + .STEP2
     24  5999				   .LUM3      SET	.LUM3 + .STEP3
     13  5999					      REPEND
     14  5999		       44		      .byte.b	$40+(.LUM1/256)
     15  599a		       26		      .byte.b	$20+(.LUM2/256)
     16  599b		       98		      .byte.b	$90+(.LUM3/256)
     17  599c
     18  599c
     19  599c
     20  599c
     21  599c
     22  599c				   .LUM1      SET	.LUM1 + .STEP1
     23  599c				   .LUM2      SET	.LUM2 + .STEP2
     24  599c				   .LUM3      SET	.LUM3 + .STEP3
     13  599c					      REPEND
     14  599c		       44		      .byte.b	$40+(.LUM1/256)
     15  599d		       26		      .byte.b	$20+(.LUM2/256)
     16  599e		       98		      .byte.b	$90+(.LUM3/256)
     17  599f
     18  599f
     19  599f
     20  599f
     21  599f
     22  599f				   .LUM1      SET	.LUM1 + .STEP1
     23  599f				   .LUM2      SET	.LUM2 + .STEP2
     24  599f				   .LUM3      SET	.LUM3 + .STEP3
     13  599f					      REPEND
     14  599f		       44		      .byte.b	$40+(.LUM1/256)
     15  59a0		       26		      .byte.b	$20+(.LUM2/256)
     16  59a1		       98		      .byte.b	$90+(.LUM3/256)
     17  59a2
     18  59a2
     19  59a2
     20  59a2
     21  59a2
     22  59a2				   .LUM1      SET	.LUM1 + .STEP1
     23  59a2				   .LUM2      SET	.LUM2 + .STEP2
     24  59a2				   .LUM3      SET	.LUM3 + .STEP3
     13  59a2					      REPEND
     14  59a2		       44		      .byte.b	$40+(.LUM1/256)
     15  59a3		       26		      .byte.b	$20+(.LUM2/256)
     16  59a4		       98		      .byte.b	$90+(.LUM3/256)
     17  59a5
     18  59a5
     19  59a5
     20  59a5
     21  59a5
     22  59a5				   .LUM1      SET	.LUM1 + .STEP1
     23  59a5				   .LUM2      SET	.LUM2 + .STEP2
     24  59a5				   .LUM3      SET	.LUM3 + .STEP3
     13  59a5					      REPEND
     14  59a5		       44		      .byte.b	$40+(.LUM1/256)
     15  59a6		       26		      .byte.b	$20+(.LUM2/256)
     16  59a7		       98		      .byte.b	$90+(.LUM3/256)
     17  59a8
     18  59a8
     19  59a8
     20  59a8
     21  59a8
     22  59a8				   .LUM1      SET	.LUM1 + .STEP1
     23  59a8				   .LUM2      SET	.LUM2 + .STEP2
     24  59a8				   .LUM3      SET	.LUM3 + .STEP3
     13  59a8					      REPEND
     14  59a8		       44		      .byte.b	$40+(.LUM1/256)
     15  59a9		       26		      .byte.b	$20+(.LUM2/256)
     16  59aa		       98		      .byte.b	$90+(.LUM3/256)
     17  59ab
     18  59ab
     19  59ab
     20  59ab
     21  59ab
     22  59ab				   .LUM1      SET	.LUM1 + .STEP1
     23  59ab				   .LUM2      SET	.LUM2 + .STEP2
     24  59ab				   .LUM3      SET	.LUM3 + .STEP3
     13  59ab					      REPEND
     14  59ab		       44		      .byte.b	$40+(.LUM1/256)
     15  59ac		       26		      .byte.b	$20+(.LUM2/256)
     16  59ad		       98		      .byte.b	$90+(.LUM3/256)
     17  59ae
     18  59ae
     19  59ae
     20  59ae
     21  59ae
     22  59ae				   .LUM1      SET	.LUM1 + .STEP1
     23  59ae				   .LUM2      SET	.LUM2 + .STEP2
     24  59ae				   .LUM3      SET	.LUM3 + .STEP3
     13  59ae					      REPEND
     14  59ae		       44		      .byte.b	$40+(.LUM1/256)
     15  59af		       26		      .byte.b	$20+(.LUM2/256)
     16  59b0		       98		      .byte.b	$90+(.LUM3/256)
     17  59b1
     18  59b1
     19  59b1
     20  59b1
     21  59b1
     22  59b1				   .LUM1      SET	.LUM1 + .STEP1
     23  59b1				   .LUM2      SET	.LUM2 + .STEP2
     24  59b1				   .LUM3      SET	.LUM3 + .STEP3
     13  59b1					      REPEND
     14  59b1		       44		      .byte.b	$40+(.LUM1/256)
     15  59b2		       26		      .byte.b	$20+(.LUM2/256)
     16  59b3		       98		      .byte.b	$90+(.LUM3/256)
     17  59b4
     18  59b4
     19  59b4
     20  59b4
     21  59b4
     22  59b4				   .LUM1      SET	.LUM1 + .STEP1
     23  59b4				   .LUM2      SET	.LUM2 + .STEP2
     24  59b4				   .LUM3      SET	.LUM3 + .STEP3
     13  59b4					      REPEND
     14  59b4		       44		      .byte.b	$40+(.LUM1/256)
     15  59b5		       26		      .byte.b	$20+(.LUM2/256)
     16  59b6		       98		      .byte.b	$90+(.LUM3/256)
     17  59b7
     18  59b7
     19  59b7
     20  59b7
     21  59b7
     22  59b7				   .LUM1      SET	.LUM1 + .STEP1
     23  59b7				   .LUM2      SET	.LUM2 + .STEP2
     24  59b7				   .LUM3      SET	.LUM3 + .STEP3
     13  59b7					      REPEND
     14  59b7		       44		      .byte.b	$40+(.LUM1/256)
     15  59b8		       26		      .byte.b	$20+(.LUM2/256)
     16  59b9		       98		      .byte.b	$90+(.LUM3/256)
     17  59ba
     18  59ba
     19  59ba
     20  59ba
     21  59ba
     22  59ba				   .LUM1      SET	.LUM1 + .STEP1
     23  59ba				   .LUM2      SET	.LUM2 + .STEP2
     24  59ba				   .LUM3      SET	.LUM3 + .STEP3
     13  59ba					      REPEND
     14  59ba		       44		      .byte.b	$40+(.LUM1/256)
     15  59bb		       26		      .byte.b	$20+(.LUM2/256)
     16  59bc		       98		      .byte.b	$90+(.LUM3/256)
     17  59bd
     18  59bd
     19  59bd
     20  59bd
     21  59bd
     22  59bd				   .LUM1      SET	.LUM1 + .STEP1
     23  59bd				   .LUM2      SET	.LUM2 + .STEP2
     24  59bd				   .LUM3      SET	.LUM3 + .STEP3
     13  59bd					      REPEND
     14  59bd		       44		      .byte.b	$40+(.LUM1/256)
     15  59be		       26		      .byte.b	$20+(.LUM2/256)
     16  59bf		       98		      .byte.b	$90+(.LUM3/256)
     17  59c0
     18  59c0
     19  59c0
     20  59c0
     21  59c0
     22  59c0				   .LUM1      SET	.LUM1 + .STEP1
     23  59c0				   .LUM2      SET	.LUM2 + .STEP2
     24  59c0				   .LUM3      SET	.LUM3 + .STEP3
     13  59c0					      REPEND
     14  59c0		       44		      .byte.b	$40+(.LUM1/256)
     15  59c1		       26		      .byte.b	$20+(.LUM2/256)
     16  59c2		       98		      .byte.b	$90+(.LUM3/256)
     17  59c3
     18  59c3
     19  59c3
     20  59c3
     21  59c3
     22  59c3				   .LUM1      SET	.LUM1 + .STEP1
     23  59c3				   .LUM2      SET	.LUM2 + .STEP2
     24  59c3				   .LUM3      SET	.LUM3 + .STEP3
     13  59c3					      REPEND
     14  59c3		       44		      .byte.b	$40+(.LUM1/256)
     15  59c4		       26		      .byte.b	$20+(.LUM2/256)
     16  59c5		       98		      .byte.b	$90+(.LUM3/256)
     17  59c6
     18  59c6
     19  59c6
     20  59c6
     21  59c6
     22  59c6				   .LUM1      SET	.LUM1 + .STEP1
     23  59c6				   .LUM2      SET	.LUM2 + .STEP2
     24  59c6				   .LUM3      SET	.LUM3 + .STEP3
     13  59c6					      REPEND
     14  59c6		       44		      .byte.b	$40+(.LUM1/256)
     15  59c7		       26		      .byte.b	$20+(.LUM2/256)
     16  59c8		       98		      .byte.b	$90+(.LUM3/256)
     17  59c9
     18  59c9
     19  59c9
     20  59c9
     21  59c9
     22  59c9				   .LUM1      SET	.LUM1 + .STEP1
     23  59c9				   .LUM2      SET	.LUM2 + .STEP2
     24  59c9				   .LUM3      SET	.LUM3 + .STEP3
     13  59c9					      REPEND
     14  59c9		       44		      .byte.b	$40+(.LUM1/256)
     15  59ca		       26		      .byte.b	$20+(.LUM2/256)
     16  59cb		       98		      .byte.b	$90+(.LUM3/256)
     17  59cc
     18  59cc
     19  59cc
     20  59cc
     21  59cc
     22  59cc				   .LUM1      SET	.LUM1 + .STEP1
     23  59cc				   .LUM2      SET	.LUM2 + .STEP2
     24  59cc				   .LUM3      SET	.LUM3 + .STEP3
     13  59cc					      REPEND
     14  59cc		       44		      .byte.b	$40+(.LUM1/256)
     15  59cd		       26		      .byte.b	$20+(.LUM2/256)
     16  59ce		       98		      .byte.b	$90+(.LUM3/256)
     17  59cf
     18  59cf
     19  59cf
     20  59cf
     21  59cf
     22  59cf				   .LUM1      SET	.LUM1 + .STEP1
     23  59cf				   .LUM2      SET	.LUM2 + .STEP2
     24  59cf				   .LUM3      SET	.LUM3 + .STEP3
     13  59cf					      REPEND
     14  59cf		       44		      .byte.b	$40+(.LUM1/256)
     15  59d0		       26		      .byte.b	$20+(.LUM2/256)
     16  59d1		       98		      .byte.b	$90+(.LUM3/256)
     17  59d2
     18  59d2
     19  59d2
     20  59d2
     21  59d2
     22  59d2				   .LUM1      SET	.LUM1 + .STEP1
     23  59d2				   .LUM2      SET	.LUM2 + .STEP2
     24  59d2				   .LUM3      SET	.LUM3 + .STEP3
     13  59d2					      REPEND
     14  59d2		       44		      .byte.b	$40+(.LUM1/256)
     15  59d3		       26		      .byte.b	$20+(.LUM2/256)
     16  59d4		       98		      .byte.b	$90+(.LUM3/256)
     17  59d5
     18  59d5
     19  59d5
     20  59d5
     21  59d5
     22  59d5				   .LUM1      SET	.LUM1 + .STEP1
     23  59d5				   .LUM2      SET	.LUM2 + .STEP2
     24  59d5				   .LUM3      SET	.LUM3 + .STEP3
     13  59d5					      REPEND
     14  59d5		       44		      .byte.b	$40+(.LUM1/256)
     15  59d6		       26		      .byte.b	$20+(.LUM2/256)
     16  59d7		       98		      .byte.b	$90+(.LUM3/256)
     17  59d8
     18  59d8
     19  59d8
     20  59d8
     21  59d8
     22  59d8				   .LUM1      SET	.LUM1 + .STEP1
     23  59d8				   .LUM2      SET	.LUM2 + .STEP2
     24  59d8				   .LUM3      SET	.LUM3 + .STEP3
     25  59d8					      REPEND
    257  59d8							;colr_ntsc   LUMTABLE $70,$40,$a0,$A,$2,$E,$8,$E,$8
    258  59d8
    259  59d8							;    ECHO "PAL LUMS"
    260  59d8							;    OPTIONAL_PAGEBREAK "colr_pal", 72*3
      0  59d8				   colr_pal   LUMTABLE	$60, $80, $10, $6,$4,$8,$6,$4,$8
      1  59d8
      2  59d8
      3  59d8
      4  59d8
      5  59d8				   .LUM1      SET	$6*256
      6  59d8				   .LUM2      SET	$4*256
      7  59d8				   .LUM3      SET	$8*256
      8  59d8
      9  59d8		       00 00	   .STEP1     =	(256*($6-$6))/72
     10  59d8		       00 00	   .STEP2     =	(256*($4-$4))/72
     11  59d8		       00 00	   .STEP3     =	(256*($8-$8))/72
     12  59d8
     13  59d8					      REPEAT	72
     14  59d8		       66		      .byte.b	$60+(.LUM1/256)
     15  59d9		       84		      .byte.b	$80+(.LUM2/256)
     16  59da		       18		      .byte.b	$10+(.LUM3/256)
     17  59db
     18  59db
     19  59db
     20  59db
     21  59db
     22  59db				   .LUM1      SET	.LUM1 + .STEP1
     23  59db				   .LUM2      SET	.LUM2 + .STEP2
     24  59db				   .LUM3      SET	.LUM3 + .STEP3
     13  59db					      REPEND
     14  59db		       66		      .byte.b	$60+(.LUM1/256)
     15  59dc		       84		      .byte.b	$80+(.LUM2/256)
     16  59dd		       18		      .byte.b	$10+(.LUM3/256)
     17  59de
     18  59de
     19  59de
     20  59de
     21  59de
     22  59de				   .LUM1      SET	.LUM1 + .STEP1
     23  59de				   .LUM2      SET	.LUM2 + .STEP2
     24  59de				   .LUM3      SET	.LUM3 + .STEP3
     13  59de					      REPEND
     14  59de		       66		      .byte.b	$60+(.LUM1/256)
     15  59df		       84		      .byte.b	$80+(.LUM2/256)
     16  59e0		       18		      .byte.b	$10+(.LUM3/256)
     17  59e1
     18  59e1
     19  59e1
     20  59e1
     21  59e1
     22  59e1				   .LUM1      SET	.LUM1 + .STEP1
     23  59e1				   .LUM2      SET	.LUM2 + .STEP2
     24  59e1				   .LUM3      SET	.LUM3 + .STEP3
     13  59e1					      REPEND
     14  59e1		       66		      .byte.b	$60+(.LUM1/256)
     15  59e2		       84		      .byte.b	$80+(.LUM2/256)
     16  59e3		       18		      .byte.b	$10+(.LUM3/256)
     17  59e4
     18  59e4
     19  59e4
     20  59e4
     21  59e4
     22  59e4				   .LUM1      SET	.LUM1 + .STEP1
     23  59e4				   .LUM2      SET	.LUM2 + .STEP2
     24  59e4				   .LUM3      SET	.LUM3 + .STEP3
     13  59e4					      REPEND
     14  59e4		       66		      .byte.b	$60+(.LUM1/256)
     15  59e5		       84		      .byte.b	$80+(.LUM2/256)
     16  59e6		       18		      .byte.b	$10+(.LUM3/256)
     17  59e7
     18  59e7
     19  59e7
     20  59e7
     21  59e7
     22  59e7				   .LUM1      SET	.LUM1 + .STEP1
     23  59e7				   .LUM2      SET	.LUM2 + .STEP2
     24  59e7				   .LUM3      SET	.LUM3 + .STEP3
     13  59e7					      REPEND
     14  59e7		       66		      .byte.b	$60+(.LUM1/256)
     15  59e8		       84		      .byte.b	$80+(.LUM2/256)
     16  59e9		       18		      .byte.b	$10+(.LUM3/256)
     17  59ea
     18  59ea
     19  59ea
     20  59ea
     21  59ea
     22  59ea				   .LUM1      SET	.LUM1 + .STEP1
     23  59ea				   .LUM2      SET	.LUM2 + .STEP2
     24  59ea				   .LUM3      SET	.LUM3 + .STEP3
     13  59ea					      REPEND
     14  59ea		       66		      .byte.b	$60+(.LUM1/256)
     15  59eb		       84		      .byte.b	$80+(.LUM2/256)
     16  59ec		       18		      .byte.b	$10+(.LUM3/256)
     17  59ed
     18  59ed
     19  59ed
     20  59ed
     21  59ed
     22  59ed				   .LUM1      SET	.LUM1 + .STEP1
     23  59ed				   .LUM2      SET	.LUM2 + .STEP2
     24  59ed				   .LUM3      SET	.LUM3 + .STEP3
     13  59ed					      REPEND
     14  59ed		       66		      .byte.b	$60+(.LUM1/256)
     15  59ee		       84		      .byte.b	$80+(.LUM2/256)
     16  59ef		       18		      .byte.b	$10+(.LUM3/256)
     17  59f0
     18  59f0
     19  59f0
     20  59f0
     21  59f0
     22  59f0				   .LUM1      SET	.LUM1 + .STEP1
     23  59f0				   .LUM2      SET	.LUM2 + .STEP2
     24  59f0				   .LUM3      SET	.LUM3 + .STEP3
     13  59f0					      REPEND
     14  59f0		       66		      .byte.b	$60+(.LUM1/256)
     15  59f1		       84		      .byte.b	$80+(.LUM2/256)
     16  59f2		       18		      .byte.b	$10+(.LUM3/256)
     17  59f3
     18  59f3
     19  59f3
     20  59f3
     21  59f3
     22  59f3				   .LUM1      SET	.LUM1 + .STEP1
     23  59f3				   .LUM2      SET	.LUM2 + .STEP2
     24  59f3				   .LUM3      SET	.LUM3 + .STEP3
     13  59f3					      REPEND
     14  59f3		       66		      .byte.b	$60+(.LUM1/256)
     15  59f4		       84		      .byte.b	$80+(.LUM2/256)
     16  59f5		       18		      .byte.b	$10+(.LUM3/256)
     17  59f6
     18  59f6
     19  59f6
     20  59f6
     21  59f6
     22  59f6				   .LUM1      SET	.LUM1 + .STEP1
     23  59f6				   .LUM2      SET	.LUM2 + .STEP2
     24  59f6				   .LUM3      SET	.LUM3 + .STEP3
     13  59f6					      REPEND
     14  59f6		       66		      .byte.b	$60+(.LUM1/256)
     15  59f7		       84		      .byte.b	$80+(.LUM2/256)
     16  59f8		       18		      .byte.b	$10+(.LUM3/256)
     17  59f9
     18  59f9
     19  59f9
     20  59f9
     21  59f9
     22  59f9				   .LUM1      SET	.LUM1 + .STEP1
     23  59f9				   .LUM2      SET	.LUM2 + .STEP2
     24  59f9				   .LUM3      SET	.LUM3 + .STEP3
     13  59f9					      REPEND
     14  59f9		       66		      .byte.b	$60+(.LUM1/256)
     15  59fa		       84		      .byte.b	$80+(.LUM2/256)
     16  59fb		       18		      .byte.b	$10+(.LUM3/256)
     17  59fc
     18  59fc
     19  59fc
     20  59fc
     21  59fc
     22  59fc				   .LUM1      SET	.LUM1 + .STEP1
     23  59fc				   .LUM2      SET	.LUM2 + .STEP2
     24  59fc				   .LUM3      SET	.LUM3 + .STEP3
     13  59fc					      REPEND
     14  59fc		       66		      .byte.b	$60+(.LUM1/256)
     15  59fd		       84		      .byte.b	$80+(.LUM2/256)
     16  59fe		       18		      .byte.b	$10+(.LUM3/256)
     17  59ff
     18  59ff
     19  59ff
     20  59ff
     21  59ff
     22  59ff				   .LUM1      SET	.LUM1 + .STEP1
     23  59ff				   .LUM2      SET	.LUM2 + .STEP2
     24  59ff				   .LUM3      SET	.LUM3 + .STEP3
     13  59ff					      REPEND
     14  59ff		       66		      .byte.b	$60+(.LUM1/256)
     15  5a00		       84		      .byte.b	$80+(.LUM2/256)
     16  5a01		       18		      .byte.b	$10+(.LUM3/256)
     17  5a02
     18  5a02
     19  5a02
     20  5a02
     21  5a02
     22  5a02				   .LUM1      SET	.LUM1 + .STEP1
     23  5a02				   .LUM2      SET	.LUM2 + .STEP2
     24  5a02				   .LUM3      SET	.LUM3 + .STEP3
     13  5a02					      REPEND
     14  5a02		       66		      .byte.b	$60+(.LUM1/256)
     15  5a03		       84		      .byte.b	$80+(.LUM2/256)
     16  5a04		       18		      .byte.b	$10+(.LUM3/256)
     17  5a05
     18  5a05
     19  5a05
     20  5a05
     21  5a05
     22  5a05				   .LUM1      SET	.LUM1 + .STEP1
     23  5a05				   .LUM2      SET	.LUM2 + .STEP2
     24  5a05				   .LUM3      SET	.LUM3 + .STEP3
     13  5a05					      REPEND
     14  5a05		       66		      .byte.b	$60+(.LUM1/256)
     15  5a06		       84		      .byte.b	$80+(.LUM2/256)
     16  5a07		       18		      .byte.b	$10+(.LUM3/256)
     17  5a08
     18  5a08
     19  5a08
     20  5a08
     21  5a08
     22  5a08				   .LUM1      SET	.LUM1 + .STEP1
     23  5a08				   .LUM2      SET	.LUM2 + .STEP2
     24  5a08				   .LUM3      SET	.LUM3 + .STEP3
     13  5a08					      REPEND
     14  5a08		       66		      .byte.b	$60+(.LUM1/256)
     15  5a09		       84		      .byte.b	$80+(.LUM2/256)
     16  5a0a		       18		      .byte.b	$10+(.LUM3/256)
     17  5a0b
     18  5a0b
     19  5a0b
     20  5a0b
     21  5a0b
     22  5a0b				   .LUM1      SET	.LUM1 + .STEP1
     23  5a0b				   .LUM2      SET	.LUM2 + .STEP2
     24  5a0b				   .LUM3      SET	.LUM3 + .STEP3
     13  5a0b					      REPEND
     14  5a0b		       66		      .byte.b	$60+(.LUM1/256)
     15  5a0c		       84		      .byte.b	$80+(.LUM2/256)
     16  5a0d		       18		      .byte.b	$10+(.LUM3/256)
     17  5a0e
     18  5a0e
     19  5a0e
     20  5a0e
     21  5a0e
     22  5a0e				   .LUM1      SET	.LUM1 + .STEP1
     23  5a0e				   .LUM2      SET	.LUM2 + .STEP2
     24  5a0e				   .LUM3      SET	.LUM3 + .STEP3
     13  5a0e					      REPEND
     14  5a0e		       66		      .byte.b	$60+(.LUM1/256)
     15  5a0f		       84		      .byte.b	$80+(.LUM2/256)
     16  5a10		       18		      .byte.b	$10+(.LUM3/256)
     17  5a11
     18  5a11
     19  5a11
     20  5a11
     21  5a11
     22  5a11				   .LUM1      SET	.LUM1 + .STEP1
     23  5a11				   .LUM2      SET	.LUM2 + .STEP2
     24  5a11				   .LUM3      SET	.LUM3 + .STEP3
     13  5a11					      REPEND
     14  5a11		       66		      .byte.b	$60+(.LUM1/256)
     15  5a12		       84		      .byte.b	$80+(.LUM2/256)
     16  5a13		       18		      .byte.b	$10+(.LUM3/256)
     17  5a14
     18  5a14
     19  5a14
     20  5a14
     21  5a14
     22  5a14				   .LUM1      SET	.LUM1 + .STEP1
     23  5a14				   .LUM2      SET	.LUM2 + .STEP2
     24  5a14				   .LUM3      SET	.LUM3 + .STEP3
     13  5a14					      REPEND
     14  5a14		       66		      .byte.b	$60+(.LUM1/256)
     15  5a15		       84		      .byte.b	$80+(.LUM2/256)
     16  5a16		       18		      .byte.b	$10+(.LUM3/256)
     17  5a17
     18  5a17
     19  5a17
     20  5a17
     21  5a17
     22  5a17				   .LUM1      SET	.LUM1 + .STEP1
     23  5a17				   .LUM2      SET	.LUM2 + .STEP2
     24  5a17				   .LUM3      SET	.LUM3 + .STEP3
     13  5a17					      REPEND
     14  5a17		       66		      .byte.b	$60+(.LUM1/256)
     15  5a18		       84		      .byte.b	$80+(.LUM2/256)
     16  5a19		       18		      .byte.b	$10+(.LUM3/256)
     17  5a1a
     18  5a1a
     19  5a1a
     20  5a1a
     21  5a1a
     22  5a1a				   .LUM1      SET	.LUM1 + .STEP1
     23  5a1a				   .LUM2      SET	.LUM2 + .STEP2
     24  5a1a				   .LUM3      SET	.LUM3 + .STEP3
     13  5a1a					      REPEND
     14  5a1a		       66		      .byte.b	$60+(.LUM1/256)
     15  5a1b		       84		      .byte.b	$80+(.LUM2/256)
     16  5a1c		       18		      .byte.b	$10+(.LUM3/256)
     17  5a1d
     18  5a1d
     19  5a1d
     20  5a1d
     21  5a1d
     22  5a1d				   .LUM1      SET	.LUM1 + .STEP1
     23  5a1d				   .LUM2      SET	.LUM2 + .STEP2
     24  5a1d				   .LUM3      SET	.LUM3 + .STEP3
     13  5a1d					      REPEND
     14  5a1d		       66		      .byte.b	$60+(.LUM1/256)
     15  5a1e		       84		      .byte.b	$80+(.LUM2/256)
     16  5a1f		       18		      .byte.b	$10+(.LUM3/256)
     17  5a20
     18  5a20
     19  5a20
     20  5a20
     21  5a20
     22  5a20				   .LUM1      SET	.LUM1 + .STEP1
     23  5a20				   .LUM2      SET	.LUM2 + .STEP2
     24  5a20				   .LUM3      SET	.LUM3 + .STEP3
     13  5a20					      REPEND
     14  5a20		       66		      .byte.b	$60+(.LUM1/256)
     15  5a21		       84		      .byte.b	$80+(.LUM2/256)
     16  5a22		       18		      .byte.b	$10+(.LUM3/256)
     17  5a23
     18  5a23
     19  5a23
     20  5a23
     21  5a23
     22  5a23				   .LUM1      SET	.LUM1 + .STEP1
     23  5a23				   .LUM2      SET	.LUM2 + .STEP2
     24  5a23				   .LUM3      SET	.LUM3 + .STEP3
     13  5a23					      REPEND
     14  5a23		       66		      .byte.b	$60+(.LUM1/256)
     15  5a24		       84		      .byte.b	$80+(.LUM2/256)
     16  5a25		       18		      .byte.b	$10+(.LUM3/256)
     17  5a26
     18  5a26
     19  5a26
     20  5a26
     21  5a26
     22  5a26				   .LUM1      SET	.LUM1 + .STEP1
     23  5a26				   .LUM2      SET	.LUM2 + .STEP2
     24  5a26				   .LUM3      SET	.LUM3 + .STEP3
     13  5a26					      REPEND
     14  5a26		       66		      .byte.b	$60+(.LUM1/256)
     15  5a27		       84		      .byte.b	$80+(.LUM2/256)
     16  5a28		       18		      .byte.b	$10+(.LUM3/256)
     17  5a29
     18  5a29
     19  5a29
     20  5a29
     21  5a29
     22  5a29				   .LUM1      SET	.LUM1 + .STEP1
     23  5a29				   .LUM2      SET	.LUM2 + .STEP2
     24  5a29				   .LUM3      SET	.LUM3 + .STEP3
     13  5a29					      REPEND
     14  5a29		       66		      .byte.b	$60+(.LUM1/256)
     15  5a2a		       84		      .byte.b	$80+(.LUM2/256)
     16  5a2b		       18		      .byte.b	$10+(.LUM3/256)
     17  5a2c
     18  5a2c
     19  5a2c
     20  5a2c
     21  5a2c
     22  5a2c				   .LUM1      SET	.LUM1 + .STEP1
     23  5a2c				   .LUM2      SET	.LUM2 + .STEP2
     24  5a2c				   .LUM3      SET	.LUM3 + .STEP3
     13  5a2c					      REPEND
     14  5a2c		       66		      .byte.b	$60+(.LUM1/256)
     15  5a2d		       84		      .byte.b	$80+(.LUM2/256)
     16  5a2e		       18		      .byte.b	$10+(.LUM3/256)
     17  5a2f
     18  5a2f
     19  5a2f
     20  5a2f
     21  5a2f
     22  5a2f				   .LUM1      SET	.LUM1 + .STEP1
     23  5a2f				   .LUM2      SET	.LUM2 + .STEP2
     24  5a2f				   .LUM3      SET	.LUM3 + .STEP3
     13  5a2f					      REPEND
     14  5a2f		       66		      .byte.b	$60+(.LUM1/256)
     15  5a30		       84		      .byte.b	$80+(.LUM2/256)
     16  5a31		       18		      .byte.b	$10+(.LUM3/256)
     17  5a32
     18  5a32
     19  5a32
     20  5a32
     21  5a32
     22  5a32				   .LUM1      SET	.LUM1 + .STEP1
     23  5a32				   .LUM2      SET	.LUM2 + .STEP2
     24  5a32				   .LUM3      SET	.LUM3 + .STEP3
     13  5a32					      REPEND
     14  5a32		       66		      .byte.b	$60+(.LUM1/256)
     15  5a33		       84		      .byte.b	$80+(.LUM2/256)
     16  5a34		       18		      .byte.b	$10+(.LUM3/256)
     17  5a35
     18  5a35
     19  5a35
     20  5a35
     21  5a35
     22  5a35				   .LUM1      SET	.LUM1 + .STEP1
     23  5a35				   .LUM2      SET	.LUM2 + .STEP2
     24  5a35				   .LUM3      SET	.LUM3 + .STEP3
     13  5a35					      REPEND
     14  5a35		       66		      .byte.b	$60+(.LUM1/256)
     15  5a36		       84		      .byte.b	$80+(.LUM2/256)
     16  5a37		       18		      .byte.b	$10+(.LUM3/256)
     17  5a38
     18  5a38
     19  5a38
     20  5a38
     21  5a38
     22  5a38				   .LUM1      SET	.LUM1 + .STEP1
     23  5a38				   .LUM2      SET	.LUM2 + .STEP2
     24  5a38				   .LUM3      SET	.LUM3 + .STEP3
     13  5a38					      REPEND
     14  5a38		       66		      .byte.b	$60+(.LUM1/256)
     15  5a39		       84		      .byte.b	$80+(.LUM2/256)
     16  5a3a		       18		      .byte.b	$10+(.LUM3/256)
     17  5a3b
     18  5a3b
     19  5a3b
     20  5a3b
     21  5a3b
     22  5a3b				   .LUM1      SET	.LUM1 + .STEP1
     23  5a3b				   .LUM2      SET	.LUM2 + .STEP2
     24  5a3b				   .LUM3      SET	.LUM3 + .STEP3
     13  5a3b					      REPEND
     14  5a3b		       66		      .byte.b	$60+(.LUM1/256)
     15  5a3c		       84		      .byte.b	$80+(.LUM2/256)
     16  5a3d		       18		      .byte.b	$10+(.LUM3/256)
     17  5a3e
     18  5a3e
     19  5a3e
     20  5a3e
     21  5a3e
     22  5a3e				   .LUM1      SET	.LUM1 + .STEP1
     23  5a3e				   .LUM2      SET	.LUM2 + .STEP2
     24  5a3e				   .LUM3      SET	.LUM3 + .STEP3
     13  5a3e					      REPEND
     14  5a3e		       66		      .byte.b	$60+(.LUM1/256)
     15  5a3f		       84		      .byte.b	$80+(.LUM2/256)
     16  5a40		       18		      .byte.b	$10+(.LUM3/256)
     17  5a41
     18  5a41
     19  5a41
     20  5a41
     21  5a41
     22  5a41				   .LUM1      SET	.LUM1 + .STEP1
     23  5a41				   .LUM2      SET	.LUM2 + .STEP2
     24  5a41				   .LUM3      SET	.LUM3 + .STEP3
     13  5a41					      REPEND
     14  5a41		       66		      .byte.b	$60+(.LUM1/256)
     15  5a42		       84		      .byte.b	$80+(.LUM2/256)
     16  5a43		       18		      .byte.b	$10+(.LUM3/256)
     17  5a44
     18  5a44
     19  5a44
     20  5a44
     21  5a44
     22  5a44				   .LUM1      SET	.LUM1 + .STEP1
     23  5a44				   .LUM2      SET	.LUM2 + .STEP2
     24  5a44				   .LUM3      SET	.LUM3 + .STEP3
     13  5a44					      REPEND
     14  5a44		       66		      .byte.b	$60+(.LUM1/256)
     15  5a45		       84		      .byte.b	$80+(.LUM2/256)
     16  5a46		       18		      .byte.b	$10+(.LUM3/256)
     17  5a47
     18  5a47
     19  5a47
     20  5a47
     21  5a47
     22  5a47				   .LUM1      SET	.LUM1 + .STEP1
     23  5a47				   .LUM2      SET	.LUM2 + .STEP2
     24  5a47				   .LUM3      SET	.LUM3 + .STEP3
     13  5a47					      REPEND
     14  5a47		       66		      .byte.b	$60+(.LUM1/256)
     15  5a48		       84		      .byte.b	$80+(.LUM2/256)
     16  5a49		       18		      .byte.b	$10+(.LUM3/256)
     17  5a4a
     18  5a4a
     19  5a4a
     20  5a4a
     21  5a4a
     22  5a4a				   .LUM1      SET	.LUM1 + .STEP1
     23  5a4a				   .LUM2      SET	.LUM2 + .STEP2
     24  5a4a				   .LUM3      SET	.LUM3 + .STEP3
     13  5a4a					      REPEND
     14  5a4a		       66		      .byte.b	$60+(.LUM1/256)
     15  5a4b		       84		      .byte.b	$80+(.LUM2/256)
     16  5a4c		       18		      .byte.b	$10+(.LUM3/256)
     17  5a4d
     18  5a4d
     19  5a4d
     20  5a4d
     21  5a4d
     22  5a4d				   .LUM1      SET	.LUM1 + .STEP1
     23  5a4d				   .LUM2      SET	.LUM2 + .STEP2
     24  5a4d				   .LUM3      SET	.LUM3 + .STEP3
     13  5a4d					      REPEND
     14  5a4d		       66		      .byte.b	$60+(.LUM1/256)
     15  5a4e		       84		      .byte.b	$80+(.LUM2/256)
     16  5a4f		       18		      .byte.b	$10+(.LUM3/256)
     17  5a50
     18  5a50
     19  5a50
     20  5a50
     21  5a50
     22  5a50				   .LUM1      SET	.LUM1 + .STEP1
     23  5a50				   .LUM2      SET	.LUM2 + .STEP2
     24  5a50				   .LUM3      SET	.LUM3 + .STEP3
     13  5a50					      REPEND
     14  5a50		       66		      .byte.b	$60+(.LUM1/256)
     15  5a51		       84		      .byte.b	$80+(.LUM2/256)
     16  5a52		       18		      .byte.b	$10+(.LUM3/256)
     17  5a53
     18  5a53
     19  5a53
     20  5a53
     21  5a53
     22  5a53				   .LUM1      SET	.LUM1 + .STEP1
     23  5a53				   .LUM2      SET	.LUM2 + .STEP2
     24  5a53				   .LUM3      SET	.LUM3 + .STEP3
     13  5a53					      REPEND
     14  5a53		       66		      .byte.b	$60+(.LUM1/256)
     15  5a54		       84		      .byte.b	$80+(.LUM2/256)
     16  5a55		       18		      .byte.b	$10+(.LUM3/256)
     17  5a56
     18  5a56
     19  5a56
     20  5a56
     21  5a56
     22  5a56				   .LUM1      SET	.LUM1 + .STEP1
     23  5a56				   .LUM2      SET	.LUM2 + .STEP2
     24  5a56				   .LUM3      SET	.LUM3 + .STEP3
     13  5a56					      REPEND
     14  5a56		       66		      .byte.b	$60+(.LUM1/256)
     15  5a57		       84		      .byte.b	$80+(.LUM2/256)
     16  5a58		       18		      .byte.b	$10+(.LUM3/256)
     17  5a59
     18  5a59
     19  5a59
     20  5a59
     21  5a59
     22  5a59				   .LUM1      SET	.LUM1 + .STEP1
     23  5a59				   .LUM2      SET	.LUM2 + .STEP2
     24  5a59				   .LUM3      SET	.LUM3 + .STEP3
     13  5a59					      REPEND
     14  5a59		       66		      .byte.b	$60+(.LUM1/256)
     15  5a5a		       84		      .byte.b	$80+(.LUM2/256)
     16  5a5b		       18		      .byte.b	$10+(.LUM3/256)
     17  5a5c
     18  5a5c
     19  5a5c
     20  5a5c
     21  5a5c
     22  5a5c				   .LUM1      SET	.LUM1 + .STEP1
     23  5a5c				   .LUM2      SET	.LUM2 + .STEP2
     24  5a5c				   .LUM3      SET	.LUM3 + .STEP3
     13  5a5c					      REPEND
     14  5a5c		       66		      .byte.b	$60+(.LUM1/256)
     15  5a5d		       84		      .byte.b	$80+(.LUM2/256)
     16  5a5e		       18		      .byte.b	$10+(.LUM3/256)
     17  5a5f
     18  5a5f
     19  5a5f
     20  5a5f
     21  5a5f
     22  5a5f				   .LUM1      SET	.LUM1 + .STEP1
     23  5a5f				   .LUM2      SET	.LUM2 + .STEP2
     24  5a5f				   .LUM3      SET	.LUM3 + .STEP3
     13  5a5f					      REPEND
     14  5a5f		       66		      .byte.b	$60+(.LUM1/256)
     15  5a60		       84		      .byte.b	$80+(.LUM2/256)
     16  5a61		       18		      .byte.b	$10+(.LUM3/256)
     17  5a62
     18  5a62
     19  5a62
     20  5a62
     21  5a62
     22  5a62				   .LUM1      SET	.LUM1 + .STEP1
     23  5a62				   .LUM2      SET	.LUM2 + .STEP2
     24  5a62				   .LUM3      SET	.LUM3 + .STEP3
     13  5a62					      REPEND
     14  5a62		       66		      .byte.b	$60+(.LUM1/256)
     15  5a63		       84		      .byte.b	$80+(.LUM2/256)
     16  5a64		       18		      .byte.b	$10+(.LUM3/256)
     17  5a65
     18  5a65
     19  5a65
     20  5a65
     21  5a65
     22  5a65				   .LUM1      SET	.LUM1 + .STEP1
     23  5a65				   .LUM2      SET	.LUM2 + .STEP2
     24  5a65				   .LUM3      SET	.LUM3 + .STEP3
     13  5a65					      REPEND
     14  5a65		       66		      .byte.b	$60+(.LUM1/256)
     15  5a66		       84		      .byte.b	$80+(.LUM2/256)
     16  5a67		       18		      .byte.b	$10+(.LUM3/256)
     17  5a68
     18  5a68
     19  5a68
     20  5a68
     21  5a68
     22  5a68				   .LUM1      SET	.LUM1 + .STEP1
     23  5a68				   .LUM2      SET	.LUM2 + .STEP2
     24  5a68				   .LUM3      SET	.LUM3 + .STEP3
     13  5a68					      REPEND
     14  5a68		       66		      .byte.b	$60+(.LUM1/256)
     15  5a69		       84		      .byte.b	$80+(.LUM2/256)
     16  5a6a		       18		      .byte.b	$10+(.LUM3/256)
     17  5a6b
     18  5a6b
     19  5a6b
     20  5a6b
     21  5a6b
     22  5a6b				   .LUM1      SET	.LUM1 + .STEP1
     23  5a6b				   .LUM2      SET	.LUM2 + .STEP2
     24  5a6b				   .LUM3      SET	.LUM3 + .STEP3
     13  5a6b					      REPEND
     14  5a6b		       66		      .byte.b	$60+(.LUM1/256)
     15  5a6c		       84		      .byte.b	$80+(.LUM2/256)
     16  5a6d		       18		      .byte.b	$10+(.LUM3/256)
     17  5a6e
     18  5a6e
     19  5a6e
     20  5a6e
     21  5a6e
     22  5a6e				   .LUM1      SET	.LUM1 + .STEP1
     23  5a6e				   .LUM2      SET	.LUM2 + .STEP2
     24  5a6e				   .LUM3      SET	.LUM3 + .STEP3
     13  5a6e					      REPEND
     14  5a6e		       66		      .byte.b	$60+(.LUM1/256)
     15  5a6f		       84		      .byte.b	$80+(.LUM2/256)
     16  5a70		       18		      .byte.b	$10+(.LUM3/256)
     17  5a71
     18  5a71
     19  5a71
     20  5a71
     21  5a71
     22  5a71				   .LUM1      SET	.LUM1 + .STEP1
     23  5a71				   .LUM2      SET	.LUM2 + .STEP2
     24  5a71				   .LUM3      SET	.LUM3 + .STEP3
     13  5a71					      REPEND
     14  5a71		       66		      .byte.b	$60+(.LUM1/256)
     15  5a72		       84		      .byte.b	$80+(.LUM2/256)
     16  5a73		       18		      .byte.b	$10+(.LUM3/256)
     17  5a74
     18  5a74
     19  5a74
     20  5a74
     21  5a74
     22  5a74				   .LUM1      SET	.LUM1 + .STEP1
     23  5a74				   .LUM2      SET	.LUM2 + .STEP2
     24  5a74				   .LUM3      SET	.LUM3 + .STEP3
     13  5a74					      REPEND
     14  5a74		       66		      .byte.b	$60+(.LUM1/256)
     15  5a75		       84		      .byte.b	$80+(.LUM2/256)
     16  5a76		       18		      .byte.b	$10+(.LUM3/256)
     17  5a77
     18  5a77
     19  5a77
     20  5a77
     21  5a77
     22  5a77				   .LUM1      SET	.LUM1 + .STEP1
     23  5a77				   .LUM2      SET	.LUM2 + .STEP2
     24  5a77				   .LUM3      SET	.LUM3 + .STEP3
     13  5a77					      REPEND
     14  5a77		       66		      .byte.b	$60+(.LUM1/256)
     15  5a78		       84		      .byte.b	$80+(.LUM2/256)
     16  5a79		       18		      .byte.b	$10+(.LUM3/256)
     17  5a7a
     18  5a7a
     19  5a7a
     20  5a7a
     21  5a7a
     22  5a7a				   .LUM1      SET	.LUM1 + .STEP1
     23  5a7a				   .LUM2      SET	.LUM2 + .STEP2
     24  5a7a				   .LUM3      SET	.LUM3 + .STEP3
     13  5a7a					      REPEND
     14  5a7a		       66		      .byte.b	$60+(.LUM1/256)
     15  5a7b		       84		      .byte.b	$80+(.LUM2/256)
     16  5a7c		       18		      .byte.b	$10+(.LUM3/256)
     17  5a7d
     18  5a7d
     19  5a7d
     20  5a7d
     21  5a7d
     22  5a7d				   .LUM1      SET	.LUM1 + .STEP1
     23  5a7d				   .LUM2      SET	.LUM2 + .STEP2
     24  5a7d				   .LUM3      SET	.LUM3 + .STEP3
     13  5a7d					      REPEND
     14  5a7d		       66		      .byte.b	$60+(.LUM1/256)
     15  5a7e		       84		      .byte.b	$80+(.LUM2/256)
     16  5a7f		       18		      .byte.b	$10+(.LUM3/256)
     17  5a80
     18  5a80
     19  5a80
     20  5a80
     21  5a80
     22  5a80				   .LUM1      SET	.LUM1 + .STEP1
     23  5a80				   .LUM2      SET	.LUM2 + .STEP2
     24  5a80				   .LUM3      SET	.LUM3 + .STEP3
     13  5a80					      REPEND
     14  5a80		       66		      .byte.b	$60+(.LUM1/256)
     15  5a81		       84		      .byte.b	$80+(.LUM2/256)
     16  5a82		       18		      .byte.b	$10+(.LUM3/256)
     17  5a83
     18  5a83
     19  5a83
     20  5a83
     21  5a83
     22  5a83				   .LUM1      SET	.LUM1 + .STEP1
     23  5a83				   .LUM2      SET	.LUM2 + .STEP2
     24  5a83				   .LUM3      SET	.LUM3 + .STEP3
     13  5a83					      REPEND
     14  5a83		       66		      .byte.b	$60+(.LUM1/256)
     15  5a84		       84		      .byte.b	$80+(.LUM2/256)
     16  5a85		       18		      .byte.b	$10+(.LUM3/256)
     17  5a86
     18  5a86
     19  5a86
     20  5a86
     21  5a86
     22  5a86				   .LUM1      SET	.LUM1 + .STEP1
     23  5a86				   .LUM2      SET	.LUM2 + .STEP2
     24  5a86				   .LUM3      SET	.LUM3 + .STEP3
     13  5a86					      REPEND
     14  5a86		       66		      .byte.b	$60+(.LUM1/256)
     15  5a87		       84		      .byte.b	$80+(.LUM2/256)
     16  5a88		       18		      .byte.b	$10+(.LUM3/256)
     17  5a89
     18  5a89
     19  5a89
     20  5a89
     21  5a89
     22  5a89				   .LUM1      SET	.LUM1 + .STEP1
     23  5a89				   .LUM2      SET	.LUM2 + .STEP2
     24  5a89				   .LUM3      SET	.LUM3 + .STEP3
     13  5a89					      REPEND
     14  5a89		       66		      .byte.b	$60+(.LUM1/256)
     15  5a8a		       84		      .byte.b	$80+(.LUM2/256)
     16  5a8b		       18		      .byte.b	$10+(.LUM3/256)
     17  5a8c
     18  5a8c
     19  5a8c
     20  5a8c
     21  5a8c
     22  5a8c				   .LUM1      SET	.LUM1 + .STEP1
     23  5a8c				   .LUM2      SET	.LUM2 + .STEP2
     24  5a8c				   .LUM3      SET	.LUM3 + .STEP3
     13  5a8c					      REPEND
     14  5a8c		       66		      .byte.b	$60+(.LUM1/256)
     15  5a8d		       84		      .byte.b	$80+(.LUM2/256)
     16  5a8e		       18		      .byte.b	$10+(.LUM3/256)
     17  5a8f
     18  5a8f
     19  5a8f
     20  5a8f
     21  5a8f
     22  5a8f				   .LUM1      SET	.LUM1 + .STEP1
     23  5a8f				   .LUM2      SET	.LUM2 + .STEP2
     24  5a8f				   .LUM3      SET	.LUM3 + .STEP3
     13  5a8f					      REPEND
     14  5a8f		       66		      .byte.b	$60+(.LUM1/256)
     15  5a90		       84		      .byte.b	$80+(.LUM2/256)
     16  5a91		       18		      .byte.b	$10+(.LUM3/256)
     17  5a92
     18  5a92
     19  5a92
     20  5a92
     21  5a92
     22  5a92				   .LUM1      SET	.LUM1 + .STEP1
     23  5a92				   .LUM2      SET	.LUM2 + .STEP2
     24  5a92				   .LUM3      SET	.LUM3 + .STEP3
     13  5a92					      REPEND
     14  5a92		       66		      .byte.b	$60+(.LUM1/256)
     15  5a93		       84		      .byte.b	$80+(.LUM2/256)
     16  5a94		       18		      .byte.b	$10+(.LUM3/256)
     17  5a95
     18  5a95
     19  5a95
     20  5a95
     21  5a95
     22  5a95				   .LUM1      SET	.LUM1 + .STEP1
     23  5a95				   .LUM2      SET	.LUM2 + .STEP2
     24  5a95				   .LUM3      SET	.LUM3 + .STEP3
     13  5a95					      REPEND
     14  5a95		       66		      .byte.b	$60+(.LUM1/256)
     15  5a96		       84		      .byte.b	$80+(.LUM2/256)
     16  5a97		       18		      .byte.b	$10+(.LUM3/256)
     17  5a98
     18  5a98
     19  5a98
     20  5a98
     21  5a98
     22  5a98				   .LUM1      SET	.LUM1 + .STEP1
     23  5a98				   .LUM2      SET	.LUM2 + .STEP2
     24  5a98				   .LUM3      SET	.LUM3 + .STEP3
     13  5a98					      REPEND
     14  5a98		       66		      .byte.b	$60+(.LUM1/256)
     15  5a99		       84		      .byte.b	$80+(.LUM2/256)
     16  5a9a		       18		      .byte.b	$10+(.LUM3/256)
     17  5a9b
     18  5a9b
     19  5a9b
     20  5a9b
     21  5a9b
     22  5a9b				   .LUM1      SET	.LUM1 + .STEP1
     23  5a9b				   .LUM2      SET	.LUM2 + .STEP2
     24  5a9b				   .LUM3      SET	.LUM3 + .STEP3
     13  5a9b					      REPEND
     14  5a9b		       66		      .byte.b	$60+(.LUM1/256)
     15  5a9c		       84		      .byte.b	$80+(.LUM2/256)
     16  5a9d		       18		      .byte.b	$10+(.LUM3/256)
     17  5a9e
     18  5a9e
     19  5a9e
     20  5a9e
     21  5a9e
     22  5a9e				   .LUM1      SET	.LUM1 + .STEP1
     23  5a9e				   .LUM2      SET	.LUM2 + .STEP2
     24  5a9e				   .LUM3      SET	.LUM3 + .STEP3
     13  5a9e					      REPEND
     14  5a9e		       66		      .byte.b	$60+(.LUM1/256)
     15  5a9f		       84		      .byte.b	$80+(.LUM2/256)
     16  5aa0		       18		      .byte.b	$10+(.LUM3/256)
     17  5aa1
     18  5aa1
     19  5aa1
     20  5aa1
     21  5aa1
     22  5aa1				   .LUM1      SET	.LUM1 + .STEP1
     23  5aa1				   .LUM2      SET	.LUM2 + .STEP2
     24  5aa1				   .LUM3      SET	.LUM3 + .STEP3
     13  5aa1					      REPEND
     14  5aa1		       66		      .byte.b	$60+(.LUM1/256)
     15  5aa2		       84		      .byte.b	$80+(.LUM2/256)
     16  5aa3		       18		      .byte.b	$10+(.LUM3/256)
     17  5aa4
     18  5aa4
     19  5aa4
     20  5aa4
     21  5aa4
     22  5aa4				   .LUM1      SET	.LUM1 + .STEP1
     23  5aa4				   .LUM2      SET	.LUM2 + .STEP2
     24  5aa4				   .LUM3      SET	.LUM3 + .STEP3
     13  5aa4					      REPEND
     14  5aa4		       66		      .byte.b	$60+(.LUM1/256)
     15  5aa5		       84		      .byte.b	$80+(.LUM2/256)
     16  5aa6		       18		      .byte.b	$10+(.LUM3/256)
     17  5aa7
     18  5aa7
     19  5aa7
     20  5aa7
     21  5aa7
     22  5aa7				   .LUM1      SET	.LUM1 + .STEP1
     23  5aa7				   .LUM2      SET	.LUM2 + .STEP2
     24  5aa7				   .LUM3      SET	.LUM3 + .STEP3
     13  5aa7					      REPEND
     14  5aa7		       66		      .byte.b	$60+(.LUM1/256)
     15  5aa8		       84		      .byte.b	$80+(.LUM2/256)
     16  5aa9		       18		      .byte.b	$10+(.LUM3/256)
     17  5aaa
     18  5aaa
     19  5aaa
     20  5aaa
     21  5aaa
     22  5aaa				   .LUM1      SET	.LUM1 + .STEP1
     23  5aaa				   .LUM2      SET	.LUM2 + .STEP2
     24  5aaa				   .LUM3      SET	.LUM3 + .STEP3
     13  5aaa					      REPEND
     14  5aaa		       66		      .byte.b	$60+(.LUM1/256)
     15  5aab		       84		      .byte.b	$80+(.LUM2/256)
     16  5aac		       18		      .byte.b	$10+(.LUM3/256)
     17  5aad
     18  5aad
     19  5aad
     20  5aad
     21  5aad
     22  5aad				   .LUM1      SET	.LUM1 + .STEP1
     23  5aad				   .LUM2      SET	.LUM2 + .STEP2
     24  5aad				   .LUM3      SET	.LUM3 + .STEP3
     13  5aad					      REPEND
     14  5aad		       66		      .byte.b	$60+(.LUM1/256)
     15  5aae		       84		      .byte.b	$80+(.LUM2/256)
     16  5aaf		       18		      .byte.b	$10+(.LUM3/256)
     17  5ab0
     18  5ab0
     19  5ab0
     20  5ab0
     21  5ab0
     22  5ab0				   .LUM1      SET	.LUM1 + .STEP1
     23  5ab0				   .LUM2      SET	.LUM2 + .STEP2
     24  5ab0				   .LUM3      SET	.LUM3 + .STEP3
     25  5ab0					      REPEND
    262  5ab0							;colr_pal	  LUMTABLE $90, $20, $60, $6,$A,$a,$C,$6,$8
    263  5ab0
------- FILE titleData.asm LEVEL 3 PASS 2
      0  5ab0					      include	"titleData.asm"
      1  5ab0				   COL_0
      2  5ab0		       00		      .byte.b	0	;R (71)
      3  5ab1		       00		      .byte.b	0	;G
      4  5ab2		       00		      .byte.b	0	;B
      5  5ab3		       40		      .byte.b	64	;R (70)
      6  5ab4		       40		      .byte.b	64	;G
      7  5ab5		       00		      .byte.b	0	;B
      8  5ab6		       00		      .byte.b	0	;R (69)
      9  5ab7		       00		      .byte.b	0	;G
     10  5ab8		       00		      .byte.b	0	;B
     11  5ab9		       00		      .byte.b	0	;R (68)
     12  5aba		       80		      .byte.b	128	;G
     13  5abb		       00		      .byte.b	0	;B
     14  5abc		       00		      .byte.b	0	;R (67)
     15  5abd		       20		      .byte.b	32	;G
     16  5abe		       00		      .byte.b	0	;B
     17  5abf		       80		      .byte.b	128	;R (66)
     18  5ac0		       80		      .byte.b	128	;G
     19  5ac1		       00		      .byte.b	0	;B
     20  5ac2		       c0		      .byte.b	192	;R (65)
     21  5ac3		       c0		      .byte.b	192	;G
     22  5ac4		       00		      .byte.b	0	;B
     23  5ac5		       40		      .byte.b	64	;R (64)
     24  5ac6		       c0		      .byte.b	192	;G
     25  5ac7		       00		      .byte.b	0	;B
     26  5ac8		       00		      .byte.b	0	;R (63)
     27  5ac9		       a0		      .byte.b	160	;G
     28  5aca		       00		      .byte.b	0	;B
     29  5acb		       10		      .byte.b	16	;R (62)
     30  5acc		       70		      .byte.b	112	;G
     31  5acd		       00		      .byte.b	0	;B
     32  5ace		       00		      .byte.b	0	;R (61)
     33  5acf		       80		      .byte.b	128	;G
     34  5ad0		       40		      .byte.b	64	;B
     35  5ad1		       00		      .byte.b	0	;R (60)
     36  5ad2		       c0		      .byte.b	192	;G
     37  5ad3		       00		      .byte.b	0	;B
     38  5ad4		       00		      .byte.b	0	;R (59)
     39  5ad5		       c0		      .byte.b	192	;G
     40  5ad6		       00		      .byte.b	0	;B
     41  5ad7		       00		      .byte.b	0	;R (58)
     42  5ad8		       40		      .byte.b	64	;G
     43  5ad9		       00		      .byte.b	0	;B
     44  5ada		       00		      .byte.b	0	;R (57)
     45  5adb		       c0		      .byte.b	192	;G
     46  5adc		       00		      .byte.b	0	;B
     47  5add		       00		      .byte.b	0	;R (56)
     48  5ade		       60		      .byte.b	96	;G
     49  5adf		       00		      .byte.b	0	;B
     50  5ae0		       00		      .byte.b	0	;R (55)
     51  5ae1		       80		      .byte.b	128	;G
     52  5ae2		       00		      .byte.b	0	;B
     53  5ae3		       00		      .byte.b	0	;R (54)
     54  5ae4		       40		      .byte.b	64	;G
     55  5ae5		       00		      .byte.b	0	;B
     56  5ae6		       00		      .byte.b	0	;R (53)
     57  5ae7		       80		      .byte.b	128	;G
     58  5ae8		       00		      .byte.b	0	;B
     59  5ae9		       00		      .byte.b	0	;R (52)
     60  5aea		       80		      .byte.b	128	;G
     61  5aeb		       00		      .byte.b	0	;B
     62  5aec		       00		      .byte.b	0	;R (51)
     63  5aed		       10		      .byte.b	16	;G
     64  5aee		       00		      .byte.b	0	;B
     65  5aef		       00		      .byte.b	0	;R (50)
     66  5af0		       00		      .byte.b	0	;G
     67  5af1		       00		      .byte.b	0	;B
     68  5af2		       00		      .byte.b	0	;R (49)
     69  5af3		       00		      .byte.b	0	;G
     70  5af4		       00		      .byte.b	0	;B
     71  5af5		       00		      .byte.b	0	;R (48)
     72  5af6		       00		      .byte.b	0	;G
     73  5af7		       00		      .byte.b	0	;B
     74  5af8		       00		      .byte.b	0	;R (47)
     75  5af9		       00		      .byte.b	0	;G
     76  5afa		       00		      .byte.b	0	;B
     77  5afb		       00		      .byte.b	0	;R (46)
     78  5afc		       40		      .byte.b	64	;G
     79  5afd		       00		      .byte.b	0	;B
     80  5afe		       00		      .byte.b	0	;R (45)
     81  5aff		       00		      .byte.b	0	;G
     82  5b00		       00		      .byte.b	0	;B
     83  5b01		       00		      .byte.b	0	;R (44)
     84  5b02		       00		      .byte.b	0	;G
     85  5b03		       00		      .byte.b	0	;B
     86  5b04		       00		      .byte.b	0	;R (43)
     87  5b05		       00		      .byte.b	0	;G
     88  5b06		       00		      .byte.b	0	;B
     89  5b07		       00		      .byte.b	0	;R (42)
     90  5b08		       40		      .byte.b	64	;G
     91  5b09		       00		      .byte.b	0	;B
     92  5b0a		       00		      .byte.b	0	;R (41)
     93  5b0b		       00		      .byte.b	0	;G
     94  5b0c		       00		      .byte.b	0	;B
     95  5b0d		       00		      .byte.b	0	;R (40)
     96  5b0e		       00		      .byte.b	0	;G
     97  5b0f		       00		      .byte.b	0	;B
     98  5b10		       00		      .byte.b	0	;R (39)
     99  5b11		       20		      .byte.b	32	;G
    100  5b12		       00		      .byte.b	0	;B
    101  5b13		       00		      .byte.b	0	;R (38)
    102  5b14		       00		      .byte.b	0	;G
    103  5b15		       00		      .byte.b	0	;B
    104  5b16		       00		      .byte.b	0	;R (37)
    105  5b17		       10		      .byte.b	16	;G
    106  5b18		       00		      .byte.b	0	;B
    107  5b19		       00		      .byte.b	0	;R (36)
    108  5b1a		       00		      .byte.b	0	;G
    109  5b1b		       00		      .byte.b	0	;B
    110  5b1c		       00		      .byte.b	0	;R (35)
    111  5b1d		       40		      .byte.b	64	;G
    112  5b1e		       00		      .byte.b	0	;B
    113  5b1f		       00		      .byte.b	0	;R (34)
    114  5b20		       20		      .byte.b	32	;G
    115  5b21		       00		      .byte.b	0	;B
    116  5b22		       00		      .byte.b	0	;R (33)
    117  5b23		       00		      .byte.b	0	;G
    118  5b24		       00		      .byte.b	0	;B
    119  5b25		       00		      .byte.b	0	;R (32)
    120  5b26		       00		      .byte.b	0	;G
    121  5b27		       00		      .byte.b	0	;B
    122  5b28		       00		      .byte.b	0	;R (31)
    123  5b29		       20		      .byte.b	32	;G
    124  5b2a		       00		      .byte.b	0	;B
    125  5b2b		       00		      .byte.b	0	;R (30)
    126  5b2c		       00		      .byte.b	0	;G
    127  5b2d		       00		      .byte.b	0	;B
    128  5b2e		       00		      .byte.b	0	;R (29)
    129  5b2f		       80		      .byte.b	128	;G
    130  5b30		       00		      .byte.b	0	;B
    131  5b31		       00		      .byte.b	0	;R (28)
    132  5b32		       00		      .byte.b	0	;G
    133  5b33		       00		      .byte.b	0	;B
    134  5b34		       00		      .byte.b	0	;R (27)
    135  5b35		       20		      .byte.b	32	;G
    136  5b36		       00		      .byte.b	0	;B
    137  5b37		       00		      .byte.b	0	;R (26)
    138  5b38		       00		      .byte.b	0	;G
    139  5b39		       00		      .byte.b	0	;B
    140  5b3a		       00		      .byte.b	0	;R (25)
    141  5b3b		       00		      .byte.b	0	;G
    142  5b3c		       00		      .byte.b	0	;B
    143  5b3d		       00		      .byte.b	0	;R (24)
    144  5b3e		       20		      .byte.b	32	;G
    145  5b3f		       00		      .byte.b	0	;B
    146  5b40		       00		      .byte.b	0	;R (23)
    147  5b41		       00		      .byte.b	0	;G
    148  5b42		       00		      .byte.b	0	;B
    149  5b43		       00		      .byte.b	0	;R (22)
    150  5b44		       00		      .byte.b	0	;G
    151  5b45		       00		      .byte.b	0	;B
    152  5b46		       00		      .byte.b	0	;R (21)
    153  5b47		       20		      .byte.b	32	;G
    154  5b48		       00		      .byte.b	0	;B
    155  5b49		       00		      .byte.b	0	;R (20)
    156  5b4a		       00		      .byte.b	0	;G
    157  5b4b		       00		      .byte.b	0	;B
    158  5b4c		       00		      .byte.b	0	;R (19)
    159  5b4d		       00		      .byte.b	0	;G
    160  5b4e		       00		      .byte.b	0	;B
    161  5b4f		       00		      .byte.b	0	;R (18)
    162  5b50		       00		      .byte.b	0	;G
    163  5b51		       00		      .byte.b	0	;B
    164  5b52		       00		      .byte.b	0	;R (17)
    165  5b53		       80		      .byte.b	128	;G
    166  5b54		       00		      .byte.b	0	;B
    167  5b55		       00		      .byte.b	0	;R (16)
    168  5b56		       00		      .byte.b	0	;G
    169  5b57		       00		      .byte.b	0	;B
    170  5b58		       00		      .byte.b	0	;R (15)
    171  5b59		       10		      .byte.b	16	;G
    172  5b5a		       00		      .byte.b	0	;B
    173  5b5b		       00		      .byte.b	0	;R (14)
    174  5b5c		       00		      .byte.b	0	;G
    175  5b5d		       00		      .byte.b	0	;B
    176  5b5e		       00		      .byte.b	0	;R (13)
    177  5b5f		       00		      .byte.b	0	;G
    178  5b60		       00		      .byte.b	0	;B
    179  5b61		       00		      .byte.b	0	;R (12)
    180  5b62		       80		      .byte.b	128	;G
    181  5b63		       00		      .byte.b	0	;B
    182  5b64		       00		      .byte.b	0	;R (11)
    183  5b65		       00		      .byte.b	0	;G
    184  5b66		       00		      .byte.b	0	;B
    185  5b67		       00		      .byte.b	0	;R (10)
    186  5b68		       00		      .byte.b	0	;G
    187  5b69		       00		      .byte.b	0	;B
    188  5b6a		       00		      .byte.b	0	;R (9)
    189  5b6b		       80		      .byte.b	128	;G
    190  5b6c		       00		      .byte.b	0	;B
    191  5b6d		       00		      .byte.b	0	;R (8)
    192  5b6e		       00		      .byte.b	0	;G
    193  5b6f		       00		      .byte.b	0	;B
    194  5b70		       00		      .byte.b	0	;R (7)
    195  5b71		       20		      .byte.b	32	;G
    196  5b72		       00		      .byte.b	0	;B
    197  5b73		       00		      .byte.b	0	;R (6)
    198  5b74		       00		      .byte.b	0	;G
    199  5b75		       00		      .byte.b	0	;B
    200  5b76		       00		      .byte.b	0	;R (5)
    201  5b77		       10		      .byte.b	16	;G
    202  5b78		       00		      .byte.b	0	;B
    203  5b79		       00		      .byte.b	0	;R (4)
    204  5b7a		       00		      .byte.b	0	;G
    205  5b7b		       00		      .byte.b	0	;B
    206  5b7c		       00		      .byte.b	0	;R (3)
    207  5b7d		       00		      .byte.b	0	;G
    208  5b7e		       00		      .byte.b	0	;B
    209  5b7f		       00		      .byte.b	0	;R (2)
    210  5b80		       40		      .byte.b	64	;G
    211  5b81		       00		      .byte.b	0	;B
    212  5b82		       00		      .byte.b	0	;R (1)
    213  5b83		       00		      .byte.b	0	;G
    214  5b84		       00		      .byte.b	0	;B
    215  5b85		       00		      .byte.b	0	;R (0)
    216  5b86		       00		      .byte.b	0	;G
    217  5b87		       00		      .byte.b	0	;B
    218  5b88				   COL_1
    219  5b88		       80		      .byte.b	128	;R (71)
    220  5b89		       80		      .byte.b	128	;G
    221  5b8a		       00		      .byte.b	0	;B
    222  5b8b		       10		      .byte.b	16	;R (70)
    223  5b8c		       14		      .byte.b	20	;G
    224  5b8d		       00		      .byte.b	0	;B
    225  5b8e		       00		      .byte.b	0	;R (69)
    226  5b8f		       41		      .byte.b	65	;G
    227  5b90		       00		      .byte.b	0	;B
    228  5b91		       00		      .byte.b	0	;R (68)
    229  5b92		       08		      .byte.b	8	;G
    230  5b93		       00		      .byte.b	0	;B
    231  5b94		       20		      .byte.b	32	;R (67)
    232  5b95		       20		      .byte.b	32	;G
    233  5b96		       00		      .byte.b	0	;B
    234  5b97		       63		      .byte.b	99	;R (66)
    235  5b98		       6b		      .byte.b	107	;G
    236  5b99		       00		      .byte.b	0	;B
    237  5b9a		       ff		      .byte.b	255	;R (65)
    238  5b9b		       f5		      .byte.b	245	;G
    239  5b9c		       00		      .byte.b	0	;B
    240  5b9d		       80		      .byte.b	128	;R (64)
    241  5b9e		       fb		      .byte.b	251	;G
    242  5b9f		       04		      .byte.b	4	;B
    243  5ba0		       00		      .byte.b	0	;R (63)
    244  5ba1		       b7		      .byte.b	183	;G
    245  5ba2		       00		      .byte.b	0	;B
    246  5ba3		       00		      .byte.b	0	;R (62)
    247  5ba4		       b5		      .byte.b	181	;G
    248  5ba5		       00		      .byte.b	0	;B
    249  5ba6		       00		      .byte.b	0	;R (61)
    250  5ba7		       ef		      .byte.b	239	;G
    251  5ba8		       10		      .byte.b	16	;B
    252  5ba9		       00		      .byte.b	0	;R (60)
    253  5baa		       bd		      .byte.b	189	;G
    254  5bab		       42		      .byte.b	66	;B
    255  5bac		       00		      .byte.b	0	;R (59)
    256  5bad		       77		      .byte.b	119	;G
    257  5bae		       00		      .byte.b	0	;B
    258  5baf		       00		      .byte.b	0	;R (58)
    259  5bb0		       ee		      .byte.b	238	;G
    260  5bb1		       00		      .byte.b	0	;B
    261  5bb2		       00		      .byte.b	0	;R (57)
    262  5bb3		       9b		      .byte.b	155	;G
    263  5bb4		       00		      .byte.b	0	;B
    264  5bb5		       00		      .byte.b	0	;R (56)
    265  5bb6		       f2		      .byte.b	242	;G
    266  5bb7		       00		      .byte.b	0	;B
    267  5bb8		       00		      .byte.b	0	;R (55)
    268  5bb9		       40		      .byte.b	64	;G
    269  5bba		       00		      .byte.b	0	;B
    270  5bbb		       00		      .byte.b	0	;R (54)
    271  5bbc		       df		      .byte.b	223	;G
    272  5bbd		       00		      .byte.b	0	;B
    273  5bbe		       10		      .byte.b	16	;R (53)
    274  5bbf		       69		      .byte.b	105	;G
    275  5bc0		       10		      .byte.b	16	;B
    276  5bc1		       00		      .byte.b	0	;R (52)
    277  5bc2		       4b		      .byte.b	75	;G
    278  5bc3		       00		      .byte.b	0	;B
    279  5bc4		       00		      .byte.b	0	;R (51)
    280  5bc5		       b0		      .byte.b	176	;G
    281  5bc6		       00		      .byte.b	0	;B
    282  5bc7		       00		      .byte.b	0	;R (50)
    283  5bc8		       a7		      .byte.b	167	;G
    284  5bc9		       00		      .byte.b	0	;B
    285  5bca		       00		      .byte.b	0	;R (49)
    286  5bcb		       7d		      .byte.b	125	;G
    287  5bcc		       02		      .byte.b	2	;B
    288  5bcd		       00		      .byte.b	0	;R (48)
    289  5bce		       db		      .byte.b	219	;G
    290  5bcf		       20		      .byte.b	32	;B
    291  5bd0		       00		      .byte.b	0	;R (47)
    292  5bd1		       6d		      .byte.b	109	;G
    293  5bd2		       00		      .byte.b	0	;B
    294  5bd3		       00		      .byte.b	0	;R (46)
    295  5bd4		       ea		      .byte.b	234	;G
    296  5bd5		       00		      .byte.b	0	;B
    297  5bd6		       00		      .byte.b	0	;R (45)
    298  5bd7		       13		      .byte.b	19	;G
    299  5bd8		       00		      .byte.b	0	;B
    300  5bd9		       00		      .byte.b	0	;R (44)
    301  5bda		       7e		      .byte.b	126	;G
    302  5bdb		       01		      .byte.b	1	;B
    303  5bdc		       22		      .byte.b	34	;R (43)
    304  5bdd		       77		      .byte.b	119	;G
    305  5bde		       08		      .byte.b	8	;B
    306  5bdf		       04		      .byte.b	4	;R (42)
    307  5be0		       5f		      .byte.b	95	;G
    308  5be1		       00		      .byte.b	0	;B
    309  5be2		       00		      .byte.b	0	;R (41)
    310  5be3		       6f		      .byte.b	111	;G
    311  5be4		       00		      .byte.b	0	;B
    312  5be5		       00		      .byte.b	0	;R (40)
    313  5be6		       b5		      .byte.b	181	;G
    314  5be7		       00		      .byte.b	0	;B
    315  5be8		       00		      .byte.b	0	;R (39)
    316  5be9		       5b		      .byte.b	91	;G
    317  5bea		       00		      .byte.b	0	;B
    318  5beb		       00		      .byte.b	0	;R (38)
    319  5bec		       57		      .byte.b	87	;G
    320  5bed		       00		      .byte.b	0	;B
    321  5bee		       20		      .byte.b	32	;R (37)
    322  5bef		       4d		      .byte.b	77	;G
    323  5bf0		       22		      .byte.b	34	;B
    324  5bf1		       00		      .byte.b	0	;R (36)
    325  5bf2		       55		      .byte.b	85	;G
    326  5bf3		       00		      .byte.b	0	;B
    327  5bf4		       01		      .byte.b	1	;R (35)
    328  5bf5		       56		      .byte.b	86	;G
    329  5bf6		       00		      .byte.b	0	;B
    330  5bf7		       02		      .byte.b	2	;R (34)
    331  5bf8		       57		      .byte.b	87	;G
    332  5bf9		       00		      .byte.b	0	;B
    333  5bfa		       00		      .byte.b	0	;R (33)
    334  5bfb		       2a		      .byte.b	42	;G
    335  5bfc		       01		      .byte.b	1	;B
    336  5bfd		       01		      .byte.b	1	;R (32)
    337  5bfe		       ab		      .byte.b	171	;G
    338  5bff		       00		      .byte.b	0	;B
    339  5c00		       22		      .byte.b	34	;R (31)
    340  5c01		       17		      .byte.b	23	;G
    341  5c02		       20		      .byte.b	32	;B
    342  5c03		       00		      .byte.b	0	;R (30)
    343  5c04		       55		      .byte.b	85	;G
    344  5c05		       02		      .byte.b	2	;B
    345  5c06		       22		      .byte.b	34	;R (29)
    346  5c07		       17		      .byte.b	23	;G
    347  5c08		       20		      .byte.b	32	;B
    348  5c09		       00		      .byte.b	0	;R (28)
    349  5c0a		       2b		      .byte.b	43	;G
    350  5c0b		       00		      .byte.b	0	;B
    351  5c0c		       00		      .byte.b	0	;R (27)
    352  5c0d		       95		      .byte.b	149	;G
    353  5c0e		       02		      .byte.b	2	;B
    354  5c0f		       00		      .byte.b	0	;R (26)
    355  5c10		       17		      .byte.b	23	;G
    356  5c11		       00		      .byte.b	0	;B
    357  5c12		       00		      .byte.b	0	;R (25)
    358  5c13		       2d		      .byte.b	45	;G
    359  5c14		       00		      .byte.b	0	;B
    360  5c15		       00		      .byte.b	0	;R (24)
    361  5c16		       b4		      .byte.b	180	;G
    362  5c17		       00		      .byte.b	0	;B
    363  5c18		       00		      .byte.b	0	;R (23)
    364  5c19		       0a		      .byte.b	10	;G
    365  5c1a		       00		      .byte.b	0	;B
    366  5c1b		       10		      .byte.b	16	;R (22)
    367  5c1c		       3c		      .byte.b	60	;G
    368  5c1d		       00		      .byte.b	0	;B
    369  5c1e		       10		      .byte.b	16	;R (21)
    370  5c1f		       98		      .byte.b	152	;G
    371  5c20		       00		      .byte.b	0	;B
    372  5c21		       10		      .byte.b	16	;R (20)
    373  5c22		       1a		      .byte.b	26	;G
    374  5c23		       00		      .byte.b	0	;B
    375  5c24		       00		      .byte.b	0	;R (19)
    376  5c25		       14		      .byte.b	20	;G
    377  5c26		       00		      .byte.b	0	;B
    378  5c27		       00		      .byte.b	0	;R (18)
    379  5c28		       5a		      .byte.b	90	;G
    380  5c29		       00		      .byte.b	0	;B
    381  5c2a		       00		      .byte.b	0	;R (17)
    382  5c2b		       09		      .byte.b	9	;G
    383  5c2c		       00		      .byte.b	0	;B
    384  5c2d		       08		      .byte.b	8	;R (16)
    385  5c2e		       1d		      .byte.b	29	;G
    386  5c2f		       00		      .byte.b	0	;B
    387  5c30		       00		      .byte.b	0	;R (15)
    388  5c31		       1a		      .byte.b	26	;G
    389  5c32		       00		      .byte.b	0	;B
    390  5c33		       20		      .byte.b	32	;R (14)
    391  5c34		       ba		      .byte.b	186	;G
    392  5c35		       00		      .byte.b	0	;B
    393  5c36		       00		      .byte.b	0	;R (13)
    394  5c37		       12		      .byte.b	18	;G
    395  5c38		       00		      .byte.b	0	;B
    396  5c39		       00		      .byte.b	0	;R (12)
    397  5c3a		       1a		      .byte.b	26	;G
    398  5c3b		       00		      .byte.b	0	;B
    399  5c3c		       00		      .byte.b	0	;R (11)
    400  5c3d		       2d		      .byte.b	45	;G
    401  5c3e		       10		      .byte.b	16	;B
    402  5c3f		       10		      .byte.b	16	;R (10)
    403  5c40		       3b		      .byte.b	59	;G
    404  5c41		       00		      .byte.b	0	;B
    405  5c42		       24		      .byte.b	36	;R (9)
    406  5c43		       39		      .byte.b	57	;G
    407  5c44		       04		      .byte.b	4	;B
    408  5c45		       20		      .byte.b	32	;R (8)
    409  5c46		       35		      .byte.b	53	;G
    410  5c47		       00		      .byte.b	0	;B
    411  5c48		       00		      .byte.b	0	;R (7)
    412  5c49		       3d		      .byte.b	61	;G
    413  5c4a		       00		      .byte.b	0	;B
    414  5c4b		       00		      .byte.b	0	;R (6)
    415  5c4c		       32		      .byte.b	50	;G
    416  5c4d		       00		      .byte.b	0	;B
    417  5c4e		       00		      .byte.b	0	;R (5)
    418  5c4f		       98		      .byte.b	152	;G
    419  5c50		       00		      .byte.b	0	;B
    420  5c51		       00		      .byte.b	0	;R (4)
    421  5c52		       12		      .byte.b	18	;G
    422  5c53		       00		      .byte.b	0	;B
    423  5c54		       00		      .byte.b	0	;R (3)
    424  5c55		       20		      .byte.b	32	;G
    425  5c56		       00		      .byte.b	0	;B
    426  5c57		       01		      .byte.b	1	;R (2)
    427  5c58		       49		      .byte.b	73	;G
    428  5c59		       00		      .byte.b	0	;B
    429  5c5a		       20		      .byte.b	32	;R (1)
    430  5c5b		       20		      .byte.b	32	;G
    431  5c5c		       00		      .byte.b	0	;B
    432  5c5d		       00		      .byte.b	0	;R (0)
    433  5c5e		       00		      .byte.b	0	;G
    434  5c5f		       00		      .byte.b	0	;B
    435  5c60				   COL_2
    436  5c60		       14		      .byte.b	20	;R (71)
    437  5c61		       14		      .byte.b	20	;G
    438  5c62		       00		      .byte.b	0	;B
    439  5c63		       40		      .byte.b	64	;R (70)
    440  5c64		       42		      .byte.b	66	;G
    441  5c65		       00		      .byte.b	0	;B
    442  5c66		       a8		      .byte.b	168	;R (69)
    443  5c67		       a8		      .byte.b	168	;G
    444  5c68		       00		      .byte.b	0	;B
    445  5c69		       fd		      .byte.b	253	;R (68)
    446  5c6a		       1d		      .byte.b	29	;G
    447  5c6b		       00		      .byte.b	0	;B
    448  5c6c		       f0		      .byte.b	240	;R (67)
    449  5c6d		       44		      .byte.b	68	;G
    450  5c6e		       08		      .byte.b	8	;B
    451  5c6f		       ff		      .byte.b	255	;R (66)
    452  5c70		       2f		      .byte.b	47	;G
    453  5c71		       00		      .byte.b	0	;B
    454  5c72		       ff		      .byte.b	255	;R (65)
    455  5c73		       0e		      .byte.b	14	;G
    456  5c74		       00		      .byte.b	0	;B
    457  5c75		       f8		      .byte.b	248	;R (64)
    458  5c76		       0f		      .byte.b	15	;G
    459  5c77		       00		      .byte.b	0	;B
    460  5c78		       f8		      .byte.b	248	;R (63)
    461  5c79		       2e		      .byte.b	46	;G
    462  5c7a		       00		      .byte.b	0	;B
    463  5c7b		       f8		      .byte.b	248	;R (62)
    464  5c7c		       1e		      .byte.b	30	;G
    465  5c7d		       01		      .byte.b	1	;B
    466  5c7e		       74		      .byte.b	116	;R (61)
    467  5c7f		       23		      .byte.b	35	;G
    468  5c80		       88		      .byte.b	136	;B
    469  5c81		       fc		      .byte.b	252	;R (60)
    470  5c82		       0f		      .byte.b	15	;G
    471  5c83		       00		      .byte.b	0	;B
    472  5c84		       f8		      .byte.b	248	;R (59)
    473  5c85		       06		      .byte.b	6	;G
    474  5c86		       01		      .byte.b	1	;B
    475  5c87		       f8		      .byte.b	248	;R (58)
    476  5c88		       8f		      .byte.b	143	;G
    477  5c89		       00		      .byte.b	0	;B
    478  5c8a		       e8		      .byte.b	232	;R (57)
    479  5c8b		       0e		      .byte.b	14	;G
    480  5c8c		       10		      .byte.b	16	;B
    481  5c8d		       e0		      .byte.b	224	;R (56)
    482  5c8e		       97		      .byte.b	151	;G
    483  5c8f		       00		      .byte.b	0	;B
    484  5c90		       f0		      .byte.b	240	;R (55)
    485  5c91		       3a		      .byte.b	58	;G
    486  5c92		       00		      .byte.b	0	;B
    487  5c93		       e0		      .byte.b	224	;R (54)
    488  5c94		       bb		      .byte.b	187	;G
    489  5c95		       04		      .byte.b	4	;B
    490  5c96		       e0		      .byte.b	224	;R (53)
    491  5c97		       3e		      .byte.b	62	;G
    492  5c98		       00		      .byte.b	0	;B
    493  5c99		       c0		      .byte.b	192	;R (52)
    494  5c9a		       2a		      .byte.b	42	;G
    495  5c9b		       00		      .byte.b	0	;B
    496  5c9c		       80		      .byte.b	128	;R (51)
    497  5c9d		       3f		      .byte.b	63	;G
    498  5c9e		       40		      .byte.b	64	;B
    499  5c9f		       f5		      .byte.b	245	;R (50)
    500  5ca0		       3f		      .byte.b	63	;G
    501  5ca1		       00		      .byte.b	0	;B
    502  5ca2		       e8		      .byte.b	232	;R (49)
    503  5ca3		       7f		      .byte.b	127	;G
    504  5ca4		       00		      .byte.b	0	;B
    505  5ca5		       e0		      .byte.b	224	;R (48)
    506  5ca6		       7a		      .byte.b	122	;G
    507  5ca7		       04		      .byte.b	4	;B
    508  5ca8		       c0		      .byte.b	192	;R (47)
    509  5ca9		       5f		      .byte.b	95	;G
    510  5caa		       00		      .byte.b	0	;B
    511  5cab		       90		      .byte.b	144	;R (46)
    512  5cac		       dd		      .byte.b	221	;G
    513  5cad		       02		      .byte.b	2	;B
    514  5cae		       84		      .byte.b	132	;R (45)
    515  5caf		       9f		      .byte.b	159	;G
    516  5cb0		       00		      .byte.b	0	;B
    517  5cb1		       c4		      .byte.b	196	;R (44)
    518  5cb2		       cf		      .byte.b	207	;G
    519  5cb3		       00		      .byte.b	0	;B
    520  5cb4		       c5		      .byte.b	197	;R (43)
    521  5cb5		       1f		      .byte.b	31	;G
    522  5cb6		       00		      .byte.b	0	;B
    523  5cb7		       d4		      .byte.b	212	;R (42)
    524  5cb8		       9f		      .byte.b	159	;G
    525  5cb9		       20		      .byte.b	32	;B
    526  5cba		       c8		      .byte.b	200	;R (41)
    527  5cbb		       1e		      .byte.b	30	;G
    528  5cbc		       01		      .byte.b	1	;B
    529  5cbd		       c8		      .byte.b	200	;R (40)
    530  5cbe		       5f		      .byte.b	95	;G
    531  5cbf		       00		      .byte.b	0	;B
    532  5cc0		       cd		      .byte.b	205	;R (39)
    533  5cc1		       5e		      .byte.b	94	;G
    534  5cc2		       00		      .byte.b	0	;B
    535  5cc3		       c7		      .byte.b	199	;R (38)
    536  5cc4		       5b		      .byte.b	91	;G
    537  5cc5		       00		      .byte.b	0	;B
    538  5cc6		       8b		      .byte.b	139	;R (37)
    539  5cc7		       1c		      .byte.b	28	;G
    540  5cc8		       00		      .byte.b	0	;B
    541  5cc9		       81		      .byte.b	129	;R (36)
    542  5cca		       9a		      .byte.b	154	;G
    543  5ccb		       04		      .byte.b	4	;B
    544  5ccc		       8e		      .byte.b	142	;R (35)
    545  5ccd		       9d		      .byte.b	157	;G
    546  5cce		       00		      .byte.b	0	;B
    547  5ccf		       2b		      .byte.b	43	;R (34)
    548  5cd0		       36		      .byte.b	54	;G
    549  5cd1		       00		      .byte.b	0	;B
    550  5cd2		       3a		      .byte.b	58	;R (33)
    551  5cd3		       0d		      .byte.b	13	;G
    552  5cd4		       00		      .byte.b	0	;B
    553  5cd5		       3e		      .byte.b	62	;R (32)
    554  5cd6		       85		      .byte.b	133	;G
    555  5cd7		       40		      .byte.b	64	;B
    556  5cd8		       fa		      .byte.b	250	;R (31)
    557  5cd9		       17		      .byte.b	23	;G
    558  5cda		       00		      .byte.b	0	;B
    559  5cdb		       ff		      .byte.b	255	;R (30)
    560  5cdc		       03		      .byte.b	3	;G
    561  5cdd		       00		      .byte.b	0	;B
    562  5cde		       fc		      .byte.b	252	;R (29)
    563  5cdf		       93		      .byte.b	147	;G
    564  5ce0		       00		      .byte.b	0	;B
    565  5ce1		       f7		      .byte.b	247	;R (28)
    566  5ce2		       81		      .byte.b	129	;G
    567  5ce3		       08		      .byte.b	8	;B
    568  5ce4		       ff		      .byte.b	255	;R (27)
    569  5ce5		       03		      .byte.b	3	;G
    570  5ce6		       00		      .byte.b	0	;B
    571  5ce7		       fe		      .byte.b	254	;R (26)
    572  5ce8		       2b		      .byte.b	43	;G
    573  5ce9		       00		      .byte.b	0	;B
    574  5cea		       fe		      .byte.b	254	;R (25)
    575  5ceb		       0a		      .byte.b	10	;G
    576  5cec		       00		      .byte.b	0	;B
    577  5ced		       fc		      .byte.b	252	;R (24)
    578  5cee		       4f		      .byte.b	79	;G
    579  5cef		       00		      .byte.b	0	;B
    580  5cf0		       fc		      .byte.b	252	;R (23)
    581  5cf1		       55		      .byte.b	85	;G
    582  5cf2		       00		      .byte.b	0	;B
    583  5cf3		       f8		      .byte.b	248	;R (22)
    584  5cf4		       45		      .byte.b	69	;G
    585  5cf5		       00		      .byte.b	0	;B
    586  5cf6		       e8		      .byte.b	232	;R (21)
    587  5cf7		       05		      .byte.b	5	;G
    588  5cf8		       10		      .byte.b	16	;B
    589  5cf9		       f8		      .byte.b	248	;R (20)
    590  5cfa		       5b		      .byte.b	91	;G
    591  5cfb		       00		      .byte.b	0	;B
    592  5cfc		       f8		      .byte.b	248	;R (19)
    593  5cfd		       1d		      .byte.b	29	;G
    594  5cfe		       00		      .byte.b	0	;B
    595  5cff		       f0		      .byte.b	240	;R (18)
    596  5d00		       55		      .byte.b	85	;G
    597  5d01		       00		      .byte.b	0	;B
    598  5d02		       f0		      .byte.b	240	;R (17)
    599  5d03		       16		      .byte.b	22	;G
    600  5d04		       00		      .byte.b	0	;B
    601  5d05		       f0		      .byte.b	240	;R (16)
    602  5d06		       b2		      .byte.b	178	;G
    603  5d07		       00		      .byte.b	0	;B
    604  5d08		       e0		      .byte.b	224	;R (15)
    605  5d09		       0e		      .byte.b	14	;G
    606  5d0a		       10		      .byte.b	16	;B
    607  5d0b		       f0		      .byte.b	240	;R (14)
    608  5d0c		       93		      .byte.b	147	;G
    609  5d0d		       00		      .byte.b	0	;B
    610  5d0e		       e0		      .byte.b	224	;R (13)
    611  5d0f		       25		      .byte.b	37	;G
    612  5d10		       00		      .byte.b	0	;B
    613  5d11		       c0		      .byte.b	192	;R (12)
    614  5d12		       e5		      .byte.b	229	;G
    615  5d13		       00		      .byte.b	0	;B
    616  5d14		       80		      .byte.b	128	;R (11)
    617  5d15		       0e		      .byte.b	14	;G
    618  5d16		       00		      .byte.b	0	;B
    619  5d17		       c0		      .byte.b	192	;R (10)
    620  5d18		       ca		      .byte.b	202	;G
    621  5d19		       00		      .byte.b	0	;B
    622  5d1a		       84		      .byte.b	132	;R (9)
    623  5d1b		       8e		      .byte.b	142	;G
    624  5d1c		       00		      .byte.b	0	;B
    625  5d1d		       00		      .byte.b	0	;R (8)
    626  5d1e		       8e		      .byte.b	142	;G
    627  5d1f		       00		      .byte.b	0	;B
    628  5d20		       00		      .byte.b	0	;R (7)
    629  5d21		       15		      .byte.b	21	;G
    630  5d22		       00		      .byte.b	0	;B
    631  5d23		       00		      .byte.b	0	;R (6)
    632  5d24		       14		      .byte.b	20	;G
    633  5d25		       00		      .byte.b	0	;B
    634  5d26		       00		      .byte.b	0	;R (5)
    635  5d27		       14		      .byte.b	20	;G
    636  5d28		       00		      .byte.b	0	;B
    637  5d29		       00		      .byte.b	0	;R (4)
    638  5d2a		       0a		      .byte.b	10	;G
    639  5d2b		       00		      .byte.b	0	;B
    640  5d2c		       00		      .byte.b	0	;R (3)
    641  5d2d		       10		      .byte.b	16	;G
    642  5d2e		       00		      .byte.b	0	;B
    643  5d2f		       08		      .byte.b	8	;R (2)
    644  5d30		       88		      .byte.b	136	;G
    645  5d31		       00		      .byte.b	0	;B
    646  5d32		       40		      .byte.b	64	;R (1)
    647  5d33		       42		      .byte.b	66	;G
    648  5d34		       00		      .byte.b	0	;B
    649  5d35		       00		      .byte.b	0	;R (0)
    650  5d36		       00		      .byte.b	0	;G
    651  5d37		       00		      .byte.b	0	;B
    652  5d38				   COL_3
    653  5d38		       90		      .byte.b	144	;R (71)
    654  5d39		       90		      .byte.b	144	;G
    655  5d3a		       00		      .byte.b	0	;B
    656  5d3b		       40		      .byte.b	64	;R (70)
    657  5d3c		       40		      .byte.b	64	;G
    658  5d3d		       00		      .byte.b	0	;B
    659  5d3e		       b0		      .byte.b	176	;R (69)
    660  5d3f		       b0		      .byte.b	176	;G
    661  5d40		       00		      .byte.b	0	;B
    662  5d41		       d0		      .byte.b	208	;R (68)
    663  5d42		       00		      .byte.b	0	;G
    664  5d43		       20		      .byte.b	32	;B
    665  5d44		       f0		      .byte.b	240	;R (67)
    666  5d45		       00		      .byte.b	0	;G
    667  5d46		       00		      .byte.b	0	;B
    668  5d47		       f0		      .byte.b	240	;R (66)
    669  5d48		       d0		      .byte.b	208	;G
    670  5d49		       00		      .byte.b	0	;B
    671  5d4a		       f0		      .byte.b	240	;R (65)
    672  5d4b		       00		      .byte.b	0	;G
    673  5d4c		       00		      .byte.b	0	;B
    674  5d4d		       f0		      .byte.b	240	;R (64)
    675  5d4e		       00		      .byte.b	0	;G
    676  5d4f		       00		      .byte.b	0	;B
    677  5d50		       f0		      .byte.b	240	;R (63)
    678  5d51		       50		      .byte.b	80	;G
    679  5d52		       00		      .byte.b	0	;B
    680  5d53		       f0		      .byte.b	240	;R (62)
    681  5d54		       00		      .byte.b	0	;G
    682  5d55		       00		      .byte.b	0	;B
    683  5d56		       f0		      .byte.b	240	;R (61)
    684  5d57		       a0		      .byte.b	160	;G
    685  5d58		       00		      .byte.b	0	;B
    686  5d59		       f0		      .byte.b	240	;R (60)
    687  5d5a		       00		      .byte.b	0	;G
    688  5d5b		       00		      .byte.b	0	;B
    689  5d5c		       f0		      .byte.b	240	;R (59)
    690  5d5d		       d0		      .byte.b	208	;G
    691  5d5e		       00		      .byte.b	0	;B
    692  5d5f		       f0		      .byte.b	240	;R (58)
    693  5d60		       c0		      .byte.b	192	;G
    694  5d61		       00		      .byte.b	0	;B
    695  5d62		       f0		      .byte.b	240	;R (57)
    696  5d63		       90		      .byte.b	144	;G
    697  5d64		       00		      .byte.b	0	;B
    698  5d65		       f0		      .byte.b	240	;R (56)
    699  5d66		       80		      .byte.b	128	;G
    700  5d67		       00		      .byte.b	0	;B
    701  5d68		       f0		      .byte.b	240	;R (55)
    702  5d69		       40		      .byte.b	64	;G
    703  5d6a		       00		      .byte.b	0	;B
    704  5d6b		       70		      .byte.b	112	;R (54)
    705  5d6c		       00		      .byte.b	0	;G
    706  5d6d		       80		      .byte.b	128	;B
    707  5d6e		       d0		      .byte.b	208	;R (53)
    708  5d6f		       00		      .byte.b	0	;G
    709  5d70		       20		      .byte.b	32	;B
    710  5d71		       f0		      .byte.b	240	;R (52)
    711  5d72		       80		      .byte.b	128	;G
    712  5d73		       00		      .byte.b	0	;B
    713  5d74		       f0		      .byte.b	240	;R (51)
    714  5d75		       00		      .byte.b	0	;G
    715  5d76		       00		      .byte.b	0	;B
    716  5d77		       f0		      .byte.b	240	;R (50)
    717  5d78		       a0		      .byte.b	160	;G
    718  5d79		       00		      .byte.b	0	;B
    719  5d7a		       f0		      .byte.b	240	;R (49)
    720  5d7b		       80		      .byte.b	128	;G
    721  5d7c		       00		      .byte.b	0	;B
    722  5d7d		       f0		      .byte.b	240	;R (48)
    723  5d7e		       40		      .byte.b	64	;G
    724  5d7f		       00		      .byte.b	0	;B
    725  5d80		       f0		      .byte.b	240	;R (47)
    726  5d81		       20		      .byte.b	32	;G
    727  5d82		       00		      .byte.b	0	;B
    728  5d83		       f0		      .byte.b	240	;R (46)
    729  5d84		       00		      .byte.b	0	;G
    730  5d85		       00		      .byte.b	0	;B
    731  5d86		       f0		      .byte.b	240	;R (45)
    732  5d87		       80		      .byte.b	128	;G
    733  5d88		       00		      .byte.b	0	;B
    734  5d89		       f0		      .byte.b	240	;R (44)
    735  5d8a		       00		      .byte.b	0	;G
    736  5d8b		       00		      .byte.b	0	;B
    737  5d8c		       f0		      .byte.b	240	;R (43)
    738  5d8d		       40		      .byte.b	64	;G
    739  5d8e		       00		      .byte.b	0	;B
    740  5d8f		       f0		      .byte.b	240	;R (42)
    741  5d90		       00		      .byte.b	0	;G
    742  5d91		       00		      .byte.b	0	;B
    743  5d92		       f0		      .byte.b	240	;R (41)
    744  5d93		       20		      .byte.b	32	;G
    745  5d94		       00		      .byte.b	0	;B
    746  5d95		       f0		      .byte.b	240	;R (40)
    747  5d96		       20		      .byte.b	32	;G
    748  5d97		       00		      .byte.b	0	;B
    749  5d98		       f0		      .byte.b	240	;R (39)
    750  5d99		       50		      .byte.b	80	;G
    751  5d9a		       00		      .byte.b	0	;B
    752  5d9b		       f0		      .byte.b	240	;R (38)
    753  5d9c		       10		      .byte.b	16	;G
    754  5d9d		       00		      .byte.b	0	;B
    755  5d9e		       70		      .byte.b	112	;R (37)
    756  5d9f		       80		      .byte.b	128	;G
    757  5da0		       80		      .byte.b	128	;B
    758  5da1		       f0		      .byte.b	240	;R (36)
    759  5da2		       50		      .byte.b	80	;G
    760  5da3		       00		      .byte.b	0	;B
    761  5da4		       f0		      .byte.b	240	;R (35)
    762  5da5		       00		      .byte.b	0	;G
    763  5da6		       00		      .byte.b	0	;B
    764  5da7		       f0		      .byte.b	240	;R (34)
    765  5da8		       40		      .byte.b	64	;G
    766  5da9		       00		      .byte.b	0	;B
    767  5daa		       f0		      .byte.b	240	;R (33)
    768  5dab		       10		      .byte.b	16	;G
    769  5dac		       00		      .byte.b	0	;B
    770  5dad		       f0		      .byte.b	240	;R (32)
    771  5dae		       b0		      .byte.b	176	;G
    772  5daf		       00		      .byte.b	0	;B
    773  5db0		       e0		      .byte.b	224	;R (31)
    774  5db1		       00		      .byte.b	0	;G
    775  5db2		       10		      .byte.b	16	;B
    776  5db3		       e0		      .byte.b	224	;R (30)
    777  5db4		       40		      .byte.b	64	;G
    778  5db5		       00		      .byte.b	0	;B
    779  5db6		       e0		      .byte.b	224	;R (29)
    780  5db7		       20		      .byte.b	32	;G
    781  5db8		       00		      .byte.b	0	;B
    782  5db9		       c0		      .byte.b	192	;R (28)
    783  5dba		       00		      .byte.b	0	;G
    784  5dbb		       00		      .byte.b	0	;B
    785  5dbc		       c0		      .byte.b	192	;R (27)
    786  5dbd		       10		      .byte.b	16	;G
    787  5dbe		       00		      .byte.b	0	;B
    788  5dbf		       c0		      .byte.b	192	;R (26)
    789  5dc0		       40		      .byte.b	64	;G
    790  5dc1		       10		      .byte.b	16	;B
    791  5dc2		       90		      .byte.b	144	;R (25)
    792  5dc3		       00		      .byte.b	0	;G
    793  5dc4		       00		      .byte.b	0	;B
    794  5dc5		       f0		      .byte.b	240	;R (24)
    795  5dc6		       60		      .byte.b	96	;G
    796  5dc7		       00		      .byte.b	0	;B
    797  5dc8		       f0		      .byte.b	240	;R (23)
    798  5dc9		       00		      .byte.b	0	;G
    799  5dca		       00		      .byte.b	0	;B
    800  5dcb		       f0		      .byte.b	240	;R (22)
    801  5dcc		       40		      .byte.b	64	;G
    802  5dcd		       00		      .byte.b	0	;B
    803  5dce		       f0		      .byte.b	240	;R (21)
    804  5dcf		       10		      .byte.b	16	;G
    805  5dd0		       00		      .byte.b	0	;B
    806  5dd1		       f0		      .byte.b	240	;R (20)
    807  5dd2		       00		      .byte.b	0	;G
    808  5dd3		       00		      .byte.b	0	;B
    809  5dd4		       f0		      .byte.b	240	;R (19)
    810  5dd5		       60		      .byte.b	96	;G
    811  5dd6		       00		      .byte.b	0	;B
    812  5dd7		       f0		      .byte.b	240	;R (18)
    813  5dd8		       20		      .byte.b	32	;G
    814  5dd9		       00		      .byte.b	0	;B
    815  5dda		       f0		      .byte.b	240	;R (17)
    816  5ddb		       50		      .byte.b	80	;G
    817  5ddc		       00		      .byte.b	0	;B
    818  5ddd		       f0		      .byte.b	240	;R (16)
    819  5dde		       40		      .byte.b	64	;G
    820  5ddf		       00		      .byte.b	0	;B
    821  5de0		       f0		      .byte.b	240	;R (15)
    822  5de1		       80		      .byte.b	128	;G
    823  5de2		       00		      .byte.b	0	;B
    824  5de3		       f0		      .byte.b	240	;R (14)
    825  5de4		       40		      .byte.b	64	;G
    826  5de5		       00		      .byte.b	0	;B
    827  5de6		       f0		      .byte.b	240	;R (13)
    828  5de7		       00		      .byte.b	0	;G
    829  5de8		       00		      .byte.b	0	;B
    830  5de9		       f0		      .byte.b	240	;R (12)
    831  5dea		       10		      .byte.b	16	;G
    832  5deb		       00		      .byte.b	0	;B
    833  5dec		       f0		      .byte.b	240	;R (11)
    834  5ded		       50		      .byte.b	80	;G
    835  5dee		       00		      .byte.b	0	;B
    836  5def		       f0		      .byte.b	240	;R (10)
    837  5df0		       00		      .byte.b	0	;G
    838  5df1		       00		      .byte.b	0	;B
    839  5df2		       f0		      .byte.b	240	;R (9)
    840  5df3		       b0		      .byte.b	176	;G
    841  5df4		       00		      .byte.b	0	;B
    842  5df5		       f0		      .byte.b	240	;R (8)
    843  5df6		       90		      .byte.b	144	;G
    844  5df7		       00		      .byte.b	0	;B
    845  5df8		       e0		      .byte.b	224	;R (7)
    846  5df9		       e0		      .byte.b	224	;G
    847  5dfa		       00		      .byte.b	0	;B
    848  5dfb		       f0		      .byte.b	240	;R (6)
    849  5dfc		       d0		      .byte.b	208	;G
    850  5dfd		       00		      .byte.b	0	;B
    851  5dfe		       60		      .byte.b	96	;R (5)
    852  5dff		       00		      .byte.b	0	;G
    853  5e00		       00		      .byte.b	0	;B
    854  5e01		       60		      .byte.b	96	;R (4)
    855  5e02		       40		      .byte.b	64	;G
    856  5e03		       00		      .byte.b	0	;B
    857  5e04		       40		      .byte.b	64	;R (3)
    858  5e05		       50		      .byte.b	80	;G
    859  5e06		       00		      .byte.b	0	;B
    860  5e07		       00		      .byte.b	0	;R (2)
    861  5e08		       00		      .byte.b	0	;G
    862  5e09		       00		      .byte.b	0	;B
    863  5e0a		       00		      .byte.b	0	;R (1)
    864  5e0b		       80		      .byte.b	128	;G
    865  5e0c		       00		      .byte.b	0	;B
    866  5e0d		       00		      .byte.b	0	;R (0)
    867  5e0e		       00		      .byte.b	0	;G
    868  5e0f		       00		      .byte.b	0	;B
    869  5e10				   COL_4
    870  5e10		       25		      .byte.b	37	;R (71)
    871  5e11		       25		      .byte.b	37	;G
    872  5e12		       00		      .byte.b	0	;B
    873  5e13		       48		      .byte.b	72	;R (70)
    874  5e14		       48		      .byte.b	72	;G
    875  5e15		       00		      .byte.b	0	;B
    876  5e16		       25		      .byte.b	37	;R (69)
    877  5e17		       25		      .byte.b	37	;G
    878  5e18		       88		      .byte.b	136	;B
    879  5e19		       ff		      .byte.b	255	;R (68)
    880  5e1a		       00		      .byte.b	0	;G
    881  5e1b		       00		      .byte.b	0	;B
    882  5e1c		       ff		      .byte.b	255	;R (67)
    883  5e1d		       04		      .byte.b	4	;G
    884  5e1e		       00		      .byte.b	0	;B
    885  5e1f		       ef		      .byte.b	239	;R (66)
    886  5e20		       40		      .byte.b	64	;G
    887  5e21		       10		      .byte.b	16	;B
    888  5e22		       ff		      .byte.b	255	;R (65)
    889  5e23		       00		      .byte.b	0	;G
    890  5e24		       00		      .byte.b	0	;B
    891  5e25		       ff		      .byte.b	255	;R (64)
    892  5e26		       02		      .byte.b	2	;G
    893  5e27		       00		      .byte.b	0	;B
    894  5e28		       ff		      .byte.b	255	;R (63)
    895  5e29		       20		      .byte.b	32	;G
    896  5e2a		       00		      .byte.b	0	;B
    897  5e2b		       ff		      .byte.b	255	;R (62)
    898  5e2c		       a5		      .byte.b	165	;G
    899  5e2d		       00		      .byte.b	0	;B
    900  5e2e		       ff		      .byte.b	255	;R (61)
    901  5e2f		       09		      .byte.b	9	;G
    902  5e30		       00		      .byte.b	0	;B
    903  5e31		       ff		      .byte.b	255	;R (60)
    904  5e32		       00		      .byte.b	0	;G
    905  5e33		       00		      .byte.b	0	;B
    906  5e34		       7f		      .byte.b	127	;R (59)
    907  5e35		       42		      .byte.b	66	;G
    908  5e36		       80		      .byte.b	128	;B
    909  5e37		       ff		      .byte.b	255	;R (58)
    910  5e38		       88		      .byte.b	136	;G
    911  5e39		       00		      .byte.b	0	;B
    912  5e3a		       ff		      .byte.b	255	;R (57)
    913  5e3b		       40		      .byte.b	64	;G
    914  5e3c		       00		      .byte.b	0	;B
    915  5e3d		       ff		      .byte.b	255	;R (56)
    916  5e3e		       09		      .byte.b	9	;G
    917  5e3f		       00		      .byte.b	0	;B
    918  5e40		       7f		      .byte.b	127	;R (55)
    919  5e41		       01		      .byte.b	1	;G
    920  5e42		       80		      .byte.b	128	;B
    921  5e43		       ff		      .byte.b	255	;R (54)
    922  5e44		       91		      .byte.b	145	;G
    923  5e45		       00		      .byte.b	0	;B
    924  5e46		       fe		      .byte.b	254	;R (53)
    925  5e47		       81		      .byte.b	129	;G
    926  5e48		       00		      .byte.b	0	;B
    927  5e49		       fe		      .byte.b	254	;R (52)
    928  5e4a		       20		      .byte.b	32	;G
    929  5e4b		       00		      .byte.b	0	;B
    930  5e4c		       ff		      .byte.b	255	;R (51)
    931  5e4d		       03		      .byte.b	3	;G
    932  5e4e		       00		      .byte.b	0	;B
    933  5e4f		       ff		      .byte.b	255	;R (50)
    934  5e50		       83		      .byte.b	131	;G
    935  5e51		       00		      .byte.b	0	;B
    936  5e52		       fe		      .byte.b	254	;R (49)
    937  5e53		       90		      .byte.b	144	;G
    938  5e54		       00		      .byte.b	0	;B
    939  5e55		       fe		      .byte.b	254	;R (48)
    940  5e56		       83		      .byte.b	131	;G
    941  5e57		       00		      .byte.b	0	;B
    942  5e58		       7e		      .byte.b	126	;R (47)
    943  5e59		       12		      .byte.b	18	;G
    944  5e5a		       80		      .byte.b	128	;B
    945  5e5b		       fc		      .byte.b	252	;R (46)
    946  5e5c		       00		      .byte.b	0	;G
    947  5e5d		       00		      .byte.b	0	;B
    948  5e5e		       fe		      .byte.b	254	;R (45)
    949  5e5f		       07		      .byte.b	7	;G
    950  5e60		       00		      .byte.b	0	;B
    951  5e61		       ef		      .byte.b	239	;R (44)
    952  5e62		       03		      .byte.b	3	;G
    953  5e63		       10		      .byte.b	16	;B
    954  5e64		       ff		      .byte.b	255	;R (43)
    955  5e65		       40		      .byte.b	64	;G
    956  5e66		       00		      .byte.b	0	;B
    957  5e67		       ff		      .byte.b	255	;R (42)
    958  5e68		       01		      .byte.b	1	;G
    959  5e69		       00		      .byte.b	0	;B
    960  5e6a		       ff		      .byte.b	255	;R (41)
    961  5e6b		       01		      .byte.b	1	;G
    962  5e6c		       00		      .byte.b	0	;B
    963  5e6d		       bf		      .byte.b	191	;R (40)
    964  5e6e		       01		      .byte.b	1	;G
    965  5e6f		       40		      .byte.b	64	;B
    966  5e70		       f7		      .byte.b	247	;R (39)
    967  5e71		       80		      .byte.b	128	;G
    968  5e72		       08		      .byte.b	8	;B
    969  5e73		       ff		      .byte.b	255	;R (38)
    970  5e74		       40		      .byte.b	64	;G
    971  5e75		       00		      .byte.b	0	;B
    972  5e76		       ff		      .byte.b	255	;R (37)
    973  5e77		       00		      .byte.b	0	;G
    974  5e78		       00		      .byte.b	0	;B
    975  5e79		       ff		      .byte.b	255	;R (36)
    976  5e7a		       40		      .byte.b	64	;G
    977  5e7b		       00		      .byte.b	0	;B
    978  5e7c		       ff		      .byte.b	255	;R (35)
    979  5e7d		       a1		      .byte.b	161	;G
    980  5e7e		       00		      .byte.b	0	;B
    981  5e7f		       7f		      .byte.b	127	;R (34)
    982  5e80		       05		      .byte.b	5	;G
    983  5e81		       80		      .byte.b	128	;B
    984  5e82		       ff		      .byte.b	255	;R (33)
    985  5e83		       21		      .byte.b	33	;G
    986  5e84		       00		      .byte.b	0	;B
    987  5e85		       bf		      .byte.b	191	;R (32)
    988  5e86		       40		      .byte.b	64	;G
    989  5e87		       40		      .byte.b	64	;B
    990  5e88		       ff		      .byte.b	255	;R (31)
    991  5e89		       61		      .byte.b	97	;G
    992  5e8a		       00		      .byte.b	0	;B
    993  5e8b		       7f		      .byte.b	127	;R (30)
    994  5e8c		       81		      .byte.b	129	;G
    995  5e8d		       80		      .byte.b	128	;B
    996  5e8e		       f7		      .byte.b	247	;R (29)
    997  5e8f		       60		      .byte.b	96	;G
    998  5e90		       08		      .byte.b	8	;B
    999  5e91		       ff		      .byte.b	255	;R (28)
   1000  5e92		       81		      .byte.b	129	;G
   1001  5e93		       00		      .byte.b	0	;B
   1002  5e94		       ef		      .byte.b	239	;R (27)
   1003  5e95		       40		      .byte.b	64	;G
   1004  5e96		       10		      .byte.b	16	;B
   1005  5e97		       ff		      .byte.b	255	;R (26)
   1006  5e98		       60		      .byte.b	96	;G
   1007  5e99		       00		      .byte.b	0	;B
   1008  5e9a		       ff		      .byte.b	255	;R (25)
   1009  5e9b		       18		      .byte.b	24	;G
   1010  5e9c		       00		      .byte.b	0	;B
   1011  5e9d		       ff		      .byte.b	255	;R (24)
   1012  5e9e		       20		      .byte.b	32	;G
   1013  5e9f		       00		      .byte.b	0	;B
   1014  5ea0		       ff		      .byte.b	255	;R (23)
   1015  5ea1		       8a		      .byte.b	138	;G
   1016  5ea2		       00		      .byte.b	0	;B
   1017  5ea3		       f7		      .byte.b	247	;R (22)
   1018  5ea4		       10		      .byte.b	16	;G
   1019  5ea5		       08		      .byte.b	8	;B
   1020  5ea6		       ff		      .byte.b	255	;R (21)
   1021  5ea7		       04		      .byte.b	4	;G
   1022  5ea8		       00		      .byte.b	0	;B
   1023  5ea9		       df		      .byte.b	223	;R (20)
   1024  5eaa		       10		      .byte.b	16	;G
   1025  5eab		       20		      .byte.b	32	;B
   1026  5eac		       ff		      .byte.b	255	;R (19)
   1027  5ead		       90		      .byte.b	144	;G
   1028  5eae		       00		      .byte.b	0	;B
   1029  5eaf		       ff		      .byte.b	255	;R (18)
   1030  5eb0		       12		      .byte.b	18	;G
   1031  5eb1		       00		      .byte.b	0	;B
   1032  5eb2		       ff		      .byte.b	255	;R (17)
   1033  5eb3		       00		      .byte.b	0	;G
   1034  5eb4		       00		      .byte.b	0	;B
   1035  5eb5		       ff		      .byte.b	255	;R (16)
   1036  5eb6		       45		      .byte.b	69	;G
   1037  5eb7		       00		      .byte.b	0	;B
   1038  5eb8		       ff		      .byte.b	255	;R (15)
   1039  5eb9		       10		      .byte.b	16	;G
   1040  5eba		       00		      .byte.b	0	;B
   1041  5ebb		       ff		      .byte.b	255	;R (14)
   1042  5ebc		       23		      .byte.b	35	;G
   1043  5ebd		       00		      .byte.b	0	;B
   1044  5ebe		       fc		      .byte.b	252	;R (13)
   1045  5ebf		       12		      .byte.b	18	;G
   1046  5ec0		       00		      .byte.b	0	;B
   1047  5ec1		       fc		      .byte.b	252	;R (12)
   1048  5ec2		       20		      .byte.b	32	;G
   1049  5ec3		       00		      .byte.b	0	;B
   1050  5ec4		       fe		      .byte.b	254	;R (11)
   1051  5ec5		       46		      .byte.b	70	;G
   1052  5ec6		       00		      .byte.b	0	;B
   1053  5ec7		       f8		      .byte.b	248	;R (10)
   1054  5ec8		       48		      .byte.b	72	;G
   1055  5ec9		       00		      .byte.b	0	;B
   1056  5eca		       f0		      .byte.b	240	;R (9)
   1057  5ecb		       04		      .byte.b	4	;G
   1058  5ecc		       00		      .byte.b	0	;B
   1059  5ecd		       e0		      .byte.b	224	;R (8)
   1060  5ece		       20		      .byte.b	32	;G
   1061  5ecf		       00		      .byte.b	0	;B
   1062  5ed0		       e0		      .byte.b	224	;R (7)
   1063  5ed1		       29		      .byte.b	41	;G
   1064  5ed2		       00		      .byte.b	0	;B
   1065  5ed3		       e0		      .byte.b	224	;R (6)
   1066  5ed4		       20		      .byte.b	32	;G
   1067  5ed5		       00		      .byte.b	0	;B
   1068  5ed6		       e0		      .byte.b	224	;R (5)
   1069  5ed7		       84		      .byte.b	132	;G
   1070  5ed8		       00		      .byte.b	0	;B
   1071  5ed9		       60		      .byte.b	96	;R (4)
   1072  5eda		       40		      .byte.b	64	;G
   1073  5edb		       00		      .byte.b	0	;B
   1074  5edc		       00		      .byte.b	0	;R (3)
   1075  5edd		       88		      .byte.b	136	;G
   1076  5ede		       00		      .byte.b	0	;B
   1077  5edf		       00		      .byte.b	0	;R (2)
   1078  5ee0		       11		      .byte.b	17	;G
   1079  5ee1		       00		      .byte.b	0	;B
   1080  5ee2		       24		      .byte.b	36	;R (1)
   1081  5ee3		       24		      .byte.b	36	;G
   1082  5ee4		       00		      .byte.b	0	;B
   1083  5ee5		       00		      .byte.b	0	;R (0)
   1084  5ee6		       00		      .byte.b	0	;G
   1085  5ee7		       00		      .byte.b	0	;B
   1086  5ee8				   COL_5
   1087  5ee8		       02		      .byte.b	2	;R (71)
   1088  5ee9		       12		      .byte.b	18	;G
   1089  5eea		       00		      .byte.b	0	;B
   1090  5eeb		       00		      .byte.b	0	;R (70)
   1091  5eec		       00		      .byte.b	0	;G
   1092  5eed		       00		      .byte.b	0	;B
   1093  5eee		       00		      .byte.b	0	;R (69)
   1094  5eef		       02		      .byte.b	2	;G
   1095  5ef0		       00		      .byte.b	0	;B
   1096  5ef1		       03		      .byte.b	3	;R (68)
   1097  5ef2		       12		      .byte.b	18	;G
   1098  5ef3		       00		      .byte.b	0	;B
   1099  5ef4		       0b		      .byte.b	11	;R (67)
   1100  5ef5		       09		      .byte.b	9	;G
   1101  5ef6		       00		      .byte.b	0	;B
   1102  5ef7		       07		      .byte.b	7	;R (66)
   1103  5ef8		       05		      .byte.b	5	;G
   1104  5ef9		       00		      .byte.b	0	;B
   1105  5efa		       03		      .byte.b	3	;R (65)
   1106  5efb		       06		      .byte.b	6	;G
   1107  5efc		       00		      .byte.b	0	;B
   1108  5efd		       01		      .byte.b	1	;R (64)
   1109  5efe		       20		      .byte.b	32	;G
   1110  5eff		       00		      .byte.b	0	;B
   1111  5f00		       03		      .byte.b	3	;R (63)
   1112  5f01		       03		      .byte.b	3	;G
   1113  5f02		       00		      .byte.b	0	;B
   1114  5f03		       03		      .byte.b	3	;R (62)
   1115  5f04		       0a		      .byte.b	10	;G
   1116  5f05		       00		      .byte.b	0	;B
   1117  5f06		       03		      .byte.b	3	;R (61)
   1118  5f07		       02		      .byte.b	2	;G
   1119  5f08		       00		      .byte.b	0	;B
   1120  5f09		       03		      .byte.b	3	;R (60)
   1121  5f0a		       00		      .byte.b	0	;G
   1122  5f0b		       00		      .byte.b	0	;B
   1123  5f0c		       03		      .byte.b	3	;R (59)
   1124  5f0d		       0a		      .byte.b	10	;G
   1125  5f0e		       00		      .byte.b	0	;B
   1126  5f0f		       03		      .byte.b	3	;R (58)
   1127  5f10		       02		      .byte.b	2	;G
   1128  5f11		       00		      .byte.b	0	;B
   1129  5f12		       01		      .byte.b	1	;R (57)
   1130  5f13		       03		      .byte.b	3	;G
   1131  5f14		       00		      .byte.b	0	;B
   1132  5f15		       01		      .byte.b	1	;R (56)
   1133  5f16		       01		      .byte.b	1	;G
   1134  5f17		       00		      .byte.b	0	;B
   1135  5f18		       00		      .byte.b	0	;R (55)
   1136  5f19		       25		      .byte.b	37	;G
   1137  5f1a		       00		      .byte.b	0	;B
   1138  5f1b		       00		      .byte.b	0	;R (54)
   1139  5f1c		       00		      .byte.b	0	;G
   1140  5f1d		       00		      .byte.b	0	;B
   1141  5f1e		       00		      .byte.b	0	;R (53)
   1142  5f1f		       20		      .byte.b	32	;G
   1143  5f20		       00		      .byte.b	0	;B
   1144  5f21		       00		      .byte.b	0	;R (52)
   1145  5f22		       08		      .byte.b	8	;G
   1146  5f23		       00		      .byte.b	0	;B
   1147  5f24		       00		      .byte.b	0	;R (51)
   1148  5f25		       02		      .byte.b	2	;G
   1149  5f26		       00		      .byte.b	0	;B
   1150  5f27		       00		      .byte.b	0	;R (50)
   1151  5f28		       40		      .byte.b	64	;G
   1152  5f29		       00		      .byte.b	0	;B
   1153  5f2a		       00		      .byte.b	0	;R (49)
   1154  5f2b		       11		      .byte.b	17	;G
   1155  5f2c		       00		      .byte.b	0	;B
   1156  5f2d		       00		      .byte.b	0	;R (48)
   1157  5f2e		       00		      .byte.b	0	;G
   1158  5f2f		       00		      .byte.b	0	;B
   1159  5f30		       00		      .byte.b	0	;R (47)
   1160  5f31		       20		      .byte.b	32	;G
   1161  5f32		       00		      .byte.b	0	;B
   1162  5f33		       00		      .byte.b	0	;R (46)
   1163  5f34		       08		      .byte.b	8	;G
   1164  5f35		       00		      .byte.b	0	;B
   1165  5f36		       00		      .byte.b	0	;R (45)
   1166  5f37		       00		      .byte.b	0	;G
   1167  5f38		       00		      .byte.b	0	;B
   1168  5f39		       00		      .byte.b	0	;R (44)
   1169  5f3a		       24		      .byte.b	36	;G
   1170  5f3b		       00		      .byte.b	0	;B
   1171  5f3c		       00		      .byte.b	0	;R (43)
   1172  5f3d		       00		      .byte.b	0	;G
   1173  5f3e		       00		      .byte.b	0	;B
   1174  5f3f		       00		      .byte.b	0	;R (42)
   1175  5f40		       04		      .byte.b	4	;G
   1176  5f41		       00		      .byte.b	0	;B
   1177  5f42		       00		      .byte.b	0	;R (41)
   1178  5f43		       21		      .byte.b	33	;G
   1179  5f44		       00		      .byte.b	0	;B
   1180  5f45		       01		      .byte.b	1	;R (40)
   1181  5f46		       01		      .byte.b	1	;G
   1182  5f47		       00		      .byte.b	0	;B
   1183  5f48		       01		      .byte.b	1	;R (39)
   1184  5f49		       25		      .byte.b	37	;G
   1185  5f4a		       00		      .byte.b	0	;B
   1186  5f4b		       01		      .byte.b	1	;R (38)
   1187  5f4c		       01		      .byte.b	1	;G
   1188  5f4d		       00		      .byte.b	0	;B
   1189  5f4e		       03		      .byte.b	3	;R (37)
   1190  5f4f		       23		      .byte.b	35	;G
   1191  5f50		       00		      .byte.b	0	;B
   1192  5f51		       03		      .byte.b	3	;R (36)
   1193  5f52		       13		      .byte.b	19	;G
   1194  5f53		       00		      .byte.b	0	;B
   1195  5f54		       01		      .byte.b	1	;R (35)
   1196  5f55		       02		      .byte.b	2	;G
   1197  5f56		       00		      .byte.b	0	;B
   1198  5f57		       01		      .byte.b	1	;R (34)
   1199  5f58		       10		      .byte.b	16	;G
   1200  5f59		       00		      .byte.b	0	;B
   1201  5f5a		       03		      .byte.b	3	;R (33)
   1202  5f5b		       02		      .byte.b	2	;G
   1203  5f5c		       00		      .byte.b	0	;B
   1204  5f5d		       01		      .byte.b	1	;R (32)
   1205  5f5e		       08		      .byte.b	8	;G
   1206  5f5f		       00		      .byte.b	0	;B
   1207  5f60		       03		      .byte.b	3	;R (31)
   1208  5f61		       20		      .byte.b	32	;G
   1209  5f62		       00		      .byte.b	0	;B
   1210  5f63		       03		      .byte.b	3	;R (30)
   1211  5f64		       00		      .byte.b	0	;G
   1212  5f65		       00		      .byte.b	0	;B
   1213  5f66		       03		      .byte.b	3	;R (29)
   1214  5f67		       10		      .byte.b	16	;G
   1215  5f68		       00		      .byte.b	0	;B
   1216  5f69		       03		      .byte.b	3	;R (28)
   1217  5f6a		       00		      .byte.b	0	;G
   1218  5f6b		       00		      .byte.b	0	;B
   1219  5f6c		       07		      .byte.b	7	;R (27)
   1220  5f6d		       0e		      .byte.b	14	;G
   1221  5f6e		       00		      .byte.b	0	;B
   1222  5f6f		       03		      .byte.b	3	;R (26)
   1223  5f70		       41		      .byte.b	65	;G
   1224  5f71		       00		      .byte.b	0	;B
   1225  5f72		       07		      .byte.b	7	;R (25)
   1226  5f73		       04		      .byte.b	4	;G
   1227  5f74		       00		      .byte.b	0	;B
   1228  5f75		       03		      .byte.b	3	;R (24)
   1229  5f76		       21		      .byte.b	33	;G
   1230  5f77		       00		      .byte.b	0	;B
   1231  5f78		       03		      .byte.b	3	;R (23)
   1232  5f79		       04		      .byte.b	4	;G
   1233  5f7a		       00		      .byte.b	0	;B
   1234  5f7b		       03		      .byte.b	3	;R (22)
   1235  5f7c		       02		      .byte.b	2	;G
   1236  5f7d		       00		      .byte.b	0	;B
   1237  5f7e		       03		      .byte.b	3	;R (21)
   1238  5f7f		       26		      .byte.b	38	;G
   1239  5f80		       00		      .byte.b	0	;B
   1240  5f81		       01		      .byte.b	1	;R (20)
   1241  5f82		       01		      .byte.b	1	;G
   1242  5f83		       00		      .byte.b	0	;B
   1243  5f84		       00		      .byte.b	0	;R (19)
   1244  5f85		       21		      .byte.b	33	;G
   1245  5f86		       00		      .byte.b	0	;B
   1246  5f87		       01		      .byte.b	1	;R (18)
   1247  5f88		       09		      .byte.b	9	;G
   1248  5f89		       00		      .byte.b	0	;B
   1249  5f8a		       23		      .byte.b	35	;R (17)
   1250  5f8b		       22		      .byte.b	34	;G
   1251  5f8c		       00		      .byte.b	0	;B
   1252  5f8d		       01		      .byte.b	1	;R (16)
   1253  5f8e		       01		      .byte.b	1	;G
   1254  5f8f		       00		      .byte.b	0	;B
   1255  5f90		       00		      .byte.b	0	;R (15)
   1256  5f91		       29		      .byte.b	41	;G
   1257  5f92		       00		      .byte.b	0	;B
   1258  5f93		       00		      .byte.b	0	;R (14)
   1259  5f94		       00		      .byte.b	0	;G
   1260  5f95		       00		      .byte.b	0	;B
   1261  5f96		       00		      .byte.b	0	;R (13)
   1262  5f97		       04		      .byte.b	4	;G
   1263  5f98		       00		      .byte.b	0	;B
   1264  5f99		       00		      .byte.b	0	;R (12)
   1265  5f9a		       20		      .byte.b	32	;G
   1266  5f9b		       00		      .byte.b	0	;B
   1267  5f9c		       10		      .byte.b	16	;R (11)
   1268  5f9d		       12		      .byte.b	18	;G
   1269  5f9e		       00		      .byte.b	0	;B
   1270  5f9f		       00		      .byte.b	0	;R (10)
   1271  5fa0		       00		      .byte.b	0	;G
   1272  5fa1		       00		      .byte.b	0	;B
   1273  5fa2		       00		      .byte.b	0	;R (9)
   1274  5fa3		       21		      .byte.b	33	;G
   1275  5fa4		       00		      .byte.b	0	;B
   1276  5fa5		       00		      .byte.b	0	;R (8)
   1277  5fa6		       08		      .byte.b	8	;G
   1278  5fa7		       00		      .byte.b	0	;B
   1279  5fa8		       00		      .byte.b	0	;R (7)
   1280  5fa9		       20		      .byte.b	32	;G
   1281  5faa		       00		      .byte.b	0	;B
   1282  5fab		       00		      .byte.b	0	;R (6)
   1283  5fac		       04		      .byte.b	4	;G
   1284  5fad		       00		      .byte.b	0	;B
   1285  5fae		       20		      .byte.b	32	;R (5)
   1286  5faf		       20		      .byte.b	32	;G
   1287  5fb0		       00		      .byte.b	0	;B
   1288  5fb1		       00		      .byte.b	0	;R (4)
   1289  5fb2		       09		      .byte.b	9	;G
   1290  5fb3		       00		      .byte.b	0	;B
   1291  5fb4		       00		      .byte.b	0	;R (3)
   1292  5fb5		       00		      .byte.b	0	;G
   1293  5fb6		       00		      .byte.b	0	;B
   1294  5fb7		       00		      .byte.b	0	;R (2)
   1295  5fb8		       48		      .byte.b	72	;G
   1296  5fb9		       00		      .byte.b	0	;B
   1297  5fba		       02		      .byte.b	2	;R (1)
   1298  5fbb		       02		      .byte.b	2	;G
   1299  5fbc		       00		      .byte.b	0	;B
   1300  5fbd		       00		      .byte.b	0	;R (0)
   1301  5fbe		       00		      .byte.b	0	;G
   1302  5fbf		       00		      .byte.b	0	;B
------- FILE titleScreen.asm
    265  5fc0							;    include "pizza.asm"
    266  5fc0
      0  5fc0					      CHECK_BANK_SIZE	"TITLESCREEN"
      1  5fc0		       07 c0	   .TEMP      =	* - BANK_START
 TITLESCREEN (2K) SIZE =  $7c0 , FREE= $40
      2  5fc0					      ECHO	"TITLESCREEN", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  5fc0				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  5fc0				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  5fc0				  -	      ERR
      6  5fc0					      endif
------- FILE ./chess.asm
------- FILE BANK_RECON.asm LEVEL 2 PASS 2
      0  5fc0					      include	"BANK_RECON.asm"
      0  5fc0					      NEWBANK	RECON
      1  60e2 ????				      SEG	RECON
      2  6000					      ORG	ORIGIN
      3  6000					      RORG	$F000
      4  6000				   BANK_START SET	*
      5  6000				   RECON      SET	ORIGIN / 2048
      6  6000				   ORIGIN     SET	ORIGIN + 2048
      7  6000				   _CURRENT_BANK SET	RECON
      2  6000
      3  6000							;---------------------------------------------------------------------------------------------------
      4  6000
      0  6000					      DEF	UNSAFE_showMoveCaptures
      1  6000				   BANK_UNSAFE_showMoveCaptures SET	_CURRENT_BANK
      2  6000				   UNSAFE_showMoveCaptures
      3  6000				   TEMPORARY_VAR SET	Overlay
      4  6000				   TEMPORARY_OFFSET SET	0
      5  6000					      SUBROUTINE
      6  6000					      SUBROUTINE
      7  6000
      0  6000					      VAR	__x, 1
      1  6000				   __x	      SET	TEMPORARY_VAR
      2  6000				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  6000
      4  6000				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  6000				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  6000				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  6000					      ENDIF
      8  6000				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  6000				  -	      ECHO	"Temporary Variable", __x, "overflow!"
     10  6000				  -	      ERR
     11  6000					      ENDIF
     12  6000					      LIST	ON
      0  6000					      VAR	__fromSquare, 1
      1  6000				   __fromSquare SET	TEMPORARY_VAR
      2  6000				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  6000
      4  6000				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  6000				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  6000				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  6000					      ENDIF
      8  6000				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  6000				  -	      ECHO	"Temporary Variable", __fromSquare, "overflow!"
     10  6000				  -	      ERR
     11  6000					      ENDIF
     12  6000					      LIST	ON
      0  6000					      VAR	__toSquare, 1
      1  6000				   __toSquare SET	TEMPORARY_VAR
      2  6000				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  6000
      4  6000				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  6000				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  6000				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  6000					      ENDIF
      8  6000				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  6000				  -	      ECHO	"Temporary Variable", __toSquare, "overflow!"
     10  6000				  -	      ERR
     11  6000					      ENDIF
     12  6000					      LIST	ON
     11  6000
     12  6000							; place a marker on the board for any square matching the piece
     13  6000							; EXCEPT for squares which are occupied (we'll flash those later)
     14  6000							; x = movelist item # being checked
     15  6000
     16  6000		       a5 8b		      lda	savedBank
     17  6002		       48		      pha
     18  6003
     19  6003		       a9 0c		      lda	#BANK_UNSAFE_showMoveCaptures
     20  6005		       85 8b		      sta	savedBank
     21  6007
     22  6007
     23  6007		       a6 92	   .next      ldx	aiMoveIndex
     24  6009		       30 2d		      bmi	.skip	; no moves in list
     25  600b
     26  600b		       c6 92		      dec	aiMoveIndex
     27  600d
     28  600d		       20 d3 fe 	      jsr	GetMoveFrom
     29  6010		       c5 90		      cmp	aiFromSquareX12
     30  6012		       d0 f3		      bne	.next
     31  6014		       85 a6		      sta	__fromSquare
     32  6016
     33  6016		       20 df fe 	      jsr	GetMoveTo
     34  6019		       85 a7		      sta	__toSquare
     35  601b
     36  601b		       a8		      tay
     37  601c		       20 4f fd 	      jsr	GetBoard
     38  601f		       29 0f		      and	#PIECE_MASK
     39  6021		       f0 e4		      beq	.next
     40  6023		       c9 03		      cmp	#BP+1
     41  6025		       b0 00		      bcs	.legit
     42  6027
     43  6027							; if the "moveto" square appears more than once... urk
     44  6027							; then we skip the next three moves (assuming they're promotions)
     45  6027
     46  6027				  -	      if	0
     47  6027				  -.sk	      dex
     48  6027				  -	      bmi	.legit
     49  6027				  -
     50  6027				  -	      jsr	GetMoveTo
     51  6027				  -	      cmp	__toSquare
     52  6027				  -	      bne	.legit
     53  6027				  -
     54  6027				  -	      dec	aiMoveIndex
     55  6027				  -	      dec	aiMoveIndex
     56  6027				  -	      dec	aiMoveIndex
     57  6027					      endif
     58  6027
     59  6027				   .legit
     60  6027
      0  6027					      TIMECHECK	COPYSINGLEPIECE, skip000
      1  6027		       ad 84 02 	      lda	INTIM
      2  602a		       c9 22		      cmp	#SPEEDOF_COPYSINGLEPIECE
      3  602c		       90 0a		      bcc	skip000
     62  602e
     63  602e		       a4 a7		      ldy	__toSquare
     64  6030		       b9 3c f0 	      lda	X12B64_00,y	; convert from X12 numbering to B64
     65  6033		       85 80		      sta	drawPieceNumber
     66  6035
     67  6035		       20 ea fd 	      jsr	SAFE_CopySinglePiece
     68  6038
     69  6038				   .skip
     70  6038				   skip000
     71  6038		       68		      pla
     72  6039		       85 8b		      sta	savedBank
     73  603b
     74  603b		       60		      rts
     75  603c
     76  603c
     77  603c							; Use a local copy of the conversion table as it saves fixed bank bytes
      0  603c					      ALLOCATE	X12B64_00, 100
      0  603c					      OPTIONAL_PAGEBREAK	"Table", 100
     10  603c					      LIST	ON
      0  603c					      DEF	X12B64_00
      1  603c				   BANK_X12B64_00 SET	_CURRENT_BANK
      2  603c				   X12B64_00
      3  603c				   TEMPORARY_VAR SET	Overlay
      4  603c				   TEMPORARY_OFFSET SET	0
      5  603c					      SUBROUTINE
      0  603c					      X12B64TABLE
      1  603c
      2  603c
      3  603c
      4  603c
      5  603c
      6  603c		       ff ff ff ff*	      .byte.b	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1
      7  6046		       ff ff ff ff*	      .byte.b	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1
      8  6050		       ff ff 00 01*	      .byte.b	-1, -1, 0, 1, 2, 3, 4, 5, 6, 7
      9  605a		       ff ff 08 09*	      .byte.b	-1, -1, 8, 9, 10, 11, 12, 13, 14, 15
     10  6064		       ff ff 10 11*	      .byte.b	-1, -1, 16, 17, 18, 19, 20, 21, 22, 23
     11  606e		       ff ff 18 19*	      .byte.b	-1, -1, 24, 25, 26, 27, 28, 29, 30, 31
     12  6078		       ff ff 20 21*	      .byte.b	-1, -1, 32, 33, 34, 35, 36, 37, 38, 39
     13  6082		       ff ff 28 29*	      .byte.b	-1, -1, 40, 41, 42, 43, 44, 45, 46, 47
     14  608c		       ff ff 30 31*	      .byte.b	-1, -1, 48, 49, 50, 51, 52, 53, 54, 55
     15  6096		       ff ff 38 39*	      .byte.b	-1, -1, 56, 57, 58, 59, 60, 61, 62, 63
     80  60a0
     81  60a0
     82  60a0							;---------------------------------------------------------------------------------------------------
     83  60a0
      0  60a0					      DEF	RECON_MarchToTargetA
      1  60a0				   BANK_RECON_MarchToTargetA SET	_CURRENT_BANK
      2  60a0				   RECON_MarchToTargetA
      3  60a0				   TEMPORARY_VAR SET	Overlay
      4  60a0				   TEMPORARY_OFFSET SET	0
      5  60a0					      SUBROUTINE
     85  60a0
     86  60a0
      0  60a0					      VAR	__fromRow, 1
      1  60a0				   __fromRow  SET	TEMPORARY_VAR
      2  60a0				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  60a0
      4  60a0				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  60a0				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  60a0				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  60a0					      ENDIF
      8  60a0				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  60a0				  -	      ECHO	"Temporary Variable", __fromRow, "overflow!"
     10  60a0				  -	      ERR
     11  60a0					      ENDIF
     12  60a0					      LIST	ON
     88  60a0
     89  60a0							; Start marching towards destination
     90  60a0
     91  60a0							;lda drawDelay
     92  60a0							;beq .progress
     93  60a0							;dec drawDelay
     94  60a0							;rts
     95  60a0				   .progress
     96  60a0
     97  60a0		       a5 9e		      lda	fromSquare
     98  60a2		       c5 a0		      cmp	toSquare
     99  60a4		       f0 3b		      beq	.unmovedx
    100  60a6
    101  60a6							; Now we calculate move to new square
    102  60a6
    103  60a6		       a5 9e		      lda	fromSquare
    104  60a8		       85 83		      sta	lastSquare
    105  60aa		       4a		      lsr
    106  60ab		       4a		      lsr
    107  60ac		       4a		      lsr
    108  60ad		       85 a5		      sta	__fromRow
    109  60af		       a5 a0		      lda	toSquare
    110  60b1		       4a		      lsr
    111  60b2		       4a		      lsr
    112  60b3		       4a		      lsr
    113  60b4		       c5 a5		      cmp	__fromRow
    114  60b6		       f0 11		      beq	rowOK
    115  60b8		       b0 09		      bcs	.downRow
    116  60ba		       a5 9e		      lda	fromSquare
    117  60bc		       e9 07		      sbc	#7
    118  60be		       85 9e		      sta	fromSquare
    119  60c0		       4c c9 f0 	      jmp	nowcol
    120  60c3		       a5 9e	   .downRow   lda	fromSquare
    121  60c5		       69 07		      adc	#7
    122  60c7		       85 9e		      sta	fromSquare
    123  60c9				   rowOK
    124  60c9				   nowcol
    125  60c9
    126  60c9		       a5 9e		      lda	fromSquare
    127  60cb		       29 07		      and	#7
    128  60cd		       85 a5		      sta	__fromRow
    129  60cf		       a5 a0		      lda	toSquare
    130  60d1		       29 07		      and	#7
    131  60d3		       c5 a5		      cmp	__fromRow
    132  60d5		       f0 09		      beq	colok
    133  60d7		       90 05		      bcc	.leftCol
    134  60d9		       e6 9e		      inc	fromSquare
    135  60db		       4c e0 f0 	      jmp	colok
    136  60de		       c6 9e	   .leftCol   dec	fromSquare
    137  60e0				   colok
    138  60e0		       18		      clc
    139  60e1				   .unmovedx
    140  60e1		       60		      rts
    141  60e2
    142  60e2
    143  60e2
    144  60e2
      0  60e2					      CHECK_BANK_SIZE	"BANK_RECON"
      1  60e2		       00 e2	   .TEMP      =	* - BANK_START
 BANK_RECON (2K) SIZE =  $e2 , FREE= $71e
      2  60e2					      ECHO	"BANK_RECON", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  60e2				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  60e2				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  60e2				  -	      ERR
      6  60e2					      endif
    146  60e2
    147  60e2							; EOF
------- FILE ./chess.asm
    472  60e2
    473  60e2							; The handlers for piece move generation
------- FILE Handler_BANK1.asm LEVEL 2 PASS 2
      0  60e2					      include	"Handler_BANK1.asm"
      1  60e2							; Copyright (C)2020 Andrew Davie
      2  60e2
      3  60e2							;---------------------------------------------------------------------------------------------------
      4  60e2
      0  60e2					      NEWRAMBANK	MOVES_RAM	; RAM bank for holding the following ROM shadow
      1  60e2
      2  60e2
      3  60e2
      4 U2000 ????				      SEG.U	MOVES_RAM
      5 U2000					      ORG	ORIGIN_RAM
      6 U2000					      RORG	RAM_3E
      7 U2000				   BANK_START SET	*
      8 U2000				   RAMBANK_MOVES_RAM SET	ORIGIN_RAM / RAM_SIZE
      9 U2000				   _CURRENT_RAMBANK SET	RAMBANK_MOVES_RAM
     10 U2000				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
      0 U2000					      NEWBANK	MOVES	; copy the following bank to RAMBANK_MOVES_RAM
      1  6c64 ????				      SEG	MOVES
      2  6800					      ORG	ORIGIN
      3  6800					      RORG	$F000
      4  6800				   BANK_START SET	*
      5  6800				   MOVES      SET	ORIGIN / 2048
      6  6800				   ORIGIN     SET	ORIGIN + 2048
      7  6800				   _CURRENT_BANK SET	MOVES
      7  6800
      0  6800					      DEF	.GetBoard
      1  6800				   BANK_.GetBoard SET	_CURRENT_BANK
      2  6800				   .GetBoard
      3  6800				   TEMPORARY_VAR SET	Overlay
      4  6800				   TEMPORARY_OFFSET SET	0
      5  6800					      SUBROUTINE
      9  6800		       00 00 00 00	      ds	4	; dummy to switch here
     10  6804		       a6 8b		      ldx	savedBank
     11  6806		       b9 7c f0 	      lda	Board,y
     12  6809		       86 3e		      stx	SET_BANK_RAM
     13  680b		       00		      ds	1
      0  680c					      DEF	.Get64
      1  680c				   BANK_.Get64 SET	_CURRENT_BANK
      2  680c				   .Get64
      3  680c				   TEMPORARY_VAR SET	Overlay
      4  680c				   TEMPORARY_OFFSET SET	0
      5  680c					      SUBROUTINE
     15  680c		       00 00 00 00	      ds	4
     16  6810		       bc 00 f4 	      ldy	X12toBase64b,x
     17  6813		       a5 9b		      lda	currentPly
     18  6815		       85 3e		      sta	SET_BANK_RAM
     19  6817		       00		      ds	1
     20  6818
     21  6818							; Board is a 10 x 12 object which simplifies the generation of moves
     22  6818							; The squares marked '░░░' are illegal. The ("X12") index of each square is the left
     23  6818							; number + the bottom number. The "BASE64" square numbering is used to simplify movement code.
     24  6818							; Bottom left legal square (AS VISIBLE ON SCREEN) is #22
     25  6818
     26  6818							;     X12 numbering
     27  6818							;    ┏━━━┯━━━┯━━━┯━━━┯━━━┯━━━┯━━━┯━━━┯━━━┯━━━┓
     28  6818							;110 ┃░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┃	      BASE64 numbering
     29  6818							;100 ┃░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┃	      ┏━━━┯━━━┯━━━┯━━━┯━━━┯━━━┯━━━┯━━━┓
     30  6818							; 90 ┃░░░┊░░░┊ 92┊ 93┊ 94┊ 95┊ 96┊ 97┊ 98┊ 99┃  BLACK    8 ┃ 56┊ 57┊ 58┊ 59┊ 60┊ 61┊ 62┊ 63┃
     31  6818							; 80 ┃░░░┊░░░┊ 82┊ 83┊ 84┊ 85┊ 86┊ 87┊ 88┊ 89┃  BLACK    7 ┃ 48┊ 49┊ 50┊ 51┊ 52┊ 53┊ 54┊ 55┃
     32  6818							; 70 ┃░░░┊░░░┊ 72┊ 73┊ 74┊ 75┊ 76┊ 77┊ 78┊ 79┃	    6 ┃ 40┊ 41┊ 42┊ 43┊ 44┊ 45┊ 46┊ 47┃
     33  6818							; 60 ┃░░░┊░░░┊ 62┊ 63┊ 64┊ 65┊ 66┊ 67┊ 68┊ 69┃	    5 ┃ 32┊ 33┊ 34┊ 35┊ 36┊ 37┊ 38┊ 39┃
     34  6818							; 50 ┃░░░┊░░░┊ 52┊ 53┊ 54┊ 55┊ 56┊ 57┊ 58┊ 59┃	    4 ┃ 24┊ 25┊ 26┊ 27┊ 28┊ 29┊ 30┊ 31┃
     35  6818							; 40 ┃░░░┊░░░┊ 42┊ 43┊ 44┊ 45┊ 46┊ 47┊ 48┊ 49┃	    3 ┃ 16┊ 17┊ 18┊ 19┊ 20┊ 21┊ 22┊ 23┃
     36  6818							; 30 ┃░░░┊░░░┊ 32┊ 33┊ 34┊ 35┊ 36┊ 37┊ 38┊ 39┃  WHITE    2 ┃  8┊  9┊ 10┊ 11┊ 12┊ 13┊ 14┊ 15┃
     37  6818							; 20 ┃░░░┊░░░┊ 22┊ 23┊ 24┊ 25┊ 26┊ 27┊ 28┊ 29┃  WHITE    1 ┃  0┊  1┊  2┊  3┊  4┊  5┊  6┊  7┃
     38  6818							; 10 ┃░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┃	      ┗━━━┷━━━┷━━━┷━━━┷━━━┷━━━┷━━━┷━━━┛
     39  6818							;  0 ┃░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┃		A   B	C   D	E   F	G   H
     40  6818							;    ┗━━━┷━━━┷━━━┷━━━┷━━━┷━━━┷━━━┷━━━┷━━━┷━━━┛
     41  6818							;	0   1	2   3	4   5	6   7	8   9
     42  6818							;		A   B	C   D	E   F	G   H
     43  6818
     44  6818							;     HEX X12
     45  6818							;    ┏━━━┯━━━┯━━━┯━━━┯━━━┯━━━┯━━━┯━━━┯━━━┯━━━┓
     46  6818							;110 ┃░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┃
     47  6818							;100 ┃░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┃
     48  6818							; 90 ┃░░░┊░░░┊$5C┊$5D┊$5E┊$5F┊$60┊$61┊$62┊$63┃
     49  6818							; 80 ┃░░░┊░░░┊$52┊$53┊$54┊$55┊$56┊$57┊$58┊$59┃
     50  6818							; 70 ┃░░░┊░░░┊$48┊$49┊$4A┊$4B┊$4C┊$4D┊$4E┊$4F┃
     51  6818							; 60 ┃░░░┊░░░┊$3E┊$3F┊$40┊$41┊$42┊$43┊$44┊$45┃
     52  6818							; 50 ┃░░░┊░░░┊$34┊$35┊$36┊$37┊$38┊$39┊$3A┊$3B┃
     53  6818							; 40 ┃░░░┊░░░┊$2A┊$2B┊$2C┊$2D┊$2E┊$2F┊$30┊$31┃
     54  6818							; 30 ┃░░░┊░░░┊$20┊$21┊$22┊$23┊$24┊$25┊$26|$27┃
     55  6818							; 20 ┃░░░┊░░░┊$16┊$17┊$18┊$19┊$1A┊$1B┊$1C┊$1D┃
     56  6818							; 10 ┃░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┃
     57  6818							;  0 ┃░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┊░░░┃
     58  6818							;    ┗━━━┷━━━┷━━━┷━━━┷━━━┷━━━┷━━━┷━━━┷━━━┷━━━┛
     59  6818							;	0   1	2   3	4   5	6   7	8   9
     60  6818							;		A   B	C   D	E   F	G   H
     61  6818
     62  6818
     63  6818							; We put a short buffer before 'ValidSquare' when it is at the start of the bank, so that
     64  6818							; the move indexing (ie., "ValidSquare+{1},x" won't drop off the beginning of the bank
     65  6818							; and sause "segfaults". 22 is the max offset (a knight move). These spare bytes can
     66  6818							; be re-used for something else - we just need to guarantee there are 22 of them there
     67  6818
      0  6818					      ALLOCATE	Valid, 120 + 80	;+ 22
      0  6818					      OPTIONAL_PAGEBREAK	"Table", 120 + 80
     10  6818					      LIST	ON
      0  6818					      DEF	Valid
      1  6818				   BANK_Valid SET	_CURRENT_BANK
      2  6818				   Valid
      3  6818				   TEMPORARY_VAR SET	Overlay
      4  6818				   TEMPORARY_OFFSET SET	0
      5  6818					      SUBROUTINE
     69  6818
     70  6818							;ORG Valid+22
     71  6818							;ds 22 		     ; so indexing of "ValidSquare-22,x" won't fail
     72  6818
     73  6818							; Note, we will never index INTO the above bytes - x will always be >= 22
     74  6818							; We just need to make sure that the actual indexing will not have an address before
     75  6818							; the index of outside the page.
     76  6818
      0  6818					      DEF	ValidSquare
      1  6818				   BANK_ValidSquare SET	_CURRENT_BANK
      2  6818				   ValidSquare
      3  6818				   TEMPORARY_VAR SET	Overlay
      4  6818				   TEMPORARY_OFFSET SET	0
      5  6818					      SUBROUTINE
     78  6818
     79  6818
     80  6818							; Use this table to
     81  6818							;   a) Determine if a square is valid (-1 = NO)
     82  6818							;   b) Move pieces without addition.  e.g., "lda ValidSquareTable+10,x" will let you know
     83  6818							;	if a white pawn on square "x" can move "up" the board.
     84  6818
     85  6818		       ff ff ff ff*	      .byte.b	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1
     86  6822		       ff ff ff ff*	      .byte.b	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1
     87  682c		       ff ff 16 17*	      .byte.b	-1, -1, 22, 23, 24, 25, 26, 27, 28, 29
     88  6836		       ff ff 20 21*	      .byte.b	-1, -1, 32, 33, 34, 35, 36, 37, 38, 39
     89  6840		       ff ff 2a 2b*	      .byte.b	-1, -1, 42, 43, 44, 45, 46, 47, 48, 49
     90  684a		       ff ff 34 35*	      .byte.b	-1, -1, 52, 53, 54, 55, 56, 57, 58, 59
     91  6854		       ff ff 3e 3f*	      .byte.b	-1, -1, 62, 63, 64, 65, 66, 67, 68, 69
     92  685e		       ff ff 48 49*	      .byte.b	-1, -1, 72, 73, 74, 75, 76, 77, 78, 79
     93  6868		       ff ff 52 53*	      .byte.b	-1, -1, 82, 83, 84, 85, 86, 87, 88, 89
     94  6872		       ff ff 5c 5d*	      .byte.b	-1, -1, 92, 93, 94, 95, 96, 97, 98, 99	; CONTINUES...
     95  687c
      0  687c					      DEF	Board
      1  687c				   BANK_Board SET	_CURRENT_BANK
      2  687c				   Board
      3  687c				   TEMPORARY_VAR SET	Overlay
      4  687c				   TEMPORARY_OFFSET SET	0
      5  687c					      SUBROUTINE
     97  687c
     98  687c							; A 10X10... we should never write using invalid square
     99  687c							; ON COPY TO RAM BANK, 'BOARD' SELF-INITIALISES TO THE FOLLOWING VALUES
    100  687c							; FROM THEN ON IT'S WRITEABLE (REMEMBER TO +RAM_WRITE) FOR MODIFICATIONS
    101  687c
    102  687c		       ff ff ff ff*	      .byte.b	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1	; shared with above table
    103  6886		       ff ff ff ff*	      .byte.b	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1	; shared with above table
    104  6890
    105  6890					      REPEAT	8
    106  6890		       ff ff 00 00*	      .byte.b	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0
    105  6890					      REPEND
    106  689a		       ff ff 00 00*	      .byte.b	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0
    105  689a					      REPEND
    106  68a4		       ff ff 00 00*	      .byte.b	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0
    105  68a4					      REPEND
    106  68ae		       ff ff 00 00*	      .byte.b	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0
    105  68ae					      REPEND
    106  68b8		       ff ff 00 00*	      .byte.b	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0
    105  68b8					      REPEND
    106  68c2		       ff ff 00 00*	      .byte.b	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0
    105  68c2					      REPEND
    106  68cc		       ff ff 00 00*	      .byte.b	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0
    105  68cc					      REPEND
    106  68d6		       ff ff 00 00*	      .byte.b	-1, -1, 0, 0, 0, 0, 0, 0, 0, 0
    107  68e0					      REPEND
    108  68e0
    109  68e0							; DON'T OVERSTEP BOUNDS WHEN WRITING BOARD - MAXIMUM INDEX = 99
    110  68e0
    111  68e0							; PARANOIA... following not used, but there in case above violated
    112  68e0							;.byte -1, -1, -1, -1, -1, -1, -1, -1, -1, -1	      ; shared with above table
    113  68e0							;.byte -1, -1, -1, -1, -1, -1, -1, -1, -1, -1	      ; shared with above table
    114  68e0
    115  68e0							;---------------------------------------------------------------------------------------------------
    116  68e0
------- FILE Handler_QUEEN.asm LEVEL 3 PASS 2
      0  68e0					      include	"Handler_QUEEN.asm"
      1  68e0							; Copyright (C)2020 Andrew Davie
      2  68e0
      3  68e0							;---------------------------------------------------------------------------------------------------
      4  68e0							; QUEEN
      5  68e0							;---------------------------------------------------------------------------------------------------
      6  68e0
      0  68e0					      DEF	Handle_QUEEN
      1  68e0				   BANK_Handle_QUEEN SET	_CURRENT_BANK
      2  68e0				   Handle_QUEEN
      3  68e0				   TEMPORARY_VAR SET	Overlay
      4  68e0				   TEMPORARY_OFFSET SET	0
      5  68e0					      SUBROUTINE
      8  68e0					      SUBROUTINE
      9  68e0
     10  68e0							; Pass...
     11  68e0							; x = currentSquare (square the piece is on)
     12  68e0							; currentPiece (with flags/colour attached)
     13  68e0
      0  68e0					      MOVE_TOWARDS	_DOWN+_LEFT
      1  68e0					      SUBROUTINE
      2  68e0
      3  68e0
      4  68e0
      5  68e0		       a6 97		      ldx	currentSquare
      6  68e2		       d0 03		      bne	.project
      7  68e4
      8  68e4		       20 b8 fc    .empty     jsr	AddMove
      9  68e7		       bc 0d f0    .project   ldy	ValidSquare+_DOWN+_LEFT,x
     10  68ea		       30 0c		      bmi	.invalid
     11  68ec		       b9 7c f0 	      lda	Board,y
     12  68ef		       f0 f3		      beq	.empty
     13  68f1		       45 96		      eor	currentPiece
     14  68f3		       10 03		      bpl	.invalid
     15  68f5		       20 b8 fc 	      jsr	AddMove
     16  68f8
     17  68f8				   .invalid
      0  68f8					      MOVE_TOWARDS	_DOWN
      1  68f8					      SUBROUTINE
      2  68f8
      3  68f8
      4  68f8
      5  68f8		       a6 97		      ldx	currentSquare
      6  68fa		       d0 03		      bne	.project
      7  68fc
      8  68fc		       20 b8 fc    .empty     jsr	AddMove
      9  68ff		       bc 0e f0    .project   ldy	ValidSquare+_DOWN,x
     10  6902		       30 0c		      bmi	.invalid
     11  6904		       b9 7c f0 	      lda	Board,y
     12  6907		       f0 f3		      beq	.empty
     13  6909		       45 96		      eor	currentPiece
     14  690b		       10 03		      bpl	.invalid
     15  690d		       20 b8 fc 	      jsr	AddMove
     16  6910
     17  6910				   .invalid
      0  6910					      MOVE_TOWARDS	_DOWN+_RIGHT
      1  6910					      SUBROUTINE
      2  6910
      3  6910
      4  6910
      5  6910		       a6 97		      ldx	currentSquare
      6  6912		       d0 03		      bne	.project
      7  6914
      8  6914		       20 b8 fc    .empty     jsr	AddMove
      9  6917		       bc 0f f0    .project   ldy	ValidSquare+_DOWN+_RIGHT,x
     10  691a		       30 0c		      bmi	.invalid
     11  691c		       b9 7c f0 	      lda	Board,y
     12  691f		       f0 f3		      beq	.empty
     13  6921		       45 96		      eor	currentPiece
     14  6923		       10 03		      bpl	.invalid
     15  6925		       20 b8 fc 	      jsr	AddMove
     16  6928
     17  6928				   .invalid
      0  6928					      MOVE_TOWARDS	_RIGHT
      1  6928					      SUBROUTINE
      2  6928
      3  6928
      4  6928
      5  6928		       a6 97		      ldx	currentSquare
      6  692a		       d0 03		      bne	.project
      7  692c
      8  692c		       20 b8 fc    .empty     jsr	AddMove
      9  692f		       bc 19 f0    .project   ldy	ValidSquare+_RIGHT,x
     10  6932		       30 0c		      bmi	.invalid
     11  6934		       b9 7c f0 	      lda	Board,y
     12  6937		       f0 f3		      beq	.empty
     13  6939		       45 96		      eor	currentPiece
     14  693b		       10 03		      bpl	.invalid
     15  693d		       20 b8 fc 	      jsr	AddMove
     16  6940
     17  6940				   .invalid
      0  6940					      MOVE_TOWARDS	_UP+_RIGHT
      1  6940					      SUBROUTINE
      2  6940
      3  6940
      4  6940
      5  6940		       a6 97		      ldx	currentSquare
      6  6942		       d0 03		      bne	.project
      7  6944
      8  6944		       20 b8 fc    .empty     jsr	AddMove
      9  6947		       bc 23 f0    .project   ldy	ValidSquare+_UP+_RIGHT,x
     10  694a		       30 0c		      bmi	.invalid
     11  694c		       b9 7c f0 	      lda	Board,y
     12  694f		       f0 f3		      beq	.empty
     13  6951		       45 96		      eor	currentPiece
     14  6953		       10 03		      bpl	.invalid
     15  6955		       20 b8 fc 	      jsr	AddMove
     16  6958
     17  6958				   .invalid
      0  6958					      MOVE_TOWARDS	_UP
      1  6958					      SUBROUTINE
      2  6958
      3  6958
      4  6958
      5  6958		       a6 97		      ldx	currentSquare
      6  695a		       d0 03		      bne	.project
      7  695c
      8  695c		       20 b8 fc    .empty     jsr	AddMove
      9  695f		       bc 22 f0    .project   ldy	ValidSquare+_UP,x
     10  6962		       30 0c		      bmi	.invalid
     11  6964		       b9 7c f0 	      lda	Board,y
     12  6967		       f0 f3		      beq	.empty
     13  6969		       45 96		      eor	currentPiece
     14  696b		       10 03		      bpl	.invalid
     15  696d		       20 b8 fc 	      jsr	AddMove
     16  6970
     17  6970				   .invalid
      0  6970					      MOVE_TOWARDS	_UP+_LEFT
      1  6970					      SUBROUTINE
      2  6970
      3  6970
      4  6970
      5  6970		       a6 97		      ldx	currentSquare
      6  6972		       d0 03		      bne	.project
      7  6974
      8  6974		       20 b8 fc    .empty     jsr	AddMove
      9  6977		       bc 21 f0    .project   ldy	ValidSquare+_UP+_LEFT,x
     10  697a		       30 0c		      bmi	.invalid
     11  697c		       b9 7c f0 	      lda	Board,y
     12  697f		       f0 f3		      beq	.empty
     13  6981		       45 96		      eor	currentPiece
     14  6983		       10 03		      bpl	.invalid
     15  6985		       20 b8 fc 	      jsr	AddMove
     16  6988
     17  6988				   .invalid
      0  6988					      MOVE_TOWARDS	_LEFT
      1  6988					      SUBROUTINE
      2  6988
      3  6988
      4  6988
      5  6988		       a6 97		      ldx	currentSquare
      6  698a		       d0 03		      bne	.project
      7  698c
      8  698c		       20 b8 fc    .empty     jsr	AddMove
      9  698f		       bc 17 f0    .project   ldy	ValidSquare+_LEFT,x
     10  6992		       30 0c		      bmi	.invalid
     11  6994		       b9 7c f0 	      lda	Board,y
     12  6997		       f0 f3		      beq	.empty
     13  6999		       45 96		      eor	currentPiece
     14  699b		       10 03		      bpl	.invalid
     15  699d		       20 b8 fc 	      jsr	AddMove
     16  69a0
     17  69a0				   .invalid
     22  69a0
     23  69a0		       4c 7f fa 	      jmp	MoveReturn
     24  69a3
     25  69a3							; EOF
------- FILE Handler_BANK1.asm
------- FILE Handler_BISHOP.asm LEVEL 3 PASS 2
      0  69a3					      include	"Handler_BISHOP.asm"
      1  69a3							; Copyright (C)2020 Andrew Davie
      2  69a3
      3  69a3							;---------------------------------------------------------------------------------------------------
      4  69a3							; BISHOP
      5  69a3							;---------------------------------------------------------------------------------------------------
      6  69a3
      0  69a3					      DEF	Handle_BISHOP
      1  69a3				   BANK_Handle_BISHOP SET	_CURRENT_BANK
      2  69a3				   Handle_BISHOP
      3  69a3				   TEMPORARY_VAR SET	Overlay
      4  69a3				   TEMPORARY_OFFSET SET	0
      5  69a3					      SUBROUTINE
      8  69a3					      SUBROUTINE
      9  69a3
     10  69a3							; x = currentSquare (square the piece is on)
     11  69a3							; currentPiece (with flags/colour attached)
     12  69a3
      0  69a3					      MOVE_TOWARDS	_DOWN+_LEFT
      1  69a3					      SUBROUTINE
      2  69a3
      3  69a3
      4  69a3
      5  69a3		       a6 97		      ldx	currentSquare
      6  69a5		       d0 03		      bne	.project
      7  69a7
      8  69a7		       20 b8 fc    .empty     jsr	AddMove
      9  69aa		       bc 0d f0    .project   ldy	ValidSquare+_DOWN+_LEFT,x
     10  69ad		       30 0c		      bmi	.invalid
     11  69af		       b9 7c f0 	      lda	Board,y
     12  69b2		       f0 f3		      beq	.empty
     13  69b4		       45 96		      eor	currentPiece
     14  69b6		       10 03		      bpl	.invalid
     15  69b8		       20 b8 fc 	      jsr	AddMove
     16  69bb
     17  69bb				   .invalid
      0  69bb					      MOVE_TOWARDS	_DOWN+_RIGHT
      1  69bb					      SUBROUTINE
      2  69bb
      3  69bb
      4  69bb
      5  69bb		       a6 97		      ldx	currentSquare
      6  69bd		       d0 03		      bne	.project
      7  69bf
      8  69bf		       20 b8 fc    .empty     jsr	AddMove
      9  69c2		       bc 0f f0    .project   ldy	ValidSquare+_DOWN+_RIGHT,x
     10  69c5		       30 0c		      bmi	.invalid
     11  69c7		       b9 7c f0 	      lda	Board,y
     12  69ca		       f0 f3		      beq	.empty
     13  69cc		       45 96		      eor	currentPiece
     14  69ce		       10 03		      bpl	.invalid
     15  69d0		       20 b8 fc 	      jsr	AddMove
     16  69d3
     17  69d3				   .invalid
      0  69d3					      MOVE_TOWARDS	_UP+_LEFT
      1  69d3					      SUBROUTINE
      2  69d3
      3  69d3
      4  69d3
      5  69d3		       a6 97		      ldx	currentSquare
      6  69d5		       d0 03		      bne	.project
      7  69d7
      8  69d7		       20 b8 fc    .empty     jsr	AddMove
      9  69da		       bc 21 f0    .project   ldy	ValidSquare+_UP+_LEFT,x
     10  69dd		       30 0c		      bmi	.invalid
     11  69df		       b9 7c f0 	      lda	Board,y
     12  69e2		       f0 f3		      beq	.empty
     13  69e4		       45 96		      eor	currentPiece
     14  69e6		       10 03		      bpl	.invalid
     15  69e8		       20 b8 fc 	      jsr	AddMove
     16  69eb
     17  69eb				   .invalid
      0  69eb					      MOVE_TOWARDS	_UP+_RIGHT
      1  69eb					      SUBROUTINE
      2  69eb
      3  69eb
      4  69eb
      5  69eb		       a6 97		      ldx	currentSquare
      6  69ed		       d0 03		      bne	.project
      7  69ef
      8  69ef		       20 b8 fc    .empty     jsr	AddMove
      9  69f2		       bc 23 f0    .project   ldy	ValidSquare+_UP+_RIGHT,x
     10  69f5		       30 0c		      bmi	.invalid
     11  69f7		       b9 7c f0 	      lda	Board,y
     12  69fa		       f0 f3		      beq	.empty
     13  69fc		       45 96		      eor	currentPiece
     14  69fe		       10 03		      bpl	.invalid
     15  6a00		       20 b8 fc 	      jsr	AddMove
     16  6a03
     17  6a03				   .invalid
     17  6a03
     18  6a03		       4c 7f fa 	      jmp	MoveReturn
     19  6a06
     20  6a06							;---------------------------------------------------------------------------------------------------
     21  6a06							; EOF
------- FILE Handler_BANK1.asm
------- FILE Handler_ROOK.asm LEVEL 3 PASS 2
      0  6a06					      include	"Handler_ROOK.asm"
      1  6a06							; Copyright (C)2020 Andrew Davie
      2  6a06							; Rook move handler
      3  6a06
      4  6a06							;---------------------------------------------------------------------------------------------------
      5  6a06							; ROOK
      6  6a06							;---------------------------------------------------------------------------------------------------
      7  6a06
      0  6a06					      DEF	Handle_ROOK
      1  6a06				   BANK_Handle_ROOK SET	_CURRENT_BANK
      2  6a06				   Handle_ROOK
      3  6a06				   TEMPORARY_VAR SET	Overlay
      4  6a06				   TEMPORARY_OFFSET SET	0
      5  6a06					      SUBROUTINE
      9  6a06					      SUBROUTINE
     10  6a06
     11  6a06							; Pass...
     12  6a06							; x = currentSquare (square the piece is on)
     13  6a06							; currentPiece (with flags/colour attached)
     14  6a06
      0  6a06					      MOVE_TOWARDS	_DOWN
      1  6a06					      SUBROUTINE
      2  6a06
      3  6a06
      4  6a06
      5  6a06		       a6 97		      ldx	currentSquare
      6  6a08		       d0 03		      bne	.project
      7  6a0a
      8  6a0a		       20 b8 fc    .empty     jsr	AddMove
      9  6a0d		       bc 0e f0    .project   ldy	ValidSquare+_DOWN,x
     10  6a10		       30 0c		      bmi	.invalid
     11  6a12		       b9 7c f0 	      lda	Board,y
     12  6a15		       f0 f3		      beq	.empty
     13  6a17		       45 96		      eor	currentPiece
     14  6a19		       10 03		      bpl	.invalid
     15  6a1b		       20 b8 fc 	      jsr	AddMove
     16  6a1e
     17  6a1e				   .invalid
      0  6a1e					      MOVE_TOWARDS	_RIGHT
      1  6a1e					      SUBROUTINE
      2  6a1e
      3  6a1e
      4  6a1e
      5  6a1e		       a6 97		      ldx	currentSquare
      6  6a20		       d0 03		      bne	.project
      7  6a22
      8  6a22		       20 b8 fc    .empty     jsr	AddMove
      9  6a25		       bc 19 f0    .project   ldy	ValidSquare+_RIGHT,x
     10  6a28		       30 0c		      bmi	.invalid
     11  6a2a		       b9 7c f0 	      lda	Board,y
     12  6a2d		       f0 f3		      beq	.empty
     13  6a2f		       45 96		      eor	currentPiece
     14  6a31		       10 03		      bpl	.invalid
     15  6a33		       20 b8 fc 	      jsr	AddMove
     16  6a36
     17  6a36				   .invalid
      0  6a36					      MOVE_TOWARDS	_UP
      1  6a36					      SUBROUTINE
      2  6a36
      3  6a36
      4  6a36
      5  6a36		       a6 97		      ldx	currentSquare
      6  6a38		       d0 03		      bne	.project
      7  6a3a
      8  6a3a		       20 b8 fc    .empty     jsr	AddMove
      9  6a3d		       bc 22 f0    .project   ldy	ValidSquare+_UP,x
     10  6a40		       30 0c		      bmi	.invalid
     11  6a42		       b9 7c f0 	      lda	Board,y
     12  6a45		       f0 f3		      beq	.empty
     13  6a47		       45 96		      eor	currentPiece
     14  6a49		       10 03		      bpl	.invalid
     15  6a4b		       20 b8 fc 	      jsr	AddMove
     16  6a4e
     17  6a4e				   .invalid
      0  6a4e					      MOVE_TOWARDS	_LEFT
      1  6a4e					      SUBROUTINE
      2  6a4e
      3  6a4e
      4  6a4e
      5  6a4e		       a6 97		      ldx	currentSquare
      6  6a50		       d0 03		      bne	.project
      7  6a52
      8  6a52		       20 b8 fc    .empty     jsr	AddMove
      9  6a55		       bc 17 f0    .project   ldy	ValidSquare+_LEFT,x
     10  6a58		       30 0c		      bmi	.invalid
     11  6a5a		       b9 7c f0 	      lda	Board,y
     12  6a5d		       f0 f3		      beq	.empty
     13  6a5f		       45 96		      eor	currentPiece
     14  6a61		       10 03		      bpl	.invalid
     15  6a63		       20 b8 fc 	      jsr	AddMove
     16  6a66
     17  6a66				   .invalid
     19  6a66
     20  6a66		       4c 7f fa 	      jmp	MoveReturn
     21  6a69
     22  6a69							;---------------------------------------------------------------------------------------------------
     23  6a69							; EOF
------- FILE Handler_BANK1.asm
------- FILE Handler_KING.asm LEVEL 3 PASS 2
      0  6a69					      include	"Handler_KING.asm"
      1  6a69							; Copyright (C)2020 Andrew Davie
      2  6a69
      3  6a69							;---------------------------------------------------------------------------------------------------
      4  6a69							; KING
      5  6a69							; This is the move handler for a KING
      6  6a69							; "Check" is detected in the next ply of the search.
      7  6a69
      8  6a69
      9  6a69							;---------------------------------------------------------------------------------------------------
     10  6a69
     11  6a69							; MACRO - Castling
     12  6a69
     13  6a69		       00 03	   KINGSIDE   =	3
     14  6a69		       ff ff ff fc QUEENSIDE  =	-4
     15  6a69
     16  6a69					      MAC	castle
     17  6a69							; {1} = "KINGSIDE" or "QUEENSIDE"
     18  6a69
     19  6a69					      ldx	currentSquare
     20  6a69					      lda	Board+{1},x	; kingside/queenside R position
     21  6a69					      and	#PIECE_MASK|FLAG_MOVED
     22  6a69					      cmp	#ROOK
     23  6a69					      bne	.noCastle	; not a R that hasn't moved
     24  6a69
     25  6a69							; It's a R and it *HAS* to be correct colour because it hasn't moved!
     26  6a69							; AND the K hasn't moved (earlier check), so check for vacant squares between K and R
     27  6a69
     28  6a69					      IF	{1} = QUEENSIDE
     29  6a69					      lda	Board-3,x	; nothing in N pos
     30  6a69					      bne	.noCastle
     31  6a69					      lda	Board-2,x	; nothing in B pos
     32  6a69					      bne	.noCastle
     33  6a69					      lda	Board-1,x	; nothing in Q pos
     34  6a69					      bne	.noCastle
     35  6a69
     36  6a69					      ENDIF
     37  6a69
     38  6a69					      IF	{1} = KINGSIDE
     39  6a69					      lda	Board+2,x	; check N pos
     40  6a69					      bne	.noCastle
     41  6a69					      lda	Board+1,x	; check B pos
     42  6a69					      bne	.noCastle
     43  6a69					      ENDIF
     44  6a69
     45  6a69							; appropriate N/B/(Q) squares are vacant so we proceed...
     46  6a69
     47  6a69							; FINALLY -- king can castle
     48  6a69							; note: when we actually DO the move we MUST insert "Phantom" kings onto the board over the
     49  6a69							; squares the king traverses so that "check" (and thus illegal moves) can be detected on the
     50  6a69							; next move. Castling will be detected by K moving > 1 square. (TODO: FIX?? not CASTLE flag??)
     51  6a69
     52  6a69					      lda	currentPiece
     53  6a69					      ora	#FLAG_CASTLE	; flag it's a castling move
     54  6a69					      sta	currentPiece
     55  6a69
     56  6a69					      IF	{1} = KINGSIDE
     57  6a69					      ldy	ValidSquare+2,x
     58  6a69					      ENDIF
     59  6a69
     60  6a69					      IF	{1} = QUEENSIDE
     61  6a69					      ldy	ValidSquare-2,x
     62  6a69					      ENDIF
     63  6a69
     64  6a69					      jsr	AddMove	; 57
     65  6a69
     66  6a69				   .noCastle
     67  6a69					      ENDM
     68  6a69
     69  6a69
     70  6a69							;---------------------------------------------------------------------------------------------------
     71  6a69
      0  6a69					      DEF	Handle_KING
      1  6a69				   BANK_Handle_KING SET	_CURRENT_BANK
      2  6a69				   Handle_KING
      3  6a69				   TEMPORARY_VAR SET	Overlay
      4  6a69				   TEMPORARY_OFFSET SET	0
      5  6a69					      SUBROUTINE
     73  6a69					      SUBROUTINE
     74  6a69
     75  6a69							; x = currentSquare (square the KING is on)
     76  6a69							; currentPiece (KING of course, but with flags/colour attached)
     77  6a69
      0  6a69					      MOVE_TO	_DOWN+_LEFT
      1  6a69					      SUBROUTINE
      2  6a69		       bc 0d f0 	      ldy	ValidSquare+_DOWN+_LEFT,x
      3  6a6c		       30 0c		      bmi	.invalid
      4  6a6e		       b9 7c f0 	      lda	Board,y
      5  6a71		       f0 04		      beq	.squareEmpty
      6  6a73		       45 96		      eor	currentPiece
      7  6a75		       10 03		      bpl	.invalid
      8  6a77		       20 b8 fc    .squareEmpty jsr	AddMove
      9  6a7a				   .invalid
      0  6a7a					      MOVE_TO_X	_DOWN
      1  6a7a		       a6 97		      ldx	currentSquare
      0  6a7c					      MOVE_TO	_DOWN
      1  6a7c					      SUBROUTINE
      2  6a7c		       bc 0e f0 	      ldy	ValidSquare+_DOWN,x
      3  6a7f		       30 0c		      bmi	.invalid
      4  6a81		       b9 7c f0 	      lda	Board,y
      5  6a84		       f0 04		      beq	.squareEmpty
      6  6a86		       45 96		      eor	currentPiece
      7  6a88		       10 03		      bpl	.invalid
      8  6a8a		       20 b8 fc    .squareEmpty jsr	AddMove
      9  6a8d				   .invalid
      0  6a8d					      MOVE_TO_X	_DOWN+_RIGHT
      1  6a8d		       a6 97		      ldx	currentSquare
      0  6a8f					      MOVE_TO	_DOWN+_RIGHT
      1  6a8f					      SUBROUTINE
      2  6a8f		       bc 0f f0 	      ldy	ValidSquare+_DOWN+_RIGHT,x
      3  6a92		       30 0c		      bmi	.invalid
      4  6a94		       b9 7c f0 	      lda	Board,y
      5  6a97		       f0 04		      beq	.squareEmpty
      6  6a99		       45 96		      eor	currentPiece
      7  6a9b		       10 03		      bpl	.invalid
      8  6a9d		       20 b8 fc    .squareEmpty jsr	AddMove
      9  6aa0				   .invalid
      0  6aa0					      MOVE_TO_X	_RIGHT
      1  6aa0		       a6 97		      ldx	currentSquare
      0  6aa2					      MOVE_TO	_RIGHT
      1  6aa2					      SUBROUTINE
      2  6aa2		       bc 19 f0 	      ldy	ValidSquare+_RIGHT,x
      3  6aa5		       30 0c		      bmi	.invalid
      4  6aa7		       b9 7c f0 	      lda	Board,y
      5  6aaa		       f0 04		      beq	.squareEmpty
      6  6aac		       45 96		      eor	currentPiece
      7  6aae		       10 03		      bpl	.invalid
      8  6ab0		       20 b8 fc    .squareEmpty jsr	AddMove
      9  6ab3				   .invalid
      0  6ab3					      MOVE_TO_X	_UP+_RIGHT
      1  6ab3		       a6 97		      ldx	currentSquare
      0  6ab5					      MOVE_TO	_UP+_RIGHT
      1  6ab5					      SUBROUTINE
      2  6ab5		       bc 23 f0 	      ldy	ValidSquare+_UP+_RIGHT,x
      3  6ab8		       30 0c		      bmi	.invalid
      4  6aba		       b9 7c f0 	      lda	Board,y
      5  6abd		       f0 04		      beq	.squareEmpty
      6  6abf		       45 96		      eor	currentPiece
      7  6ac1		       10 03		      bpl	.invalid
      8  6ac3		       20 b8 fc    .squareEmpty jsr	AddMove
      9  6ac6				   .invalid
      0  6ac6					      MOVE_TO_X	_UP
      1  6ac6		       a6 97		      ldx	currentSquare
      0  6ac8					      MOVE_TO	_UP
      1  6ac8					      SUBROUTINE
      2  6ac8		       bc 22 f0 	      ldy	ValidSquare+_UP,x
      3  6acb		       30 0c		      bmi	.invalid
      4  6acd		       b9 7c f0 	      lda	Board,y
      5  6ad0		       f0 04		      beq	.squareEmpty
      6  6ad2		       45 96		      eor	currentPiece
      7  6ad4		       10 03		      bpl	.invalid
      8  6ad6		       20 b8 fc    .squareEmpty jsr	AddMove
      9  6ad9				   .invalid
      0  6ad9					      MOVE_TO_X	_UP+_LEFT
      1  6ad9		       a6 97		      ldx	currentSquare
      0  6adb					      MOVE_TO	_UP+_LEFT
      1  6adb					      SUBROUTINE
      2  6adb		       bc 21 f0 	      ldy	ValidSquare+_UP+_LEFT,x
      3  6ade		       30 0c		      bmi	.invalid
      4  6ae0		       b9 7c f0 	      lda	Board,y
      5  6ae3		       f0 04		      beq	.squareEmpty
      6  6ae5		       45 96		      eor	currentPiece
      7  6ae7		       10 03		      bpl	.invalid
      8  6ae9		       20 b8 fc    .squareEmpty jsr	AddMove
      9  6aec				   .invalid
      0  6aec					      MOVE_TO_X	_LEFT
      1  6aec		       a6 97		      ldx	currentSquare
      0  6aee					      MOVE_TO	_LEFT
      1  6aee					      SUBROUTINE
      2  6aee		       bc 17 f0 	      ldy	ValidSquare+_LEFT,x
      3  6af1		       30 0c		      bmi	.invalid
      4  6af3		       b9 7c f0 	      lda	Board,y
      5  6af6		       f0 04		      beq	.squareEmpty
      6  6af8		       45 96		      eor	currentPiece
      7  6afa		       10 03		      bpl	.invalid
      8  6afc		       20 b8 fc    .squareEmpty jsr	AddMove
      9  6aff				   .invalid
     86  6aff
     87  6aff		       24 96		      bit	currentPiece
     88  6b01		       70 47		      bvs	.exit	; king has moved, so no castling
     89  6b03
      0  6b03					      CASTLE	KINGSIDE
      1  6b03
      2  6b03
      3  6b03		       a6 97		      ldx	currentSquare
      4  6b05		       bd 7f f0 	      lda	Board+KINGSIDE,x
      5  6b08		       29 4f		      and	#PIECE_MASK|FLAG_MOVED
      6  6b0a		       c9 05		      cmp	#ROOK
      7  6b0c		       d0 16		      bne	.noCastle
      8  6b0e
      9  6b0e
     10  6b0e
     11  6b0e
     12  6b0e				  -	      IF	KINGSIDE = QUEENSIDE
     13  6b0e				  -	      lda	Board-3,x
     14  6b0e				  -	      bne	.noCastle
     15  6b0e				  -	      lda	Board-2,x
     16  6b0e				  -	      bne	.noCastle
     17  6b0e				  -	      lda	Board-1,x
     18  6b0e				  -	      bne	.noCastle
     19  6b0e				  -
     20  6b0e					      ENDIF
     21  6b0e
     22  6b0e					      IF	KINGSIDE = KINGSIDE
     23  6b0e		       bd 7e f0 	      lda	Board+2,x
     24  6b11		       d0 11		      bne	.noCastle
     25  6b13		       bd 7d f0 	      lda	Board+1,x
     26  6b16		       d0 0c		      bne	.noCastle
     27  6b18					      ENDIF
     28  6b18
     29  6b18
     30  6b18
     31  6b18
     32  6b18
     33  6b18
     34  6b18
     35  6b18
     36  6b18		       a5 96		      lda	currentPiece
     37  6b1a		       09 10		      ora	#FLAG_CASTLE
     38  6b1c		       85 96		      sta	currentPiece
     39  6b1e
     40  6b1e					      IF	KINGSIDE = KINGSIDE
     41  6b1e		       bc 1a f0 	      ldy	ValidSquare+2,x
     42  6b21					      ENDIF
     43  6b21
     44  6b21				  -	      IF	KINGSIDE = QUEENSIDE
     45  6b21				  -	      ldy	ValidSquare-2,x
     46  6b21					      ENDIF
     47  6b21
     48  6b21		       20 b8 fc 	      jsr	AddMove
     49  6b24
     50  6b24				   .noCastle
      0  6b24					      CASTLE	QUEENSIDE
      1  6b24
      2  6b24
      3  6b24		       a6 97		      ldx	currentSquare
      4  6b26		       bd 78 f0 	      lda	Board+QUEENSIDE,x
      5  6b29		       29 4f		      and	#PIECE_MASK|FLAG_MOVED
      6  6b2b		       c9 05		      cmp	#ROOK
      7  6b2d		       d0 1b		      bne	.noCastle
      8  6b2f
      9  6b2f
     10  6b2f
     11  6b2f
     12  6b2f					      IF	QUEENSIDE = QUEENSIDE
     13  6b2f		       bd 79 f0 	      lda	Board-3,x
     14  6b32		       d0 16		      bne	.noCastle
     15  6b34		       bd 7a f0 	      lda	Board-2,x
     16  6b37		       d0 11		      bne	.noCastle
     17  6b39		       bd 7b f0 	      lda	Board-1,x
     18  6b3c		       d0 0c		      bne	.noCastle
     19  6b3e
     20  6b3e					      ENDIF
     21  6b3e
     22  6b3e				  -	      IF	QUEENSIDE = KINGSIDE
     23  6b3e				  -	      lda	Board+2,x
     24  6b3e				  -	      bne	.noCastle
     25  6b3e				  -	      lda	Board+1,x
     26  6b3e				  -	      bne	.noCastle
     27  6b3e					      ENDIF
     28  6b3e
     29  6b3e
     30  6b3e
     31  6b3e
     32  6b3e
     33  6b3e
     34  6b3e
     35  6b3e
     36  6b3e		       a5 96		      lda	currentPiece
     37  6b40		       09 10		      ora	#FLAG_CASTLE
     38  6b42		       85 96		      sta	currentPiece
     39  6b44
     40  6b44				  -	      IF	QUEENSIDE = KINGSIDE
     41  6b44				  -	      ldy	ValidSquare+2,x
     42  6b44					      ENDIF
     43  6b44
     44  6b44					      IF	QUEENSIDE = QUEENSIDE
     45  6b44		       bc 16 f0 	      ldy	ValidSquare-2,x
     46  6b47					      ENDIF
     47  6b47
     48  6b47		       20 b8 fc 	      jsr	AddMove
     49  6b4a
     50  6b4a				   .noCastle
     92  6b4a
     93  6b4a		       4c 7f fa    .exit      jmp	MoveReturn
     94  6b4d
     95  6b4d							;---------------------------------------------------------------------------------------------------
     96  6b4d							; EOF
------- FILE Handler_BANK1.asm
    121  6b4d
    122  6b4d
    123  6b4d							;---------------------------------------------------------------------------------------------------
    124  6b4d
    125  6b4d
      0  6b4d					      ALLOCATE	_Base64ToIndex, 64
      0  6b4d					      OPTIONAL_PAGEBREAK	"Table", 64
     10  6b4d					      LIST	ON
      0  6b4d					      DEF	_Base64ToIndex
      1  6b4d				   BANK__Base64ToIndex SET	_CURRENT_BANK
      2  6b4d				   _Base64ToIndex
      3  6b4d				   TEMPORARY_VAR SET	Overlay
      4  6b4d				   TEMPORARY_OFFSET SET	0
      5  6b4d					      SUBROUTINE
      0  6b4d					      DEF	Base64ToIndex
      1  6b4d				   BANK_Base64ToIndex SET	_CURRENT_BANK
      2  6b4d				   Base64ToIndex
      3  6b4d				   TEMPORARY_VAR SET	Overlay
      4  6b4d				   TEMPORARY_OFFSET SET	0
      5  6b4d					      SUBROUTINE
    128  6b4d							; Convert from 0-63 numbering into an index into the Chessboard
    129  6b4d
    130  6b4d		       16 17 18 19*	      .byte.b	22,23,24,25,26,27,28,29
    131  6b55		       20 21 22 23*	      .byte.b	32,33,34,35,36,37,38,39
    132  6b5d		       2a 2b 2c 2d*	      .byte.b	42,43,44,45,46,47,48,49
    133  6b65		       34 35 36 37*	      .byte.b	52,53,54,55,56,57,58,59
    134  6b6d		       3e 3f 40 41*	      .byte.b	62,63,64,65,66,67,68,69
    135  6b75		       48 49 4a 4b*	      .byte.b	72,73,74,75,76,77,78,79
    136  6b7d		       52 53 54 55*	      .byte.b	82,83,84,85,86,87,88,89
    137  6b85		       5c 5d 5e 5f*	      .byte.b	92,93,94,95,96,97,98,99
    138  6b8d
    139  6b8d
    140  6b8d							;---------------------------------------------------------------------------------------------------
    141  6b8d
      0  6b8d					      DEF	CopySetupForMarker
      1  6b8d				   BANK_CopySetupForMarker SET	_CURRENT_BANK
      2  6b8d				   CopySetupForMarker
      3  6b8d				   TEMPORARY_VAR SET	Overlay
      4  6b8d				   TEMPORARY_OFFSET SET	0
      5  6b8d					      SUBROUTINE
    143  6b8d					      SUBROUTINE
    144  6b8d
      0  6b8d					      VAR	__pieceColour, 1
      1  6b8d				   __pieceColour SET	TEMPORARY_VAR
      2  6b8d				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  6b8d
      4  6b8d				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  6b8d				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  6b8d				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  6b8d					      ENDIF
      8  6b8d				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  6b8d				  -	      ECHO	"Temporary Variable", __pieceColour, "overflow!"
     10  6b8d				  -	      ERR
     11  6b8d					      ENDIF
     12  6b8d					      LIST	ON
    146  6b8d
    147  6b8d		       a5 80		      lda	drawPieceNumber	;0-63
    148  6b8f		       4a		      lsr
    149  6b90		       4a		      lsr
    150  6b91		       4a		      lsr
    151  6b92		       18		      clc
    152  6b93		       65 80		      adc	drawPieceNumber
    153  6b95		       29 01		      and	#1
    154  6b97		       49 01		      eor	#1
    155  6b99		       f0 02		      beq	.white
    156  6b9b		       a9 24		      lda	#36
    157  6b9d				   .white
    158  6b9d		       85 a5		      sta	__pieceColour	; actually SQUARE black/white
    159  6b9f
    160  6b9f		       8a		      txa
    161  6ba0		       18		      clc
    162  6ba1		       65 a5		      adc	__pieceColour
    163  6ba3		       85 a5		      sta	__pieceColour
    164  6ba5
    165  6ba5
    166  6ba5		       a5 80		      lda	drawPieceNumber
    167  6ba7		       29 03		      and	#3	; shift position in PF
    168  6ba9		       18		      clc
    169  6baa		       65 a5		      adc	__pieceColour
    170  6bac		       a8		      tay
    171  6bad		       60		      rts
    172  6bae
    173  6bae
    174  6bae					      endif
    175  6bae
    176  6bae							;---------------------------------------------------------------------------------------------------
    177  6bae
    178  6bae
      0  6bae					      DEF	CopySetup
      1  6bae				   BANK_CopySetup SET	_CURRENT_BANK
      2  6bae				   CopySetup
      3  6bae				   TEMPORARY_VAR SET	Overlay
      4  6bae				   TEMPORARY_OFFSET SET	0
      5  6bae					      SUBROUTINE
    180  6bae					      SUBROUTINE
    181  6bae
    182  6bae							; figure colouration of square
    183  6bae
    184  6bae		       a5 80		      lda	drawPieceNumber	;0-63
    185  6bb0		       4a		      lsr
    186  6bb1		       4a		      lsr
    187  6bb2		       4a		      lsr
    188  6bb3		       18		      clc
    189  6bb4		       65 80		      adc	drawPieceNumber
    190  6bb6		       29 01		      and	#1
    191  6bb8		       49 01		      eor	#1
    192  6bba		       f0 02		      beq	.white
    193  6bbc		       a9 24		      lda	#36
    194  6bbe		       85 a5	   .white     sta	__pieceColour	; actually SQUARE black/white
    195  6bc0
    196  6bc0							; PieceColour = 0 for white square, 28 for black square
    197  6bc0
    198  6bc0							;lda #RAMBANK_MOVES_RAM
    199  6bc0							;sta SET_BANK_RAM
    200  6bc0
    201  6bc0		       a4 80		      ldy	drawPieceNumber	; 0-63
    202  6bc2		       be 4d f3 	      ldx	Base64ToIndex,y
    203  6bc5
    204  6bc5		       bd 7c f0 	      lda	Board,x
    205  6bc8		       0a		      asl
    206  6bc9		       90 02		      bcc	.blackAdjust
    207  6bcb		       09 10		      ora	#16
    208  6bcd		       4a	   .blackAdjust lsr
    209  6bce		       29 0f		      and	#%1111
    210  6bd0		       aa		      tax
    211  6bd1
    212  6bd1		       98		      tya
    213  6bd2		       29 03		      and	#3	; shift position in PF
    214  6bd4
    215  6bd4		       18		      clc
    216  6bd5		       7d dd f3 	      adc	PieceToShape,x
    217  6bd8		       18		      clc
    218  6bd9		       65 a5		      adc	__pieceColour
    219  6bdb		       a8		      tay
    220  6bdc		       60		      rts
    221  6bdd
    222  6bdd				   PieceToShape
    223  6bdd
    224  6bdd		       00		      .byte.b	INDEX_WHITE_BLANK_on_WHITE_SQUARE_0
    225  6bde		       04		      .byte.b	INDEX_WHITE_PAWN_on_WHITE_SQUARE_0
    226  6bdf		       4c		      .byte.b	INDEX_BLACK_PAWN_on_WHITE_SQUARE_0
    227  6be0		       08		      .byte.b	INDEX_WHITE_KNIGHT_on_WHITE_SQUARE_0
    228  6be1		       0c		      .byte.b	INDEX_WHITE_BISHOP_on_WHITE_SQUARE_0
    229  6be2		       10		      .byte.b	INDEX_WHITE_ROOK_on_WHITE_SQUARE_0
    230  6be3		       14		      .byte.b	INDEX_WHITE_QUEEN_on_WHITE_SQUARE_0
    231  6be4		       18		      .byte.b	INDEX_WHITE_KING_on_WHITE_SQUARE_0
    232  6be5
    233  6be5		       48		      .byte.b	INDEX_BLACK_BLANK_on_WHITE_SQUARE_0
    234  6be6		       04		      .byte.b	INDEX_WHITE_PAWN_on_WHITE_SQUARE_0
    235  6be7		       4c		      .byte.b	INDEX_BLACK_PAWN_on_WHITE_SQUARE_0
    236  6be8		       50		      .byte.b	INDEX_BLACK_KNIGHT_on_WHITE_SQUARE_0
    237  6be9		       54		      .byte.b	INDEX_BLACK_BISHOP_on_WHITE_SQUARE_0
    238  6bea		       58		      .byte.b	INDEX_BLACK_ROOK_on_WHITE_SQUARE_0
    239  6beb		       5c		      .byte.b	INDEX_BLACK_QUEEN_on_WHITE_SQUARE_0
    240  6bec		       60		      .byte.b	INDEX_BLACK_KING_on_WHITE_SQUARE_0
    241  6bed
    242  6bed
    243  6bed
    244  6bed
    245  6bed
    246  6bed							;    ds 20
    247  6bed
    248  6bed							;---------------------------------------------------------------------------------------------------
    249  6bed
    250  6bed
      0  6bed					      CHECK_HALF_BANK_SIZE	"HANDLER_BANK1 -- 1K"
      1  6bed
      2  6bed
      3  6bed		       03 ed	   .TEMP      =	* - BANK_START
 HANDLER_BANK1 -- 1K (1K) SIZE =  $3ed , FREE= $13
      4  6bed					      ECHO	"HANDLER_BANK1 -- 1K", "(1K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE/2 - .TEMP
      5  6bed				  -	      if	( .TEMP ) > ROM_BANK_SIZE/2
      6  6bed				  -	      ECHO	"HALF-BANK OVERFLOW @ ", * - ORIGIN
      7  6bed				  -	      ERR
      8  6bed					      endif
    252  6bed
    253  6bed
    254  6bed							; There is space here (1K) for use as ROM
    255  6bed							; but NOT when the above bank is switched in as RAM, of course!
    256  6bed
    257  6bed
    258  6bed							;---------------------------------------------------------------------------------------------------
    259  6bed
      0  6bed					      ALLOCATE	X12toBase64b, 100
      0  6bed					      OPTIONAL_PAGEBREAK	"Table", 100
 PAGE BREAK INSERTED FOR Table
 REQUESTED SIZE = $64
 WASTED SPACE = $13
 PAGEBREAK LOCATION = $f400
     10  6c00					      LIST	ON
      0  6c00					      DEF	X12toBase64b
      1  6c00				   BANK_X12toBase64b SET	_CURRENT_BANK
      2  6c00				   X12toBase64b
      3  6c00				   TEMPORARY_VAR SET	Overlay
      4  6c00				   TEMPORARY_OFFSET SET	0
      5  6c00					      SUBROUTINE
      0  6c00					      X12B64TABLE
      1  6c00
      2  6c00
      3  6c00
      4  6c00
      5  6c00
      6  6c00		       ff ff ff ff*	      .byte.b	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1
      7  6c0a		       ff ff ff ff*	      .byte.b	-1, -1, -1, -1, -1, -1, -1, -1, -1, -1
      8  6c14		       ff ff 00 01*	      .byte.b	-1, -1, 0, 1, 2, 3, 4, 5, 6, 7
      9  6c1e		       ff ff 08 09*	      .byte.b	-1, -1, 8, 9, 10, 11, 12, 13, 14, 15
     10  6c28		       ff ff 10 11*	      .byte.b	-1, -1, 16, 17, 18, 19, 20, 21, 22, 23
     11  6c32		       ff ff 18 19*	      .byte.b	-1, -1, 24, 25, 26, 27, 28, 29, 30, 31
     12  6c3c		       ff ff 20 21*	      .byte.b	-1, -1, 32, 33, 34, 35, 36, 37, 38, 39
     13  6c46		       ff ff 28 29*	      .byte.b	-1, -1, 40, 41, 42, 43, 44, 45, 46, 47
     14  6c50		       ff ff 30 31*	      .byte.b	-1, -1, 48, 49, 50, 51, 52, 53, 54, 55
     15  6c5a		       ff ff 38 39*	      .byte.b	-1, -1, 56, 57, 58, 59, 60, 61, 62, 63
    262  6c64
      0  6c64					      CHECK_BANK_SIZE	"HANDLER_BANK_1 -- full 2K"
      1  6c64		       04 64	   .TEMP      =	* - BANK_START
 HANDLER_BANK_1 -- full 2K (2K) SIZE =  $464 , FREE= $39c
      2  6c64					      ECHO	"HANDLER_BANK_1 -- full 2K", "(2K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE - .TEMP
      3  6c64				  -	      if	( .TEMP ) > ROM_BANK_SIZE
      4  6c64				  -	      ECHO	"BANK OVERFLOW @ ", * - ORIGIN
      5  6c64				  -	      ERR
      6  6c64					      endif
    264  6c64
    265  6c64
    266  6c64
    267  6c64							;---------------------------------------------------------------------------------------------------
    268  6c64							; EOF
------- FILE ./chess.asm
------- FILE ply.asm LEVEL 2 PASS 2
      0  6c64					      include	"ply.asm"
      1  6c64							; Copyright (C)2020 Andrew Davie
      2  6c64							; andrew@taswegian.com
      3  6c64
      4  6c64
      5  6c64							;---------------------------------------------------------------------------------------------------
      6  6c64							; Define the RAM banks
      7  6c64							; A "PLY" bank represents all the data required on any single ply of the search tree.
      8  6c64							; The banks are organised sequentially, MAX_PLY of them starting at RAMBANK_PLY
      9  6c64							; The startup code copies the ROM shadow into each of these PLY banks, and from then on
     10  6c64							; they act as independant switchable banks usable for data on each ply during the search.
     11  6c64							; A ply will hold the move list for that position
     12  6c64
     13  6c64
     14  6c64		       00 06	   MAX_PLY    =	6
      0  6c64					      NEWRAMBANK	PLY	; RAM bank for holding the following ROM shadow
      1  6c64
      2  6c64
      3  6c64
      4 U2400 ????				      SEG.U	PLY
      5 U2400					      ORG	ORIGIN_RAM
      6 U2400					      RORG	RAM_3E
      7 U2400				   BANK_START SET	*
      8 U2400				   RAMBANK_PLY SET	ORIGIN_RAM / RAM_SIZE
      9 U2400				   _CURRENT_RAMBANK SET	RAMBANK_PLY
     10 U2400				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
     16 U2400					      REPEAT	MAX_PLY-1
      0 U2400					      NEWRAMBANK	.DUMMY_PLY
      1 U2400
      2 U2400
      3 U2400
      4 U3800 ????				      SEG.U	.DUMMY_PLY
      5 U2800					      ORG	ORIGIN_RAM
      6 U2800					      RORG	RAM_3E
      7 U2800				   BANK_START SET	*
      8 U2800				   RAMBANK_.DUMMY_PLY SET	ORIGIN_RAM / RAM_SIZE
      9 U2800				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY_PLY
     10 U2800				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
     16 U2800					      REPEND
      0 U2800					      NEWRAMBANK	.DUMMY_PLY
      1 U2800
      2 U2800
      3 U2800
      4 U2800					      SEG.U	.DUMMY_PLY
      5 U2c00					      ORG	ORIGIN_RAM
      6 U2c00					      RORG	RAM_3E
      7 U2c00				   BANK_START SET	*
      8 U2c00				   RAMBANK_.DUMMY_PLY SET	ORIGIN_RAM / RAM_SIZE
      9 U2c00				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY_PLY
     10 U2c00				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
     16 U2c00					      REPEND
      0 U2c00					      NEWRAMBANK	.DUMMY_PLY
      1 U2c00
      2 U2c00
      3 U2c00
      4 U2c00					      SEG.U	.DUMMY_PLY
      5 U3000					      ORG	ORIGIN_RAM
      6 U3000					      RORG	RAM_3E
      7 U3000				   BANK_START SET	*
      8 U3000				   RAMBANK_.DUMMY_PLY SET	ORIGIN_RAM / RAM_SIZE
      9 U3000				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY_PLY
     10 U3000				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
     16 U3000					      REPEND
      0 U3000					      NEWRAMBANK	.DUMMY_PLY
      1 U3000
      2 U3000
      3 U3000
      4 U3000					      SEG.U	.DUMMY_PLY
      5 U3400					      ORG	ORIGIN_RAM
      6 U3400					      RORG	RAM_3E
      7 U3400				   BANK_START SET	*
      8 U3400				   RAMBANK_.DUMMY_PLY SET	ORIGIN_RAM / RAM_SIZE
      9 U3400				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY_PLY
     10 U3400				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
     16 U3400					      REPEND
      0 U3400					      NEWRAMBANK	.DUMMY_PLY
      1 U3400
      2 U3400
      3 U3400
      4 U3400					      SEG.U	.DUMMY_PLY
      5 U3800					      ORG	ORIGIN_RAM
      6 U3800					      RORG	RAM_3E
      7 U3800				   BANK_START SET	*
      8 U3800				   RAMBANK_.DUMMY_PLY SET	ORIGIN_RAM / RAM_SIZE
      9 U3800				   _CURRENT_RAMBANK SET	RAMBANK_.DUMMY_PLY
     10 U3800				   ORIGIN_RAM SET	ORIGIN_RAM + RAM_SIZE
     18 U3800					      REPEND
     19 U3800
     20 U3800
     21 U3800							;---------------------------------------------------------------------------------------------------
     22 U3800							; and now the ROM shadow - this is copied to ALL of the RAM ply banks
     23 U3800
      0 U3800					      NEWBANK	BANK_PLY	; ROM SHADOW
      1  73a5 ????				      SEG	BANK_PLY
      2  7000					      ORG	ORIGIN
      3  7000					      RORG	$F000
      4  7000				   BANK_START SET	*
      5  7000				   BANK_PLY   SET	ORIGIN / 2048
      6  7000				   ORIGIN     SET	ORIGIN + 2048
      7  7000				   _CURRENT_BANK SET	BANK_PLY
     25  7000
      0  7000					      DEF	XGetBoard
      1  7000				   BANK_XGetBoard SET	_CURRENT_BANK
      2  7000				   XGetBoard
      3  7000				   TEMPORARY_VAR SET	Overlay
      4  7000				   TEMPORARY_OFFSET SET	0
      5  7000					      SUBROUTINE
     27  7000		       a2 08		      ldx	#RAMBANK_MOVES_RAM
     28  7002		       86 3e		      stx	SET_BANK_RAM	; now executing in other bank
     29  7004		       00 00 00 00*	      ds	7
     30  700b		       60		      rts
      0  700c					      DEF	XGet64
      1  700c				   BANK_XGet64 SET	_CURRENT_BANK
      2  700c				   XGet64
      3  700c				   TEMPORARY_VAR SET	Overlay
      4  700c				   TEMPORARY_OFFSET SET	0
      5  700c					      SUBROUTINE
     32  700c		       a9 0d		      lda	#BANK_X12toBase64b
     33  700e		       85 3f		      sta	SET_BANK
     34  7010		       00 00 00 00*	      ds	7
     35  7017		       60		      rts
     36  7018
     37  7018							;---------------------------------------------------------------------------------------------------
     38  7018							; The piece-lists
     39  7018							; ONLY the very first bank piecelist is used - all other banks switch to the first for
     40  7018							; piecelist usage. Note that this initialisation (below) comes from the shadow ROM/RAM copy
     41  7018							; but this needs to be initialised programatically on new game.
     42  7018
     43  7018							; We have TWO piecelists, in different banks
     44  7018							; WHITE pieces in bank BANK_PLY
     45  7018							; BLACK pieces in bank BANK_PLY+1
     46  7018
     47  7018
     48  7018		       7f ff	   INFINITY   =	32767
     49  7018
     50  7018
      0  7018					      VARIABLE	SortedPieceList, 16	; indexes into PieceSquare, etc. NEG = no piece
      0  7018					      OPTIONAL_PAGEBREAK	"Variable", 16
     10  7018					      LIST	ON
      2  7018		       00 00 00 00*SortedPieceList ds	16
      0  7028					      VARIABLE	PieceSquare, 16
      0  7028					      OPTIONAL_PAGEBREAK	"Variable", 16
     10  7028					      LIST	ON
      2  7028		       00 00 00 00*PieceSquare ds	16
      0  7038					      VARIABLE	PieceType, 16
      0  7038					      OPTIONAL_PAGEBREAK	"Variable", 16
     10  7038					      LIST	ON
      2  7038		       00 00 00 00*PieceType  ds	16
      0  7048					      VARIABLE	PieceMaterialValueLO, 16
      0  7048					      OPTIONAL_PAGEBREAK	"Variable", 16
     10  7048					      LIST	ON
      2  7048		       00 00 00 00*PieceMaterialValueLO ds	16
      0  7058					      VARIABLE	PieceMaterialValueHI, 16
      0  7058					      OPTIONAL_PAGEBREAK	"Variable", 16
     10  7058					      LIST	ON
      2  7058		       00 00 00 00*PieceMaterialValueHI ds	16
      0  7068					      VARIABLE	PiecePositionValueLO, 16
      0  7068					      OPTIONAL_PAGEBREAK	"Variable", 16
     10  7068					      LIST	ON
      2  7068		       00 00 00 00*PiecePositionValueLO ds	16
      0  7078					      VARIABLE	PiecePositionValueHI, 16
      0  7078					      OPTIONAL_PAGEBREAK	"Variable", 16
     10  7078					      LIST	ON
      2  7078		       00 00 00 00*PiecePositionValueHI ds	16
      0  7088					      VARIABLE	PieceListPtr, 1
      0  7088					      OPTIONAL_PAGEBREAK	"Variable", 1
     10  7088					      LIST	ON
      2  7088		       00	   PieceListPtr ds	1
      0  7089					      VARIABLE	plyValue, 2	; 16-bit signed score value from alphabeta
      0  7089					      OPTIONAL_PAGEBREAK	"Variable", 2
     10  7089					      LIST	ON
      2  7089		       00 00	   plyValue   ds	2
      0  708b					      VARIABLE	bestMove, 1	; index of move (-1 = none)
      0  708b					      OPTIONAL_PAGEBREAK	"Variable", 1
     10  708b					      LIST	ON
      2  708b		       00	   bestMove   ds	1
      0  708c					      VARIABLE	SavedEvaluation, 2	; THIS node's evaluation - used for reverting moves!
      0  708c					      OPTIONAL_PAGEBREAK	"Variable", 2
     10  708c					      LIST	ON
      2  708c		       00 00	   SavedEvaluation ds	2
     62  708e
     63  708e
     64  708e							;---------------------------------------------------------------------------------------------------
     65  708e
     66  708e		       00 50	   MAX_MOVES  =	80
     67  708e
      0  708e					      VARIABLE	MoveFrom, MAX_MOVES
      0  708e					      OPTIONAL_PAGEBREAK	"Variable", MAX_MOVES
     10  708e					      LIST	ON
      2  708e		       00 00 00 00*MoveFrom   ds	MAX_MOVES
      0  70de					      VARIABLE	MoveTo, MAX_MOVES
      0  70de					      OPTIONAL_PAGEBREAK	"Variable", MAX_MOVES
 PAGE BREAK INSERTED FOR Variable
 REQUESTED SIZE = $50
 WASTED SPACE = $22
 PAGEBREAK LOCATION = $f100
     10  7100					      LIST	ON
      2  7100		       00 00 00 00*MoveTo     ds	MAX_MOVES
      0  7150					      VARIABLE	MovePiece, MAX_MOVES
      0  7150					      OPTIONAL_PAGEBREAK	"Variable", MAX_MOVES
     10  7150					      LIST	ON
      2  7150		       00 00 00 00*MovePiece  ds	MAX_MOVES
     71  71a0
     72  71a0
     73  71a0							;---------------------------------------------------------------------------------------------------
     74  71a0
     75  71a0							; The X12 square at which a pawn CAN be taken en-passant. Normally 0.
     76  71a0							; This is set/cleared whenever a move is made. The flag is indicated in the move description.
     77  71a0
      0  71a0					      VARIABLE	enPassantSquare, 1
      0  71a0					      OPTIONAL_PAGEBREAK	"Variable", 1
     10  71a0					      LIST	ON
      2  71a0		       00	   enPassantSquare ds	1
     79  71a1
     80  71a1
     81  71a1							;---------------------------------------------------------------------------------------------------
     82  71a1							; Move tables hold piece moves for this current ply
     83  71a1
      0  71a1					      VARIABLE	moveIndex, 1	; points to first available 'slot' for move storage
      0  71a1					      OPTIONAL_PAGEBREAK	"Variable", 1
     10  71a1					      LIST	ON
      2  71a1		       00	   moveIndex  ds	1
     85  71a2
     86  71a2
     87  71a2							;---------------------------------------------------------------------------------------------------
     88  71a2
     89  71a2
     90  71a2				  -	      if	0
     91  71a2				  -			; reverting a move
     92  71a2				  -			; from/to/piece/toOriginal
     93  71a2				  -			; castling   affects 4 squares (2xfrom/to each with original piece)
     94  71a2				  -			; en-passant
     95  71a2				  -
     96  71a2				  -from/to/piece
     97  71a2				  -
     98  71a2				  -
     99  71a2				  -from       =	piece
    100  71a2				  -to	      =	originalPiece
    101  71a2				  -from2      =	piece2
    102  71a2				  -to2	      =	originalPiece2
    103  71a2				  -
    104  71a2				  -
    105  71a2				  -
    106  71a2				  -so,	      normal	move (N)
    107  71a2				  -
    108  71a2				  -B1	      =	knight
    109  71a2				  -C3	      =	blank
    110  71a2				  -null/null
    111  71a2				  -
    112  71a2				  -pawn       promot	with capture
    113  71a2				  -A7	      =	WP
    114  71a2				  -B8	      =	BLACK_ROOK
    115  71a2				  -
    116  71a2				  -
    117  71a2				  -castle
    118  71a2				  -E1	      =	king
    119  71a2				  -G1	      =	blank
    120  71a2				  -H1	      =	rook
    121  71a2				  -F1	      =	blank
    122  71a2				  -
    123  71a2				  -
    124  71a2				  -en-passant
    125  71a2				  -B4	      =	P
    126  71a2				  -A3	      =	blank
    127  71a2				  -A4	      =	P
    128  71a2				  -A3	      =	blank
    129  71a2				  -
    130  71a2				  -FROM
    131  71a2				  -TO
    132  71a2				  -CAPTURED_PIECE
    133  71a2				  -ORIG_PIECE
    134  71a2				  -FROM2
    135  71a2				  -TO2
    136  71a2				  -PIECE2
    137  71a2				  -
    138  71a2				  -board[FROM] =	ORIG_PIECE
    139  71a2				  -board[TO]  =	CAPTURED_PIECE
    140  71a2				  -
    141  71a2				  -value      =	-new_piece + orig_piece - captured_piece
    142  71a2				  -
    143  71a2				  -
    144  71a2					      endif
    145  71a2
    146  71a2
    147  71a2
    148  71a2							;---------------------------------------------------------------------------------------------------
    149  71a2
      0  71a2					      DEF	InitPieceLists
      1  71a2				   BANK_InitPieceLists SET	_CURRENT_BANK
      2  71a2				   InitPieceLists
      3  71a2				   TEMPORARY_VAR SET	Overlay
      4  71a2				   TEMPORARY_OFFSET SET	0
      5  71a2					      SUBROUTINE
    151  71a2
    152  71a2		       a9 ff		      lda	#-1
    153  71a4		       8d 88 f4 	      sta	PieceListPtr+RAM_WRITE
    154  71a7
    155  71a7		       a2 0f		      ldx	#15
    156  71a9		       a9 00		      lda	#0
    157  71ab		       9d 18 f4    .clearLists sta	SortedPieceList+RAM_WRITE,x
    158  71ae		       9d 28 f4 	      sta	PieceSquare+RAM_WRITE,x
    159  71b1		       9d 38 f4 	      sta	PieceType+RAM_WRITE,x
    160  71b4		       ca		      dex
    161  71b5		       10 f4		      bpl	.clearLists
    162  71b7
    163  71b7
    164  71b7							; TODO: move the following as they're called 2x due to double-call of InitPiecLists
    165  71b7
    166  71b7		       85 94		      sta	Evaluation
    167  71b9		       85 95		      sta	Evaluation+1	; tracks CURRENT value of everything (signed 16-bit)
    168  71bb
    169  71bb
    170  71bb							; General inits that are moved out of FIXED....
    171  71bb
    172  71bb
    173  71bb		       a9 07		      lda	#%111	; 111= quad
    174  71bd		       85 44		      sta	NUSIZ0
    175  71bf		       85 45		      sta	NUSIZ1	; quad-width
    176  71c1
    177  71c1
    178  71c1
    179  71c1
    180  71c1		       a9 04		      lda	#%00000100
    181  71c3		       85 4a		      sta	CTRLPF
    182  71c5		       a9 00		      lda	#BACKGCOL
    183  71c7		       85 49		      sta	COLUBK
    184  71c9
      0  71c9					      PHASE	AI_StartClearBoard
      1  71c9		       a9 0d		      lda	#AI_StartClearBoard
      2  71cb		       85 8c		      sta	aiPhase
    186  71cd		       60		      rts
    187  71ce
    188  71ce
    189  71ce							;---------------------------------------------------------------------------------------------------
    190  71ce
    191  71ce					      if	ASSERTS
    192  71ce
      0  71ce					      DEF	checkPiecesBank
      1  71ce				   BANK_checkPiecesBank SET	_CURRENT_BANK
      2  71ce				   checkPiecesBank
      3  71ce				   TEMPORARY_VAR SET	Overlay
      4  71ce				   TEMPORARY_OFFSET SET	0
      5  71ce					      SUBROUTINE
    194  71ce					      SUBROUTINE
    195  71ce
      0  71ce					      VAR	__x, 1
      1  71ce				   __x	      SET	TEMPORARY_VAR
      2  71ce				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  71ce
      4  71ce				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  71ce				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  71ce				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  71ce					      ENDIF
      8  71ce				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  71ce				  -	      ECHO	"Temporary Variable", __x, "overflow!"
     10  71ce				  -	      ERR
     11  71ce					      ENDIF
     12  71ce					      LIST	ON
      0  71ce					      VAR	__bank, 1
      1  71ce				   __bank     SET	TEMPORARY_VAR
      2  71ce				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  71ce
      4  71ce				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  71ce				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  71ce				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  71ce					      ENDIF
      8  71ce				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  71ce				  -	      ECHO	"Temporary Variable", __bank, "overflow!"
     10  71ce				  -	      ERR
     11  71ce					      ENDIF
     12  71ce					      LIST	ON
    198  71ce
    199  71ce							; odd usage - switches between concurrent bank code
    200  71ce
    201  71ce		       a2 0f		      ldx	#15
    202  71d0		       a5 a6	   .check     lda	__bank
    203  71d2		       85 3e		      sta	SET_BANK_RAM
    204  71d4		       bc 28 f0 	      ldy	PieceSquare,x
    205  71d7		       f0 0d		      beq	.nonehere
    206  71d9
    207  71d9		       86 a5		      stx	__x
    208  71db
    209  71db		       20 00 f0 	      jsr	XGetBoard
    210  71de		       f0 fe	   .fail      beq	.fail
    211  71e0		       c9 ff		      cmp	#-1
    212  71e2		       f0 fe	   .fail2     beq	.fail2
    213  71e4
    214  71e4		       a6 a5		      ldx	__x
    215  71e6
    216  71e6		       ca	   .nonehere  dex
    217  71e7		       10 e7		      bpl	.check
    218  71e9		       60		      rts
    219  71ea
    220  71ea
    221  71ea							;---------------------------------------------------------------------------------------------------
    222  71ea
      0  71ea					      DEF	DIAGNOSTIC_checkPieces
      1  71ea				   BANK_DIAGNOSTIC_checkPieces SET	_CURRENT_BANK
      2  71ea				   DIAGNOSTIC_checkPieces
      3  71ea				   TEMPORARY_VAR SET	Overlay
      4  71ea				   TEMPORARY_OFFSET SET	0
      5  71ea					      SUBROUTINE
    224  71ea					      SUBROUTINE
    225  71ea
    226  71ea							; SAFE call
    227  71ea							; DIAGNOSTIC ONLY
    228  71ea							; Scan the piecelist and the board square it points to and make sure non blank, non -1
    229  71ea
    230  71ea		       a9 09		      lda	#RAMBANK_PLY
    231  71ec		       85 a6		      sta	__bank
    232  71ee		       20 ce f1 	      jsr	checkPiecesBank
    233  71f1		       e6 a6		      inc	__bank
    234  71f3		       20 ce f1 	      jsr	checkPiecesBank
    235  71f6		       60		      rts
    236  71f7
    237  71f7					      endif
    238  71f7
    239  71f7
    240  71f7							;---------------------------------------------------------------------------------------------------
    241  71f7
    242  71f7				   InitPieceList
    243  71f7
------- FILE setup_board.asm LEVEL 3 PASS 2
      0  71f7					      include	"setup_board.asm"
      1  71f7					      if	!TEST_POSITION
      2  71f7
      3  71f7		       06 19		      .byte.b	WHITE|Q, 25
      4  71f9		       04 18		      .byte.b	WHITE|B, 24
      5  71fb		       04 1b		      .byte.b	WHITE|B, 27
      6  71fd		       05 16		      .byte.b	WHITE|R, 22
      7  71ff		       05 1d		      .byte.b	WHITE|R, 29
      8  7201		       03 17		      .byte.b	WHITE|N, 23
      9  7203		       03 1c		      .byte.b	WHITE|N, 28
     10  7205
     11  7205		       01 23		      .byte.b	WHITE|WP, 35
     12  7207		       01 24		      .byte.b	WHITE|WP, 36
     13  7209		       01 22		      .byte.b	WHITE|WP, 34
     14  720b		       01 25		      .byte.b	WHITE|WP, 37
     15  720d		       01 21		      .byte.b	WHITE|WP, 33
     16  720f		       01 26		      .byte.b	WHITE|WP, 38
     17  7211		       01 20		      .byte.b	WHITE|WP, 32
     18  7213		       01 27		      .byte.b	WHITE|WP, 39
     19  7215
     20  7215		       07 1a		      .byte.b	WHITE|K, 26
     21  7217
     22  7217		       86 5f		      .byte.b	BLACK|Q, 95
     23  7219		       84 5e		      .byte.b	BLACK|B, 94
     24  721b		       84 61		      .byte.b	BLACK|B, 97
     25  721d		       85 5c		      .byte.b	BLACK|R, 92
     26  721f		       85 63		      .byte.b	BLACK|R, 99
     27  7221		       83 5d		      .byte.b	BLACK|N, 93
     28  7223		       83 62		      .byte.b	BLACK|N, 98
     29  7225
     30  7225		       82 55		      .byte.b	BLACK|BP, 85
     31  7227		       82 56		      .byte.b	BLACK|BP, 86
     32  7229		       82 54		      .byte.b	BLACK|BP, 84
     33  722b		       82 57		      .byte.b	BLACK|BP, 87
     34  722d		       82 53		      .byte.b	BLACK|BP, 83
     35  722f		       82 58		      .byte.b	BLACK|BP, 88
     36  7231		       82 52		      .byte.b	BLACK|BP, 82
     37  7233		       82 59		      .byte.b	BLACK|BP, 89
     38  7235
     39  7235		       87 60		      .byte.b	BLACK|K, 96
     40  7237
     41  7237		       00		      .byte.b	0	;end
     42  7238
     43  7238				  -	      else		; test position...
     44  7238				  -
     45  7238				  -	      .byte	WHITE|WP, 88
     46  7238				  -	      .byte	BLACK|BISHOP, 97
     47  7238				  -
     48  7238				  -	      .byte	BLACK|BP, 82
     49  7238				  -
     50  7238				  -
     51  7238				  -	      .byte	0	;end
     52  7238				  -
     53  7238					      endif
------- FILE ply.asm
    245  7238
    246  7238
    247  7238							;---------------------------------------------------------------------------------------------------
    248  7238
    249  7238
      0  7238					      DEF	NewPlyInitialise
      1  7238				   BANK_NewPlyInitialise SET	_CURRENT_BANK
      2  7238				   NewPlyInitialise
      3  7238				   TEMPORARY_VAR SET	Overlay
      4  7238				   TEMPORARY_OFFSET SET	0
      5  7238					      SUBROUTINE
    251  7238
    252  7238							; This MUST be called at the start of a new ply
    253  7238							; It initialises the movelist to empty
    254  7238
    255  7238		       a2 ff		      ldx	#-1
    256  723a		       8e a1 f5 	      stx	moveIndex+RAM_WRITE	; no valid moves
    257  723d		       8d 8b f4 	      sta	bestMove+RAM_WRITE
    258  7240
    259  7240		       a5 99		      lda	enPassantPawn	; flag/square from last actual move made
    260  7242		       8d a0 f5 	      sta	enPassantSquare+RAM_WRITE	; used for backtracking, to reset the flag
    261  7245
    262  7245							; The evaluation of the current position is a signed 16-bit number
    263  7245							; +ve is good for the current side.
    264  7245							; This is used during the alpha-beta search for finding best position
    265  7245							; Note, this is not the same as the 'Evaluation' which is the current value at ply -- it is the
    266  7245							; alphabeta best/worst value of the node!!
    267  7245
    268  7245		       a9 01		      lda	#<(-INFINITY)
    269  7247		       8d 89 f4 	      sta	plyValue+RAM_WRITE
    270  724a		       a9 80		      lda	#>(-INFINITY)
    271  724c		       8d 8a f4 	      sta	plyValue+RAM_WRITE+1
    272  724f
    273  724f							; The value of the material (signed, 16-bit) is restored to the saved value at the reversion
    274  724f							; of a move. It's quicker to restore than to re-sum. So we save the current evaluation at the
    275  724f							; start of each new ply.
    276  724f
    277  724f		       a5 94		      lda	Evaluation
    278  7251		       8d 8c f4 	      sta	SavedEvaluation+RAM_WRITE
    279  7254		       a5 95		      lda	Evaluation+1
    280  7256		       8d 8d f4 	      sta	SavedEvaluation+RAM_WRITE+1
    281  7259
    282  7259		       a9 00		      lda	#0
    283  725b		       85 9c		      sta	piecelistIndex	; move traversing
    284  725d
    285  725d		       60		      rts
    286  725e
    287  725e
    288  725e							;---------------------------------------------------------------------------------------------------
    289  725e
      0  725e					      DEF	GenerateMovesForNextPiece
      1  725e				   BANK_GenerateMovesForNextPiece SET	_CURRENT_BANK
      2  725e				   GenerateMovesForNextPiece
      3  725e				   TEMPORARY_VAR SET	Overlay
      4  725e				   TEMPORARY_OFFSET SET	0
      5  725e					      SUBROUTINE
    291  725e
    292  725e		       a5 9c		      lda	piecelistIndex
    293  7260		       29 0f		      and	#15
    294  7262		       aa		      tax
    295  7263
    296  7263		       a5 9d		      lda	sideToMove
    297  7265		       0a		      asl
    298  7266		       a9 09		      lda	#RAMBANK_PLY	; W piecelist in "PLY0" bank, and B in "PLY1"
    299  7268		       69 00		      adc	#0
    300  726a		       85 3e		      sta	SET_BANK_RAM	; ooh! self-switching bank
    301  726c
    302  726c		       bd 28 f0 	      lda	PieceSquare,x
    303  726f		       f0 05		      beq	.noPieceHere	; piece deleted
    304  7271		       85 97		      sta	currentSquare
    305  7273
    306  7273							;lda enPassantSquare		  ; saved from previous side's move...
    307  7273							;sta enPassantPawn		  ; used for move generation
    308  7273
    309  7273		       20 5c fa 	      jsr	MoveForSinglePiece
    310  7276
    311  7276		       e6 9c	   .noPieceHere inc	piecelistIndex
    312  7278
    313  7278
    314  7278		       a5 9c		      lda	piecelistIndex
    315  727a		       29 0f		      and	#15
    316  727c		       c9 00		      cmp	#0
    317  727e		       f0 07		      beq	.stop
    318  7280
    319  7280		       ad 84 02 	      lda	INTIM
    320  7283		       c9 16		      cmp	#22
    321  7285		       b0 d7		      bcs	GenerateMovesForNextPiece
    322  7287
    323  7287
    324  7287		       60	   .stop      rts
    325  7288
    326  7288
    327  7288							;---------------------------------------------------------------------------------------------------
    328  7288
      0  7288					      DEF	GetMaterialValue
      1  7288				   BANK_GetMaterialValue SET	_CURRENT_BANK
      2  7288				   GetMaterialValue
      3  7288				   TEMPORARY_VAR SET	Overlay
      4  7288				   TEMPORARY_OFFSET SET	0
      5  7288					      SUBROUTINE
    330  7288					      SUBROUTINE
    331  7288
      0  7288					      VAR	__material, 2
      1  7288				   __material SET	TEMPORARY_VAR
      2  7288				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 2
      3  7288
      4  7288				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  7288				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  7288				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  7288					      ENDIF
      8  7288				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  7288				  -	      ECHO	"Temporary Variable", __material, "overflow!"
     10  7288				  -	      ERR
     11  7288					      ENDIF
     12  7288					      LIST	ON
    333  7288
    334  7288				  -	      if	0
    335  7288				  -	      lda	#0
    336  7288				  -	      sta	__material
    337  7288				  -	      sta	__material+1
    338  7288				  -
    339  7288				  -	      ldx	#15
    340  7288				  -.sum       lda	PieceSquare,x
    341  7288				  -	      beq	.dead
    342  7288				  -
    343  7288				  -	      clc
    344  7288				  -	      lda	__material
    345  7288				  -	      adc	PieceMaterialValueLO,x
    346  7288				  -	      sta	__material
    347  7288				  -	      lda	__material+1
    348  7288				  -	      adc	PieceMaterialValueHI,x
    349  7288				  -	      sta	__material+1
    350  7288				  -
    351  7288				  -.dead      dex
    352  7288				  -	      bpl	.sum
    353  7288					      endif
    354  7288		       60		      rts
    355  7289
    356  7289
    357  7289							;---------------------------------------------------------------------------------------------------
    358  7289
      0  7289					      DEF	FixPieceList
      1  7289				   BANK_FixPieceList SET	_CURRENT_BANK
      2  7289				   FixPieceList
      3  7289				   TEMPORARY_VAR SET	Overlay
      4  7289				   TEMPORARY_OFFSET SET	0
      5  7289					      SUBROUTINE
    360  7289					      SUBROUTINE
    361  7289
    362  7289							; fromX12	      X12 square piece moved from
    363  7289							; toX12	      X12 square piece moved to (0 to erase piece from list)
    364  7289
    365  7289							; It scans the piece list looking for the '__from' square and sets it to the '__to' square
    366  7289							; Eventually this will have to be more sophisticated when moves (like castling) involve
    367  7289							; more than one piece.
    368  7289
    369  7289							; TODO: this is slow and should use a pointer to pieces instead
    370  7289
    371  7289
    372  7289		       a2 0f		      ldx	#15
    373  728b		       a5 85		      lda	fromX12
    374  728d		       dd 28 f0    .pieceCheck cmp	PieceSquare,x
    375  7290		       f0 04		      beq	.adjustPiece
    376  7292		       ca		      dex
    377  7293		       10 f8		      bpl	.pieceCheck
    378  7295		       60		      rts
    379  7296
    380  7296		       a5 86	   .adjustPiece lda	toX12
    381  7298		       9d 28 f4 	      sta	PieceSquare+RAM_WRITE,x
    382  729b		       60		      rts
    383  729c
    384  729c
    385  729c							;---------------------------------------------------------------------------------------------------
    386  729c
      0  729c					      DEF	alphaBeta
      1  729c				   BANK_alphaBeta SET	_CURRENT_BANK
      2  729c				   alphaBeta
      3  729c				   TEMPORARY_VAR SET	Overlay
      4  729c				   TEMPORARY_OFFSET SET	0
      5  729c					      SUBROUTINE
    388  729c					      SUBROUTINE
    389  729c
    390  729c
    391  729c				  -	      if	0
    392  729c				  -
    393  729c				  -1.	      create	movelist
    394  729c				  -2.	      init	score
    395  729c				  -
    396  729c				  -
    397  729c				  -
    398  729c				  -
    399  729c				  -
    400  729c				  -
    401  729c				  -
    402  729c					      endif
    403  729c
    404  729c
    405  729c
    406  729c
    407  729c		       60		      rts
    408  729d		       e6 9b		      inc	currentPly
    409  729f		       a5 9b		      lda	currentPly
    410  72a1
    411  72a1		       c9 0f		      cmp	#MAX_PLY+RAMBANK_PLY
    412  72a3		       f0 31		      beq	.bottomOut	; at a leaf node of the search?
    413  72a5		       85 3e		      sta	SET_BANK_RAM	; self-referential weirdness!
    414  72a7
    415  72a7		       a5 9d		      lda	sideToMove
    416  72a9		       49 80		      eor	#128
    417  72ab		       85 9d		      sta	sideToMove
    418  72ad
    419  72ad		       20 38 f2 	      jsr	NewPlyInitialise
    420  72b0
    421  72b0		       a5 9b		      lda	currentPly
    422  72b2		       85 3e		      sta	SET_BANK_RAM
    423  72b4
    424  72b4		       a9 00		      lda	#0
    425  72b6		       85 9c		      sta	piecelistIndex
    426  72b8		       20 5e f2    iterPieces jsr	GenerateMovesForNextPiece
    427  72bb		       a5 9c		      lda	piecelistIndex
    428  72bd		       c9 0f		      cmp	#15
    429  72bf		       d0 f7		      bne	iterPieces
    430  72c1
    431  72c1							; Perform a recursive search
    432  72c1							; simulate alpha-beta cull to just 7 moves per node
    433  72c1
    434  72c1					      REPEAT	7
    435  72c1							;jsr PhysicallyMovePiece
    436  72c1							;jsr FinaliseMove
    437  72c1		       20 9c f2 	      jsr	alphaBeta
    434  72c1					      REPEND
    435  72c4							;jsr PhysicallyMovePiece
    436  72c4							;jsr FinaliseMove
    437  72c4		       20 9c f2 	      jsr	alphaBeta
    434  72c4					      REPEND
    435  72c7							;jsr PhysicallyMovePiece
    436  72c7							;jsr FinaliseMove
    437  72c7		       20 9c f2 	      jsr	alphaBeta
    434  72c7					      REPEND
    435  72ca							;jsr PhysicallyMovePiece
    436  72ca							;jsr FinaliseMove
    437  72ca		       20 9c f2 	      jsr	alphaBeta
    434  72ca					      REPEND
    435  72cd							;jsr PhysicallyMovePiece
    436  72cd							;jsr FinaliseMove
    437  72cd		       20 9c f2 	      jsr	alphaBeta
    434  72cd					      REPEND
    435  72d0							;jsr PhysicallyMovePiece
    436  72d0							;jsr FinaliseMove
    437  72d0		       20 9c f2 	      jsr	alphaBeta
    434  72d0					      REPEND
    435  72d3							;jsr PhysicallyMovePiece
    436  72d3							;jsr FinaliseMove
    437  72d3		       20 9c f2 	      jsr	alphaBeta
    438  72d6					      REPEND
    439  72d6
    440  72d6				   .bottomOut
    441  72d6
    442  72d6							; TODO: evaluate board position
    443  72d6							; reverse move to previous position
    444  72d6							; check the results, update scores and move pointers
    445  72d6							; and return vars to expected
    446  72d6
    447  72d6		       a5 9d		      lda	sideToMove
    448  72d8		       49 80		      eor	#128
    449  72da		       85 9d		      sta	sideToMove
    450  72dc
    451  72dc		       c6 9b		      dec	currentPly
    452  72de		       a5 9b		      lda	currentPly
    453  72e0		       85 3e		      sta	SET_BANK_RAM	; self-referential weirdness!
    454  72e2
    455  72e2		       60		      rts
    456  72e3
    457  72e3							;---------------------------------------------------------------------------------------------------
    458  72e3
      0  72e3					      DEF	RevertMove
      1  72e3				   BANK_RevertMove SET	_CURRENT_BANK
      2  72e3				   RevertMove
      3  72e3				   TEMPORARY_VAR SET	Overlay
      4  72e3				   TEMPORARY_OFFSET SET	0
      5  72e3					      SUBROUTINE
    460  72e3					      SUBROUTINE
    461  72e3
    462  72e3							; backtrack after a move, restoring things to the way they were
    463  72e3
    464  72e3
    465  72e3							; piecelist
    466  72e3							; piece1, piece2
    467  72e3							; board
    468  72e3							; enpassantpawn
    469  72e3							; materialvalue
    470  72e3							; positionvalue
    471  72e3							; score?
    472  72e3
    473  72e3
    474  72e3							; restore the board evaluation to what it was at the start of this ply
    475  72e3
    476  72e3		       ad 8c f0 	      lda	SavedEvaluation
    477  72e6		       85 94		      sta	Evaluation
    478  72e8		       ad 8d f0 	      lda	SavedEvaluation+1
    479  72eb		       85 95		      sta	Evaluation+1
    480  72ed
    481  72ed		       60		      rts
    482  72ee
    483  72ee
    484  72ee							;---------------------------------------------------------------------------------------------------
    485  72ee
      0  72ee					      DEF	MoveViaListAtPly
      1  72ee				   BANK_MoveViaListAtPly SET	_CURRENT_BANK
      2  72ee				   MoveViaListAtPly
      3  72ee				   TEMPORARY_VAR SET	Overlay
      4  72ee				   TEMPORARY_OFFSET SET	0
      5  72ee					      SUBROUTINE
    487  72ee					      SUBROUTINE
    488  72ee
    489  72ee		       ac a1 f1 	      ldy	moveIndex
    490  72f1		       30 3e		      bmi	halted	; no valid moves (stalemate if not in check)
    491  72f3
      0  72f3					      NEXT_RANDOM
      1  72f3		       a5 81		      lda	rnd
      2  72f5		       4a		      lsr
      3  72f6		       90 02		      bcc	.skipEOR
      4  72f8		       49 fe		      eor	#RND_EOR_VAL
      5  72fa		       85 81	   .skipEOR   sta	rnd
    493  72fc
    494  72fc							; int(random * # moves) --> a random move #
    495  72fc
    496  72fc		       a9 00		      lda	#0
    497  72fe		       aa		      tax		; selected move
    498  72ff		       18		      clc
    499  7300		       65 81	   .mulxcc    adc	rnd
    500  7302		       90 02		      bcc	.mulx
    501  7304		       18		      clc
    502  7305		       e8		      inx
    503  7306		       88	   .mulx      dey
    504  7307		       10 f7		      bpl	.mulxcc
    505  7309
    506  7309					      IF	ASSERTS
    507  7309							; Catch illgal move/index
    508  7309		       ec a1 f1 	      cpx	moveIndex
    509  730c		       f0 02		      beq	.ok
    510  730e		       b0 fe	   .whoops    bcs	.whoops
    511  7310				   .ok
    512  7310					      ENDIF
    513  7310
    514  7310
    515  7310							; fall through...
    516  7310							;---------------------------------------------------------------------------------------------------
    517  7310
    518  7310							;DEF PhysicallyMovePiece
    519  7310
    520  7310				   .foundMove
    521  7310		       bd 8e f0 	      lda	MoveFrom,x
    522  7313		       85 9e		      sta	fromSquare
    523  7315		       85 85		      sta	fromX12
    524  7317		       bd 00 f1 	      lda	MoveTo,x
    525  731a		       85 a0		      sta	toSquare
    526  731c		       85 86		      sta	toX12
    527  731e
    528  731e		       bd 50 f1 	      lda	MovePiece,x
    529  7321							;ora #FLAG_MOVED		 ; prevents usage in castling (for K/R)
    530  7321		       85 9f		      sta	fromPiece	; MIGHT have castling bit set, which should be handled last
    531  7323
    532  7323		       a6 9e		      ldx	fromSquare
    533  7325		       20 0c f0 	      jsr	XGet64
    534  7328							;		      ldy X12toBase64,x
    535  7328		       84 9e		      sty	fromSquare	; B64
    536  732a
    537  732a		       a6 a0		      ldx	toSquare
    538  732c		       20 0c f0 	      jsr	XGet64
    539  732f							;ldy X12toBase64,x
    540  732f		       84 a0		      sty	toSquare	; B64
    541  7331
    542  7331		       60	   halted     rts
    543  7332
    544  7332
    545  7332							;---------------------------------------------------------------------------------------------------
    546  7332
      0  7332					      DEF	CheckMoveListFromSquare
      1  7332				   BANK_CheckMoveListFromSquare SET	_CURRENT_BANK
      2  7332				   CheckMoveListFromSquare
      3  7332				   TEMPORARY_VAR SET	Overlay
      4  7332				   TEMPORARY_OFFSET SET	0
      5  7332					      SUBROUTINE
    548  7332					      SUBROUTINE
    549  7332
    550  7332							; X12 in A
    551  7332							; y = -1 on return if NOT FOUND
    552  7332
    553  7332		       ac a1 f1 	      ldy	moveIndex
    554  7335		       30 0d		      bmi	.failed
    555  7337
    556  7337		       d9 8e f0    .scan      cmp	MoveFrom,y
    557  733a		       f0 03		      beq	.scanned
    558  733c		       88		      dey
    559  733d		       10 f8		      bpl	.scan
    560  733f
    561  733f		       b9 50 f1    .scanned   lda	MovePiece,y
    562  7342							;and #PIECE_MASK
    563  7342		       85 a4		      sta	aiPiece
    564  7344
    565  7344		       60	   .failed    rts
    566  7345
    567  7345
    568  7345							;---------------------------------------------------------------------------------------------------
    569  7345
      0  7345					      DEF	IsSquareUnderAttack
      1  7345				   BANK_IsSquareUnderAttack SET	_CURRENT_BANK
      2  7345				   IsSquareUnderAttack
      3  7345				   TEMPORARY_VAR SET	Overlay
      4  7345				   TEMPORARY_OFFSET SET	0
      5  7345					      SUBROUTINE
    571  7345					      SUBROUTINE
    572  7345
    573  7345							; Scan the movelist to find if given square is under attack
    574  7345
    575  7345							; Pass:	 A = X12 square to check
    576  7345							; Return:	 CC = no
    577  7345
    578  7345		       ac a1 f1 	      ldy	moveIndex
    579  7348		       30 08		      bmi	.exit
    580  734a		       d9 00 f1    .scan      cmp	MoveTo,y
    581  734d		       f0 04		      beq	.found	; YES!
    582  734f		       88		      dey
    583  7350		       10 f8		      bpl	.scan
    584  7352
    585  7352		       18	   .exit      clc
    586  7353		       60	   .found     rts
    587  7354
    588  7354
    589  7354							;---------------------------------------------------------------------------------------------------
    590  7354
      0  7354					      DEF	GetKingSquare
      1  7354				   BANK_GetKingSquare SET	_CURRENT_BANK
      2  7354				   GetKingSquare
      3  7354				   TEMPORARY_VAR SET	Overlay
      4  7354				   TEMPORARY_OFFSET SET	0
      5  7354					      SUBROUTINE
    592  7354					      SUBROUTINE
    593  7354
    594  7354							; Return:	 a = square king is on (or -1)
    595  7354
    596  7354		       ac 88 f0 	      ldy	PieceListPtr
    597  7357		       30 0c		      bmi	.exit	; no pieces?!
    598  7359		       b9 38 f0    .find      lda	PieceType,y
    599  735c		       29 0f		      and	#PIECE_MASK
    600  735e		       c9 07		      cmp	#KING
    601  7360		       f0 06		      beq	.found
    602  7362		       88		      dey
    603  7363		       10 f4		      bpl	.find
    604  7365
    605  7365		       a9 ff	   .exit      lda	#-1	; not found/no king square
    606  7367		       60		      rts
    607  7368
    608  7368		       b9 28 f0    .found     lda	PieceSquare,y
    609  736b		       be 38 f0 	      ldx	PieceType,y
    610  736e		       60		      rts
    611  736f
    612  736f
    613  736f							;---------------------------------------------------------------------------------------------------
    614  736f
      0  736f					      DEF	GetPieceGivenFromToSquares
      1  736f				   BANK_GetPieceGivenFromToSquares SET	_CURRENT_BANK
      2  736f				   GetPieceGivenFromToSquares
      3  736f				   TEMPORARY_VAR SET	Overlay
      4  736f				   TEMPORARY_OFFSET SET	0
      5  736f					      SUBROUTINE
    616  736f					      SUBROUTINE
    617  736f
    618  736f							; We need to get the piece from the movelist because it contains flags (e.g., castling) about
    619  736f							; the move. We need to do from/to checks because moves can have multiple origin/desinations.
    620  736f							; This fixes the move with/without castle flag
    621  736f
    622  736f		       ac a1 f1 	      ldy	moveIndex
    623  7372		       30 11		      bmi	.fail	; shouldn't happen
    624  7374		       a5 85	   .scan      lda	fromX12
    625  7376		       d9 8e f0 	      cmp	MoveFrom,y
    626  7379		       d0 07		      bne	.next
    627  737b		       a5 86		      lda	toX12
    628  737d		       d9 00 f1 	      cmp	MoveTo,y
    629  7380		       f0 04		      beq	.found
    630  7382		       88	   .next      dey
    631  7383		       10 ef		      bpl	.scan
    632  7385		       60	   .fail      rts
    633  7386
    634  7386		       b9 50 f1    .found     lda	MovePiece,y
    635  7389							;and #PIECE_MASK	 castling fails if enabled
    636  7389		       85 a4		      sta	aiPiece
    637  738b		       60		      rts
    638  738c
    639  738c
    640  738c
    641  738c							;---------------------------------------------------------------------------------------------------
    642  738c
      0  738c					      DEF	CheckMoveListToSquare
      1  738c				   BANK_CheckMoveListToSquare SET	_CURRENT_BANK
      2  738c				   CheckMoveListToSquare
      3  738c				   TEMPORARY_VAR SET	Overlay
      4  738c				   TEMPORARY_OFFSET SET	0
      5  738c					      SUBROUTINE
    644  738c					      SUBROUTINE
    645  738c
    646  738c							; X12 in A
    647  738c							; y = -1 on return if NOT FOUND
    648  738c
    649  738c		       ac a1 f1 	      ldy	moveIndex
    650  738f		       30 13		      bmi	.sout
    651  7391		       d9 00 f1    .scan      cmp	MoveTo,y
    652  7394		       d0 09		      bne	.xscanned
    653  7396
    654  7396		       48		      pha
    655  7397		       b9 8e f0 	      lda	MoveFrom,y
    656  739a		       c5 90		      cmp	aiFromSquareX12
    657  739c		       f0 05		      beq	.scanned
    658  739e		       68		      pla
    659  739f
    660  739f		       88	   .xscanned  dey
    661  73a0		       10 ef		      bpl	.scan
    662  73a2		       48		      pha
    663  73a3
    664  73a3		       68	   .scanned   pla
    665  73a4		       60	   .sout      rts
    666  73a5
    667  73a5
    668  73a5							;---------------------------------------------------------------------------------------------------
    669  73a5
      0  73a5					      CHECK_HALF_BANK_SIZE	"PLY -- 1K"
      1  73a5
      2  73a5
      3  73a5		       03 a5	   .TEMP      =	* - BANK_START
 PLY -- 1K (1K) SIZE =  $3a5 , FREE= $5b
      4  73a5					      ECHO	"PLY -- 1K", "(1K) SIZE = ", .TEMP, ", FREE=", ROM_BANK_SIZE/2 - .TEMP
      5  73a5				  -	      if	( .TEMP ) > ROM_BANK_SIZE/2
      6  73a5				  -	      ECHO	"HALF-BANK OVERFLOW @ ", * - ORIGIN
      7  73a5				  -	      ERR
      8  73a5					      endif
    671  73a5
    672  73a5							;---------------------------------------------------------------------------------------------------
    673  73a5
    674  73a5							; There is space here (1K) for use as ROM
    675  73a5							; but NOT when the above bank is switched in as RAM, of course!
    676  73a5
    677  73a5
    678  73a5
    679  73a5
    680  73a5							;---------------------------------------------------------------------------------------------------
    681  73a5							; EOF
------- FILE ./chess.asm
------- FILE BANK_EVAL.asm LEVEL 2 PASS 2
      0  73a5					      include	"BANK_EVAL.asm"
      0  73a5					      NEWBANK	EVAL
      1  7fc8 ????				      SEG	EVAL
      2  7800					      ORG	ORIGIN
      3  7800					      RORG	$F000
      4  7800				   BANK_START SET	*
      5  7800				   EVAL       SET	ORIGIN / 2048
      6  7800				   ORIGIN     SET	ORIGIN + 2048
      7  7800				   _CURRENT_BANK SET	EVAL
      2  7800
      3  7800
      4  7800							; see https://www.chessprogramming.org/Simplified_Evaluation_Function
      5  7800
      6  7800
      7  7800		       00 64	   VALUE_P    =	100
      8  7800		       01 40	   VALUE_N    =	320
      9  7800		       01 4a	   VALUE_B    =	330
     10  7800		       01 f4	   VALUE_R    =	500
     11  7800		       03 84	   VALUE_Q    =	900
     12  7800		       4e 20	   VALUE_K    =	20000
     13  7800
     14  7800
     15  7800					      MAC	vequ
     16  7800				   VALUE_{1}  =	{2}
     17  7800					      ENDM
     18  7800
     19  7800					      MAC	lobyte
     20  7800					      .byte	<{2}
     21  7800					      ENDM
     22  7800
     23  7800					      MAC	hibyte
     24  7800					      .byte	>{2}
     25  7800					      ENDM
     26  7800
     27  7800
     28  7800					      MAC	valueof
     29  7800					      {1}	BLANK, 0
     30  7800					      {1}	PAWN, 100	; white
     31  7800					      {1}	PAWN, 100	; black
     32  7800					      {1}	KNIGHT, 320
     33  7800					      {1}	BISHOP, 330
     34  7800					      {1}	ROOK, 500
     35  7800					      {1}	QUEEN, 900
     36  7800					      {1}	KING, 20000
     37  7800					      ENDM
     38  7800
     39  7800
      0  7800					      VALUEOF	VEQU
      0  7800					      VEQU	BLANK, 0
      1  7800		       00 00	   VALUE_BLANK =	0
      0  7800					      VEQU	PAWN, 100
      1  7800		       00 64	   VALUE_PAWN =	100
      0  7800					      VEQU	PAWN, 100
      1  7800		       00 64	   VALUE_PAWN =	100
      0  7800					      VEQU	KNIGHT, 320
      1  7800		       01 40	   VALUE_KNIGHT =	320
      0  7800					      VEQU	BISHOP, 330
      1  7800		       01 4a	   VALUE_BISHOP =	330
      0  7800					      VEQU	ROOK, 500
      1  7800		       01 f4	   VALUE_ROOK =	500
      0  7800					      VEQU	QUEEN, 900
      1  7800		       03 84	   VALUE_QUEEN =	900
      0  7800					      VEQU	KING, 20000
      1  7800		       4e 20	   VALUE_KING =	20000
      0  7800					      DEF	PieceValueLO
      1  7800				   BANK_PieceValueLO SET	_CURRENT_BANK
      2  7800				   PieceValueLO
      3  7800				   TEMPORARY_VAR SET	Overlay
      4  7800				   TEMPORARY_OFFSET SET	0
      5  7800					      SUBROUTINE
      0  7800					      VALUEOF	LOBYTE
      0  7800					      LOBYTE	BLANK, 0
      1  7800		       00		      .byte.b	<0
      0  7801					      LOBYTE	PAWN, 100
      1  7801		       64		      .byte.b	<100
      0  7802					      LOBYTE	PAWN, 100
      1  7802		       64		      .byte.b	<100
      0  7803					      LOBYTE	KNIGHT, 320
      1  7803		       40		      .byte.b	<320
      0  7804					      LOBYTE	BISHOP, 330
      1  7804		       4a		      .byte.b	<330
      0  7805					      LOBYTE	ROOK, 500
      1  7805		       f4		      .byte.b	<500
      0  7806					      LOBYTE	QUEEN, 900
      1  7806		       84		      .byte.b	<900
      0  7807					      LOBYTE	KING, 20000
      1  7807		       20		      .byte.b	<20000
      0  7808					      DEF	PieceValueHI
      1  7808				   BANK_PieceValueHI SET	_CURRENT_BANK
      2  7808				   PieceValueHI
      3  7808				   TEMPORARY_VAR SET	Overlay
      4  7808				   TEMPORARY_OFFSET SET	0
      5  7808					      SUBROUTINE
      0  7808					      VALUEOF	HIBYTE
      0  7808					      HIBYTE	BLANK, 0
      1  7808		       00		      .byte.b	>0
      0  7809					      HIBYTE	PAWN, 100
      1  7809		       00		      .byte.b	>100
      0  780a					      HIBYTE	PAWN, 100
      1  780a		       00		      .byte.b	>100
      0  780b					      HIBYTE	KNIGHT, 320
      1  780b		       01		      .byte.b	>320
      0  780c					      HIBYTE	BISHOP, 330
      1  780c		       01		      .byte.b	>330
      0  780d					      HIBYTE	ROOK, 500
      1  780d		       01		      .byte.b	>500
      0  780e					      HIBYTE	QUEEN, 900
      1  780e		       03		      .byte.b	>900
      0  780f					      HIBYTE	KING, 20000
      1  780f		       4e		      .byte.b	>20000
     45  7810
     46  7810
     47  7810							;---------------------------------------------------------------------------------------------------
     48  7810
      0  7810					      DEF	AddPieceMaterialValue
      1  7810				   BANK_AddPieceMaterialValue SET	_CURRENT_BANK
      2  7810				   AddPieceMaterialValue
      3  7810				   TEMPORARY_VAR SET	Overlay
      4  7810				   TEMPORARY_OFFSET SET	0
      5  7810					      SUBROUTINE
     50  7810					      SUBROUTINE
     51  7810							; Adjust the material score based on the piece
     52  7810							; to REMOVE a piece, negate the piece colour!
     53  7810							; y = piece type
     54  7810							; carry C = white, S = black
     55  7810
     56  7810		       b0 0f		      bcs	.black
     57  7812
     58  7812		       b9 00 f0 	      lda	PieceValueLO,y
     59  7815		       65 94		      adc	Evaluation
     60  7817		       85 94		      sta	Evaluation
     61  7819		       b9 08 f0 	      lda	PieceValueHI,y
     62  781c		       65 95		      adc	Evaluation+1
     63  781e		       85 95		      sta	Evaluation+1
     64  7820
     65  7820		       60		      rts
     66  7821
     67  7821		       a5 94	   .black     lda	Evaluation
     68  7823		       f9 00 f0 	      sbc	PieceValueLO,y
     69  7826		       85 94		      sta	Evaluation
     70  7828		       a5 95		      lda	Evaluation+1
     71  782a		       f9 08 f0 	      sbc	PieceValueHI,y
     72  782d		       85 95		      sta	Evaluation+1
     73  782f		       60		      rts
     74  7830
     75  7830
     76  7830							;---------------------------------------------------------------------------------------------------
     77  7830
      0  7830					      DEF	AddPiecePositionValue
      1  7830				   BANK_AddPiecePositionValue SET	_CURRENT_BANK
      2  7830				   AddPiecePositionValue
      3  7830				   TEMPORARY_VAR SET	Overlay
      4  7830				   TEMPORARY_OFFSET SET	0
      5  7830					      SUBROUTINE
     79  7830					      SUBROUTINE
     80  7830
      0  7830					      VAR	__pval, 2
      1  7830				   __pval     SET	TEMPORARY_VAR
      2  7830				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 2
      3  7830
      4  7830				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  7830				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  7830				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  7830					      ENDIF
      8  7830				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  7830				  -	      ECHO	"Temporary Variable", __pval, "overflow!"
     10  7830				  -	      ERR
     11  7830					      ENDIF
     12  7830					      LIST	ON
     82  7830
     83  7830							; y = square
     84  7830							; a = piece type (+flags)
     85  7830
     86  7830		       c9 80		      cmp	#128	; black = CS
     87  7832		       29 0f		      and	#PIECE_MASK
     88  7834		       aa		      tax
     89  7835
     90  7835		       bd cb f0 	      lda	PosValVecLO,x
     91  7838		       85 a5		      sta	__pval
     92  783a		       bd d3 f0 	      lda	PosValVecHI,x
     93  783d		       85 a6		      sta	__pval+1
     94  783f
     95  783f		       b0 12		      bcs	.black
     96  7841
     97  7841		       98		      tya
     98  7842		       0a		      asl
     99  7843		       a8		      tay
    100  7844
    101  7844		       18		      clc
    102  7845		       a5 94		      lda	Evaluation
    103  7847		       71 a5		      adc	(__pval),y
    104  7849		       85 94		      sta	Evaluation
    105  784b		       c8		      iny
    106  784c		       a5 95		      lda	Evaluation+1
    107  784e		       71 a5		      adc	(__pval),y
    108  7850		       85 95		      sta	Evaluation+1
    109  7852		       60		      rts
    110  7853
    111  7853				   .black
    112  7853
    113  7853
    114  7853							; negate the index
    115  7853							; converts
    116  7853
    117  7853		       98		      tya
    118  7854		       aa		      tax
    119  7855		       bc 67 f0 	      ldy	FlipSquareIndex,x
    120  7858
    121  7858		       38		      sec
    122  7859		       a5 94		      lda	Evaluation
    123  785b		       f1 a5		      sbc	(__pval),y
    124  785d		       85 94		      sta	Evaluation
    125  785f		       c8		      iny
    126  7860		       a5 95		      lda	Evaluation+1
    127  7862		       f1 a5		      sbc	(__pval),y
    128  7864		       85 95		      sta	Evaluation+1
    129  7866		       60		      rts
    130  7867
    131  7867
    132  7867							;---------------------------------------------------------------------------------------------------
    133  7867
    134  7867
      0  7867					      ALLOCATE	FlipSquareIndex, 100
      0  7867					      OPTIONAL_PAGEBREAK	"Table", 100
     10  7867					      LIST	ON
      0  7867					      DEF	FlipSquareIndex
      1  7867				   BANK_FlipSquareIndex SET	_CURRENT_BANK
      2  7867				   FlipSquareIndex
      3  7867				   TEMPORARY_VAR SET	Overlay
      4  7867				   TEMPORARY_OFFSET SET	0
      5  7867					      SUBROUTINE
    136  7867
    137  7867		       00 00 00 00*	      .byte.b	0,0,0,0,0,0,0,0,0,0
    138  7871		       00 00 00 00*	      .byte.b	0,0,0,0,0,0,0,0,0,0
    139  787b
    140  787b				   .SQBASE    SET	90
    141  787b					      REPEAT	8
    142  787b		       00 00		      .byte.b	0,0
    143  787b				   .SQX       SET	2
    144  787d					      REPEAT	8
    145  787d		       b8		      .byte.b	(.SQBASE+.SQX)*2
    146  787d				   .SQX       SET	.SQX + 1
    144  787d					      REPEND
    145  787e		       ba		      .byte.b	(.SQBASE+.SQX)*2
    146  787e				   .SQX       SET	.SQX + 1
    144  787e					      REPEND
    145  787f		       bc		      .byte.b	(.SQBASE+.SQX)*2
    146  787f				   .SQX       SET	.SQX + 1
    144  787f					      REPEND
    145  7880		       be		      .byte.b	(.SQBASE+.SQX)*2
    146  7880				   .SQX       SET	.SQX + 1
    144  7880					      REPEND
    145  7881		       c0		      .byte.b	(.SQBASE+.SQX)*2
    146  7881				   .SQX       SET	.SQX + 1
    144  7881					      REPEND
    145  7882		       c2		      .byte.b	(.SQBASE+.SQX)*2
    146  7882				   .SQX       SET	.SQX + 1
    144  7882					      REPEND
    145  7883		       c4		      .byte.b	(.SQBASE+.SQX)*2
    146  7883				   .SQX       SET	.SQX + 1
    144  7883					      REPEND
    145  7884		       c6		      .byte.b	(.SQBASE+.SQX)*2
    146  7884				   .SQX       SET	.SQX + 1
    147  7885					      REPEND
    148  7885				   .SQBASE    SET	.SQBASE - 10
    141  7885					      REPEND
    142  7885		       00 00		      .byte.b	0,0
    143  7885				   .SQX       SET	2
    144  7887					      REPEAT	8
    145  7887		       a4		      .byte.b	(.SQBASE+.SQX)*2
    146  7887				   .SQX       SET	.SQX + 1
    144  7887					      REPEND
    145  7888		       a6		      .byte.b	(.SQBASE+.SQX)*2
    146  7888				   .SQX       SET	.SQX + 1
    144  7888					      REPEND
    145  7889		       a8		      .byte.b	(.SQBASE+.SQX)*2
    146  7889				   .SQX       SET	.SQX + 1
    144  7889					      REPEND
    145  788a		       aa		      .byte.b	(.SQBASE+.SQX)*2
    146  788a				   .SQX       SET	.SQX + 1
    144  788a					      REPEND
    145  788b		       ac		      .byte.b	(.SQBASE+.SQX)*2
    146  788b				   .SQX       SET	.SQX + 1
    144  788b					      REPEND
    145  788c		       ae		      .byte.b	(.SQBASE+.SQX)*2
    146  788c				   .SQX       SET	.SQX + 1
    144  788c					      REPEND
    145  788d		       b0		      .byte.b	(.SQBASE+.SQX)*2
    146  788d				   .SQX       SET	.SQX + 1
    144  788d					      REPEND
    145  788e		       b2		      .byte.b	(.SQBASE+.SQX)*2
    146  788e				   .SQX       SET	.SQX + 1
    147  788f					      REPEND
    148  788f				   .SQBASE    SET	.SQBASE - 10
    141  788f					      REPEND
    142  788f		       00 00		      .byte.b	0,0
    143  788f				   .SQX       SET	2
    144  7891					      REPEAT	8
    145  7891		       90		      .byte.b	(.SQBASE+.SQX)*2
    146  7891				   .SQX       SET	.SQX + 1
    144  7891					      REPEND
    145  7892		       92		      .byte.b	(.SQBASE+.SQX)*2
    146  7892				   .SQX       SET	.SQX + 1
    144  7892					      REPEND
    145  7893		       94		      .byte.b	(.SQBASE+.SQX)*2
    146  7893				   .SQX       SET	.SQX + 1
    144  7893					      REPEND
    145  7894		       96		      .byte.b	(.SQBASE+.SQX)*2
    146  7894				   .SQX       SET	.SQX + 1
    144  7894					      REPEND
    145  7895		       98		      .byte.b	(.SQBASE+.SQX)*2
    146  7895				   .SQX       SET	.SQX + 1
    144  7895					      REPEND
    145  7896		       9a		      .byte.b	(.SQBASE+.SQX)*2
    146  7896				   .SQX       SET	.SQX + 1
    144  7896					      REPEND
    145  7897		       9c		      .byte.b	(.SQBASE+.SQX)*2
    146  7897				   .SQX       SET	.SQX + 1
    144  7897					      REPEND
    145  7898		       9e		      .byte.b	(.SQBASE+.SQX)*2
    146  7898				   .SQX       SET	.SQX + 1
    147  7899					      REPEND
    148  7899				   .SQBASE    SET	.SQBASE - 10
    141  7899					      REPEND
    142  7899		       00 00		      .byte.b	0,0
    143  7899				   .SQX       SET	2
    144  789b					      REPEAT	8
    145  789b		       7c		      .byte.b	(.SQBASE+.SQX)*2
    146  789b				   .SQX       SET	.SQX + 1
    144  789b					      REPEND
    145  789c		       7e		      .byte.b	(.SQBASE+.SQX)*2
    146  789c				   .SQX       SET	.SQX + 1
    144  789c					      REPEND
    145  789d		       80		      .byte.b	(.SQBASE+.SQX)*2
    146  789d				   .SQX       SET	.SQX + 1
    144  789d					      REPEND
    145  789e		       82		      .byte.b	(.SQBASE+.SQX)*2
    146  789e				   .SQX       SET	.SQX + 1
    144  789e					      REPEND
    145  789f		       84		      .byte.b	(.SQBASE+.SQX)*2
    146  789f				   .SQX       SET	.SQX + 1
    144  789f					      REPEND
    145  78a0		       86		      .byte.b	(.SQBASE+.SQX)*2
    146  78a0				   .SQX       SET	.SQX + 1
    144  78a0					      REPEND
    145  78a1		       88		      .byte.b	(.SQBASE+.SQX)*2
    146  78a1				   .SQX       SET	.SQX + 1
    144  78a1					      REPEND
    145  78a2		       8a		      .byte.b	(.SQBASE+.SQX)*2
    146  78a2				   .SQX       SET	.SQX + 1
    147  78a3					      REPEND
    148  78a3				   .SQBASE    SET	.SQBASE - 10
    141  78a3					      REPEND
    142  78a3		       00 00		      .byte.b	0,0
    143  78a3				   .SQX       SET	2
    144  78a5					      REPEAT	8
    145  78a5		       68		      .byte.b	(.SQBASE+.SQX)*2
    146  78a5				   .SQX       SET	.SQX + 1
    144  78a5					      REPEND
    145  78a6		       6a		      .byte.b	(.SQBASE+.SQX)*2
    146  78a6				   .SQX       SET	.SQX + 1
    144  78a6					      REPEND
    145  78a7		       6c		      .byte.b	(.SQBASE+.SQX)*2
    146  78a7				   .SQX       SET	.SQX + 1
    144  78a7					      REPEND
    145  78a8		       6e		      .byte.b	(.SQBASE+.SQX)*2
    146  78a8				   .SQX       SET	.SQX + 1
    144  78a8					      REPEND
    145  78a9		       70		      .byte.b	(.SQBASE+.SQX)*2
    146  78a9				   .SQX       SET	.SQX + 1
    144  78a9					      REPEND
    145  78aa		       72		      .byte.b	(.SQBASE+.SQX)*2
    146  78aa				   .SQX       SET	.SQX + 1
    144  78aa					      REPEND
    145  78ab		       74		      .byte.b	(.SQBASE+.SQX)*2
    146  78ab				   .SQX       SET	.SQX + 1
    144  78ab					      REPEND
    145  78ac		       76		      .byte.b	(.SQBASE+.SQX)*2
    146  78ac				   .SQX       SET	.SQX + 1
    147  78ad					      REPEND
    148  78ad				   .SQBASE    SET	.SQBASE - 10
    141  78ad					      REPEND
    142  78ad		       00 00		      .byte.b	0,0
    143  78ad				   .SQX       SET	2
    144  78af					      REPEAT	8
    145  78af		       54		      .byte.b	(.SQBASE+.SQX)*2
    146  78af				   .SQX       SET	.SQX + 1
    144  78af					      REPEND
    145  78b0		       56		      .byte.b	(.SQBASE+.SQX)*2
    146  78b0				   .SQX       SET	.SQX + 1
    144  78b0					      REPEND
    145  78b1		       58		      .byte.b	(.SQBASE+.SQX)*2
    146  78b1				   .SQX       SET	.SQX + 1
    144  78b1					      REPEND
    145  78b2		       5a		      .byte.b	(.SQBASE+.SQX)*2
    146  78b2				   .SQX       SET	.SQX + 1
    144  78b2					      REPEND
    145  78b3		       5c		      .byte.b	(.SQBASE+.SQX)*2
    146  78b3				   .SQX       SET	.SQX + 1
    144  78b3					      REPEND
    145  78b4		       5e		      .byte.b	(.SQBASE+.SQX)*2
    146  78b4				   .SQX       SET	.SQX + 1
    144  78b4					      REPEND
    145  78b5		       60		      .byte.b	(.SQBASE+.SQX)*2
    146  78b5				   .SQX       SET	.SQX + 1
    144  78b5					      REPEND
    145  78b6		       62		      .byte.b	(.SQBASE+.SQX)*2
    146  78b6				   .SQX       SET	.SQX + 1
    147  78b7					      REPEND
    148  78b7				   .SQBASE    SET	.SQBASE - 10
    141  78b7					      REPEND
    142  78b7		       00 00		      .byte.b	0,0
    143  78b7				   .SQX       SET	2
    144  78b9					      REPEAT	8
    145  78b9		       40		      .byte.b	(.SQBASE+.SQX)*2
    146  78b9				   .SQX       SET	.SQX + 1
    144  78b9					      REPEND
    145  78ba		       42		      .byte.b	(.SQBASE+.SQX)*2
    146  78ba				   .SQX       SET	.SQX + 1
    144  78ba					      REPEND
    145  78bb		       44		      .byte.b	(.SQBASE+.SQX)*2
    146  78bb				   .SQX       SET	.SQX + 1
    144  78bb					      REPEND
    145  78bc		       46		      .byte.b	(.SQBASE+.SQX)*2
    146  78bc				   .SQX       SET	.SQX + 1
    144  78bc					      REPEND
    145  78bd		       48		      .byte.b	(.SQBASE+.SQX)*2
    146  78bd				   .SQX       SET	.SQX + 1
    144  78bd					      REPEND
    145  78be		       4a		      .byte.b	(.SQBASE+.SQX)*2
    146  78be				   .SQX       SET	.SQX + 1
    144  78be					      REPEND
    145  78bf		       4c		      .byte.b	(.SQBASE+.SQX)*2
    146  78bf				   .SQX       SET	.SQX + 1
    144  78bf					      REPEND
    145  78c0		       4e		      .byte.b	(.SQBASE+.SQX)*2
    146  78c0				   .SQX       SET	.SQX + 1
    147  78c1					      REPEND
    148  78c1				   .SQBASE    SET	.SQBASE - 10
    141  78c1					      REPEND
    142  78c1		       00 00		      .byte.b	0,0
    143  78c1				   .SQX       SET	2
    144  78c3					      REPEAT	8
    145  78c3		       2c		      .byte.b	(.SQBASE+.SQX)*2
    146  78c3				   .SQX       SET	.SQX + 1
    144  78c3					      REPEND
    145  78c4		       2e		      .byte.b	(.SQBASE+.SQX)*2
    146  78c4				   .SQX       SET	.SQX + 1
    144  78c4					      REPEND
    145  78c5		       30		      .byte.b	(.SQBASE+.SQX)*2
    146  78c5				   .SQX       SET	.SQX + 1
    144  78c5					      REPEND
    145  78c6		       32		      .byte.b	(.SQBASE+.SQX)*2
    146  78c6				   .SQX       SET	.SQX + 1
    144  78c6					      REPEND
    145  78c7		       34		      .byte.b	(.SQBASE+.SQX)*2
    146  78c7				   .SQX       SET	.SQX + 1
    144  78c7					      REPEND
    145  78c8		       36		      .byte.b	(.SQBASE+.SQX)*2
    146  78c8				   .SQX       SET	.SQX + 1
    144  78c8					      REPEND
    145  78c9		       38		      .byte.b	(.SQBASE+.SQX)*2
    146  78c9				   .SQX       SET	.SQX + 1
    144  78c9					      REPEND
    145  78ca		       3a		      .byte.b	(.SQBASE+.SQX)*2
    146  78ca				   .SQX       SET	.SQX + 1
    147  78cb					      REPEND
    148  78cb				   .SQBASE    SET	.SQBASE - 10
    149  78cb					      REPEND
    150  78cb
    151  78cb
    152  78cb							;---------------------------------------------------------------------------------------------------
    153  78cb							; Vectors to the position value tables for each piece
    154  78cb
    155  78cb					      MAC	posval
    156  78cb					      .byte	0
    157  78cb					      .byte	{1}PositionalValue_PAWN
    158  78cb					      .byte	{1}PositionalValue_PAWN
    159  78cb					      .byte	{1}PositionalValue_KNIGHT
    160  78cb					      .byte	{1}PositionalValue_BISHOP
    161  78cb					      .byte	{1}PositionalValue_ROOK
    162  78cb					      .byte	{1}PositionalValue_QUEEN
    163  78cb					      .byte	{1}PositionalValue_KING_MIDGAME
    164  78cb					      ENDM
    165  78cb
      0  78cb					      ALLOCATE	PosValVecLO, 8
      0  78cb					      OPTIONAL_PAGEBREAK	"Table", 8
     10  78cb					      LIST	ON
      0  78cb					      DEF	PosValVecLO
      1  78cb				   BANK_PosValVecLO SET	_CURRENT_BANK
      2  78cb				   PosValVecLO
      3  78cb				   TEMPORARY_VAR SET	Overlay
      4  78cb				   TEMPORARY_OFFSET SET	0
      5  78cb					      SUBROUTINE
      0  78cb					      POSVAL	<
      1  78cb		       00		      .byte.b	0
      2  78cc		       00		      .byte.b	<PositionalValue_PAWN
      3  78cd		       00		      .byte.b	<PositionalValue_PAWN
      4  78ce		       00		      .byte.b	<PositionalValue_KNIGHT
      5  78cf		       00		      .byte.b	<PositionalValue_BISHOP
      6  78d0		       00		      .byte.b	<PositionalValue_ROOK
      7  78d1		       00		      .byte.b	<PositionalValue_QUEEN
      8  78d2		       00		      .byte.b	<PositionalValue_KING_MIDGAME
      0  78d3					      ALLOCATE	PosValVecHI, 8
      0  78d3					      OPTIONAL_PAGEBREAK	"Table", 8
     10  78d3					      LIST	ON
      0  78d3					      DEF	PosValVecHI
      1  78d3				   BANK_PosValVecHI SET	_CURRENT_BANK
      2  78d3				   PosValVecHI
      3  78d3				   TEMPORARY_VAR SET	Overlay
      4  78d3				   TEMPORARY_OFFSET SET	0
      5  78d3					      SUBROUTINE
      0  78d3					      POSVAL	>
      1  78d3		       00		      .byte.b	0
      2  78d4		       f1		      .byte.b	>PositionalValue_PAWN
      3  78d5		       f1		      .byte.b	>PositionalValue_PAWN
      4  78d6		       f2		      .byte.b	>PositionalValue_KNIGHT
      5  78d7		       f3		      .byte.b	>PositionalValue_BISHOP
      6  78d8		       f4		      .byte.b	>PositionalValue_ROOK
      7  78d9		       f5		      .byte.b	>PositionalValue_QUEEN
      8  78da		       f6		      .byte.b	>PositionalValue_KING_MIDGAME
    170  78db
    171  78db
    172  78db							;---------------------------------------------------------------------------------------------------
    173  78db
      0  78db					      ALLOCATE	PositionalValue_PAWN, 200
      0  78db					      OPTIONAL_PAGEBREAK	"Table", 200
 PAGE BREAK INSERTED FOR Table
 REQUESTED SIZE = $c8
 WASTED SPACE = $25
 PAGEBREAK LOCATION = $f100
     10  7900					      LIST	ON
      0  7900					      DEF	PositionalValue_PAWN
      1  7900				   BANK_PositionalValue_PAWN SET	_CURRENT_BANK
      2  7900				   PositionalValue_PAWN
      3  7900				   TEMPORARY_VAR SET	Overlay
      4  7900				   TEMPORARY_OFFSET SET	0
      5  7900					      SUBROUTINE
    175  7900
    176  7900		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    177  7914		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    178  7928
    179  7928		       00 00 00 00*	      .word.w	0,0, 0, 0, 0, 0, 0, 0, 0, 0	; 20-29
    180  793c		       00 00 00 00*	      .word.w	0,0, 5, 10, 10,-20,-20, 10, 10, 5	; 30-
    181  7950		       00 00 00 00*	      .word.w	0,0, 5, -5,-10, 0, 0,-10, -5, 5	; 40-
    182  7964		       00 00 00 00*	      .word.w	0,0, 0, 0, 0, 20, 20, 0, 0, 0	; 50-
    183  7978		       00 00 00 00*	      .word.w	0,0, 5, 5, 10, 25, 25, 10, 5, 5	; 60-
    184  798c		       00 00 00 00*	      .word.w	0,0, 10, 10, 20, 30, 30, 20, 10, 10	; 70-
    185  79a0		       00 00 00 00*	      .word.w	0,0, 50, 50, 50, 50, 50, 50, 50, 50	; 80-
    186  79b4		       00 00 00 00*	      .word.w	0,0, 0, 0, 0, 0, 0, 0, 0, 0	; 90-
    187  79c8
    188  79c8
    189  79c8							;---------------------------------------------------------------------------------------------------
    190  79c8
      0  79c8					      ALLOCATE	PositionalValue_KNIGHT, 200
      0  79c8					      OPTIONAL_PAGEBREAK	"Table", 200
 PAGE BREAK INSERTED FOR Table
 REQUESTED SIZE = $c8
 WASTED SPACE = $38
 PAGEBREAK LOCATION = $f200
     10  7a00					      LIST	ON
      0  7a00					      DEF	PositionalValue_KNIGHT
      1  7a00				   BANK_PositionalValue_KNIGHT SET	_CURRENT_BANK
      2  7a00				   PositionalValue_KNIGHT
      3  7a00				   TEMPORARY_VAR SET	Overlay
      4  7a00				   TEMPORARY_OFFSET SET	0
      5  7a00					      SUBROUTINE
    192  7a00
    193  7a00		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    194  7a14		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    195  7a28
    196  7a28		       00 00 00 00*	      .word.w	0,0, -50,-40,-30,-30,-30,-30,-40,-50
    197  7a3c		       00 00 00 00*	      .word.w	0,0, -40,-20, 0, 5, 5, 0,-20,-40
    198  7a50		       00 00 00 00*	      .word.w	0,0, -30, 5, 10, 15, 15, 10, 5,-30
    199  7a64		       00 00 00 00*	      .word.w	0,0, -30, 0, 15, 20, 20, 15, 0,-30
    200  7a78		       00 00 00 00*	      .word.w	0,0, -30, 5, 15, 20, 20, 15, 5,-30
    201  7a8c		       00 00 00 00*	      .word.w	0,0, -30, 0, 10, 15, 15, 10, 0,-30
    202  7aa0		       00 00 00 00*	      .word.w	0,0, -40,-20, 0, 0, 0, 0,-20,-40
    203  7ab4		       00 00 00 00*	      .word.w	0,0, -50,-40,-30,-30,-30,-30,-40,-50
    204  7ac8
    205  7ac8
    206  7ac8							;---------------------------------------------------------------------------------------------------
    207  7ac8
      0  7ac8					      ALLOCATE	PositionalValue_BISHOP, 200
      0  7ac8					      OPTIONAL_PAGEBREAK	"Table", 200
 PAGE BREAK INSERTED FOR Table
 REQUESTED SIZE = $c8
 WASTED SPACE = $38
 PAGEBREAK LOCATION = $f300
     10  7b00					      LIST	ON
      0  7b00					      DEF	PositionalValue_BISHOP
      1  7b00				   BANK_PositionalValue_BISHOP SET	_CURRENT_BANK
      2  7b00				   PositionalValue_BISHOP
      3  7b00				   TEMPORARY_VAR SET	Overlay
      4  7b00				   TEMPORARY_OFFSET SET	0
      5  7b00					      SUBROUTINE
    209  7b00
    210  7b00		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    211  7b14		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    212  7b28
    213  7b28		       00 00 00 00*	      .word.w	0,0, -20,-10,-10,-10,-10,-10,-10,-20
    214  7b3c		       00 00 00 00*	      .word.w	0,0, -10, 5, 0, 0, 0, 0, 5,-10
    215  7b50		       00 00 00 00*	      .word.w	0,0, -10, 10, 10, 10, 10, 10, 10,-10
    216  7b64		       00 00 00 00*	      .word.w	0,0, -10, 0, 10, 10, 10, 10, 0,-10
    217  7b78		       00 00 00 00*	      .word.w	0,0, -10, 5, 5, 10, 10, 5, 5,-10
    218  7b8c		       00 00 00 00*	      .word.w	0,0, -10, 0, 5, 10, 10, 5, 0,-10
    219  7ba0		       00 00 00 00*	      .word.w	0,0, -10, 0, 0, 0, 0, 0, 0,-10
    220  7bb4		       00 00 00 00*	      .word.w	0,0, -20,-10,-10,-10,-10,-10,-10,-20
    221  7bc8
    222  7bc8
    223  7bc8							;---------------------------------------------------------------------------------------------------
    224  7bc8
      0  7bc8					      ALLOCATE	PositionalValue_ROOK, 200
      0  7bc8					      OPTIONAL_PAGEBREAK	"Table", 200
 PAGE BREAK INSERTED FOR Table
 REQUESTED SIZE = $c8
 WASTED SPACE = $38
 PAGEBREAK LOCATION = $f400
     10  7c00					      LIST	ON
      0  7c00					      DEF	PositionalValue_ROOK
      1  7c00				   BANK_PositionalValue_ROOK SET	_CURRENT_BANK
      2  7c00				   PositionalValue_ROOK
      3  7c00				   TEMPORARY_VAR SET	Overlay
      4  7c00				   TEMPORARY_OFFSET SET	0
      5  7c00					      SUBROUTINE
    226  7c00
    227  7c00		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    228  7c14		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    229  7c28
    230  7c28		       00 00 00 00*	      .word.w	0,0, 0, 0, 0, 5, 5, 0, 0, 0
    231  7c3c		       00 00 00 00*	      .word.w	0,0, -5, 0, 0, 0, 0, 0, 0, -5
    232  7c50		       00 00 00 00*	      .word.w	0,0, -5, 0, 0, 0, 0, 0, 0, -5
    233  7c64		       00 00 00 00*	      .word.w	0,0, -5, 0, 0, 0, 0, 0, 0, -5
    234  7c78		       00 00 00 00*	      .word.w	0,0, -5, 0, 0, 0, 0, 0, 0, -5
    235  7c8c		       00 00 00 00*	      .word.w	0,0, -5, 0, 0, 0, 0, 0, 0, -5
    236  7ca0		       00 00 00 00*	      .word.w	0,0, 5, 10, 10, 10, 10, 10, 10, 5
    237  7cb4		       00 00 00 00*	      .word.w	0,0, 0, 0, 0, 0, 0, 0, 0, 0
    238  7cc8
    239  7cc8
    240  7cc8							;---------------------------------------------------------------------------------------------------
    241  7cc8
      0  7cc8					      ALLOCATE	PositionalValue_QUEEN, 200
      0  7cc8					      OPTIONAL_PAGEBREAK	"Table", 200
 PAGE BREAK INSERTED FOR Table
 REQUESTED SIZE = $c8
 WASTED SPACE = $38
 PAGEBREAK LOCATION = $f500
     10  7d00					      LIST	ON
      0  7d00					      DEF	PositionalValue_QUEEN
      1  7d00				   BANK_PositionalValue_QUEEN SET	_CURRENT_BANK
      2  7d00				   PositionalValue_QUEEN
      3  7d00				   TEMPORARY_VAR SET	Overlay
      4  7d00				   TEMPORARY_OFFSET SET	0
      5  7d00					      SUBROUTINE
    243  7d00
    244  7d00		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    245  7d14		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    246  7d28
    247  7d28		       00 00 00 00*	      .word.w	0,0, -20,-10,-10, -5, -5,-10,-10,-20
    248  7d3c		       00 00 00 00*	      .word.w	0,0, -10, 0, 5, 0, 0, 0, 0,-10
    249  7d50		       00 00 00 00*	      .word.w	0,0, -10, 5, 5, 5, 5, 5, 0,-10
    250  7d64		       00 00 00 00*	      .word.w	0,0, 0, 0, 5, 5, 5, 5, 0, -5
    251  7d78		       00 00 00 00*	      .word.w	0,0, -5, 0, 5, 5, 5, 5, 0, -5
    252  7d8c		       00 00 00 00*	      .word.w	0,0, -10, 0, 5, 5, 5, 5, 0,-10
    253  7da0		       00 00 00 00*	      .word.w	0,0, -10, 0, 0, 0, 0, 0, 0,-10
    254  7db4		       00 00 00 00*	      .word.w	0,0, -20,-10,-10, -5, -5,-10,-10,-20
    255  7dc8
    256  7dc8
    257  7dc8							;---------------------------------------------------------------------------------------------------
    258  7dc8
      0  7dc8					      ALLOCATE	PositionalValue_KING_MIDGAME, 200
      0  7dc8					      OPTIONAL_PAGEBREAK	"Table", 200
 PAGE BREAK INSERTED FOR Table
 REQUESTED SIZE = $c8
 WASTED SPACE = $38
 PAGEBREAK LOCATION = $f600
     10  7e00					      LIST	ON
      0  7e00					      DEF	PositionalValue_KING_MIDGAME
      1  7e00				   BANK_PositionalValue_KING_MIDGAME SET	_CURRENT_BANK
      2  7e00				   PositionalValue_KING_MIDGAME
      3  7e00				   TEMPORARY_VAR SET	Overlay
      4  7e00				   TEMPORARY_OFFSET SET	0
      5  7e00					      SUBROUTINE
    260  7e00
    261  7e00		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    262  7e14		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    263  7e28
    264  7e28		       00 00 00 00*	      .word.w	0,0, 20, 30, 10, 0, 0, 10, 30, 20
    265  7e3c		       00 00 00 00*	      .word.w	0,0, 20, 20, 0, 0, 0, 0, 20, 20
    266  7e50		       00 00 00 00*	      .word.w	0,0, -10,-20,-20,-20,-20,-20,-20,-10
    267  7e64		       00 00 00 00*	      .word.w	0,0, -20,-30,-30,-40,-40,-30,-30,-20
    268  7e78		       00 00 00 00*	      .word.w	0,0, -30,-40,-40,-50,-50,-40,-40,-30
    269  7e8c		       00 00 00 00*	      .word.w	0,0, -30,-40,-40,-50,-50,-40,-40,-30
    270  7ea0		       00 00 00 00*	      .word.w	0,0, -30,-40,-40,-50,-50,-40,-40,-30
    271  7eb4		       00 00 00 00*	      .word.w	0,0, -30,-40,-40,-50,-50,-40,-40,-30
    272  7ec8
    273  7ec8
    274  7ec8							;---------------------------------------------------------------------------------------------------
    275  7ec8
      0  7ec8					      ALLOCATE	PositionalValue_KING_ENDGAME, 200
      0  7ec8					      OPTIONAL_PAGEBREAK	"Table", 200
 PAGE BREAK INSERTED FOR Table
 REQUESTED SIZE = $c8
 WASTED SPACE = $38
 PAGEBREAK LOCATION = $f700
     10  7f00					      LIST	ON
      0  7f00					      DEF	PositionalValue_KING_ENDGAME
      1  7f00				   BANK_PositionalValue_KING_ENDGAME SET	_CURRENT_BANK
      2  7f00				   PositionalValue_KING_ENDGAME
      3  7f00				   TEMPORARY_VAR SET	Overlay
      4  7f00				   TEMPORARY_OFFSET SET	0
      5  7f00					      SUBROUTINE
    277  7f00
    278  7f00		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    279  7f14		       00 00 00 00*	      .word.w	0,0,0,0,0,0,0,0,0,0
    280  7f28
    281  7f28		       00 00 00 00*	      .word.w	0,0, -50,-30,-30,-30,-30,-30,-30,-50
    282  7f3c		       00 00 00 00*	      .word.w	0,0, -30,-30, 0, 0, 0, 0,-30,-30
    283  7f50		       00 00 00 00*	      .word.w	0,0, -30,-10, 20, 30, 30, 20,-10,-30
    284  7f64		       00 00 00 00*	      .word.w	0,0, -30,-10, 30, 40, 40, 30,-10,-30
    285  7f78		       00 00 00 00*	      .word.w	0,0, -30,-10, 30, 40, 40, 30,-10,-30
    286  7f8c		       00 00 00 00*	      .word.w	0,0, -30,-10, 20, 30, 30, 20,-10,-30
    287  7fa0		       00 00 00 00*	      .word.w	0,0, -30,-20,-10, 0, 0,-10,-20,-30
    288  7fb4		       00 00 00 00*	      .word.w	0,0, -50,-40,-30,-20,-20,-30,-40,-50
    289  7fc8
    290  7fc8
    291  7fc8							;---------------------------------------------------------------------------------------------------
    292  7fc8
    293  7fc8
    294  7fc8				  -	      if	0
    295  7fc8				  -
    296  7fc8				  -def	      quiesce(	alpha, beta ):
    297  7fc8				  -	      stand_pat	= evaluate_board()
    298  7fc8				  -	      if(	stand_pat >= beta ):
    299  7fc8				  -	      return	beta
    300  7fc8				  -	      if(	alpha < stand_pat ):
    301  7fc8				  -	      alpha	= stand_pat
    302  7fc8				  -
    303  7fc8				  -	      for	move in board.legal_moves:
    304  7fc8				  -	      if	board.is_capture(move):
    305  7fc8				  -	      make_move(move)
    306  7fc8				  -	      score	= -quiesce( -beta, -alpha )
    307  7fc8				  -	      unmake_move()
    308  7fc8				  -
    309  7fc8				  -	      if(	score >= beta ):
    310  7fc8				  -	      return	beta
    311  7fc8				  -	      if(	score > alpha ):
    312  7fc8				  -	      alpha	= score
    313  7fc8				  -	      return	alpha
    314  7fc8				  -
    315  7fc8				  -def	      alphabeta(	alpha, beta, depthleft ):
    316  7fc8				  -	      bestscore	= -9999
    317  7fc8				  -	      if(	depthleft == 0 ):
    318  7fc8				  -	      return	quiesce( alpha, beta )
    319  7fc8				  -	      for	move in board.legal_moves:
    320  7fc8				  -	      make_move(move)
    321  7fc8				  -	      score	= -alphabeta( -beta, -alpha, depthleft - 1 )
    322  7fc8				  -	      unmake_move()
    323  7fc8				  -	      if(	score >= beta ):
    324  7fc8				  -	      return	score
    325  7fc8				  -	      if(	score > bestscore ):
    326  7fc8				  -	      bestscore	= score
    327  7fc8				  -	      if(	score > alpha ):
    328  7fc8				  -	      alpha	= score
    329  7fc8				  -	      return	bestscore
    330  7fc8				  -
    331  7fc8				  -import     chess.polyglot
    332  7fc8				  -
    333  7fc8				  -def	      selectmove(depth):
    334  7fc8				  -	      try:
    335  7fc8				  -	      move	= chess.polyglot.MemoryMappedReader("bookfish.bin").weighted_choice(board).move()
    336  7fc8				  -	      movehistory.append(move)
    337  7fc8				  -	      return	move
    338  7fc8				  -	      except:
    339  7fc8				  -	      bestMove	= chess.Move.null()
    340  7fc8				  -	      bestValue	= -99999
    341  7fc8				  -	      alpha	= -100000
    342  7fc8				  -	      beta	= 100000
    343  7fc8				  -	      for	move in board.legal_moves:
    344  7fc8				  -	      make_move(move)
    345  7fc8				  -	      boardValue	= -alphabeta(-beta, -alpha, depth-1)
    346  7fc8				  -	      if	boardValue > bestValue:
    347  7fc8				  -	      bestValue	= boardValue	;
    348  7fc8				  -	      bestMove	= move
    349  7fc8				  -	      if(	boardValue > alpha ):
    350  7fc8				  -	      alpha	= boardValue
    351  7fc8				  -	      unmake_move()
    352  7fc8				  -	      movehistory.append(bestMove)
    353  7fc8				  -	      return	bestMove
    354  7fc8				  -
    355  7fc8				  -
    356  7fc8				  -def	      evaluate_board():
    357  7fc8				  -
    358  7fc8				  -	      if	board.is_checkmate():
    359  7fc8				  -	      if	board.turn:
    360  7fc8				  -	      return	-9999
    361  7fc8				  -	      else:
    362  7fc8				  -	      return	9999
    363  7fc8				  -	      if	board.is_stalemate():
    364  7fc8				  -	      return	0
    365  7fc8				  -	      if	board.is_insufficient_material():
    366  7fc8				  -	      return	0
    367  7fc8				  -
    368  7fc8				  -	      eval	= boardvalue
    369  7fc8				  -	      if	board.turn:
    370  7fc8				  -	      return	eval
    371  7fc8				  -	      else:
    372  7fc8				  -	      return	-eval
    373  7fc8				  -
    374  7fc8				  -
    375  7fc8				  -
    376  7fc8				  -piecetypes =	[chess.PAWN, chess.KNIGHT, chess.BISHOP, chess.ROOK, chess.QUEEN, chess.KING ]
    377  7fc8				  -tables     =	[pawntable, knightstable, bishopstable, rookstable, queenstable, kingstable]
    378  7fc8				  -piecevalues =	[100,320,330,500,900]
    379  7fc8				  -
    380  7fc8				  -def	      update_eval(mov,	side):
    381  7fc8				  -	      global	boardvalue
    382  7fc8				  -
    383  7fc8				  -	      update	piecequares
    384  7fc8				  -	      movingpiece	= board.piece_type_at(mov.from_square)
    385  7fc8				  -	      if	side:
    386  7fc8				  -	      boardvalue	= boardvalue - tables[movingpiece - 1][mov.from_square]
    387  7fc8				  -	      update	castling
    388  7fc8				  -	      if	(mov.from_square == chess.E1) and (mov.to_square == chess.G1):
    389  7fc8				  -	      boardvalue	= boardvalue - rookstable[chess.H1]
    390  7fc8				  -	      boardvalue	= boardvalue + rookstable[chess.F1]
    391  7fc8				  -	      elif	(mov.from_square == chess.E1) and (mov.to_square == chess.C1):
    392  7fc8				  -	      boardvalue	= boardvalue - rookstable[chess.A1]
    393  7fc8				  -	      boardvalue	= boardvalue + rookstable[chess.D1]
    394  7fc8				  -	      else:
    395  7fc8				  -	      boardvalue	= boardvalue + tables[movingpiece - 1][mov.from_square]
    396  7fc8				  -	      update	castling
    397  7fc8				  -	      if	(mov.from_square == chess.E8) and (mov.to_square == chess.G8):
    398  7fc8				  -	      boardvalue	= boardvalue + rookstable[chess.H8]
    399  7fc8				  -	      boardvalue	= boardvalue - rookstable[chess.F8]
    400  7fc8				  -	      elif	(mov.from_square == chess.E8) and (mov.to_square == chess.C8):
    401  7fc8				  -	      boardvalue	= boardvalue + rookstable[chess.A8]
    402  7fc8				  -	      boardvalue	= boardvalue - rookstable[chess.D8]
    403  7fc8				  -
    404  7fc8				  -	      if	side:
    405  7fc8				  -	      boardvalue	= boardvalue + tables[movingpiece - 1][mov.to_square]
    406  7fc8				  -	      else:
    407  7fc8				  -	      boardvalue	= boardvalue - tables[movingpiece - 1][mov.to_square]
    408  7fc8				  -
    409  7fc8				  -
    410  7fc8				  -	      update	material
    411  7fc8				  -	      if	mov.drop != None:
    412  7fc8				  -	      if	side:
    413  7fc8				  -	      boardvalue	= boardvalue + piecevalues[mov.drop-1]
    414  7fc8				  -	      else:
    415  7fc8				  -	      boardvalue	= boardvalue - piecevalues[mov.drop-1]
    416  7fc8				  -
    417  7fc8				  -	      update	promotion
    418  7fc8				  -	      if	mov.promotion != None:
    419  7fc8				  -	      if	side:
    420  7fc8				  -	      boardvalue	= boardvalue + piecevalues[mov.promotion-1] - piecevalues[movingpiece-1]
    421  7fc8				  -	      boardvalue	= boardvalue - tables[movingpiece - 1][mov.to_square] \
    422  7fc8				  -	      +	tables[mov.promotion - 1][mov.to_square]
    423  7fc8				  -	      else:
    424  7fc8				  -	      boardvalue	= boardvalue - piecevalues[mov.promotion-1] + piecevalues[movingpiece-1]
    425  7fc8				  -	      boardvalue	= boardvalue + tables[movingpiece - 1][mov.to_square] \
    426  7fc8				  -	      -	tables[mov.promotion - 1][mov.to_square]
    427  7fc8				  -
    428  7fc8				  -
    429  7fc8				  -	      return	mov
    430  7fc8				  -
    431  7fc8				  -def	      make_move(mov):
    432  7fc8				  -	      update_eval(mov,	board.turn)
    433  7fc8				  -	      board.push(mov)
    434  7fc8				  -
    435  7fc8				  -	      return	mov
    436  7fc8				  -
    437  7fc8				  -def	      unmake_move():
    438  7fc8				  -	      mov	= board.pop()
    439  7fc8				  -	      update_eval(mov,	not board.turn)
    440  7fc8				  -
    441  7fc8				  -	      return	mov
    442  7fc8				  -
    443  7fc8				  -	      endif
    444  7fc8				  -
    445  7fc8				  -
    446  7fc8				  -	      CHECK_BANK_SIZE	"BANK_EVAL"
    447  7fc8				  -
    448  7fc8				  -
    449  7fc8				  -
    450  7fc8				  -			; EOF
------- FILE ./chess.asm
    477  7fc8
    478  7fc8							; MUST BE LAST...
------- FILE BANK_FIXED.asm LEVEL 2 PASS 2
      0  7fc8					      include	"BANK_FIXED.asm"
      1  7fc8							; Chess
      2  7fc8							; Copyright (c) 2019-2020 Andrew Davie
      3  7fc8							; andrew@taswegian.com
      4  7fc8
      5  7fc8
      6  7fc8							;---------------------------------------------------------------------------------------------------
      7  7fc8							;#########################################  FIXED BANK  ############################################
      8  7fc8							;---------------------------------------------------------------------------------------------------
      9  7fc8
     10  7fc8				   ORIGIN     SET	FIXED_BANK
     11  7fc8
      0  7fc8					      NEWBANK	THE_FIXED_BANK
      1  feeb ????				      SEG	THE_FIXED_BANK
      2  f800					      ORG	ORIGIN
      3  f800					      RORG	$F000
      4  f800				   BANK_START SET	*
      5  f800				   THE_FIXED_BANK SET	ORIGIN / 2048
      6  f800				   ORIGIN     SET	ORIGIN + 2048
      7  f800				   _CURRENT_BANK SET	THE_FIXED_BANK
     13  f800					      RORG	$f800
     14  f800
     15  f800							;---------------------------------------------------------------------------------------------------
     16  f800
      0  f800					      DEF	Reset
      1  f800				   BANK_Reset SET	_CURRENT_BANK
      2  f800				   Reset
      3  f800				   TEMPORARY_VAR SET	Overlay
      4  f800				   TEMPORARY_OFFSET SET	0
      5  f800					      SUBROUTINE
     18  f800					      SUBROUTINE
     19  f800
     20  f800		       78		      sei
     21  f801		       d8		      cld
     22  f802		       a2 ff		      ldx	#$FF
     23  f804		       9a		      txs
     24  f805
     25  f805
     26  f805							; See if we can come up with something 'random' for startup
     27  f805
     28  f805		       ac 84 02 	      ldy	INTIM
     29  f808		       d0 02		      bne	.toR
     30  f80a		       a0 9a		      ldy	#$9A
     31  f80c		       84 81	   .toR       sty	rnd
     32  f80e
     33  f80e							;lda #BANK_TitleScreen
     34  f80e							;sta SET_BANK
     35  f80e							;jsr TitleScreen
     36  f80e
     37  f80e
     38  f80e							; Move a copy of the row bank template to the first 8 banks of RAM
     39  f80e							; and then terminate the draw subroutine by substituting in a RTS on the last one
     40  f80e
      0  f80e					      JSRAM_SAFE	SetupBanks
      1  f80e
      2  f80e
      3  f80e
      4  f80e		       a9 00		      lda	#BANK_SetupBanks
      5  f810		       85 8b		      sta	savedBank
      6  f812		       85 3f		      sta	SET_BANK
      7  f814		       20 1c f1 	      jsr	SetupBanks
     42  f817
     43  f817							; Patch the final row's "loop" to a RTS
     44  f817
     45  f817		       a2 07		      ldx	#7
     46  f819		       86 3e		      stx	SET_BANK_RAM
     47  f81b		       a9 60		      lda	#$60	; "rts"
     48  f81d		       8d 00 f6 	      sta	SELFMOD_RTS_ON_LAST_ROW+RAM_WRITE
     49  f820
     50  f820
     51  f820		       a5 9b		      lda	currentPly
     52  f822		       85 3e		      sta	SET_BANK_RAM
     53  f824		       20 38 f2 	      jsr	NewPlyInitialise	; must be called at the start of every new ply
     54  f827
     55  f827		       a9 09		      lda	#RAMBANK_PLY
     56  f829		       85 3e		      sta	SET_BANK_RAM
     57  f82b		       20 d7 fc 	      jsr	InitialisePieceSquares
     58  f82e
     59  f82e		       a9 00		      lda	#WHITE
     60  f830		       85 9d		      sta	sideToMove
     61  f832
     62  f832							; Now the board is "living" in RAM (along with support code) we can do stuff with it
     63  f832
     64  f832							;---------------------------------------------------------------------------------------------------
     65  f832
     66  f832							;RESYNC
     67  f832				   .StartFrame
     68  f832
     69  f832
     70  f832							; START OF FRAME
     71  f832
     72  f832		       a9 0e		      lda	#%1110	; VSYNC ON
     73  f834		       85 42	   .loopVSync3 sta	WSYNC
     74  f836		       85 40		      sta	VSYNC
     75  f838		       4a		      lsr
     76  f839		       d0 f9		      bne	.loopVSync3	; branch until VYSNC has been reset
     77  f83b
     78  f83b		       a0 37		      ldy	#TIME_PART_1
     79  f83d		       8c 96 02 	      sty	TIM64T
     80  f840
     81  f840							; LOTS OF PROCESSING TIME - USE IT
     82  f840
     83  f840		       a2 00		      ldx	#0
     84  f842		       86 41		      stx	VBLANK
     85  f844
     86  f844
     87  f844					      IF	ASSERTS
     88  f844							;		      lda #$C2
     89  f844							;		      sta COLUBK		     ; colour timing band top of screen
     90  f844					      ENDIF
     91  f844
     92  f844		       20 9a f8 	      jsr	AiStateMachine
     93  f847
     94  f847							;jsr SAFE_PhasedProcessor
     95  f847
     96  f847					      IF	ASSERTS
     97  f847							;		      lda #0
     98  f847							;		      sta COLUBK		     ; end of timing band
     99  f847					      ENDIF
    100  f847
    101  f847					      if	ASSERTS
    102  f847							; Catch timer expired already
    103  f847		       2c 85 02 	      bit	TIMINT
    104  f84a							;.whoops	      bmi .whoops
    105  f84a					      endif
    106  f84a
    107  f84a
    108  f84a		       2c 85 02    .wait      bit	TIMINT
    109  f84d		       10 fb		      bpl	.wait
    110  f84f
    111  f84f
    112  f84f
    113  f84f							; START OF VISIBLE SCANLINES
    114  f84f
    115  f84f		       85 42		      sta	WSYNC
    116  f851
    117  f851		       20 99 f8 	      jsr	_rts
    118  f854		       20 99 f8 	      jsr	_rts
    119  f857		       20 99 f8 	      jsr	_rts
    120  f85a		       20 99 f8 	      jsr	_rts
      0  f85d					      SLEEP	3
      1  f85d				   .CYCLES    SET	3
      2  f85d
      3  f85d				  -	      IF	.CYCLES < 2
      4  f85d				  -	      ECHO	"MACRO ERROR: 'SLEEP': Duration must be > 1"
      5  f85d				  -	      ERR
      6  f85d					      ENDIF
      7  f85d
      8  f85d					      IF	.CYCLES & 1
      9  f85d					      IFNCONST	NO_ILLEGAL_OPCODES
     10  f85d		       04 00		      nop	0
     11  f85f				  -	      ELSE
     12  f85f				  -	      bit	VSYNC
     13  f85f					      ENDIF
     14  f85f				   .CYCLES    SET	.CYCLES - 3
     15  f85f					      ENDIF
     16  f85f
     17  f85f				  -	      REPEAT	.CYCLES / 2
     18  f85f				  -	      nop
     19  f85f					      REPEND
    122  f85f
    123  f85f		       a2 00		      ldx	#0
    124  f861		       86 41		      stx	VBLANK
    125  f863
    126  f863		       86 3e		      stx	SET_BANK_RAM
    127  f865		       20 03 f2 	      jsr	DrawRow	; draw the ENTIRE visible screen!
    128  f868
    129  f868
    130  f868
    131  f868
    132  f868		       a9 00		      lda	#0
    133  f86a		       85 4d		      sta	PF0
    134  f86c		       85 4e		      sta	PF1
    135  f86e		       85 4f		      sta	PF2
    136  f870		       85 5b		      sta	GRP0
    137  f872		       85 5c		      sta	GRP1
    138  f874
    139  f874		       a9 42		      lda	#%01000010	; bit6 is not required
    140  f876		       85 41		      sta	VBLANK	; end of screen - enter blanking
    141  f878
    142  f878
    143  f878							; END OF VISIBLE SCREEN
    144  f878							; HERE'S SOME TIME TO DO STUFF
    145  f878
    146  f878		       a9 26		      lda	#TIME_PART_2
    147  f87a		       8d 96 02 	      sta	TIM64T
    148  f87d
    149  f87d							;jsr AiStateMachine
    150  f87d
      0  f87d					      JSRAM	PositionSprites
      1  f87d
      2  f87d		       a9 09		      lda	#BANK_PositionSprites
      3  f87f		       85 3f		      sta	SET_BANK
      4  f881		       20 00 f4 	      jsr	PositionSprites
    152  f884
    153  f884
    154  f884
    155  f884							; "draw" sprite shapes into row banks
    156  f884
    157  f884		       a2 07		      ldx	#7
    158  f886		       86 3e	   zapem      stx	SET_BANK_RAM
    159  f888		       20 a6 f2 	      jsr	WriteBlank
    160  f88b		       ca		      dex
    161  f88c		       10 f8		      bpl	zapem
    162  f88e
    163  f88e		       20 cf f2 	      jsr	WriteCursor
    164  f891
    165  f891
    166  f891		       2c 85 02    Waitforit  bit	TIMINT
    167  f894		       10 fb		      bpl	Waitforit
    168  f896
    169  f896		       4c 32 f8 	      jmp	.StartFrame
    170  f899
    171  f899
    172  f899		       60	   _rts       rts
    173  f89a
    174  f89a
    175  f89a							;---------------------------------------------------------------------------------------------------
    176  f89a
      0  f89a					      DEF	AiStateMachine
      1  f89a				   BANK_AiStateMachine SET	_CURRENT_BANK
      2  f89a				   AiStateMachine
      3  f89a				   TEMPORARY_VAR SET	Overlay
      4  f89a				   TEMPORARY_OFFSET SET	0
      5  f89a					      SUBROUTINE
    178  f89a							;SUBROUTINE
    179  f89a
    180  f89a		       a9 09		      lda	#BANK_AiVectorLO
    181  f89c		       85 3f		      sta	SET_BANK	; to access vectors
    182  f89e		       20 88 f0 	      jsr	AiSetupVectors
    183  f8a1		       b0 06		      bcs	.exit
    184  f8a3		       85 3f		      sta	SET_BANK
    185  f8a5
    186  f8a5		       20 aa f8 	      jsr	.ind
    187  f8a8		       60		      rts		;tmp jmp AiStateMachine
    188  f8a9
    189  f8a9
    190  f8a9		       60	   .exit      rts
    191  f8aa		       6c ed 00    .ind       jmp	(__ptr)
    192  f8ad
    193  f8ad
    194  f8ad							;---------------------------------------------------------------------------------------------------
    195  f8ad
      0  f8ad					      DEF	CallClear
      1  f8ad				   BANK_CallClear SET	_CURRENT_BANK
      2  f8ad				   CallClear
      3  f8ad				   TEMPORARY_VAR SET	Overlay
      4  f8ad				   TEMPORARY_OFFSET SET	0
      5  f8ad					      SUBROUTINE
    197  f8ad					      SUBROUTINE
    198  f8ad
    199  f8ad		       84 3e		      sty	SET_BANK_RAM
    200  f8af		       20 90 f1 	      jsr	ClearRowBitmap
    201  f8b2		       60		      rts
    202  f8b3
    203  f8b3							;---------------------------------------------------------------------------------------------------
    204  f8b3
      0  f8b3					      DEF	SAFE_Get64toX12Board
      1  f8b3				   BANK_SAFE_Get64toX12Board SET	_CURRENT_BANK
      2  f8b3				   SAFE_Get64toX12Board
      3  f8b3				   TEMPORARY_VAR SET	Overlay
      4  f8b3				   TEMPORARY_OFFSET SET	0
      5  f8b3					      SUBROUTINE
    206  f8b3					      SUBROUTINE
    207  f8b3
    208  f8b3		       a9 08		      lda	#RAMBANK_MOVES_RAM
    209  f8b5		       85 3e		      sta	SET_BANK_RAM
    210  f8b7		       bc 4d f3 	      ldy	Base64ToIndex,x
    211  f8ba		       b9 7c f0 	      lda	Board,y
    212  f8bd		       a4 8b		      ldy	savedBank
    213  f8bf		       84 3f		      sty	SET_BANK
    214  f8c1		       60		      rts
    215  f8c2
    216  f8c2							;---------------------------------------------------------------------------------------------------
    217  f8c2
      0  f8c2					      DEF	aiDrawEntireBoard
      1  f8c2				   BANK_aiDrawEntireBoard SET	_CURRENT_BANK
      2  f8c2				   aiDrawEntireBoard
      3  f8c2				   TEMPORARY_VAR SET	Overlay
      4  f8c2				   TEMPORARY_OFFSET SET	0
      5  f8c2					      SUBROUTINE
    219  f8c2					      SUBROUTINE
    220  f8c2
    221  f8c2		       a9 08		      lda	#RAMBANK_MOVES_RAM
    222  f8c4		       85 3e		      sta	SET_BANK_RAM
    223  f8c6
    224  f8c6		       a6 80		      ldx	drawPieceNumber
    225  f8c8		       bc 4d f3 	      ldy	Base64ToIndex,x
    226  f8cb		       b9 7c f0 	      lda	Board,y
    227  f8ce		       f0 16		      beq	.isablank
    228  f8d0		       48		      pha
    229  f8d1		       a9 00		      lda	#BLANK
    230  f8d3		       99 7c f4 	      sta	Board+RAM_WRITE,y
    231  f8d6
    232  f8d6		       20 f2 fd 	      jsr	CopySinglePiece
    233  f8d9
    234  f8d9		       a9 08		      lda	#RAMBANK_MOVES_RAM
    235  f8db		       85 3e		      sta	SET_BANK_RAM
    236  f8dd		       a6 80		      ldx	drawPieceNumber
    237  f8df		       bc 4d f3 	      ldy	Base64ToIndex,x
    238  f8e2		       68		      pla
    239  f8e3		       99 7c f4 	      sta	Board+RAM_WRITE,y
    240  f8e6
      0  f8e6				   .isablank  PHASE	AI_DrawPart2
      1  f8e6		       a9 10		      lda	#AI_DrawPart2
      2  f8e8		       85 8c		      sta	aiPhase
    242  f8ea		       60		      rts
    243  f8eb
    244  f8eb
    245  f8eb							;---------------------------------------------------------------------------------------------------
    246  f8eb
      0  f8eb					      DEF	aiFlipBuffers
      1  f8eb				   BANK_aiFlipBuffers SET	_CURRENT_BANK
      2  f8eb				   aiFlipBuffers
      3  f8eb				   TEMPORARY_VAR SET	Overlay
      4  f8eb				   TEMPORARY_OFFSET SET	0
      5  f8eb					      SUBROUTINE
    248  f8eb					      SUBROUTINE
    249  f8eb
    250  f8eb							; Initialise for a new move
    251  f8eb
    252  f8eb		       a5 9b		      lda	currentPly
    253  f8ed		       85 3e		      sta	SET_BANK_RAM
    254  f8ef
    255  f8ef		       20 38 f2 	      jsr	NewPlyInitialise	; zap movelist for this ply
    256  f8f2
      0  f8f2					      PHASE	AI_GenerateMoves
      1  f8f2		       a9 12		      lda	#AI_GenerateMoves
      2  f8f4		       85 8c		      sta	aiPhase
    258  f8f6		       60		      rts
    259  f8f7
    260  f8f7
    261  f8f7							;---------------------------------------------------------------------------------------------------
    262  f8f7
      0  f8f7					      DEF	SAFE_InitialiseMoveGeneration
      1  f8f7				   BANK_SAFE_InitialiseMoveGeneration SET	_CURRENT_BANK
      2  f8f7				   SAFE_InitialiseMoveGeneration
      3  f8f7				   TEMPORARY_VAR SET	Overlay
      4  f8f7				   TEMPORARY_OFFSET SET	0
      5  f8f7					      SUBROUTINE
    264  f8f7					      SUBROUTINE
    265  f8f7
    266  f8f7		       a5 9b		      lda	currentPly
    267  f8f9		       85 3e		      sta	SET_BANK_RAM
    268  f8fb
    269  f8fb		       20 38 f2 	      jsr	NewPlyInitialise
    270  f8fe
    271  f8fe		       a5 8b		      lda	savedBank
    272  f900		       85 3f		      sta	SET_BANK
    273  f902		       60		      rts
    274  f903
    275  f903
    276  f903							;---------------------------------------------------------------------------------------------------
    277  f903
    278  f903							;TODO...
      0  f903					      DEF	SAFE_GenerateOneMove
      1  f903				   BANK_SAFE_GenerateOneMove SET	_CURRENT_BANK
      2  f903				   SAFE_GenerateOneMove
      3  f903				   TEMPORARY_VAR SET	Overlay
      4  f903				   TEMPORARY_OFFSET SET	0
      5  f903					      SUBROUTINE
    280  f903					      SUBROUTINE
    281  f903
    282  f903		       a5 9b		      lda	currentPly
    283  f905		       85 3e		      sta	SET_BANK_RAM
    284  f907		       20 5e f2 	      jsr	GenerateMovesForNextPiece
    285  f90a
    286  f90a		       a5 8b		      lda	savedBank
    287  f90c		       85 3f		      sta	SET_BANK
    288  f90e		       60		      rts
    289  f90f
    290  f90f
    291  f90f							;---------------------------------------------------------------------------------------------------
    292  f90f
    293  f90f							;TODO...
      0  f90f					      DEF	SAFE_LookForCheck
      1  f90f				   BANK_SAFE_LookForCheck SET	_CURRENT_BANK
      2  f90f				   SAFE_LookForCheck
      3  f90f				   TEMPORARY_VAR SET	Overlay
      4  f90f				   TEMPORARY_OFFSET SET	0
      5  f90f					      SUBROUTINE
    295  f90f					      SUBROUTINE
    296  f90f
    297  f90f		       a5 9b		      lda	currentPly
    298  f911		       85 3e		      sta	SET_BANK_RAM
    299  f913
    300  f913		       ac a1 f1 	      ldy	moveIndex
    301  f916		       30 0f		      bmi	.failed
    302  f918
    303  f918		       be 00 f1    .scan      ldx	MoveTo,y
    304  f91b		       bd 7c f0 	      lda	Board,x
    305  f91e		       29 0f		      and	#PIECE_MASK
    306  f920		       c9 07		      cmp	#KING
    307  f922		       f0 04		      beq	.inCheck	; --> CS too
    308  f924		       88		      dey
    309  f925		       10 f1		      bpl	.scan
    310  f927
    311  f927		       18	   .failed    clc
    312  f928
    313  f928		       a5 8b	   .inCheck   lda	savedBank	; CS or CC
    314  f92a		       85 3f		      sta	SET_BANK
    315  f92c		       60		      rts
    316  f92d
    317  f92d
    318  f92d							;---------------------------------------------------------------------------------------------------
    319  f92d
      0  f92d					      DEF	aiGenerateMoves
      1  f92d				   BANK_aiGenerateMoves SET	_CURRENT_BANK
      2  f92d				   aiGenerateMoves
      3  f92d				   TEMPORARY_VAR SET	Overlay
      4  f92d				   TEMPORARY_OFFSET SET	0
      5  f92d					      SUBROUTINE
    321  f92d					      SUBROUTINE
    322  f92d
    323  f92d		       20 03 f9 	      jsr	SAFE_GenerateOneMove
    324  f930		       90 0d		      bcc	.wait
    325  f932
    326  f932							;lda currentPly
    327  f932							;sta SET_BANK_RAM
    328  f932							;jsr alphaBeta
    329  f932
    330  f932							;lda #WHITE_PLAYER
    331  f932							;bne .computer
    332  f932
    333  f932		       a6 9d		      ldx	sideToMove
    334  f934		       10 05		      bpl	.player
    335  f936				  -	      if	PVSP
    336  f936				  -	      jmp	.player	;tmp
    337  f936					      endif
    338  f936
      0  f936				   .computer  PHASE	AI_ComputerMove	; computer select move
      1  f936		       a9 13		      lda	#AI_ComputerMove
      2  f938		       85 8c		      sta	aiPhase
    340  f93a		       60		      rts
    341  f93b
    342  f93b
      0  f93b				   .player    PHASE	AI_StartMoveGen
      1  f93b		       a9 0a		      lda	#AI_StartMoveGen
      2  f93d		       85 8c		      sta	aiPhase
    344  f93f		       60	   .wait      rts
    345  f940
    346  f940
    347  f940							;---------------------------------------------------------------------------------------------------
    348  f940
      0  f940					      DEF	aiComputerMove
      1  f940				   BANK_aiComputerMove SET	_CURRENT_BANK
      2  f940				   aiComputerMove
      3  f940				   TEMPORARY_VAR SET	Overlay
      4  f940				   TEMPORARY_OFFSET SET	0
      5  f940					      SUBROUTINE
    350  f940					      SUBROUTINE
    351  f940
    352  f940							; Choose one of the moves
    353  f940
    354  f940		       a5 9b		      lda	currentPly
    355  f942		       85 3e		      sta	SET_BANK_RAM	; switch in movelist
    356  f944
    357  f944		       a9 ff		      lda	#-1
    358  f946		       cd a1 f1 	      cmp	moveIndex
    359  f949		       f0 0f		      beq	.halted	; no valid moves
    360  f94b
    361  f94b		       85 9e		      sta	fromSquare
    362  f94d		       85 a0		      sta	toSquare
    363  f94f
    364  f94f		       a5 9d		      lda	sideToMove
    365  f951		       10 03		      bpl	.notComputer
    366  f953
    367  f953		       20 ee f2 	      jsr	MoveViaListAtPly
    368  f956
      0  f956				   .notComputer PHASE	AI_PrepForPhysicalMove
      1  f956		       a9 14		      lda	#AI_PrepForPhysicalMove
      2  f958		       85 8c		      sta	aiPhase
    370  f95a		       60	   .halted    rts
    371  f95b
    372  f95b
    373  f95b							;---------------------------------------------------------------------------------------------------
    374  f95b
      0  f95b					      DEF	debug
      1  f95b				   BANK_debug SET	_CURRENT_BANK
      2  f95b				   debug
      3  f95b				   TEMPORARY_VAR SET	Overlay
      4  f95b				   TEMPORARY_OFFSET SET	0
      5  f95b					      SUBROUTINE
    376  f95b					      SUBROUTINE
    377  f95b
    378  f95b							; Use this to trap breakpoints in "unknown" banks. Just "jsr catch" from wherever you want
    379  f95b							; to catch the code, and put a breakpoint here instead. Then step, and you're at the place
    380  f95b							; you wanted to see, without knowing the bank.
    381  f95b
    382  f95b		       60		      rts
    383  f95c
    384  f95c
    385  f95c							;---------------------------------------------------------------------------------------------------
    386  f95c
      0  f95c					      DEF	aiMarchToTargetA
      1  f95c				   BANK_aiMarchToTargetA SET	_CURRENT_BANK
      2  f95c				   aiMarchToTargetA
      3  f95c				   TEMPORARY_VAR SET	Overlay
      4  f95c				   TEMPORARY_OFFSET SET	0
      5  f95c					      SUBROUTINE
    388  f95c					      SUBROUTINE
    389  f95c
    390  f95c		       a9 0c		      lda	#BANK_RECON_MarchToTargetA
    391  f95e		       85 3f		      sta	SET_BANK
    392  f960		       20 a0 f0 	      jsr	RECON_MarchToTargetA
    393  f963		       b0 2c		      bcs	.unmoved
    394  f965
    395  f965							; erase object in new sqare --> blank
    396  f965
    397  f965		       a6 9e		      ldx	fromSquare
    398  f967		       86 80		      stx	drawPieceNumber
    399  f969		       a9 08		      lda	#RAMBANK_MOVES_RAM
    400  f96b		       85 3e		      sta	SET_BANK_RAM
    401  f96d		       bc 4d f3 	      ldy	Base64ToIndex,x
    402  f970		       b9 7c f0 	      lda	Board,y
    403  f973		       f0 03		      beq	.skipbl
    404  f975		       20 f2 fd 	      jsr	CopySinglePiece	; erase next square along --> blank
    405  f978
    406  f978		       a9 08	   .skipbl    lda	#RAMBANK_MOVES_RAM
    407  f97a		       85 3e		      sta	SET_BANK_RAM
    408  f97c		       a6 9e		      ldx	fromSquare
    409  f97e		       bc 4d f3 	      ldy	Base64ToIndex,x
    410  f981
    411  f981		       b9 7c f0 	      lda	Board,y
    412  f984		       85 a1		      sta	lastPiece	; what we are overwriting
    413  f986		       a5 9f		      lda	fromPiece
    414  f988							;ora #FLAG_MOVED		  ; prevents usage in castling for K/R
    415  f988		       29 df		      and	#~FLAG_ENPASSANT
    416  f98a		       99 7c f4 	      sta	Board+RAM_WRITE,y	; and what's actually moving there
    417  f98d
      0  f98d					      PHASE	AI_MarchB
      1  f98d		       a9 17		      lda	#AI_MarchB
      2  f98f		       85 8c		      sta	aiPhase
    419  f991
    420  f991		       60	   .unmoved   rts
    421  f992
    422  f992
    423  f992							;---------------------------------------------------------------------------------------------------
    424  f992
      0  f992					      DEF	aiMarchToTargetB
      1  f992				   BANK_aiMarchToTargetB SET	_CURRENT_BANK
      2  f992				   aiMarchToTargetB
      3  f992				   TEMPORARY_VAR SET	Overlay
      4  f992				   TEMPORARY_OFFSET SET	0
      5  f992					      SUBROUTINE
    426  f992					      SUBROUTINE
    427  f992
    428  f992							;lda drawDelay
    429  f992							;beq .mb
    430  f992							;dec drawDelay
    431  f992							;rts
    432  f992							;.mb
    433  f992
    434  f992
    435  f992							; now we want to undraw the piece in the old square
    436  f992
    437  f992		       a5 83		      lda	lastSquare
    438  f994		       85 80		      sta	drawPieceNumber
    439  f996		       20 f2 fd 	      jsr	CopySinglePiece	; erase whatever was on the previous square (completely blank)
    440  f999
    441  f999		       a9 08		      lda	#RAMBANK_MOVES_RAM
    442  f99b		       85 3e		      sta	SET_BANK_RAM
    443  f99d		       a5 a2		      lda	previousPiece
    444  f99f
    445  f99f		       a6 83		      ldx	lastSquare
    446  f9a1		       bc 4d f3 	      ldy	Base64ToIndex,x
    447  f9a4		       99 7c f4 	      sta	Board+RAM_WRITE,y
    448  f9a7
    449  f9a7		       a5 a1		      lda	lastPiece
    450  f9a9		       85 a2		      sta	previousPiece
    451  f9ab
      0  f9ab					      PHASE	AI_MarchB2
      1  f9ab		       a9 19		      lda	#AI_MarchB2
      2  f9ad		       85 8c		      sta	aiPhase
    453  f9af
    454  f9af		       60		      rts
    455  f9b0
    456  f9b0
    457  f9b0							;---------------------------------------------------------------------------------------------------
    458  f9b0
    459  f9b0
      0  f9b0					      DEF	aiMarchB2
      1  f9b0				   BANK_aiMarchB2 SET	_CURRENT_BANK
      2  f9b0				   aiMarchB2
      3  f9b0				   TEMPORARY_VAR SET	Overlay
      4  f9b0				   TEMPORARY_OFFSET SET	0
      5  f9b0					      SUBROUTINE
    461  f9b0					      SUBROUTINE
    462  f9b0
    463  f9b0		       a6 83		      ldx	lastSquare
    464  f9b2		       86 80		      stx	drawPieceNumber
    465  f9b4
    466  f9b4		       a9 08		      lda	#RAMBANK_MOVES_RAM
    467  f9b6		       85 3e		      sta	SET_BANK_RAM
    468  f9b8		       bc 4d f3 	      ldy	Base64ToIndex,x
    469  f9bb		       b9 7c f0 	      lda	Board,y
    470  f9be		       f0 03		      beq	.skipbl2
    471  f9c0
    472  f9c0		       20 f2 fd 	      jsr	CopySinglePiece	; draw previous piece back in old position
    473  f9c3				   .skipbl2
    474  f9c3		       a5 9e		      lda	fromSquare
    475  f9c5		       c5 a0		      cmp	toSquare
    476  f9c7		       f0 09		      beq	xhalt
    477  f9c9
    478  f9c9		       a9 00		      lda	#0	; inter-move segment speed (can be 0)
    479  f9cb		       85 82		      sta	drawDelay
      0  f9cd					      PHASE	AI_MarchToTargetA
      1  f9cd		       a9 16		      lda	#AI_MarchToTargetA
      2  f9cf		       85 8c		      sta	aiPhase
    481  f9d1
    482  f9d1		       60		      rts
    483  f9d2
    484  f9d2				   xhalt
    485  f9d2
    486  f9d2		       20 22 fe 	      jsr	FinaliseMove
    487  f9d5
    488  f9d5
    489  f9d5		       a9 04		      lda	#4	; on/off count
    490  f9d7		       85 84		      sta	drawCount	; flashing for piece about to move
    491  f9d9		       a9 00		      lda	#0
    492  f9db		       85 82		      sta	drawDelay
    493  f9dd
      0  f9dd					      PHASE	AI_FinalFlash
      1  f9dd		       a9 1a		      lda	#AI_FinalFlash
      2  f9df		       85 8c		      sta	aiPhase
    495  f9e1		       60		      rts
    496  f9e2
    497  f9e2
    498  f9e2							;---------------------------------------------------------------------------------------------------
    499  f9e2
      0  f9e2					      DEF	aiSpecialMoveFixup
      1  f9e2				   BANK_aiSpecialMoveFixup SET	_CURRENT_BANK
      2  f9e2				   aiSpecialMoveFixup
      3  f9e2				   TEMPORARY_VAR SET	Overlay
      4  f9e2				   TEMPORARY_OFFSET SET	0
      5  f9e2					      SUBROUTINE
    501  f9e2					      SUBROUTINE
    502  f9e2
      0  f9e2					      PHASE	AI_FlipBuffers
      1  f9e2		       a9 11		      lda	#AI_FlipBuffers
      2  f9e4		       85 8c		      sta	aiPhase
    504  f9e6
      0  f9e6					      JSRAM_SAFE	CastleFixup
      1  f9e6
      2  f9e6
      3  f9e6
      4  f9e6		       a9 00		      lda	#BANK_CastleFixup
      5  f9e8		       85 8b		      sta	savedBank
      6  f9ea		       85 3f		      sta	SET_BANK
      7  f9ec		       20 ce f0 	      jsr	CastleFixup
    506  f9ef
    507  f9ef
    508  f9ef							; Handle en-passant captures
    509  f9ef							; The (dual-use) FLAG_ENPASSANT will have been cleared if it was set for a home-rank move
    510  f9ef							; but if we're here and the flag is still set, then it's an actual en-passant CAPTURE and we
    511  f9ef							; need to do the appropriate things...
    512  f9ef
    513  f9ef
    514  f9ef							; With en-passant flag, it is essentially dual-use.
    515  f9ef							; First, it marks if the move is *involved* somehow in an en-passant
    516  f9ef							; if the piece has MOVED already, then it's an en-passant capture
    517  f9ef							; if it has NOT moved, then it's a pawn leaving home rank, and sets the en-passant square
    518  f9ef
    519  f9ef		       a4 99		      ldy	enPassantPawn	; save
    520  f9f1
    521  f9f1		       a2 00		      ldx	#0
    522  f9f3		       a5 9f		      lda	fromPiece
    523  f9f5		       29 60		      and	#FLAG_ENPASSANT|FLAG_MOVED
    524  f9f7		       c9 20		      cmp	#FLAG_ENPASSANT
    525  f9f9		       d0 08		      bne	.noep	; HAS moved, or not en-passant
    526  f9fb
    527  f9fb		       a5 9f		      lda	fromPiece
    528  f9fd		       29 df		      and	#~FLAG_ENPASSANT	; clear flag as it's been handled
    529  f9ff		       85 9f		      sta	fromPiece
    530  fa01
    531  fa01		       a6 85		      ldx	fromX12	; this IS an en-passantable opening, so record the square
    532  fa03		       86 99	   .noep      stx	enPassantPawn	; capturable square for en-passant move
    533  fa05
    534  fa05
    535  fa05							; ^
    536  fa05
    537  fa05
    538  fa05							; Check to see if we are doing an actual en-passant capture...
    539  fa05
    540  fa05		       a5 9f		      lda	fromPiece
    541  fa07		       29 20		      and	#FLAG_ENPASSANT
    542  fa09		       f0 31		      beq	.noEP
    543  fa0b
    544  fa0b
    545  fa0b					      if	1
    546  fa0b
    547  fa0b				   capture
    548  fa0b
    549  fa0b					      IF	ASSERTS
    550  fa0b		       c0 00		      cpy	#0
    551  fa0d		       f0 fe	   .eperror   beq	.eperror	; CANNOT have EP *AND* no capture square!!
    552  fa0f					      ENDIF
    553  fa0f
    554  fa0f		       a5 9d		      lda	sideToMove
    555  fa11		       49 80		      eor	#128
    556  fa13		       85 9d		      sta	sideToMove
    557  fa15
    558  fa15		       a9 0d		      lda	#BANK_X12toBase64b
    559  fa17		       85 3f		      sta	SET_BANK
    560  fa19
    561  fa19
    562  fa19		       84 85		      sty	fromX12
    563  fa1b		       b9 00 f4 	      lda	X12toBase64b,y
    564  fa1e		       85 80		      sta	drawPieceNumber
    565  fa20
    566  fa20		       a9 08		      lda	#RAMBANK_MOVES_RAM
    567  fa22		       85 3e		      sta	SET_BANK_RAM
    568  fa24		       b9 7c f0 	      lda	Board,y
    569  fa27		       20 f2 fd 	      jsr	CopySinglePiece	; ERASE pawn
    570  fa2a
    571  fa2a
    572  fa2a		       a5 9d		      lda	sideToMove
    573  fa2c		       0a		      asl
    574  fa2d		       a9 09		      lda	#RAMBANK_PLY
    575  fa2f		       69 00		      adc	#0
    576  fa31		       85 3e		      sta	SET_BANK_RAM
    577  fa33
    578  fa33		       20 89 f2 	      jsr	FixPieceList	; REMOVE any captured object
    579  fa36
    580  fa36		       a5 9d		      lda	sideToMove
    581  fa38		       49 80		      eor	#128
    582  fa3a		       85 9d		      sta	sideToMove
    583  fa3c
    584  fa3c					      endif
    585  fa3c
    586  fa3c
    587  fa3c
    588  fa3c				   .noEP
    589  fa3c
    590  fa3c							; Mark the piece as MOVED
    591  fa3c
    592  fa3c		       a9 08		      lda	#RAMBANK_MOVES_RAM
    593  fa3e		       85 3e		      sta	SET_BANK_RAM
    594  fa40		       a4 85		      ldy	fromX12	; final square
    595  fa42		       b9 7c f0 	      lda	Board,y
    596  fa45		       29 df		      and	#~FLAG_ENPASSANT
    597  fa47		       09 40		      ora	#FLAG_MOVED
    598  fa49		       99 7c f4 	      sta	Board+RAM_WRITE,y
    599  fa4c
    600  fa4c
    601  fa4c
    602  fa4c
    603  fa4c					      if	ASSERTS
      0  fa4c					      JSRAM_SAFE	DIAGNOSTIC_checkPieces
      1  fa4c
      2  fa4c
      3  fa4c
      4  fa4c		       a9 0e		      lda	#BANK_DIAGNOSTIC_checkPieces
      5  fa4e		       85 8b		      sta	savedBank
      6  fa50		       85 3f		      sta	SET_BANK
      7  fa52		       20 ea f1 	      jsr	DIAGNOSTIC_checkPieces
    605  fa55					      endif
    606  fa55
    607  fa55
    608  fa55		       a5 9d		      lda	sideToMove
    609  fa57		       49 80		      eor	#128
    610  fa59		       85 9d		      sta	sideToMove
    611  fa5b
    612  fa5b		       60		      rts
    613  fa5c
    614  fa5c
    615  fa5c							;---------------------------------------------------------------------------------------------------
    616  fa5c
      0  fa5c					      DEF	MoveForSinglePiece
      1  fa5c				   BANK_MoveForSinglePiece SET	_CURRENT_BANK
      2  fa5c				   MoveForSinglePiece
      3  fa5c				   TEMPORARY_VAR SET	Overlay
      4  fa5c				   TEMPORARY_OFFSET SET	0
      5  fa5c					      SUBROUTINE
    618  fa5c					      SUBROUTINE
    619  fa5c
      0  fa5c					      VAR	__vector, 2
      1  fa5c				   __vector   SET	TEMPORARY_VAR
      2  fa5c				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 2
      3  fa5c
      4  fa5c				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  fa5c				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  fa5c				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  fa5c					      ENDIF
      8  fa5c				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  fa5c				  -	      ECHO	"Temporary Variable", __vector, "overflow!"
     10  fa5c				  -	      ERR
     11  fa5c					      ENDIF
     12  fa5c					      LIST	ON
    621  fa5c
    622  fa5c		       a9 08		      lda	#RAMBANK_MOVES_RAM
    623  fa5e		       85 3e		      sta	SET_BANK_RAM
    624  fa60
    625  fa60		       a6 97		      ldx	currentSquare	; used in move handlers
    626  fa62		       bd 7c f0 	      lda	Board,x
    627  fa65		       85 96		      sta	currentPiece
    628  fa67
    629  fa67					      IF	ASSERTS
    630  fa67					      SUBROUTINE
    631  fa67							; DEBUG: Make sure we're looking at correct colour
    632  fa67		       45 9d		      eor	sideToMove
    633  fa69		       30 fe	   .lock      bmi	.lock
    634  fa6b		       a5 96		      lda	currentPiece
    635  fa6d					      ENDIF
    636  fa6d
    637  fa6d		       29 0f		      and	#PIECE_MASK
    638  fa6f		       a8		      tay
    639  fa70
    640  fa70					      IF	ASSERTS
    641  fa70							; DEBUG: Make sure we have an actual piece, not an empty square
    642  fa70					      SUBROUTINE
    643  fa70		       f0 fe	   .lock      beq	.lock	; catch errors
    644  fa72					      ENDIF
    645  fa72
    646  fa72		       b9 84 fa 	      lda	HandlerVectorLO-1,y
    647  fa75		       85 a5		      sta	__vector
    648  fa77		       b9 8b fa 	      lda	HandlerVectorHI-1,y
    649  fa7a		       85 a6		      sta	__vector+1
    650  fa7c		       6c a5 00 	      jmp	(__vector)
    651  fa7f
    652  fa7f		       a5 9b	   MoveReturn lda	currentPly
    653  fa81		       85 3e		      sta	SET_BANK_RAM
    654  fa83
    655  fa83		       60		      rts
    656  fa84
    657  fa84					      MAC	handlevec
    658  fa84					      .byte	{1}Handle_WHITE_PAWN	; 1
    659  fa84					      .byte	{1}Handle_BLACK_PAWN	; 2
    660  fa84					      .byte	{1}Handle_KNIGHT	; 3
    661  fa84					      .byte	{1}Handle_BISHOP	; 4
    662  fa84					      .byte	{1}Handle_ROOK	; 5
    663  fa84					      .byte	{1}Handle_QUEEN	; 6
    664  fa84					      .byte	{1}Handle_KING	; 7
    665  fa84					      ENDM
    666  fa84
    667  fa84
      0  fa84					      ALLOCATE	Handlers, 15
      0  fa84					      OPTIONAL_PAGEBREAK	"Table", 15
     10  fa84					      LIST	ON
      0  fa84					      DEF	Handlers
      1  fa84				   BANK_Handlers SET	_CURRENT_BANK
      2  fa84				   Handlers
      3  fa84				   TEMPORARY_VAR SET	Overlay
      4  fa84				   TEMPORARY_OFFSET SET	0
      5  fa84					      SUBROUTINE
    669  fa84
    670  fa84		       00		      .byte.b	0	; dummy to prevent page cross access on index 0
    671  fa85
      0  fa85				   HandlerVectorLO HANDLEVEC	<
      1  fa85		       be		      .byte.b	<Handle_WHITE_PAWN
      2  fa86		       84		      .byte.b	<Handle_BLACK_PAWN
      3  fa87		       1f		      .byte.b	<Handle_KNIGHT
      4  fa88		       a3		      .byte.b	<Handle_BISHOP
      5  fa89		       06		      .byte.b	<Handle_ROOK
      6  fa8a		       e0		      .byte.b	<Handle_QUEEN
      7  fa8b		       69		      .byte.b	<Handle_KING
      0  fa8c				   HandlerVectorHI HANDLEVEC	>
      1  fa8c		       fa		      .byte.b	>Handle_WHITE_PAWN
      2  fa8d		       fb		      .byte.b	>Handle_BLACK_PAWN
      3  fa8e		       fc		      .byte.b	>Handle_KNIGHT
      4  fa8f		       f1		      .byte.b	>Handle_BISHOP
      5  fa90		       f2		      .byte.b	>Handle_ROOK
      6  fa91		       f0		      .byte.b	>Handle_QUEEN
      7  fa92		       f2		      .byte.b	>Handle_KING
    674  fa93
    675  fa93							;---------------------------------------------------------------------------------------------------
    676  fa93
------- FILE Handler_PAWN.asm LEVEL 3 PASS 2
      0  fa93					      include	"Handler_PAWN.asm"
      1  fa93							; Copyright (C)2020 Andrew Davie
      2  fa93							; Pawn move handlers
      3  fa93
      4  fa93							;---------------------------------------------------------------------------------------------------
      5  fa93							; WHITE PAWN
      6  fa93							;---------------------------------------------------------------------------------------------------
      7  fa93
      8  fa93		       00 28	   WHITE_HOME_ROW =	40	; < this, on home row
      9  fa93		       00 52	   BLACK_HOME_ROW =	82	; >= this, on home row
     10  fa93
     11  fa93							;---------------------------------------------------------------------------------------------------
     12  fa93
     13  fa93					      MAC	en_passant
     14  fa93					      SUBROUTINE
     15  fa93							; {1} = _LEFT or _RIGHT
     16  fa93
     17  fa93					      ldx	currentSquare
     18  fa93					      ldy	ValidSquare+{1},x
     19  fa93					      cpy	enPassantPawn
     20  fa93					      bne	.invalid
     21  fa93					      ldy	ValidSquare+{1}+{2},x	; en-passant endpoint must be blank
     22  fa93					      lda	Board,y
     23  fa93					      bne	.invalid
     24  fa93					      jsr	AddMove	; the MOVE will need to deal with the details of en-passant??
     25  fa93				   .invalid
     26  fa93					      ENDM
     27  fa93
     28  fa93							;---------------------------------------------------------------------------------------------------
     29  fa93
     30  fa93					      MAC	promote_pawn
     31  fa93					      SUBROUTINE
     32  fa93
     33  fa93							;{1} = BLACK or WHITE
     34  fa93
     35  fa93					      VAR	__temp, 1
     36  fa93
     37  fa93					      lda	currentPiece
     38  fa93					      pha
     39  fa93
     40  fa93					      sty	__temp
     41  fa93					      lda	#{1}|QUEEN
     42  fa93					      sta	currentPiece
     43  fa93					      jsr	AddMove
     44  fa93
     45  fa93					      lda	#{1}|ROOK
     46  fa93					      sta	currentPiece
     47  fa93					      ldy	__temp
     48  fa93					      jsr	AddMove
     49  fa93
     50  fa93					      lda	#{1}|BISHOP
     51  fa93					      sta	currentPiece
     52  fa93					      ldy	__temp
     53  fa93					      jsr	AddMove
     54  fa93
     55  fa93					      lda	#{1}|KNIGHT
     56  fa93					      sta	currentPiece
     57  fa93					      ldy	__temp
     58  fa93					      jsr	AddMove
     59  fa93
     60  fa93					      pla
     61  fa93					      sta	currentPiece
     62  fa93					      ENDM
     63  fa93
     64  fa93							;---------------------------------------------------------------------------------------------------
     65  fa93
     66  fa93					      MAC	move_or_promote_pawn
     67  fa93					      SUBROUTINE
     68  fa93							; {1} = BLACK or WHITE
     69  fa93
     70  fa93					      IF	{1} = WHITE
     71  fa93					      cpy	#90	; last rank?
     72  fa93					      bcc	.standard
     73  fa93					      jsr	PromoteWhitePawn
     74  fa93					      jmp	.pMoved
     75  fa93					      ENDIF
     76  fa93
     77  fa93					      IF	{1} = BLACK
     78  fa93					      cpy	#30	; last rank?
     79  fa93					      bcs	.standard
     80  fa93					      jsr	PromoteBlackPawn
     81  fa93					      jmp	.pMoved
     82  fa93					      ENDIF
     83  fa93
     84  fa93				   .standard  jsr	AddMove	; add +1UP move
     85  fa93				   .pMoved
     86  fa93
     87  fa93					      ENDM
     88  fa93
     89  fa93							;---------------------------------------------------------------------------------------------------
     90  fa93
     91  fa93					      MAC	take
     92  fa93					      SUBROUTINE
     93  fa93							; {1} = capture square offset
     94  fa93
     95  fa93					      ldx	currentSquare
     96  fa93					      ldy	ValidSquare+{1},x
     97  fa93					      bmi	.invalid
     98  fa93					      lda	Board,y
     99  fa93					      beq	.invalid	; square empty
    100  fa93					      eor	currentPiece
    101  fa93					      bpl	.invalid	; same colour
    102  fa93
    103  fa93					      MOVE_OR_PROMOTE_PAWN	{2}
    104  fa93				   .invalid
    105  fa93					      ENDM
    106  fa93
    107  fa93							;---------------------------------------------------------------------------------------------------
    108  fa93
      0  fa93					      DEF	PromoteWhitePawn
      1  fa93				   BANK_PromoteWhitePawn SET	_CURRENT_BANK
      2  fa93				   PromoteWhitePawn
      3  fa93				   TEMPORARY_VAR SET	Overlay
      4  fa93				   TEMPORARY_OFFSET SET	0
      5  fa93					      SUBROUTINE
    110  fa93
      0  fa93					      PROMOTE_PAWN	WHITE
      1  fa93					      SUBROUTINE
      2  fa93
      3  fa93
      4  fa93
      0  fa93					      VAR	__temp, 1
      1  fa93				   __temp     SET	TEMPORARY_VAR
      2  fa93				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  fa93
      4  fa93				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  fa93				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  fa93				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  fa93					      ENDIF
      8  fa93				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  fa93				  -	      ECHO	"Temporary Variable", __temp, "overflow!"
     10  fa93				  -	      ERR
     11  fa93					      ENDIF
     12  fa93					      LIST	ON
      6  fa93
      7  fa93		       a5 96		      lda	currentPiece
      8  fa95		       48		      pha
      9  fa96
     10  fa96		       84 a5		      sty	__temp
     11  fa98		       a9 06		      lda	#WHITE|QUEEN
     12  fa9a		       85 96		      sta	currentPiece
     13  fa9c		       20 b8 fc 	      jsr	AddMove
     14  fa9f
     15  fa9f		       a9 05		      lda	#WHITE|ROOK
     16  faa1		       85 96		      sta	currentPiece
     17  faa3		       a4 a5		      ldy	__temp
     18  faa5		       20 b8 fc 	      jsr	AddMove
     19  faa8
     20  faa8		       a9 04		      lda	#WHITE|BISHOP
     21  faaa		       85 96		      sta	currentPiece
     22  faac		       a4 a5		      ldy	__temp
     23  faae		       20 b8 fc 	      jsr	AddMove
     24  fab1
     25  fab1		       a9 03		      lda	#WHITE|KNIGHT
     26  fab3		       85 96		      sta	currentPiece
     27  fab5		       a4 a5		      ldy	__temp
     28  fab7		       20 b8 fc 	      jsr	AddMove
     29  faba
     30  faba		       68		      pla
     31  fabb		       85 96		      sta	currentPiece
    112  fabd		       60		      rts
    113  fabe
    114  fabe							;---------------------------------------------------------------------------------------------------
    115  fabe
      0  fabe					      DEF	Handle_WHITE_PAWN
      1  fabe				   BANK_Handle_WHITE_PAWN SET	_CURRENT_BANK
      2  fabe				   Handle_WHITE_PAWN
      3  fabe				   TEMPORARY_VAR SET	Overlay
      4  fabe				   TEMPORARY_OFFSET SET	0
      5  fabe					      SUBROUTINE
    117  fabe
    118  fabe		       bc 22 f0 	      ldy	ValidSquare+_UP,x	; square above must be blank (WILL NOT EVER be off-board!)
    119  fac1		       b9 7c f0 	      lda	Board,y
    120  fac4		       d0 24		      bne	.pMoved	; occupied
    121  fac6
    122  fac6							; we may need to promote the pawn
    123  fac6							; All possibilites (Q/R/B/N) are added as individual moves
    124  fac6
      0  fac6					      MOVE_OR_PROMOTE_PAWN	WHITE
      1  fac6					      SUBROUTINE
      2  fac6
      3  fac6
      4  fac6					      IF	WHITE = WHITE
      5  fac6		       c0 5a		      cpy	#90
      6  fac8		       90 06		      bcc	.standard
      7  faca		       20 93 fa 	      jsr	PromoteWhitePawn
      8  facd		       4c d3 fa 	      jmp	.pMoved
      9  fad0					      ENDIF
     10  fad0
     11  fad0				  -	      IF	WHITE = BLACK
     12  fad0				  -	      cpy	#30
     13  fad0				  -	      bcs	.standard
     14  fad0				  -	      jsr	PromoteBlackPawn
     15  fad0				  -	      jmp	.pMoved
     16  fad0					      ENDIF
     17  fad0
     18  fad0		       20 b8 fc    .standard  jsr	AddMove
     19  fad3				   .pMoved
     20  fad3
    126  fad3
    127  fad3							; the +2 move off the home rank...
    128  fad3
    129  fad3		       a6 97		      ldx	currentSquare
    130  fad5		       e0 28		      cpx	#WHITE_HOME_ROW
    131  fad7		       b0 11		      bcs	.pMoved	; pawn has moved so can't do +2
    132  fad9		       bc 2c f0 	      ldy	ValidSquare+_UP+_UP,x	; WILL be a valid square
    133  fadc		       b9 7c f0 	      lda	Board,y
    134  fadf		       d0 09		      bne	.pMoved	; destination square occupied
    135  fae1
    136  fae1		       a5 96		      lda	currentPiece
    137  fae3		       09 20		      ora	#FLAG_ENPASSANT
    138  fae5		       85 96		      sta	currentPiece	; GENERATE en-passant opportunity
    139  fae7
    140  fae7		       20 b8 fc 	      jsr	AddMove	; add the +2UP move off home row
    141  faea
    142  faea				   .pMoved
    143  faea
    144  faea							; regular captures...
    145  faea
      0  faea					      TAKE	_UP+_LEFT, WHITE
      1  faea					      SUBROUTINE
      2  faea
      3  faea
      4  faea		       a6 97		      ldx	currentSquare
      5  faec		       bc 21 f0 	      ldy	ValidSquare+_UP+_LEFT,x
      6  faef		       30 16		      bmi	.invalid
      7  faf1		       b9 7c f0 	      lda	Board,y
      8  faf4		       f0 11		      beq	.invalid
      9  faf6		       45 96		      eor	currentPiece
     10  faf8		       10 0d		      bpl	.invalid
     11  fafa
      0  fafa					      MOVE_OR_PROMOTE_PAWN	WHITE
      1  fafa					      SUBROUTINE
      2  fafa
      3  fafa
      4  fafa					      IF	WHITE = WHITE
      5  fafa		       c0 5a		      cpy	#90
      6  fafc		       90 06		      bcc	.standard
      7  fafe		       20 93 fa 	      jsr	PromoteWhitePawn
      8  fb01		       4c 07 fb 	      jmp	.pMoved
      9  fb04					      ENDIF
     10  fb04
     11  fb04				  -	      IF	WHITE = BLACK
     12  fb04				  -	      cpy	#30
     13  fb04				  -	      bcs	.standard
     14  fb04				  -	      jsr	PromoteBlackPawn
     15  fb04				  -	      jmp	.pMoved
     16  fb04					      ENDIF
     17  fb04
     18  fb04		       20 b8 fc    .standard  jsr	AddMove
     19  fb07				   .pMoved
     20  fb07
     13  fb07				   .invalid
      0  fb07					      TAKE	_UP+_RIGHT, WHITE
      1  fb07					      SUBROUTINE
      2  fb07
      3  fb07
      4  fb07		       a6 97		      ldx	currentSquare
      5  fb09		       bc 23 f0 	      ldy	ValidSquare+_UP+_RIGHT,x
      6  fb0c		       30 16		      bmi	.invalid
      7  fb0e		       b9 7c f0 	      lda	Board,y
      8  fb11		       f0 11		      beq	.invalid
      9  fb13		       45 96		      eor	currentPiece
     10  fb15		       10 0d		      bpl	.invalid
     11  fb17
      0  fb17					      MOVE_OR_PROMOTE_PAWN	WHITE
      1  fb17					      SUBROUTINE
      2  fb17
      3  fb17
      4  fb17					      IF	WHITE = WHITE
      5  fb17		       c0 5a		      cpy	#90
      6  fb19		       90 06		      bcc	.standard
      7  fb1b		       20 93 fa 	      jsr	PromoteWhitePawn
      8  fb1e		       4c 24 fb 	      jmp	.pMoved
      9  fb21					      ENDIF
     10  fb21
     11  fb21				  -	      IF	WHITE = BLACK
     12  fb21				  -	      cpy	#30
     13  fb21				  -	      bcs	.standard
     14  fb21				  -	      jsr	PromoteBlackPawn
     15  fb21				  -	      jmp	.pMoved
     16  fb21					      ENDIF
     17  fb21
     18  fb21		       20 b8 fc    .standard  jsr	AddMove
     19  fb24				   .pMoved
     20  fb24
     13  fb24				   .invalid
    148  fb24
    149  fb24
    150  fb24							; en-passant captures...
    151  fb24
    152  fb24		       a5 99		      lda	enPassantPawn
    153  fb26		       f0 2e		      beq	.noEnPassant	; previous move (opponent) enpassant square?
    154  fb28
    155  fb28		       a5 96		      lda	currentPiece
    156  fb2a		       09 20		      ora	#FLAG_ENPASSANT
    157  fb2c		       85 96		      sta	currentPiece	; CONSUME en-passant opportunity
    158  fb2e
      0  fb2e					      EN_PASSANT	_LEFT, _UP
      1  fb2e					      SUBROUTINE
      2  fb2e
      3  fb2e
      4  fb2e		       a6 97		      ldx	currentSquare
      5  fb30		       bc 17 f0 	      ldy	ValidSquare+_LEFT,x
      6  fb33		       c4 99		      cpy	enPassantPawn
      7  fb35		       d0 0b		      bne	.invalid
      8  fb37		       bc 21 f0 	      ldy	ValidSquare+_LEFT+_UP,x
      9  fb3a		       b9 7c f0 	      lda	Board,y
     10  fb3d		       d0 03		      bne	.invalid
     11  fb3f		       20 b8 fc 	      jsr	AddMove
     12  fb42				   .invalid
      0  fb42					      EN_PASSANT	_RIGHT, _UP
      1  fb42					      SUBROUTINE
      2  fb42
      3  fb42
      4  fb42		       a6 97		      ldx	currentSquare
      5  fb44		       bc 19 f0 	      ldy	ValidSquare+_RIGHT,x
      6  fb47		       c4 99		      cpy	enPassantPawn
      7  fb49		       d0 0b		      bne	.invalid
      8  fb4b		       bc 23 f0 	      ldy	ValidSquare+_RIGHT+_UP,x
      9  fb4e		       b9 7c f0 	      lda	Board,y
     10  fb51		       d0 03		      bne	.invalid
     11  fb53		       20 b8 fc 	      jsr	AddMove
     12  fb56				   .invalid
    161  fb56
    162  fb56		       4c 7f fa    .noEnPassant jmp	MoveReturn
    163  fb59
    164  fb59
    165  fb59							;---------------------------------------------------------------------------------------------------
    166  fb59							; BLACK PAWN
    167  fb59							;---------------------------------------------------------------------------------------------------
    168  fb59
      0  fb59					      DEF	PromoteBlackPawn
      1  fb59				   BANK_PromoteBlackPawn SET	_CURRENT_BANK
      2  fb59				   PromoteBlackPawn
      3  fb59				   TEMPORARY_VAR SET	Overlay
      4  fb59				   TEMPORARY_OFFSET SET	0
      5  fb59					      SUBROUTINE
      0  fb59					      PROMOTE_PAWN	BLACK
      1  fb59					      SUBROUTINE
      2  fb59
      3  fb59
      4  fb59
      0  fb59					      VAR	__temp, 1
      1  fb59				   __temp     SET	TEMPORARY_VAR
      2  fb59				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  fb59
      4  fb59				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  fb59				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  fb59				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  fb59					      ENDIF
      8  fb59				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  fb59				  -	      ECHO	"Temporary Variable", __temp, "overflow!"
     10  fb59				  -	      ERR
     11  fb59					      ENDIF
     12  fb59					      LIST	ON
      6  fb59
      7  fb59		       a5 96		      lda	currentPiece
      8  fb5b		       48		      pha
      9  fb5c
     10  fb5c		       84 a5		      sty	__temp
     11  fb5e		       a9 86		      lda	#BLACK|QUEEN
     12  fb60		       85 96		      sta	currentPiece
     13  fb62		       20 b8 fc 	      jsr	AddMove
     14  fb65
     15  fb65		       a9 85		      lda	#BLACK|ROOK
     16  fb67		       85 96		      sta	currentPiece
     17  fb69		       a4 a5		      ldy	__temp
     18  fb6b		       20 b8 fc 	      jsr	AddMove
     19  fb6e
     20  fb6e		       a9 84		      lda	#BLACK|BISHOP
     21  fb70		       85 96		      sta	currentPiece
     22  fb72		       a4 a5		      ldy	__temp
     23  fb74		       20 b8 fc 	      jsr	AddMove
     24  fb77
     25  fb77		       a9 83		      lda	#BLACK|KNIGHT
     26  fb79		       85 96		      sta	currentPiece
     27  fb7b		       a4 a5		      ldy	__temp
     28  fb7d		       20 b8 fc 	      jsr	AddMove
     29  fb80
     30  fb80		       68		      pla
     31  fb81		       85 96		      sta	currentPiece
    171  fb83		       60		      rts
    172  fb84
      0  fb84					      DEF	Handle_BLACK_PAWN
      1  fb84				   BANK_Handle_BLACK_PAWN SET	_CURRENT_BANK
      2  fb84				   Handle_BLACK_PAWN
      3  fb84				   TEMPORARY_VAR SET	Overlay
      4  fb84				   TEMPORARY_OFFSET SET	0
      5  fb84					      SUBROUTINE
    174  fb84					      SUBROUTINE
    175  fb84
    176  fb84		       bc 0e f0 	      ldy	ValidSquare+_DOWN,x	; square below must be blank (WILL NOT EVER be off-board!)
    177  fb87		       b9 7c f0 	      lda	Board,y
    178  fb8a		       d0 24		      bne	.pMoved	; occupied
    179  fb8c
    180  fb8c
    181  fb8c							; we may need to promote the pawn
    182  fb8c							; All possibilites (Q/R/B/N) are added as individual moves
    183  fb8c
      0  fb8c					      MOVE_OR_PROMOTE_PAWN	BLACK
      1  fb8c					      SUBROUTINE
      2  fb8c
      3  fb8c
      4  fb8c				  -	      IF	BLACK = WHITE
      5  fb8c				  -	      cpy	#90
      6  fb8c				  -	      bcc	.standard
      7  fb8c				  -	      jsr	PromoteWhitePawn
      8  fb8c				  -	      jmp	.pMoved
      9  fb8c					      ENDIF
     10  fb8c
     11  fb8c					      IF	BLACK = BLACK
     12  fb8c		       c0 1e		      cpy	#30
     13  fb8e		       b0 06		      bcs	.standard
     14  fb90		       20 59 fb 	      jsr	PromoteBlackPawn
     15  fb93		       4c 99 fb 	      jmp	.pMoved
     16  fb96					      ENDIF
     17  fb96
     18  fb96		       20 b8 fc    .standard  jsr	AddMove
     19  fb99				   .pMoved
     20  fb99
    185  fb99
    186  fb99							; the +2 move off the home rank...
    187  fb99
    188  fb99		       a6 97		      ldx	currentSquare
    189  fb9b		       e0 52		      cpx	#BLACK_HOME_ROW
    190  fb9d		       90 11		      bcc	.pMoved	; pawn has moved so can't do +2
    191  fb9f
    192  fb9f
    193  fb9f		       bc 04 f0 	      ldy	ValidSquare+_DOWN+_DOWN,x	; WILL be a valid square
    194  fba2		       b9 7c f0 	      lda	Board,y
    195  fba5		       d0 09		      bne	.pMoved	; destination square occupied
    196  fba7
    197  fba7		       a5 96		      lda	currentPiece
    198  fba9		       09 20		      ora	#FLAG_ENPASSANT
    199  fbab		       85 96		      sta	currentPiece	; CAN en-passant
    200  fbad
    201  fbad		       20 b8 fc 	      jsr	AddMove	; add the +2DOWN move off home row
    202  fbb0
    203  fbb0				   .pMoved
    204  fbb0
    205  fbb0							; regular captures... (with promotion)
    206  fbb0
      0  fbb0					      TAKE	_DOWN+_LEFT, BLACK
      1  fbb0					      SUBROUTINE
      2  fbb0
      3  fbb0
      4  fbb0		       a6 97		      ldx	currentSquare
      5  fbb2		       bc 0d f0 	      ldy	ValidSquare+_DOWN+_LEFT,x
      6  fbb5		       30 16		      bmi	.invalid
      7  fbb7		       b9 7c f0 	      lda	Board,y
      8  fbba		       f0 11		      beq	.invalid
      9  fbbc		       45 96		      eor	currentPiece
     10  fbbe		       10 0d		      bpl	.invalid
     11  fbc0
      0  fbc0					      MOVE_OR_PROMOTE_PAWN	BLACK
      1  fbc0					      SUBROUTINE
      2  fbc0
      3  fbc0
      4  fbc0				  -	      IF	BLACK = WHITE
      5  fbc0				  -	      cpy	#90
      6  fbc0				  -	      bcc	.standard
      7  fbc0				  -	      jsr	PromoteWhitePawn
      8  fbc0				  -	      jmp	.pMoved
      9  fbc0					      ENDIF
     10  fbc0
     11  fbc0					      IF	BLACK = BLACK
     12  fbc0		       c0 1e		      cpy	#30
     13  fbc2		       b0 06		      bcs	.standard
     14  fbc4		       20 59 fb 	      jsr	PromoteBlackPawn
     15  fbc7		       4c cd fb 	      jmp	.pMoved
     16  fbca					      ENDIF
     17  fbca
     18  fbca		       20 b8 fc    .standard  jsr	AddMove
     19  fbcd				   .pMoved
     20  fbcd
     13  fbcd				   .invalid
      0  fbcd					      TAKE	_DOWN+_RIGHT, BLACK
      1  fbcd					      SUBROUTINE
      2  fbcd
      3  fbcd
      4  fbcd		       a6 97		      ldx	currentSquare
      5  fbcf		       bc 0f f0 	      ldy	ValidSquare+_DOWN+_RIGHT,x
      6  fbd2		       30 16		      bmi	.invalid
      7  fbd4		       b9 7c f0 	      lda	Board,y
      8  fbd7		       f0 11		      beq	.invalid
      9  fbd9		       45 96		      eor	currentPiece
     10  fbdb		       10 0d		      bpl	.invalid
     11  fbdd
      0  fbdd					      MOVE_OR_PROMOTE_PAWN	BLACK
      1  fbdd					      SUBROUTINE
      2  fbdd
      3  fbdd
      4  fbdd				  -	      IF	BLACK = WHITE
      5  fbdd				  -	      cpy	#90
      6  fbdd				  -	      bcc	.standard
      7  fbdd				  -	      jsr	PromoteWhitePawn
      8  fbdd				  -	      jmp	.pMoved
      9  fbdd					      ENDIF
     10  fbdd
     11  fbdd					      IF	BLACK = BLACK
     12  fbdd		       c0 1e		      cpy	#30
     13  fbdf		       b0 06		      bcs	.standard
     14  fbe1		       20 59 fb 	      jsr	PromoteBlackPawn
     15  fbe4		       4c ea fb 	      jmp	.pMoved
     16  fbe7					      ENDIF
     17  fbe7
     18  fbe7		       20 b8 fc    .standard  jsr	AddMove
     19  fbea				   .pMoved
     20  fbea
     13  fbea				   .invalid
    209  fbea
    210  fbea							; en-passant captures...
    211  fbea
    212  fbea		       a5 99		      lda	enPassantPawn
    213  fbec		       f0 2e		      beq	.noEnPassant	; was last move en-passantable?
    214  fbee
    215  fbee		       a5 96		      lda	currentPiece
    216  fbf0		       09 20		      ora	#FLAG_ENPASSANT
    217  fbf2		       85 96		      sta	currentPiece	; any en-passant move added will have flag set
    218  fbf4
      0  fbf4					      EN_PASSANT	_LEFT, _DOWN
      1  fbf4					      SUBROUTINE
      2  fbf4
      3  fbf4
      4  fbf4		       a6 97		      ldx	currentSquare
      5  fbf6		       bc 17 f0 	      ldy	ValidSquare+_LEFT,x
      6  fbf9		       c4 99		      cpy	enPassantPawn
      7  fbfb		       d0 0b		      bne	.invalid
      8  fbfd		       bc 0d f0 	      ldy	ValidSquare+_LEFT+_DOWN,x
      9  fc00		       b9 7c f0 	      lda	Board,y
     10  fc03		       d0 03		      bne	.invalid
     11  fc05		       20 b8 fc 	      jsr	AddMove
     12  fc08				   .invalid
      0  fc08					      EN_PASSANT	_RIGHT, _DOWN
      1  fc08					      SUBROUTINE
      2  fc08
      3  fc08
      4  fc08		       a6 97		      ldx	currentSquare
      5  fc0a		       bc 19 f0 	      ldy	ValidSquare+_RIGHT,x
      6  fc0d		       c4 99		      cpy	enPassantPawn
      7  fc0f		       d0 0b		      bne	.invalid
      8  fc11		       bc 0f f0 	      ldy	ValidSquare+_RIGHT+_DOWN,x
      9  fc14		       b9 7c f0 	      lda	Board,y
     10  fc17		       d0 03		      bne	.invalid
     11  fc19		       20 b8 fc 	      jsr	AddMove
     12  fc1c				   .invalid
    221  fc1c
    222  fc1c				   .noEnPassant
    223  fc1c		       4c 7f fa 	      jmp	MoveReturn
    224  fc1f
    225  fc1f							; EOF
------- FILE BANK_FIXED.asm
------- FILE Handler_KNIGHT.asm LEVEL 3 PASS 2
      0  fc1f					      include	"Handler_KNIGHT.asm"
      1  fc1f							; Copyright (C)2020 Andrew Davie
      2  fc1f							; Knight move handler
      3  fc1f
      4  fc1f							;---------------------------------------------------------------------------------------------------
      5  fc1f							; KNIGHT
      6  fc1f							;---------------------------------------------------------------------------------------------------
      7  fc1f
      0  fc1f					      DEF	Handle_KNIGHT
      1  fc1f				   BANK_Handle_KNIGHT SET	_CURRENT_BANK
      2  fc1f				   Handle_KNIGHT
      3  fc1f				   TEMPORARY_VAR SET	Overlay
      4  fc1f				   TEMPORARY_OFFSET SET	0
      5  fc1f					      SUBROUTINE
      9  fc1f					      SUBROUTINE
     10  fc1f
     11  fc1f							; x = currentSquare (square the piece is on)
     12  fc1f							; currentPiece (with flags/colour attached)
     13  fc1f
      0  fc1f					      MOVE_TO	_DOWN+_DOWN+_LEFT
      1  fc1f					      SUBROUTINE
      2  fc1f		       bc 03 f0 	      ldy	ValidSquare+_DOWN+_DOWN+_LEFT,x
      3  fc22		       30 0c		      bmi	.invalid
      4  fc24		       b9 7c f0 	      lda	Board,y
      5  fc27		       f0 04		      beq	.squareEmpty
      6  fc29		       45 96		      eor	currentPiece
      7  fc2b		       10 03		      bpl	.invalid
      8  fc2d		       20 b8 fc    .squareEmpty jsr	AddMove
      9  fc30				   .invalid
      0  fc30					      MOVE_TO_X	_DOWN+_DOWN+_RIGHT
      1  fc30		       a6 97		      ldx	currentSquare
      0  fc32					      MOVE_TO	_DOWN+_DOWN+_RIGHT
      1  fc32					      SUBROUTINE
      2  fc32		       bc 05 f0 	      ldy	ValidSquare+_DOWN+_DOWN+_RIGHT,x
      3  fc35		       30 0c		      bmi	.invalid
      4  fc37		       b9 7c f0 	      lda	Board,y
      5  fc3a		       f0 04		      beq	.squareEmpty
      6  fc3c		       45 96		      eor	currentPiece
      7  fc3e		       10 03		      bpl	.invalid
      8  fc40		       20 b8 fc    .squareEmpty jsr	AddMove
      9  fc43				   .invalid
      0  fc43					      MOVE_TO_X	_UP+_UP+_LEFT
      1  fc43		       a6 97		      ldx	currentSquare
      0  fc45					      MOVE_TO	_UP+_UP+_LEFT
      1  fc45					      SUBROUTINE
      2  fc45		       bc 2b f0 	      ldy	ValidSquare+_UP+_UP+_LEFT,x
      3  fc48		       30 0c		      bmi	.invalid
      4  fc4a		       b9 7c f0 	      lda	Board,y
      5  fc4d		       f0 04		      beq	.squareEmpty
      6  fc4f		       45 96		      eor	currentPiece
      7  fc51		       10 03		      bpl	.invalid
      8  fc53		       20 b8 fc    .squareEmpty jsr	AddMove
      9  fc56				   .invalid
      0  fc56					      MOVE_TO_X	_UP+_UP+_RIGHT
      1  fc56		       a6 97		      ldx	currentSquare
      0  fc58					      MOVE_TO	_UP+_UP+_RIGHT
      1  fc58					      SUBROUTINE
      2  fc58		       bc 2d f0 	      ldy	ValidSquare+_UP+_UP+_RIGHT,x
      3  fc5b		       30 0c		      bmi	.invalid
      4  fc5d		       b9 7c f0 	      lda	Board,y
      5  fc60		       f0 04		      beq	.squareEmpty
      6  fc62		       45 96		      eor	currentPiece
      7  fc64		       10 03		      bpl	.invalid
      8  fc66		       20 b8 fc    .squareEmpty jsr	AddMove
      9  fc69				   .invalid
     18  fc69
      0  fc69					      MOVE_TO_X	_DOWN+_LEFT+_LEFT
      1  fc69		       a6 97		      ldx	currentSquare
      0  fc6b					      MOVE_TO	_DOWN+_LEFT+_LEFT
      1  fc6b					      SUBROUTINE
      2  fc6b		       bc 0c f0 	      ldy	ValidSquare+_DOWN+_LEFT+_LEFT,x
      3  fc6e		       30 0c		      bmi	.invalid
      4  fc70		       b9 7c f0 	      lda	Board,y
      5  fc73		       f0 04		      beq	.squareEmpty
      6  fc75		       45 96		      eor	currentPiece
      7  fc77		       10 03		      bpl	.invalid
      8  fc79		       20 b8 fc    .squareEmpty jsr	AddMove
      9  fc7c				   .invalid
      0  fc7c					      MOVE_TO_X	_DOWN+_RIGHT+_RIGHT
      1  fc7c		       a6 97		      ldx	currentSquare
      0  fc7e					      MOVE_TO	_DOWN+_RIGHT+_RIGHT
      1  fc7e					      SUBROUTINE
      2  fc7e		       bc 10 f0 	      ldy	ValidSquare+_DOWN+_RIGHT+_RIGHT,x
      3  fc81		       30 0c		      bmi	.invalid
      4  fc83		       b9 7c f0 	      lda	Board,y
      5  fc86		       f0 04		      beq	.squareEmpty
      6  fc88		       45 96		      eor	currentPiece
      7  fc8a		       10 03		      bpl	.invalid
      8  fc8c		       20 b8 fc    .squareEmpty jsr	AddMove
      9  fc8f				   .invalid
      0  fc8f					      MOVE_TO_X	_UP+_LEFT+_LEFT
      1  fc8f		       a6 97		      ldx	currentSquare
      0  fc91					      MOVE_TO	_UP+_LEFT+_LEFT
      1  fc91					      SUBROUTINE
      2  fc91		       bc 20 f0 	      ldy	ValidSquare+_UP+_LEFT+_LEFT,x
      3  fc94		       30 0c		      bmi	.invalid
      4  fc96		       b9 7c f0 	      lda	Board,y
      5  fc99		       f0 04		      beq	.squareEmpty
      6  fc9b		       45 96		      eor	currentPiece
      7  fc9d		       10 03		      bpl	.invalid
      8  fc9f		       20 b8 fc    .squareEmpty jsr	AddMove
      9  fca2				   .invalid
      0  fca2					      MOVE_TO_X	_UP+_RIGHT+_RIGHT
      1  fca2		       a6 97		      ldx	currentSquare
      0  fca4					      MOVE_TO	_UP+_RIGHT+_RIGHT
      1  fca4					      SUBROUTINE
      2  fca4		       bc 24 f0 	      ldy	ValidSquare+_UP+_RIGHT+_RIGHT,x
      3  fca7		       30 0c		      bmi	.invalid
      4  fca9		       b9 7c f0 	      lda	Board,y
      5  fcac		       f0 04		      beq	.squareEmpty
      6  fcae		       45 96		      eor	currentPiece
      7  fcb0		       10 03		      bpl	.invalid
      8  fcb2		       20 b8 fc    .squareEmpty jsr	AddMove
      9  fcb5				   .invalid
     23  fcb5
     24  fcb5		       4c 7f fa 	      jmp	MoveReturn
     25  fcb8
     26  fcb8							; EOF
------- FILE BANK_FIXED.asm
    679  fcb8
    680  fcb8							;---------------------------------------------------------------------------------------------------
    681  fcb8
      0  fcb8					      DEF	AddMove
      1  fcb8				   BANK_AddMove SET	_CURRENT_BANK
      2  fcb8				   AddMove
      3  fcb8				   TEMPORARY_VAR SET	Overlay
      4  fcb8				   TEMPORARY_OFFSET SET	0
      5  fcb8					      SUBROUTINE
    683  fcb8					      SUBROUTINE
    684  fcb8							; =57 including call
    685  fcb8
    686  fcb8							; add square in y register to movelist as destination (X12 format)
    687  fcb8							; currentPiece = piece moving
    688  fcb8							; currentSquare = start square (X12)
    689  fcb8							; ??do not modify y
    690  fcb8
    691  fcb8		       a5 9b		      lda	currentPly	; 3
    692  fcba		       85 3e		      sta	SET_BANK_RAM	; 3
    693  fcbc
    694  fcbc							; [y]		     to square (X12)
    695  fcbc							; currentSquare     from square (X12)
    696  fcbc							; currentPiece      piece. ENPASSANT flag set if pawn double-moving off opening rank
    697  fcbc							; do not modify [Y]
    698  fcbc
    699  fcbc							; add a move to the movelist
    700  fcbc
    701  fcbc		       98		      tya		; 2
    702  fcbd
    703  fcbd		       ac a1 f1 	      ldy	moveIndex	; 3
    704  fcc0		       c8		      iny		; 2
    705  fcc1		       8c a1 f5 	      sty	moveIndex+RAM_WRITE	; 4
    706  fcc4
    707  fcc4		       99 00 f5 	      sta	MoveTo+RAM_WRITE,y	; 5
    708  fcc7		       aa		      tax		; 2   new square (for projections)
    709  fcc8
    710  fcc8		       a5 97		      lda	currentSquare	; 3
    711  fcca		       99 8e f4 	      sta	MoveFrom+RAM_WRITE,y	; 5
    712  fccd		       a5 96		      lda	currentPiece	; 3
    713  fccf		       99 50 f5 	      sta	MovePiece+RAM_WRITE,y	; 5
    714  fcd2
    715  fcd2		       a9 08		      lda	#RAMBANK_MOVES_RAM	; 2	     ; TODO: NOT NEEDED IF FIXED BANK CALLED THIS
    716  fcd4		       85 3e		      sta	SET_BANK_RAM	; 3
    717  fcd6		       60		      rts		; 6
    718  fcd7
    719  fcd7
    720  fcd7							;---------------------------------------------------------------------------------------------------
    721  fcd7
      0  fcd7					      DEF	InitialisePieceSquares
      1  fcd7				   BANK_InitialisePieceSquares SET	_CURRENT_BANK
      2  fcd7				   InitialisePieceSquares
      3  fcd7				   TEMPORARY_VAR SET	Overlay
      4  fcd7				   TEMPORARY_OFFSET SET	0
      5  fcd7					      SUBROUTINE
    723  fcd7					      SUBROUTINE
    724  fcd7
    725  fcd7							; Initialise the piecelists and the board for the two piecelist banks (BLACK/WHITE)
    726  fcd7
    727  fcd7		       a9 09		      lda	#RAMBANK_PLY
    728  fcd9		       85 3e		      sta	SET_BANK_RAM
    729  fcdb		       20 a2 f1 	      jsr	InitPieceLists	; for white
    730  fcde		       a9 0a		      lda	#RAMBANK_PLY+1
    731  fce0		       85 3e		      sta	SET_BANK_RAM
    732  fce2		       20 a2 f1 	      jsr	InitPieceLists	; for black
    733  fce5
    734  fce5
    735  fce5		       a9 00		      lda	#0
    736  fce7		       85 99		      sta	enPassantPawn	; no en-passant
    737  fce9
    738  fce9
    739  fce9							; Now setup the board/piecelists
    740  fce9
    741  fce9		       a2 00		      ldx	#0
    742  fceb				   .fillPieceLists
    743  fceb
    744  fceb		       a9 09		      lda	#RAMBANK_PLY
    745  fced		       85 3e		      sta	SET_BANK_RAM
    746  fcef
    747  fcef		       bd f7 f1 	      lda	InitPieceList,x	; colour/-1
    748  fcf2		       f0 50		      beq	.finish
    749  fcf4
    750  fcf4		       0a		      asl
    751  fcf5		       a9 09		      lda	#RAMBANK_PLY
    752  fcf7		       69 00		      adc	#0
    753  fcf9		       85 3e		      sta	SET_BANK_RAM	; BLACK/WHITE
    754  fcfb
    755  fcfb		       ac 88 f0 	      ldy	PieceListPtr
    756  fcfe		       c8		      iny
    757  fcff
    758  fcff		       bd f8 f1 	      lda	InitPieceList+1,x	; square
    759  fd02		       99 28 f4 	      sta	PieceSquare+RAM_WRITE,y
    760  fd05		       98		      tya
    761  fd06		       99 18 f4 	      sta	SortedPieceList+RAM_WRITE,y
    762  fd09
    763  fd09		       bd f7 f1 	      lda	InitPieceList,x	; piece type
    764  fd0c		       99 38 f4 	      sta	PieceType+RAM_WRITE,y
    765  fd0f		       48		      pha
    766  fd10
    767  fd10		       8c 88 f4 	      sty	PieceListPtr+RAM_WRITE
    768  fd13
    769  fd13
    770  fd13		       bc f8 f1 	      ldy	InitPieceList+1,x	; square
    771  fd16
    772  fd16		       a9 08		      lda	#RAMBANK_MOVES_RAM
    773  fd18		       85 3e		      sta	SET_BANK_RAM
    774  fd1a		       68		      pla
    775  fd1b		       99 7c f4 	      sta	Board+RAM_WRITE,y
    776  fd1e
    777  fd1e				  -	      if	0
    778  fd1e				  -			; Add the material value of the piece to the material score
    779  fd1e				  -
    780  fd1e				  -	      cmp	#128	; CC=white, CS=black
    781  fd1e				  -	      and	#PIECE_MASK
    782  fd1e				  -	      tay
    783  fd1e				  -
    784  fd1e				  -	      lda	#BANK_AddPieceMaterialValue
    785  fd1e				  -	      sta	SET_BANK
    786  fd1e				  -	      jsr	AddPieceMaterialValue
    787  fd1e				  -
    788  fd1e				  -	      txa
    789  fd1e				  -	      pha
    790  fd1e				  -
    791  fd1e				  -	      lda	#RAMBANK_PLY
    792  fd1e				  -	      sta	SET_BANK_RAM
    793  fd1e				  -	      ldy	InitPieceList+1,x	; square
    794  fd1e				  -
    795  fd1e				  -
    796  fd1e				  -	      lda	InitPieceList,x	; type
    797  fd1e				  -
    798  fd1e				  -	      ldx	#BANK_AddPiecePositionValue
    799  fd1e				  -	      stx	SET_BANK
    800  fd1e				  -
    801  fd1e				  -
    802  fd1e				  -	      jsr	AddPiecePositionValue
    803  fd1e				  -
    804  fd1e				  -	      pla
    805  fd1e				  -	      tax
    806  fd1e				  -
    807  fd1e				  -			; ^
    808  fd1e					      endif
    809  fd1e
    810  fd1e		       a9 0f		      lda	#BANK_PieceValueLO
    811  fd20		       85 3f		      sta	SET_BANK
    812  fd22
    813  fd22		       b9 08 f0 	      lda	PieceValueHI,y
    814  fd25		       48		      pha
    815  fd26		       b9 00 f0 	      lda	PieceValueLO,y
    816  fd29		       48		      pha
    817  fd2a
    818  fd2a		       bd f7 f1 	      lda	InitPieceList,x	; colour/-1
    819  fd2d		       0a		      asl
    820  fd2e		       a9 09		      lda	#RAMBANK_PLY
    821  fd30		       69 00		      adc	#0
    822  fd32		       85 3e		      sta	SET_BANK_RAM	; BLACK/WHITE
    823  fd34
    824  fd34		       ac 88 f0 	      ldy	PieceListPtr
    825  fd37		       c8		      iny
    826  fd38
    827  fd38
    828  fd38		       68		      pla
    829  fd39		       99 48 f4 	      sta	PieceMaterialValueLO+RAM_WRITE,y
    830  fd3c		       68		      pla
    831  fd3d		       99 58 f4 	      sta	PieceMaterialValueHI+RAM_WRITE,y
    832  fd40
    833  fd40		       e8		      inx
    834  fd41		       e8		      inx
    835  fd42		       10 a7		      bpl	.fillPieceLists
    836  fd44
    837  fd44				   .finish
    838  fd44
    839  fd44				  -	      if	0
    840  fd44				  -
    841  fd44				  -	      SUBROUTINE
    842  fd44				  -
    843  fd44				  -	      lda	#RAMBANK_PLY
    844  fd44				  -	      sta	SET_BANK_RAM
    845  fd44				  -
    846  fd44				  -	      ldx	#15
    847  fd44				  -.scan      lda	PieceSquare,x
    848  fd44				  -	      beq	.dead
    849  fd44				  -
    850  fd44				  -	      clc
    851  fd44				  -	      lda	Evaluation
    852  fd44				  -	      adc	PieceMaterialValueLO,x
    853  fd44				  -	      sta	Evaluation
    854  fd44				  -	      lda	Evaluation+1
    855  fd44				  -	      adc	PieceMaterialValueHI,x
    856  fd44				  -	      sta	Evaluation+1
    857  fd44				  -
    858  fd44				  -.dead      dex
    859  fd44				  -	      bpl	.scan
    860  fd44				  -
    861  fd44				  -	      SUBROUTINE
    862  fd44				  -
    863  fd44				  -	      lda	#RAMBANK_PLY+1
    864  fd44				  -	      sta	SET_BANK_RAM
    865  fd44				  -
    866  fd44				  -	      ldx	#15
    867  fd44				  -.scan      lda	PieceSquare,x
    868  fd44				  -	      beq	.dead
    869  fd44				  -
    870  fd44				  -	      sec
    871  fd44				  -	      lda	Evaluation
    872  fd44				  -	      sbc	PieceMaterialValueLO,x
    873  fd44				  -	      sta	Evaluation
    874  fd44				  -	      lda	Evaluation+1
    875  fd44				  -	      sbc	PieceMaterialValueHI,x
    876  fd44				  -	      sta	Evaluation+1
    877  fd44				  -
    878  fd44				  -.dead      dex
    879  fd44				  -	      bpl	.scan
    880  fd44				  -
    881  fd44					      endif
    882  fd44
    883  fd44		       60		      rts
    884  fd45
    885  fd45
    886  fd45							;---------------------------------------------------------------------------------------------------
    887  fd45
      0  fd45					      DEF	SAFE_GetKingSquare
      1  fd45				   BANK_SAFE_GetKingSquare SET	_CURRENT_BANK
      2  fd45				   SAFE_GetKingSquare
      3  fd45				   TEMPORARY_VAR SET	Overlay
      4  fd45				   TEMPORARY_OFFSET SET	0
      5  fd45					      SUBROUTINE
    889  fd45					      SUBROUTINE
    890  fd45
    891  fd45							; Pass:	 A = correct bank for current side (RAMBANK_PLY/+1)
    892  fd45							; Return:	 A = square king is on (or -1)
    893  fd45
    894  fd45		       85 3e		      sta	SET_BANK_RAM
    895  fd47		       20 54 f3 	      jsr	GetKingSquare
    896  fd4a		       a4 8b		      ldy	savedBank
    897  fd4c		       84 3f		      sty	SET_BANK
    898  fd4e		       60		      rts
    899  fd4f
    900  fd4f							;---------------------------------------------------------------------------------------------------
    901  fd4f
      0  fd4f					      DEF	GetBoard
      1  fd4f				   BANK_GetBoard SET	_CURRENT_BANK
      2  fd4f				   GetBoard
      3  fd4f				   TEMPORARY_VAR SET	Overlay
      4  fd4f				   TEMPORARY_OFFSET SET	0
      5  fd4f					      SUBROUTINE
    903  fd4f		       a9 08		      lda	#RAMBANK_MOVES_RAM
    904  fd51		       85 3e		      sta	SET_BANK_RAM
    905  fd53		       b9 7c f0 	      lda	Board,y
    906  fd56		       a4 8b		      ldy	savedBank
    907  fd58		       84 3f		      sty	SET_BANK
    908  fd5a		       60		      rts
    909  fd5b
    910  fd5b
    911  fd5b							;---------------------------------------------------------------------------------------------------
    912  fd5b
      0  fd5b					      DEF	calculateBase64Square
      1  fd5b				   BANK_calculateBase64Square SET	_CURRENT_BANK
      2  fd5b				   calculateBase64Square
      3  fd5b				   TEMPORARY_VAR SET	Overlay
      4  fd5b				   TEMPORARY_OFFSET SET	0
      5  fd5b					      SUBROUTINE
    914  fd5b					      SUBROUTINE
    915  fd5b
    916  fd5b							; Convert row/column into Base64 index
    917  fd5b
    918  fd5b		       a5 87		      lda	highlight_row
    919  fd5d					      IF	ASSERTS
    920  fd5d		       30 fe	   .ERROR     bmi	.ERROR
    921  fd5f					      ENDIF
    922  fd5f
    923  fd5f		       29 07		      and	#7
    924  fd61		       49 07		      eor	#7
    925  fd63		       0a		      asl
    926  fd64		       0a		      asl
    927  fd65		       0a		      asl
    928  fd66		       05 88		      ora	highlight_col
    929  fd68		       aa		      tax
    930  fd69		       60		      rts
    931  fd6a
    932  fd6a							;---------------------------------------------------------------------------------------------------
    933  fd6a
      0  fd6a					      DEF	SAFE_IsValidMoveFromSquare
      1  fd6a				   BANK_SAFE_IsValidMoveFromSquare SET	_CURRENT_BANK
      2  fd6a				   SAFE_IsValidMoveFromSquare
      3  fd6a				   TEMPORARY_VAR SET	Overlay
      4  fd6a				   TEMPORARY_OFFSET SET	0
      5  fd6a					      SUBROUTINE
    935  fd6a					      SUBROUTINE
    936  fd6a
    937  fd6a							; Does the square exist in the movelist?
    938  fd6a
    939  fd6a		       20 5b fd 	      jsr	calculateBase64Square
    940  fd6d		       86 8e		      stx	aiFromSquare
    941  fd6f
    942  fd6f		       a9 08		      lda	#RAMBANK_MOVES_RAM
    943  fd71		       85 3e		      sta	SET_BANK_RAM
    944  fd73		       bc 4d f3 	      ldy	Base64ToIndex,x
    945  fd76		       84 90		      sty	aiFromSquareX12
    946  fd78
    947  fd78		       98		      tya
    948  fd79
    949  fd79		       a4 9b		      ldy	currentPly
    950  fd7b		       84 3e		      sty	SET_BANK_RAM
    951  fd7d		       20 32 f3 	      jsr	CheckMoveListFromSquare
    952  fd80
    953  fd80		       a5 8b		      lda	savedBank
    954  fd82		       85 3f		      sta	SET_BANK
    955  fd84		       60		      rts
    956  fd85
    957  fd85
    958  fd85							;---------------------------------------------------------------------------------------------------
    959  fd85
      0  fd85					      DEF	SAFE_GetPiece
      1  fd85				   BANK_SAFE_GetPiece SET	_CURRENT_BANK
      2  fd85				   SAFE_GetPiece
      3  fd85				   TEMPORARY_VAR SET	Overlay
      4  fd85				   TEMPORARY_OFFSET SET	0
      5  fd85					      SUBROUTINE
    961  fd85					      SUBROUTINE
    962  fd85
    963  fd85							; Retrieve the piece+flags from the movelist, given from/to squares
    964  fd85							; Required as moves have different flags but same origin squares (e.g., castling)
    965  fd85
    966  fd85		       a5 9b		      lda	currentPly
    967  fd87		       85 3e		      sta	SET_BANK_RAM
    968  fd89
    969  fd89		       20 6f f3 	      jsr	GetPieceGivenFromToSquares
    970  fd8c
    971  fd8c		       a5 8b		      lda	savedBank
    972  fd8e		       85 3f		      sta	SET_BANK
    973  fd90		       60		      rts
    974  fd91
    975  fd91							;---------------------------------------------------------------------------------------------------
    976  fd91
      0  fd91					      DEF	SAFE_IsValidMoveToSquare
      1  fd91				   BANK_SAFE_IsValidMoveToSquare SET	_CURRENT_BANK
      2  fd91				   SAFE_IsValidMoveToSquare
      3  fd91				   TEMPORARY_VAR SET	Overlay
      4  fd91				   TEMPORARY_OFFSET SET	0
      5  fd91					      SUBROUTINE
    978  fd91					      SUBROUTINE
    979  fd91
    980  fd91							; Does the square exist in the movelist?
    981  fd91
    982  fd91		       20 5b fd 	      jsr	calculateBase64Square
    983  fd94		       86 8f		      stx	aiToSquare
    984  fd96
    985  fd96		       a9 08		      lda	#RAMBANK_MOVES_RAM
    986  fd98		       85 3e		      sta	SET_BANK_RAM
    987  fd9a		       bd 4d f3 	      lda	Base64ToIndex,x
    988  fd9d		       85 91		      sta	aiToSquareX12
    989  fd9f
    990  fd9f		       a4 9b		      ldy	currentPly
    991  fda1		       84 3e		      sty	SET_BANK_RAM
    992  fda3		       20 8c f3 	      jsr	CheckMoveListToSquare
    993  fda6
    994  fda6		       a5 8b	   .found     lda	savedBank
    995  fda8		       85 3f		      sta	SET_BANK
    996  fdaa		       60		      rts
    997  fdab
    998  fdab
    999  fdab							;---------------------------------------------------------------------------------------------------
   1000  fdab
      0  fdab					      DEF	SAFE_CopyShadowROMtoRAM
      1  fdab				   BANK_SAFE_CopyShadowROMtoRAM SET	_CURRENT_BANK
      2  fdab				   SAFE_CopyShadowROMtoRAM
      3  fdab				   TEMPORARY_VAR SET	Overlay
      4  fdab				   TEMPORARY_OFFSET SET	0
      5  fdab					      SUBROUTINE
   1002  fdab					      SUBROUTINE
   1003  fdab
   1004  fdab		       20 b3 fd 	      jsr	CopyShadowROMtoRAM
   1005  fdae		       a5 8b		      lda	savedBank
   1006  fdb0		       85 3f		      sta	SET_BANK
   1007  fdb2		       60		      rts
   1008  fdb3
   1009  fdb3
   1010  fdb3							;---------------------------------------------------------------------------------------------------
   1011  fdb3
      0  fdb3					      DEF	CopyShadowROMtoRAM
      1  fdb3				   BANK_CopyShadowROMtoRAM SET	_CURRENT_BANK
      2  fdb3				   CopyShadowROMtoRAM
      3  fdb3				   TEMPORARY_VAR SET	Overlay
      4  fdb3				   TEMPORARY_OFFSET SET	0
      5  fdb3					      SUBROUTINE
   1013  fdb3					      SUBROUTINE
   1014  fdb3
      0  fdb3					      VAR	__destinationBank, 1
      1  fdb3				   __destinationBank SET	TEMPORARY_VAR
      2  fdb3				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  fdb3
      4  fdb3				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  fdb3				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  fdb3				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  fdb3					      ENDIF
      8  fdb3				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  fdb3				  -	      ECHO	"Temporary Variable", __destinationBank, "overflow!"
     10  fdb3				  -	      ERR
     11  fdb3					      ENDIF
     12  fdb3					      LIST	ON
      0  fdb3					      VAR	__sourceBank, 1
      1  fdb3				   __sourceBank SET	TEMPORARY_VAR
      2  fdb3				   TEMPORARY_VAR SET	TEMPORARY_VAR + TEMPORARY_OFFSET + 1
      3  fdb3
      4  fdb3				   OVERLAY_DELTA SET	TEMPORARY_VAR - Overlay
      5  fdb3				  -	      IF	OVERLAY_DELTA > MAXIMUM_REQUIRED_OVERLAY_SIZE
      6  fdb3				  -MAXIMUM_REQUIRED_OVERLAY_SIZE SET	OVERLAY_DELTA
      7  fdb3					      ENDIF
      8  fdb3				  -	      IF	OVERLAY_DELTA > OVERLAY_SIZE
      9  fdb3				  -	      ECHO	"Temporary Variable", __sourceBank, "overflow!"
     10  fdb3				  -	      ERR
     11  fdb3					      ENDIF
     12  fdb3					      LIST	ON
   1017  fdb3
   1018  fdb3
   1019  fdb3							; Copy a whole 1K ROM SHADOW into a destination RAM 1K bank
   1020  fdb3							; used to setup callable RAM code from ROM templates
   1021  fdb3
   1022  fdb3							; x = source ROM bank
   1023  fdb3							; y = destination RAM bank (preserved)
   1024  fdb3
   1025  fdb3		       86 a6		      stx	__sourceBank
   1026  fdb5
   1027  fdb5		       a2 00		      ldx	#0
   1028  fdb7		       a5 a6	   .copyPage  lda	__sourceBank
   1029  fdb9		       85 3f		      sta	SET_BANK
   1030  fdbb
   1031  fdbb		       bd 00 f0 	      lda	$F000,x
   1032  fdbe		       48		      pha
   1033  fdbf		       bd 00 f1 	      lda	$F100,x
   1034  fdc2		       48		      pha
   1035  fdc3		       bd 00 f2 	      lda	$F200,x
   1036  fdc6		       48		      pha
   1037  fdc7		       bd 00 f3 	      lda	$F300,x
   1038  fdca
   1039  fdca		       84 3e		      sty	SET_BANK_RAM
   1040  fdcc
   1041  fdcc		       9d 00 f7 	      sta	$F300+RAM_WRITE,x
   1042  fdcf		       68		      pla
   1043  fdd0		       9d 00 f6 	      sta	$F200+RAM_WRITE,x
   1044  fdd3		       68		      pla
   1045  fdd4		       9d 00 f5 	      sta	$F100+RAM_WRITE,x
   1046  fdd7		       68		      pla
   1047  fdd8		       9d 00 f4 	      sta	$F000+RAM_WRITE,x
   1048  fddb
   1049  fddb		       ca		      dex
   1050  fddc		       d0 d9		      bne	.copyPage
   1051  fdde		       60		      rts
   1052  fddf
   1053  fddf
   1054  fddf							;---------------------------------------------------------------------------------------------------
   1055  fddf
      0  fddf					      DEF	SAFE_PromoteStart
      1  fddf				   BANK_SAFE_PromoteStart SET	_CURRENT_BANK
      2  fddf				   SAFE_PromoteStart
      3  fddf				   TEMPORARY_VAR SET	Overlay
      4  fddf				   TEMPORARY_OFFSET SET	0
      5  fddf					      SUBROUTINE
   1057  fddf					      SUBROUTINE
   1058  fddf
   1059  fddf		       a9 08		      lda	#RAMBANK_MOVES_RAM
   1060  fde1		       85 3e		      sta	SET_BANK_RAM
   1061  fde3
   1062  fde3		       b9 7c f0 	      lda	Board,y
   1063  fde6		       29 0f		      and	#PIECE_MASK
   1064  fde8		       f0 03		      beq	.nopiece
   1065  fdea
      0  fdea					      DEF	SAFE_CopySinglePiece
      1  fdea				   BANK_SAFE_CopySinglePiece SET	_CURRENT_BANK
      2  fdea				   SAFE_CopySinglePiece
      3  fdea				   TEMPORARY_VAR SET	Overlay
      4  fdea				   TEMPORARY_OFFSET SET	0
      5  fdea					      SUBROUTINE
   1067  fdea
   1068  fdea		       20 f2 fd 	      jsr	CopySinglePiece
   1069  fded		       a5 8b	   .nopiece   lda	savedBank
   1070  fdef		       85 3f		      sta	SET_BANK
   1071  fdf1		       60		      rts
   1072  fdf2
   1073  fdf2							;---------------------------------------------------------------------------------------------------
   1074  fdf2
      0  fdf2					      DEF	CopySinglePiece
      1  fdf2				   BANK_CopySinglePiece SET	_CURRENT_BANK
      2  fdf2				   CopySinglePiece
      3  fdf2				   TEMPORARY_VAR SET	Overlay
      4  fdf2				   TEMPORARY_OFFSET SET	0
      5  fdf2					      SUBROUTINE
   1076  fdf2					      SUBROUTINE
      0  fdf2					      TIMING	COPYSINGLEPIECE, 2150
      1  fdf2		       00 22	   SPEEDOF_COPYSINGLEPIECE =	(2150/64) + 1
   1078  fdf2
   1079  fdf2							; WARNING: CANNOT USE VAR/OVERLAY IN ANY ROUTINE CALLING THIS!!
   1080  fdf2							; This routine will STOMP on those vars due to __pieceShapeBuffer occupying whole overlay
   1081  fdf2
   1082  fdf2
   1083  fdf2							; @2150 max
   1084  fdf2							; = 33 TIM64T
   1085  fdf2
   1086  fdf2
   1087  fdf2		       a9 08		      lda	#RAMBANK_MOVES_RAM
   1088  fdf4		       85 3e		      sta	SET_BANK_RAM
   1089  fdf6		       20 ae f3 	      jsr	CopySetup
   1090  fdf9
   1091  fdf9
      0  fdf9					      DEF	InterceptMarkerCopy
      1  fdf9				   BANK_InterceptMarkerCopy SET	_CURRENT_BANK
      2  fdf9				   InterceptMarkerCopy
      3  fdf9				   TEMPORARY_VAR SET	Overlay
      4  fdf9				   TEMPORARY_OFFSET SET	0
      5  fdf9					      SUBROUTINE
   1093  fdf9
   1094  fdf9							; Copy a piece shape (3 PF bytes wide x 24 lines) to the RAM buffer
   1095  fdf9							; y = piece index
   1096  fdf9
   1097  fdf9		       a9 08		      lda	#BANK_PIECE_VECTOR_BANK
   1098  fdfb		       85 3f		      sta	SET_BANK
   1099  fdfd
   1100  fdfd		       b9 00 f0 	      lda	PIECE_VECTOR_LO,y
   1101  fe00		       85 ed		      sta	__ptr
   1102  fe02		       b9 90 f0 	      lda	PIECE_VECTOR_HI,y
   1103  fe05		       85 ee		      sta	__ptr+1
   1104  fe07		       b9 20 f1 	      lda	PIECE_VECTOR_BANK,y
   1105  fe0a		       85 3f		      sta	SET_BANK
   1106  fe0c
   1107  fe0c		       a0 47		      ldy	#PIECE_SHAPE_SIZE-1
   1108  fe0e		       b1 ed	   .copy      lda	(__ptr),y
   1109  fe10		       99 a5 00 	      sta	__pieceShapeBuffer,y
   1110  fe13		       88		      dey
   1111  fe14		       10 f8		      bpl	.copy
   1112  fe16
   1113  fe16		       a5 80		      lda	drawPieceNumber
   1114  fe18		       4a		      lsr
   1115  fe19		       4a		      lsr
   1116  fe1a		       4a		      lsr		; and D2-> carry (cc = left, cs = right)
   1117  fe1b		       49 07		      eor	#7
   1118  fe1d		       85 3e		      sta	SET_BANK_RAM
   1119  fe1f
   1120  fe1f		       4c 9b f1 	      jmp	CopyPieceToRowBitmap
   1121  fe22
   1122  fe22
   1123  fe22							;---------------------------------------------------------------------------------------------------
   1124  fe22
      0  fe22					      DEF	FinaliseMove
      1  fe22				   BANK_FinaliseMove SET	_CURRENT_BANK
      2  fe22				   FinaliseMove
      3  fe22				   TEMPORARY_VAR SET	Overlay
      4  fe22				   TEMPORARY_OFFSET SET	0
      5  fe22					      SUBROUTINE
   1126  fe22					      SUBROUTINE
   1127  fe22
   1128  fe22							; Now the visible movement on the board has happened, fix up the pointers to the pieces
   1129  fe22							; for both sides.
   1130  fe22
   1131  fe22
   1132  fe22		       a5 9d		      lda	sideToMove
   1133  fe24		       0a		      asl
   1134  fe25		       a9 09		      lda	#RAMBANK_PLY
   1135  fe27		       69 00		      adc	#0
   1136  fe29		       85 3e		      sta	SET_BANK_RAM
   1137  fe2b
   1138  fe2b		       20 89 f2 	      jsr	FixPieceList
   1139  fe2e
   1140  fe2e		       a5 86		      lda	toX12
   1141  fe30		       85 85		      sta	fromX12	; there MAY be no other-side piece at this square - that is OK!
   1142  fe32		       a9 00		      lda	#0
   1143  fe34		       85 86		      sta	toX12	; --> deleted (square=0)
   1144  fe36
   1145  fe36
   1146  fe36
   1147  fe36		       a5 a1		      lda	lastPiece
   1148  fe38		       f0 0e		      beq	.notake
   1149  fe3a
   1150  fe3a		       a5 9d		      lda	sideToMove
   1151  fe3c		       49 80		      eor	#128
   1152  fe3e		       0a		      asl
   1153  fe3f		       a9 09		      lda	#RAMBANK_PLY
   1154  fe41		       69 00		      adc	#0
   1155  fe43		       85 3e		      sta	SET_BANK_RAM
   1156  fe45
   1157  fe45		       20 89 f2 	      jsr	FixPieceList	; REMOVE any captured object
   1158  fe48
   1159  fe48		       60	   .notake    rts
   1160  fe49
   1161  fe49
   1162  fe49							;---------------------------------------------------------------------------------------------------
   1163  fe49
      0  fe49					      DEF	SAFE_getMoveIndex
      1  fe49				   BANK_SAFE_getMoveIndex SET	_CURRENT_BANK
      2  fe49				   SAFE_getMoveIndex
      3  fe49				   TEMPORARY_VAR SET	Overlay
      4  fe49				   TEMPORARY_OFFSET SET	0
      5  fe49					      SUBROUTINE
   1165  fe49					      SUBROUTINE
   1166  fe49
   1167  fe49		       a9 09		      lda	#RAMBANK_PLY
   1168  fe4b		       85 3e		      sta	SET_BANK_RAM
   1169  fe4d		       ad a1 f1 	      lda	moveIndex
   1170  fe50		       a6 8b		      ldx	savedBank
   1171  fe52		       86 3f		      stx	SET_BANK
   1172  fe54		       60		      rts
   1173  fe55
   1174  fe55
   1175  fe55							;---------------------------------------------------------------------------------------------------
   1176  fe55
      0  fe55					      DEF	SAFE_showMoveOptions
      1  fe55				   BANK_SAFE_showMoveOptions SET	_CURRENT_BANK
      2  fe55				   SAFE_showMoveOptions
      3  fe55				   TEMPORARY_VAR SET	Overlay
      4  fe55				   TEMPORARY_OFFSET SET	0
      5  fe55					      SUBROUTINE
   1178  fe55					      SUBROUTINE
   1179  fe55
   1180  fe55							;SAFETIME = 40 	  ; time required to be able to safely do a piece draw TODO: optimise
   1181  fe55
   1182  fe55
   1183  fe55							; place a marker on the board for any square matching the piece
   1184  fe55							; EXCEPT for squares which are occupied (we'll flash those later)
   1185  fe55							; x = movelist item # being checked
   1186  fe55
   1187  fe55
   1188  fe55		       a6 92	   .next      ldx	aiMoveIndex
   1189  fe57		       30 39		      bmi	.skip
   1190  fe59
   1191  fe59		       c6 92		      dec	aiMoveIndex
   1192  fe5b
   1193  fe5b		       a9 09		      lda	#RAMBANK_PLY	; current player
   1194  fe5d		       85 3e		      sta	SET_BANK_RAM
   1195  fe5f
   1196  fe5f		       bd 8e f0 	      lda	MoveFrom,x
   1197  fe62		       c5 90		      cmp	aiFromSquareX12
   1198  fe64		       d0 ef		      bne	.next
   1199  fe66
   1200  fe66		       bc 00 f1 	      ldy	MoveTo,x
   1201  fe69
   1202  fe69							; If it's a pawn promote (duplicate "to" AND piece different (TODO) then skip others)
   1203  fe69
   1204  fe69		       98		      tya
   1205  fe6a		       ca	   .sk	      dex
   1206  fe6b		       30 0b		      bmi	.prom
   1207  fe6d		       dd 00 f1 	      cmp	MoveTo,x
   1208  fe70		       d0 06		      bne	.prom
   1209  fe72
   1210  fe72		       c6 92		      dec	aiMoveIndex
   1211  fe74		       c6 92		      dec	aiMoveIndex
   1212  fe76		       c6 92		      dec	aiMoveIndex
   1213  fe78				   .prom
   1214  fe78
   1215  fe78
   1216  fe78
   1217  fe78		       a9 08		      lda	#RAMBANK_MOVES_RAM
   1218  fe7a		       85 3e		      sta	SET_BANK_RAM
   1219  fe7c
   1220  fe7c		       b9 7c f0 	      lda	Board,y
   1221  fe7f		       d0 d4		      bne	.next	; don't draw dots on captures - they are flashed later
   1222  fe81
   1223  fe81
   1224  fe81		       a9 0d		      lda	#BANK_X12toBase64b
   1225  fe83		       85 3f		      sta	SET_BANK
   1226  fe85
   1227  fe85		       b9 00 f4 	      lda	X12toBase64b,y
   1228  fe88		       85 80		      sta	drawPieceNumber
   1229  fe8a
   1230  fe8a		       a2 1c		      ldx	#INDEX_WHITE_MARKER_on_WHITE_SQUARE_0
   1231  fe8c		       20 8d f3 	      jsr	CopySetupForMarker
   1232  fe8f		       20 f9 fd 	      jsr	InterceptMarkerCopy
   1233  fe92
   1234  fe92		       a5 8b	   .skip      lda	savedBank
   1235  fe94		       85 3f		      sta	SET_BANK
   1236  fe96		       60		      rts
   1237  fe97
   1238  fe97
   1239  fe97							;---------------------------------------------------------------------------------------------------
   1240  fe97
      0  fe97					      DEF	SAFE_showPromoteOptions
      1  fe97				   BANK_SAFE_showPromoteOptions SET	_CURRENT_BANK
      2  fe97				   SAFE_showPromoteOptions
      3  fe97				   TEMPORARY_VAR SET	Overlay
      4  fe97				   TEMPORARY_OFFSET SET	0
      5  fe97					      SUBROUTINE
   1242  fe97					      SUBROUTINE
   1243  fe97
   1244  fe97							; Pass 	 X = character shape # (?/N/B/R/Q)
   1245  fe97
   1246  fe97		       a4 86		      ldy	toX12
   1247  fe99
   1248  fe99		       a9 0d		      lda	#BANK_X12toBase64b
   1249  fe9b		       85 3f		      sta	SET_BANK
   1250  fe9d
   1251  fe9d		       b9 00 f4 	      lda	X12toBase64b,y
   1252  fea0		       85 80		      sta	drawPieceNumber
   1253  fea2
   1254  fea2		       a9 08		      lda	#RAMBANK_MOVES_RAM
   1255  fea4		       85 3e		      sta	SET_BANK_RAM
   1256  fea6		       20 8d f3 	      jsr	CopySetupForMarker
   1257  fea9
   1258  fea9		       20 f9 fd 	      jsr	InterceptMarkerCopy
   1259  feac
   1260  feac		       a5 8b		      lda	savedBank
   1261  feae		       85 3f		      sta	SET_BANK
   1262  feb0		       60		      rts
   1263  feb1
   1264  feb1							;---------------------------------------------------------------------------------------------------
   1265  feb1
      0  feb1					      DEF	SAFE_BackupBitmaps
      1  feb1				   BANK_SAFE_BackupBitmaps SET	_CURRENT_BANK
      2  feb1				   SAFE_BackupBitmaps
      3  feb1				   TEMPORARY_VAR SET	Overlay
      4  feb1				   TEMPORARY_OFFSET SET	0
      5  feb1					      SUBROUTINE
   1267  feb1
   1268  feb1		       84 3e		      sty	SET_BANK_RAM
   1269  feb3		       20 ec f2 	      jsr	SaveBitmap
   1270  feb6		       a5 8b		      lda	savedBank
   1271  feb8		       85 3f		      sta	SET_BANK
   1272  feba		       60		      rts
   1273  febb
   1274  febb							;---------------------------------------------------------------------------------------------------
   1275  febb
      0  febb					      DEF	SAFE_IsSquareUnderAttack
      1  febb				   BANK_SAFE_IsSquareUnderAttack SET	_CURRENT_BANK
      2  febb				   SAFE_IsSquareUnderAttack
      3  febb				   TEMPORARY_VAR SET	Overlay
      4  febb				   TEMPORARY_OFFSET SET	0
      5  febb					      SUBROUTINE
   1277  febb
   1278  febb							; Check if passed X12 square is in the "TO" squares in the movelist (and thus under attack)
   1279  febb
   1280  febb							; Pass:	 currentPly = which movelist to check
   1281  febb							;		 A = X12 square to check
   1282  febb							; Return:	 CC = No, CS = Yes
   1283  febb
   1284  febb		       a6 9b		      ldx	currentPly
   1285  febd		       86 3e		      stx	SET_BANK_RAM
   1286  febf		       20 45 f3 	      jsr	IsSquareUnderAttack
   1287  fec2		       a5 8b		      lda	savedBank
   1288  fec4		       85 3f		      sta	SET_BANK
   1289  fec6		       60		      rts
   1290  fec7
   1291  fec7							;---------------------------------------------------------------------------------------------------
   1292  fec7
      0  fec7					      DEF	SAFE_showMoveCaptures
      1  fec7				   BANK_SAFE_showMoveCaptures SET	_CURRENT_BANK
      2  fec7				   SAFE_showMoveCaptures
      3  fec7				   TEMPORARY_VAR SET	Overlay
      4  fec7				   TEMPORARY_OFFSET SET	0
      5  fec7					      SUBROUTINE
   1294  fec7					      SUBROUTINE
   1295  fec7
   1296  fec7		       a9 0c		      lda	#BANK_UNSAFE_showMoveCaptures
   1297  fec9		       85 3f		      sta	SET_BANK
   1298  fecb		       20 00 f0 	      jsr	UNSAFE_showMoveCaptures
   1299  fece		       a5 8b		      lda	savedBank
   1300  fed0		       85 3f		      sta	SET_BANK
   1301  fed2		       60		      rts
   1302  fed3
   1303  fed3
   1304  fed3							;---------------------------------------------------------------------------------------------------
   1305  fed3
      0  fed3					      DEF	GetMoveFrom
      1  fed3				   BANK_GetMoveFrom SET	_CURRENT_BANK
      2  fed3				   GetMoveFrom
      3  fed3				   TEMPORARY_VAR SET	Overlay
      4  fed3				   TEMPORARY_OFFSET SET	0
      5  fed3					      SUBROUTINE
   1307  fed3		       a9 09		      lda	#RAMBANK_PLY
   1308  fed5		       85 3e		      sta	SET_BANK_RAM
   1309  fed7		       a4 8b		      ldy	savedBank
   1310  fed9		       bd 8e f0 	      lda	MoveFrom,x
   1311  fedc		       84 3f		      sty	SET_BANK
   1312  fede		       60		      rts
   1313  fedf
      0  fedf					      DEF	GetMoveTo
      1  fedf				   BANK_GetMoveTo SET	_CURRENT_BANK
      2  fedf				   GetMoveTo
      3  fedf				   TEMPORARY_VAR SET	Overlay
      4  fedf				   TEMPORARY_OFFSET SET	0
      5  fedf					      SUBROUTINE
   1315  fedf		       a9 09		      lda	#RAMBANK_PLY
   1316  fee1		       85 3e		      sta	SET_BANK_RAM
   1317  fee3		       a4 8b		      ldy	savedBank
   1318  fee5		       bd 00 f1 	      lda	MoveTo,x
   1319  fee8		       84 3f		      sty	SET_BANK
   1320  feea		       60		      rts
   1321  feeb
   1322  feeb
   1323  feeb
   1324  feeb							;---------------------------------------------------------------------------------------------------
   1325  feeb
 FREE BYTES IN FIXED BANK =  $111
   1326  feeb					      ECHO	"FREE BYTES IN FIXED BANK = ", $FFFC - *
   1327  feeb
   1328  feeb
   1329  feeb							;---------------------------------------------------------------------------------------------------
   1330  feeb							; The reset vectors
   1331  feeb							; these must live in the fixed bank (last 2K of any ROM image in "3E" scheme)
   1332  feeb
   1333  10000 ????				       SEG	InterruptVectors
   1334  fffc					      ORG	FIXED_BANK + $7FC
   1335  fffc					      RORG	$7ffC
   1336  fffc
   1337  fffc		       00 f8		      .word.w	Reset	; RESET
   1338  fffe		       00 f8		      .word.w	Reset	; IRQ	      (not used)
   1339  10000
   1340  10000							;---------------------------------------------------------------------------------------------------
   1341  10000							; EOF
------- FILE ./chess.asm
    480  10000
    481  10000							;END
